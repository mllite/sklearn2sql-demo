-- This SQL code was generated by sklearn2sql (development version).
-- Copyright 2018

-- Model : DecisionTreeRegressor_Pipeline
-- Dataset : freidman3
-- Database : pgsql


-- This SQL code can contain one or more statements, to be executed in the order they appear in this file.



-- Code For temporary table TMP_20221018190302_UXCL018_ADS_imp_1_OUT part 1. Create 


CREATE TEMPORARY TABLE "TMP_20221018190302_UXCL018_ADS_imp_1_OUT" (
	"KEY" BIGINT NOT NULL, 
	imputer_output_2 FLOAT, 
	imputer_output_3 FLOAT, 
	imputer_output_4 FLOAT, 
	imputer_output_5 FLOAT, 
	PRIMARY KEY ("KEY")
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table TMP_20221018190302_UXCL018_ADS_imp_1_OUT part 2. Populate

INSERT INTO "TMP_20221018190302_UXCL018_ADS_imp_1_OUT" ("KEY", imputer_output_2, imputer_output_3, imputer_output_4, imputer_output_5) SELECT "T"."KEY", "T".imputer_output_2, "T".imputer_output_3, "T".imputer_output_4, "T".imputer_output_5 
FROM (SELECT "ADS_imp_1_OUT"."KEY" AS "KEY", "ADS_imp_1_OUT".imputer_output_2 AS imputer_output_2, "ADS_imp_1_OUT".imputer_output_3 AS imputer_output_3, "ADS_imp_1_OUT".imputer_output_4 AS imputer_output_4, "ADS_imp_1_OUT".imputer_output_5 AS imputer_output_5 
FROM (SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_0" IS NULL) THEN 43.79128122207401 ELSE "ADS"."Feature_0" END AS imputer_output_2, CASE WHEN ("ADS"."Feature_1" IS NULL) THEN 945.9672833084396 ELSE "ADS"."Feature_1" END AS imputer_output_3, CASE WHEN ("ADS"."Feature_2" IS NULL) THEN 0.5310009099975209 ELSE "ADS"."Feature_2" END AS imputer_output_4, CASE WHEN ("ADS"."Feature_3" IS NULL) THEN 6.139967152050499 ELSE "ADS"."Feature_3" END AS imputer_output_5 
FROM freidman3 AS "ADS") AS "ADS_imp_1_OUT") AS "T"

-- Code For temporary table TMP_20221018190302_UXCL018_ADS_imp_1_OUT part 3. Create Index 

CREATE INDEX "ix_TMP_20221018190302_UXCL018_ADS_imp_1_OUT_KEY" ON "TMP_20221018190302_UXCL018_ADS_imp_1_OUT" ("KEY")

-- Code For temporary table TMP_20221018190302_NJLI14J_ADS_sca_2_OUT part 1. Create 


CREATE TEMPORARY TABLE "TMP_20221018190302_NJLI14J_ADS_sca_2_OUT" (
	"KEY" BIGINT NOT NULL, 
	scaler_output_2 FLOAT, 
	scaler_output_3 FLOAT, 
	scaler_output_4 FLOAT, 
	scaler_output_5 FLOAT, 
	PRIMARY KEY ("KEY")
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table TMP_20221018190302_NJLI14J_ADS_sca_2_OUT part 2. Populate

INSERT INTO "TMP_20221018190302_NJLI14J_ADS_sca_2_OUT" ("KEY", scaler_output_2, scaler_output_3, scaler_output_4, scaler_output_5) SELECT "T"."KEY", "T".scaler_output_2, "T".scaler_output_3, "T".scaler_output_4, "T".scaler_output_5 
FROM (SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", "ADS_sca_2_OUT".scaler_output_2 AS scaler_output_2, "ADS_sca_2_OUT".scaler_output_3 AS scaler_output_3, "ADS_sca_2_OUT".scaler_output_4 AS scaler_output_4, "ADS_sca_2_OUT".scaler_output_5 AS scaler_output_5 
FROM (SELECT "ADS_imp_1_OUT"."KEY" AS "KEY", (CAST("ADS_imp_1_OUT".imputer_output_2 AS FLOAT) - 43.79128122207401) / 26.03562357622511 AS scaler_output_2, (CAST("ADS_imp_1_OUT".imputer_output_3 AS FLOAT) - 945.9672833084396) / 461.4552766146446 AS scaler_output_3, (CAST("ADS_imp_1_OUT".imputer_output_4 AS FLOAT) - 0.5310009099975209) / 0.2901863282144786 AS scaler_output_4, (CAST("ADS_imp_1_OUT".imputer_output_5 AS FLOAT) - 6.139967152050499) / 3.072917242564058 AS scaler_output_5 
FROM "TMP_20221018190302_UXCL018_ADS_imp_1_OUT" AS "ADS_imp_1_OUT") AS "ADS_sca_2_OUT") AS "T"

-- Code For temporary table TMP_20221018190302_NJLI14J_ADS_sca_2_OUT part 3. Create Index 

CREATE INDEX "ix_TMP_20221018190302_NJLI14J_ADS_sca_2_OUT_KEY" ON "TMP_20221018190302_NJLI14J_ADS_sca_2_OUT" ("KEY")

-- Model deployment code

WITH "DT_node_lookup" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_output_4 <= -1.4309000372886658) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -0.5874325856566429) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_4 <= -1.7431707978248596) THEN 3 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.4679744988679886) THEN 5 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= 1.3414755463600159) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -0.9926323592662811) THEN 8 ELSE 9 END ELSE 10 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -1.0840756297111511) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 0.0887349471449852) THEN 13 ELSE 14 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_5 <= -0.14987096190452576) THEN 16 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.2956656664609909) THEN 18 ELSE 19 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 0.6816338896751404) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -1.4988391995429993) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_5 <= 0.5453606434166431) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_4 <= -0.0005476325750350952) THEN 24 ELSE 25 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -1.717117726802826) THEN 27 ELSE 28 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_4 <= -1.1697484254837036) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= 1.10731241106987) THEN 31 ELSE 32 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -0.9979358315467834) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -1.3966397047042847) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= 0.6280219256877899) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= 0.020498842000961304) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_5 <= 1.0123527646064758) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_4 <= 0.7431471608579159) THEN 39 ELSE 40 END ELSE 41 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= 0.42866186797618866) THEN 43 ELSE 44 END END ELSE 45 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_4 <= 0.2322053387761116) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_5 <= 1.0737027525901794) THEN 48 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_4 <= -0.46476496011018753) THEN 50 ELSE 51 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_5 <= 0.3301943149417639) THEN 53 ELSE 54 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.013251647469587624) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_4 <= -0.07885412126779556) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_5 <= -1.5075144171714783) THEN 58 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_5 <= -0.6148404628038406) THEN 60 ELSE 61 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -1.2677711248397827) THEN 63 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -0.7974012792110443) THEN 65 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -0.23644034564495087) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -0.3808511644601822) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_5 <= -0.14239919185638428) THEN 69 ELSE 70 END ELSE 71 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_5 <= 1.26242196559906) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_4 <= 0.3696778789162636) THEN 74 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_4 <= 1.1107220649719238) THEN 76 ELSE 77 END END ELSE 78 END END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_4 <= -0.5779826641082764) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -0.157425194978714) THEN 81 ELSE 82 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 0.3047986254096031) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_5 <= 0.35247907042503357) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_4 <= -0.18692036718130112) THEN 86 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -0.19583164900541306) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -0.3807009756565094) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= 0.4673061817884445) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_4 <= 0.4007360674440861) THEN 91 ELSE 92 END ELSE 93 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_5 <= -0.9217544496059418) THEN 95 ELSE 96 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= 0.35755085945129395) THEN 98 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= 0.7350868582725525) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_5 <= -0.5815658569335938) THEN 101 ELSE 102 END ELSE 103 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= 0.5796983548207209) THEN 105 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -0.06669343076646328) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_4 <= 0.10831808298826218) THEN 108 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_5 <= 1.1773918867111206) THEN 110 ELSE 111 END END ELSE 112 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= 0.824400007724762) THEN 114 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_5 <= -1.113603562116623) THEN 116 ELSE 117 END END END END END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.20375587046146393) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_5 <= -0.7887826561927795) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -1.494538426399231) THEN 121 ELSE 122 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.8670860826969147) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -1.5442689657211304) THEN 125 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_5 <= 0.054462283849716187) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 1.2351047694683075) THEN 128 ELSE 129 END ELSE 130 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_4 <= -1.1209805607795715) THEN 132 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 1.5003243684768677) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 1.1446196734905243) THEN 135 ELSE 136 END ELSE 137 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_4 <= -1.0818235576152802) THEN 139 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_4 <= -0.49651999771595) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= 0.3182849586009979) THEN 142 ELSE 143 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_5 <= 0.2622483856976032) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_5 <= -0.8360162265598774) THEN 146 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 1.2282309532165527) THEN 148 ELSE 149 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_5 <= 0.955989420413971) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 1.1709603071212769) THEN 152 ELSE 153 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_5 <= 1.2161926627159119) THEN 155 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 0.8529378771781921) THEN 157 ELSE 158 END END END END END END END END END AS node_id_2 
FROM "TMP_20221018190302_NJLI14J_ADS_sca_2_OUT" AS "ADS_sca_2_OUT"), 
"DT_node_data" AS 
(SELECT "Values".nid AS nid, "Values"."E" AS "E" 
FROM (SELECT 3 AS nid, 0.6100168381304848 AS "E" UNION ALL SELECT 5 AS nid, 1.1409162524546155 AS "E" UNION ALL SELECT 8 AS nid, 1.350090108150775 AS "E" UNION ALL SELECT 9 AS nid, 1.3687175770364277 AS "E" UNION ALL SELECT 10 AS nid, 1.4092998433520778 AS "E" UNION ALL SELECT 13 AS nid, 0.8079109230317987 AS "E" UNION ALL SELECT 14 AS nid, 0.7050714675464733 AS "E" UNION ALL SELECT 16 AS nid, 0.4848669214064692 AS "E" UNION ALL SELECT 18 AS nid, 0.3751675659770648 AS "E" UNION ALL SELECT 19 AS nid, 0.38342473185592096 AS "E" UNION ALL SELECT 24 AS nid, 1.1156147639563705 AS "E" UNION ALL SELECT 25 AS nid, 1.1610071359052208 AS "E" UNION ALL SELECT 27 AS nid, 1.5359670902044162 AS "E" UNION ALL SELECT 28 AS nid, 1.4518609404362353 AS "E" UNION ALL SELECT 31 AS nid, 1.314325621172093 AS "E" UNION ALL SELECT 32 AS nid, 1.341344197483337 AS "E" UNION ALL SELECT 39 AS nid, 1.5696790399866454 AS "E" UNION ALL SELECT 40 AS nid, 1.570583991203967 AS "E" UNION ALL SELECT 41 AS nid, 1.5684866939082733 AS "E" UNION ALL SELECT 43 AS nid, 1.5646091245855271 AS "E" UNION ALL SELECT 44 AS nid, 1.5642723241110825 AS "E" UNION ALL SELECT 45 AS nid, 1.5543288470291443 AS "E" UNION ALL SELECT 48 AS nid, 1.5278745466047203 AS "E" UNION ALL SELECT 50 AS nid, 1.536711230505171 AS "E" UNION ALL SELECT 51 AS nid, 1.541589567106448 AS "E" UNION ALL SELECT 53 AS nid, 1.5623228105763816 AS "E" UNION ALL SELECT 54 AS nid, 1.556101969927248 AS "E" UNION ALL SELECT 58 AS nid, 1.3678941404936502 AS "E" UNION ALL SELECT 60 AS nid, 1.410743936534041 AS "E" UNION ALL SELECT 61 AS nid, 1.4251802174855326 AS "E" UNION ALL SELECT 63 AS nid, 1.3844945172080796 AS "E" UNION ALL SELECT 65 AS nid, 1.534059281886407 AS "E" UNION ALL SELECT 69 AS nid, 1.496561917506885 AS "E" UNION ALL SELECT 70 AS nid, 1.499027385598966 AS "E" UNION ALL SELECT 71 AS nid, 1.4872578515104244 AS "E" UNION ALL SELECT 74 AS nid, 1.467648677980467 AS "E" UNION ALL SELECT 76 AS nid, 1.4642487267988717 AS "E" UNION ALL SELECT 77 AS nid, 1.4608890093126605 AS "E" UNION ALL SELECT 78 AS nid, 1.4929217934494698 AS "E" UNION ALL SELECT 81 AS nid, 1.477951453333812 AS "E" UNION ALL SELECT 82 AS nid, 1.4771263961886638 AS "E" UNION ALL SELECT 86 AS nid, 1.50778906671016 AS "E" UNION ALL SELECT 91 AS nid, 1.5278956973377713 AS "E" UNION ALL SELECT 92 AS nid, 1.527629409709021 AS "E" UNION ALL SELECT 93 AS nid, 1.5318155845359613 AS "E" UNION ALL SELECT 95 AS nid, 1.5352537026948319 AS "E" UNION ALL SELECT 96 AS nid, 1.5325692862833142 AS "E" UNION ALL SELECT 98 AS nid, 1.5309500463495263 AS "E" UNION ALL SELECT 101 AS nid, 1.5220836338497605 AS "E" UNION ALL SELECT 102 AS nid, 1.5216942430501499 AS "E" UNION ALL SELECT 103 AS nid, 1.521297715153797 AS "E" UNION ALL SELECT 105 AS nid, 1.5248539791622286 AS "E" UNION ALL SELECT 108 AS nid, 1.54561918356505 AS "E" UNION ALL SELECT 110 AS nid, 1.5440465088777178 AS "E" UNION ALL SELECT 111 AS nid, 1.5437502494470967 AS "E" UNION ALL SELECT 112 AS nid, 1.5374002322115805 AS "E" UNION ALL SELECT 114 AS nid, 1.484710993001392 AS "E" UNION ALL SELECT 116 AS nid, 1.5032073896269296 AS "E" UNION ALL SELECT 117 AS nid, 1.5126619620701551 AS "E" UNION ALL SELECT 121 AS nid, 1.0274843519223331 AS "E" UNION ALL SELECT 122 AS nid, 1.076547084481779 AS "E" UNION ALL SELECT 125 AS nid, 1.1440564349145939 AS "E" UNION ALL SELECT 128 AS nid, 1.278877589279357 AS "E" UNION ALL SELECT 129 AS nid, 1.2794872288206998 AS "E" UNION ALL SELECT 130 AS nid, 1.26722341655496 AS "E" UNION ALL SELECT 132 AS nid, 1.1968265037681187 AS "E" UNION ALL SELECT 135 AS nid, 1.1082904037450438 AS "E" UNION ALL SELECT 136 AS nid, 1.1063441203172228 AS "E" UNION ALL SELECT 137 AS nid, 1.1577860434316234 AS "E" UNION ALL SELECT 139 AS nid, 1.0818920012987259 AS "E" UNION ALL SELECT 142 AS nid, 1.3498429932286293 AS "E" UNION ALL SELECT 143 AS nid, 1.3463614795691619 AS "E" UNION ALL SELECT 146 AS nid, 1.4932233184960249 AS "E" UNION ALL SELECT 148 AS nid, 1.5028235051542993 AS "E" UNION ALL SELECT 149 AS nid, 1.5099001489420028 AS "E" UNION ALL SELECT 152 AS nid, 1.4719390289797578 AS "E" UNION ALL SELECT 153 AS nid, 1.4670826204003844 AS "E" UNION ALL SELECT 155 AS nid, 1.4949662645575934 AS "E" UNION ALL SELECT 157 AS nid, 1.4860572646626233 AS "E" UNION ALL SELECT 158 AS nid, 1.4783281269798374 AS "E") AS "Values"), 
"DT_Output" AS 
(SELECT "DT_node_lookup"."KEY" AS "KEY", "DT_node_lookup".node_id_2 AS node_id_2, "DT_node_data".nid AS nid, "DT_node_data"."E" AS "E" 
FROM "DT_node_lookup" LEFT OUTER JOIN "DT_node_data" ON "DT_node_lookup".node_id_2 = "DT_node_data".nid)
 SELECT "DT_Output"."KEY" AS "KEY", "DT_Output"."E" AS "Estimator" 
FROM "DT_Output"