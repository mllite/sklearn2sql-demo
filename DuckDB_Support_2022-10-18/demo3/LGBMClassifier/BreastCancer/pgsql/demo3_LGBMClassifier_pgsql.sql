-- This SQL code was generated by sklearn2sql (development version).
-- Copyright 2018

-- Model : LGBMClassifier
-- Dataset : BreastCancer
-- Database : pgsql


-- This SQL code can contain one or more statements, to be executed in the order they appear in this file.



-- Code For temporary table TMP_20221018185052_T8C9SXC_LGBM_B0 part 1. Create 


CREATE TEMPORARY TABLE "TMP_20221018185052_T8C9SXC_LGBM_B0" (
	"KEY" BIGINT, 
	"Score_0" FLOAT
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table TMP_20221018185052_T8C9SXC_LGBM_B0 part 2. Populate

WITH "DT_node_lookup" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_27" <= 0.14545000000000005) THEN CASE WHEN ("ADS"."Feature_0" <= 15.475000000000003) THEN CASE WHEN ("ADS"."Feature_13" <= 32.85000000000001) THEN CASE WHEN ("ADS"."Feature_1" <= 24.355000000000004) THEN 16 ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS"."Feature_23" <= 822.8500000000001) THEN 6 ELSE CASE WHEN ("ADS"."Feature_0" <= 19.240000000000006) THEN 14 ELSE 15 END END END AS node_id_2 
FROM "BreastCancer" AS "ADS"), 
"DT_node_data" AS 
(SELECT "Values".nid AS nid, "Values"."Score" AS "Score" 
FROM (SELECT 5 AS nid, 0.5354058820751393 AS "Score" UNION ALL SELECT 6 AS nid, 0.5354058820751393 AS "Score" UNION ALL SELECT 9 AS nid, 0.6535482271280002 AS "Score" UNION ALL SELECT 14 AS nid, 0.46961403722534256 AS "Score" UNION ALL SELECT 15 AS nid, 0.46961403722534256 AS "Score" UNION ALL SELECT 16 AS nid, 0.6889201867246652 AS "Score" UNION ALL SELECT 17 AS nid, 0.677954879249699 AS "Score") AS "Values"), 
"DT_Output" AS 
(SELECT "DT_node_lookup"."KEY" AS "KEY", "DT_node_lookup".node_id_2 AS node_id_2, "DT_node_data".nid AS nid, "DT_node_data"."Score" AS "Score" 
FROM "DT_node_lookup" LEFT OUTER JOIN "DT_node_data" ON "DT_node_lookup".node_id_2 = "DT_node_data".nid), 
"LGBM_Model_0_0" AS 
(SELECT "DT_Output"."KEY" AS "KEY", "DT_Output"."Score" AS "Score_0" 
FROM "DT_Output"), 
"DT_node_lookup_1" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_27" <= 0.14545000000000005) THEN CASE WHEN ("ADS"."Feature_23" <= 896.9500000000002) THEN CASE WHEN ("ADS"."Feature_13" <= 32.85000000000001) THEN CASE WHEN ("ADS"."Feature_28" <= 0.33055000000000007) THEN CASE WHEN ("ADS"."Feature_5" <= 0.11675) THEN CASE WHEN ("ADS"."Feature_1" <= 22.645000000000003) THEN 64 ELSE 65 END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS"."Feature_23" <= 822.8500000000001) THEN 6 ELSE 7 END END AS node_id_2 
FROM "BreastCancer" AS "ADS"), 
"DT_node_data_1" AS 
(SELECT "Values".nid AS nid, "Values"."Score" AS "Score" 
FROM (SELECT 5 AS nid, -0.07207546120951412 AS "Score" UNION ALL SELECT 6 AS nid, -0.07100347765468033 AS "Score" UNION ALL SELECT 7 AS nid, -0.12996883510683102 AS "Score" UNION ALL SELECT 9 AS nid, 0.04018284481296092 AS "Score" UNION ALL SELECT 17 AS nid, 0.06390352547532467 AS "Score" UNION ALL SELECT 33 AS nid, 0.07558108215614001 AS "Score" UNION ALL SELECT 64 AS nid, 0.07510590061677179 AS "Score" UNION ALL SELECT 65 AS nid, 0.07531369139275672 AS "Score") AS "Values"), 
"DT_Output_1" AS 
(SELECT "DT_node_lookup_1"."KEY" AS "KEY", "DT_node_lookup_1".node_id_2 AS node_id_2, "DT_node_data_1".nid AS nid, "DT_node_data_1"."Score" AS "Score" 
FROM "DT_node_lookup_1" LEFT OUTER JOIN "DT_node_data_1" ON "DT_node_lookup_1".node_id_2 = "DT_node_data_1".nid), 
"LGBM_Model_0_1" AS 
(SELECT "DT_Output_1"."KEY" AS "KEY", "DT_Output_1"."Score" AS "Score_0" 
FROM "DT_Output_1"), 
"DT_node_lookup_2" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_27" <= 0.14545000000000005) THEN CASE WHEN ("ADS"."Feature_23" <= 896.9500000000002) THEN CASE WHEN ("ADS"."Feature_13" <= 32.85000000000001) THEN CASE WHEN ("ADS"."Feature_19" <= 0.0015535000000000002) THEN 16 ELSE CASE WHEN ("ADS"."Feature_5" <= 0.12075000000000001) THEN CASE WHEN ("ADS"."Feature_28" <= 0.32245000000000007) THEN CASE WHEN ("ADS"."Feature_1" <= 22.415000000000003) THEN CASE WHEN ("ADS"."Feature_5" <= 0.10570000000000002) THEN 272 ELSE 273 END ELSE 137 END ELSE 69 END ELSE 35 END END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS"."Feature_23" <= 822.8500000000001) THEN 6 ELSE CASE WHEN ("ADS"."Feature_0" <= 20.515000000000004) THEN 14 ELSE 15 END END END AS node_id_2 
FROM "BreastCancer" AS "ADS"), 
"DT_node_data_2" AS 
(SELECT "Values".nid AS nid, "Values"."Score" AS "Score" 
FROM (SELECT 5 AS nid, -0.0672091988345742 AS "Score" UNION ALL SELECT 6 AS nid, -0.06625954772521767 AS "Score" UNION ALL SELECT 9 AS nid, 0.038688015662857955 AS "Score" UNION ALL SELECT 14 AS nid, -0.12022246377998391 AS "Score" UNION ALL SELECT 15 AS nid, -0.12022246377998394 AS "Score" UNION ALL SELECT 16 AS nid, 0.06181830875156677 AS "Score" UNION ALL SELECT 35 AS nid, 0.07376222825488356 AS "Score" UNION ALL SELECT 69 AS nid, 0.07348300977852566 AS "Score" UNION ALL SELECT 137 AS nid, 0.07345179724796454 AS "Score" UNION ALL SELECT 272 AS nid, 0.07328936666650858 AS "Score" UNION ALL SELECT 273 AS nid, 0.07328778634908635 AS "Score") AS "Values"), 
"DT_Output_2" AS 
(SELECT "DT_node_lookup_2"."KEY" AS "KEY", "DT_node_lookup_2".node_id_2 AS node_id_2, "DT_node_data_2".nid AS nid, "DT_node_data_2"."Score" AS "Score" 
FROM "DT_node_lookup_2" LEFT OUTER JOIN "DT_node_data_2" ON "DT_node_lookup_2".node_id_2 = "DT_node_data_2".nid), 
"LGBM_Model_0_2" AS 
(SELECT "DT_Output_2"."KEY" AS "KEY", "DT_Output_2"."Score" AS "Score_0" 
FROM "DT_Output_2"), 
"DT_node_lookup_3" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_27" <= 0.14545000000000005) THEN CASE WHEN ("ADS"."Feature_0" <= 15.475000000000003) THEN CASE WHEN ("ADS"."Feature_27" <= 0.1223) THEN CASE WHEN ("ADS"."Feature_11" <= 2.0975000000000006) THEN CASE WHEN ("ADS"."Feature_13" <= 32.85000000000001) THEN CASE WHEN ("ADS"."Feature_0" <= 14.045000000000002) THEN CASE WHEN ("ADS"."Feature_21" <= 29.470000000000002) THEN CASE WHEN ("ADS"."Feature_28" <= 0.3219) THEN CASE WHEN ("ADS"."Feature_19" <= 0.0017905000000000002) THEN 512 ELSE CASE WHEN ("ADS"."Feature_5" <= 0.10685000000000001) THEN CASE WHEN ("ADS"."Feature_1" <= 19.790000000000003) THEN 2052 ELSE 2053 END ELSE 1027 END END ELSE 257 END ELSE 129 END ELSE 65 END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS"."Feature_23" <= 822.8500000000001) THEN 6 ELSE CASE WHEN ("ADS"."Feature_0" <= 20.595000000000002) THEN 14 ELSE 15 END END END AS node_id_2 
FROM "BreastCancer" AS "ADS"), 
"DT_node_data_3" AS 
(SELECT "Values".nid AS nid, "Values"."Score" AS "Score" 
FROM (SELECT 5 AS nid, -0.06377889783106465 AS "Score" UNION ALL SELECT 6 AS nid, -0.062043494897927556 AS "Score" UNION ALL SELECT 9 AS nid, 0.027400374328027034 AS "Score" UNION ALL SELECT 14 AS nid, -0.11226788386358473 AS "Score" UNION ALL SELECT 15 AS nid, -0.11226788386358476 AS "Score" UNION ALL SELECT 17 AS nid, 0.049160490322085915 AS "Score" UNION ALL SELECT 33 AS nid, 0.07403722685232066 AS "Score" UNION ALL SELECT 65 AS nid, 0.07252337908464461 AS "Score" UNION ALL SELECT 129 AS nid, 0.07185517738831212 AS "Score" UNION ALL SELECT 257 AS nid, 0.07180951745022449 AS "Score" UNION ALL SELECT 512 AS nid, 0.0717811694600263 AS "Score" UNION ALL SELECT 1027 AS nid, 0.07163488435117137 AS "Score" UNION ALL SELECT 2052 AS nid, 0.07164354982202076 AS "Score" UNION ALL SELECT 2053 AS nid, 0.07164257461988083 AS "Score") AS "Values"), 
"DT_Output_3" AS 
(SELECT "DT_node_lookup_3"."KEY" AS "KEY", "DT_node_lookup_3".node_id_2 AS node_id_2, "DT_node_data_3".nid AS nid, "DT_node_data_3"."Score" AS "Score" 
FROM "DT_node_lookup_3" LEFT OUTER JOIN "DT_node_data_3" ON "DT_node_lookup_3".node_id_2 = "DT_node_data_3".nid), 
"LGBM_Model_0_3" AS 
(SELECT "DT_Output_3"."KEY" AS "KEY", "DT_Output_3"."Score" AS "Score_0" 
FROM "DT_Output_3"), 
"DT_node_lookup_4" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_27" <= 0.14545000000000005) THEN CASE WHEN ("ADS"."Feature_23" <= 896.9500000000002) THEN CASE WHEN ("ADS"."Feature_13" <= 32.85000000000001) THEN CASE WHEN ("ADS"."Feature_19" <= 0.0015535000000000002) THEN 16 ELSE CASE WHEN ("ADS"."Feature_27" <= 0.12170000000000002) THEN CASE WHEN ("ADS"."Feature_11" <= 1.9615000000000002) THEN CASE WHEN ("ADS"."Feature_28" <= 0.3219) THEN CASE WHEN ("ADS"."Feature_21" <= 28.895000000000007) THEN CASE WHEN ("ADS"."Feature_5" <= 0.10805000000000002) THEN CASE WHEN ("ADS"."Feature_20" <= 15.075000000000001) THEN CASE WHEN ("ADS"."Feature_19" <= 0.0020995000000000002) THEN 2176 ELSE CASE WHEN ("ADS"."Feature_11" <= 1.3955000000000002) THEN CASE WHEN ("ADS"."Feature_1" <= 17.100000000000005) THEN 8708 ELSE 8709 END ELSE 4355 END END ELSE 1089 END ELSE 545 END ELSE 273 END ELSE 137 END ELSE 69 END ELSE 35 END END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS"."Feature_22" <= 112.80000000000001) THEN 6 ELSE CASE WHEN ("ADS"."Feature_13" <= 39.96500000000001) THEN 14 ELSE CASE WHEN ("ADS"."Feature_0" <= 19.76) THEN 30 ELSE 31 END END END END AS node_id_2 
FROM "BreastCancer" AS "ADS"), 
"DT_node_data_4" AS 
(SELECT "Values".nid AS nid, "Values"."Score" AS "Score" 
FROM (SELECT 5 AS nid, -0.05983718015333134 AS "Score" UNION ALL SELECT 6 AS nid, -0.059325711020958585 AS "Score" UNION ALL SELECT 9 AS nid, 0.034960545003972915 AS "Score" UNION ALL SELECT 14 AS nid, -0.10705498628918952 AS "Score" UNION ALL SELECT 16 AS nid, 0.05833468381156039 AS "Score" UNION ALL SELECT 30 AS nid, -0.10565532685824763 AS "Score" UNION ALL SELECT 31 AS nid, -0.10565532685824766 AS "Score" UNION ALL SELECT 35 AS nid, 0.07156932820328817 AS "Score" UNION ALL SELECT 69 AS nid, 0.07048745472474918 AS "Score" UNION ALL SELECT 137 AS nid, 0.07033125566359116 AS "Score" UNION ALL SELECT 273 AS nid, 0.07025887096284902 AS "Score" UNION ALL SELECT 545 AS nid, 0.07013740187078958 AS "Score" UNION ALL SELECT 1089 AS nid, 0.070139809494837 AS "Score" UNION ALL SELECT 2176 AS nid, 0.07014583136536337 AS "Score" UNION ALL SELECT 4355 AS nid, 0.0701466517805533 AS "Score" UNION ALL SELECT 8708 AS nid, 0.07014717179388523 AS "Score" UNION ALL SELECT 8709 AS nid, 0.0701471886217326 AS "Score") AS "Values"), 
"DT_Output_4" AS 
(SELECT "DT_node_lookup_4"."KEY" AS "KEY", "DT_node_lookup_4".node_id_2 AS node_id_2, "DT_node_data_4".nid AS nid, "DT_node_data_4"."Score" AS "Score" 
FROM "DT_node_lookup_4" LEFT OUTER JOIN "DT_node_data_4" ON "DT_node_lookup_4".node_id_2 = "DT_node_data_4".nid), 
"LGBM_Model_0_4" AS 
(SELECT "DT_Output_4"."KEY" AS "KEY", "DT_Output_4"."Score" AS "Score_0" 
FROM "DT_Output_4"), 
"DT_node_lookup_5" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_27" <= 0.14545000000000005) THEN CASE WHEN ("ADS"."Feature_3" <= 753.7500000000001) THEN CASE WHEN ("ADS"."Feature_27" <= 0.1223) THEN CASE WHEN ("ADS"."Feature_28" <= 0.21285000000000004) THEN 16 ELSE CASE WHEN ("ADS"."Feature_13" <= 32.85000000000001) THEN CASE WHEN ("ADS"."Feature_3" <= 603.1500000000001) THEN CASE WHEN ("ADS"."Feature_19" <= 0.0016715000000000002) THEN 136 ELSE CASE WHEN ("ADS"."Feature_21" <= 29.470000000000002) THEN CASE WHEN ("ADS"."Feature_28" <= 0.3212500000000001) THEN CASE WHEN ("ADS"."Feature_14" <= 0.010440000000000001) THEN CASE WHEN ("ADS"."Feature_5" <= 0.09956000000000002) THEN CASE WHEN ("ADS"."Feature_21" <= 26.435000000000006) THEN CASE WHEN ("ADS"."Feature_19" <= 0.0021375) THEN 8768 ELSE CASE WHEN ("ADS"."Feature_28" <= 0.25455000000000005) THEN 17538 ELSE CASE WHEN ("ADS"."Feature_1" <= 15.775) THEN 35078 ELSE 35079 END END END ELSE 4385 END ELSE 2193 END ELSE 1097 END ELSE 549 END ELSE 275 END END ELSE 69 END ELSE 35 END END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS"."Feature_23" <= 822.8500000000001) THEN 6 ELSE CASE WHEN ("ADS"."Feature_2" <= 101.45000000000002) THEN 14 ELSE CASE WHEN ("ADS"."Feature_10" <= 0.44610000000000005) THEN 30 ELSE 31 END END END END AS node_id_2 
FROM "BreastCancer" AS "ADS"), 
"DT_node_data_5" AS 
(SELECT "Values".nid AS nid, "Values"."Score" AS "Score" 
FROM (SELECT 5 AS nid, -0.0634223158268449 AS "Score" UNION ALL SELECT 6 AS nid, -0.054514773150041565 AS "Score" UNION ALL SELECT 9 AS nid, 0.026311399339508552 AS "Score" UNION ALL SELECT 14 AS nid, -0.10040652106230677 AS "Score" UNION ALL SELECT 16 AS nid, 0.04607649602964367 AS "Score" UNION ALL SELECT 30 AS nid, -0.10003650815176111 AS "Score" UNION ALL SELECT 31 AS nid, -0.10007502440662502 AS "Score" UNION ALL SELECT 35 AS nid, 0.07165446931616039 AS "Score" UNION ALL SELECT 69 AS nid, 0.06994850745370089 AS "Score" UNION ALL SELECT 136 AS nid, 0.06910460991759856 AS "Score" UNION ALL SELECT 275 AS nid, 0.06902195908963044 AS "Score" UNION ALL SELECT 549 AS nid, 0.06892966886226143 AS "Score" UNION ALL SELECT 1097 AS nid, 0.06886299744545456 AS "Score" UNION ALL SELECT 2193 AS nid, 0.06877714238114228 AS "Score" UNION ALL SELECT 4385 AS nid, 0.06878111647323673 AS "Score" UNION ALL SELECT 8768 AS nid, 0.06878139922501263 AS "Score" UNION ALL SELECT 17538 AS nid, 0.06878235826368721 AS "Score" UNION ALL SELECT 35078 AS nid, 0.06878233347680973 AS "Score" UNION ALL SELECT 35079 AS nid, 0.06878233688682178 AS "Score") AS "Values"), 
"DT_Output_5" AS 
(SELECT "DT_node_lookup_5"."KEY" AS "KEY", "DT_node_lookup_5".node_id_2 AS node_id_2, "DT_node_data_5".nid AS nid, "DT_node_data_5"."Score" AS "Score" 
FROM "DT_node_lookup_5" LEFT OUTER JOIN "DT_node_data_5" ON "DT_node_lookup_5".node_id_2 = "DT_node_data_5".nid), 
"LGBM_Model_0_5" AS 
(SELECT "DT_Output_5"."KEY" AS "KEY", "DT_Output_5"."Score" AS "Score_0" 
FROM "DT_Output_5"), 
"DT_node_lookup_6" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_27" <= 0.14545000000000005) THEN CASE WHEN ("ADS"."Feature_3" <= 753.7500000000001) THEN CASE WHEN ("ADS"."Feature_13" <= 32.85000000000001) THEN CASE WHEN ("ADS"."Feature_28" <= 0.33055000000000007) THEN CASE WHEN ("ADS"."Feature_22" <= 102.85000000000001) THEN CASE WHEN ("ADS"."Feature_7" <= 0.039275000000000004) THEN CASE WHEN ("ADS"."Feature_19" <= 0.0016280000000000003) THEN 128 ELSE CASE WHEN ("ADS"."Feature_11" <= 1.9085000000000003) THEN CASE WHEN ("ADS"."Feature_28" <= 0.22675000000000003) THEN 516 ELSE CASE WHEN ("ADS"."Feature_21" <= 28.470000000000002) THEN CASE WHEN ("ADS"."Feature_7" <= 0.028670000000000005) THEN CASE WHEN ("ADS"."Feature_28" <= 0.29860000000000003) THEN CASE WHEN ("ADS"."Feature_26" <= 0.14390000000000003) THEN CASE WHEN ("ADS"."Feature_27" <= 0.04563000000000001) THEN 16544 ELSE 16545 END ELSE 8273 END ELSE 4137 END ELSE 2069 END ELSE 1035 END END ELSE 259 END END ELSE 65 END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS"."Feature_23" <= 822.8500000000001) THEN 6 ELSE CASE WHEN ("ADS"."Feature_2" <= 101.45000000000002) THEN 14 ELSE CASE WHEN ("ADS"."Feature_13" <= 50.40500000000001) THEN 30 ELSE CASE WHEN ("ADS"."Feature_12" <= 4.049) THEN 62 ELSE CASE WHEN ("ADS"."Feature_0" <= 19.425) THEN 126 ELSE 127 END END END END END END AS node_id_2 
FROM "BreastCancer" AS "ADS"), 
"DT_node_data_6" AS 
(SELECT "Values".nid AS nid, "Values"."Score" AS "Score" 
FROM (SELECT 5 AS nid, -0.05974527986344757 AS "Score" UNION ALL SELECT 6 AS nid, -0.05143713059358743 AS "Score" UNION ALL SELECT 9 AS nid, 0.031414189434694616 AS "Score" UNION ALL SELECT 14 AS nid, -0.09559182632644225 AS "Score" UNION ALL SELECT 17 AS nid, 0.05515852809147642 AS "Score" UNION ALL SELECT 30 AS nid, -0.09527299455204818 AS "Score" UNION ALL SELECT 33 AS nid, 0.06943586115607518 AS "Score" UNION ALL SELECT 62 AS nid, -0.09530662861783923 AS "Score" UNION ALL SELECT 65 AS nid, 0.06822760829747819 AS "Score" UNION ALL SELECT 126 AS nid, -0.09530636736120546 AS "Score" UNION ALL SELECT 127 AS nid, -0.09530636736120551 AS "Score" UNION ALL SELECT 128 AS nid, 0.06789239544399003 AS "Score" UNION ALL SELECT 259 AS nid, 0.06783575811477487 AS "Score" UNION ALL SELECT 516 AS nid, 0.06769045821461296 AS "Score" UNION ALL SELECT 1035 AS nid, 0.06768071604090302 AS "Score" UNION ALL SELECT 2069 AS nid, 0.06752794272521828 AS "Score" UNION ALL SELECT 4137 AS nid, 0.06753157846393017 AS "Score" UNION ALL SELECT 8273 AS nid, 0.06753389501681521 AS "Score" UNION ALL SELECT 16544 AS nid, 0.06753375939385334 AS "Score" UNION ALL SELECT 16545 AS nid, 0.06753334372618404 AS "Score") AS "Values"), 
"DT_Output_6" AS 
(SELECT "DT_node_lookup_6"."KEY" AS "KEY", "DT_node_lookup_6".node_id_2 AS node_id_2, "DT_node_data_6".nid AS nid, "DT_node_data_6"."Score" AS "Score" 
FROM "DT_node_lookup_6" LEFT OUTER JOIN "DT_node_data_6" ON "DT_node_lookup_6".node_id_2 = "DT_node_data_6".nid), 
"LGBM_Model_0_6" AS 
(SELECT "DT_Output_6"."KEY" AS "KEY", "DT_Output_6"."Score" AS "Score_0" 
FROM "DT_Output_6"), 
"DT_node_lookup_7" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_27" <= 0.14545000000000005) THEN CASE WHEN ("ADS"."Feature_20" <= 17.645000000000007) THEN CASE WHEN ("ADS"."Feature_13" <= 32.85000000000001) THEN CASE WHEN ("ADS"."Feature_1" <= 24.355000000000004) THEN CASE WHEN ("ADS"."Feature_20" <= 16.095000000000002) THEN CASE WHEN ("ADS"."Feature_27" <= 0.11065000000000001) THEN CASE WHEN ("ADS"."Feature_28" <= 0.2214) THEN 128 ELSE CASE WHEN ("ADS"."Feature_19" <= 0.0016715000000000002) THEN 258 ELSE CASE WHEN ("ADS"."Feature_28" <= 0.3204000000000001) THEN CASE WHEN ("ADS"."Feature_11" <= 1.6445) THEN CASE WHEN ("ADS"."Feature_7" <= 0.028670000000000005) THEN CASE WHEN ("ADS"."Feature_1" <= 18.945000000000004) THEN CASE WHEN ("ADS"."Feature_18" <= 0.020115000000000004) THEN CASE WHEN ("ADS"."Feature_15" <= 0.012505000000000002) THEN 16576 ELSE 16577 END ELSE 8289 END ELSE 4145 END ELSE 2073 END ELSE 1037 END ELSE 519 END END END ELSE 65 END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS"."Feature_22" <= 112.80000000000001) THEN 6 ELSE CASE WHEN ("ADS"."Feature_23" <= 1030.5000000000002) THEN 14 ELSE CASE WHEN ("ADS"."Feature_13" <= 52.41500000000001) THEN 30 ELSE CASE WHEN ("ADS"."Feature_0" <= 17.970000000000002) THEN 62 ELSE CASE WHEN ("ADS"."Feature_8" <= 0.17925000000000002) THEN 126 ELSE CASE WHEN ("ADS"."Feature_2" <= 133.25000000000003) THEN 254 ELSE 255 END END END END END END END AS node_id_2 
FROM "BreastCancer" AS "ADS"), 
"DT_node_data_7" AS 
(SELECT "Values".nid AS nid, "Values"."Score" AS "Score" 
FROM (SELECT 5 AS nid, -0.07256198457774891 AS "Score" UNION ALL SELECT 6 AS nid, -0.04945024259723097 AS "Score" UNION ALL SELECT 9 AS nid, 0.030254702176436544 AS "Score" UNION ALL SELECT 14 AS nid, -0.0926898401591884 AS "Score" UNION ALL SELECT 17 AS nid, 0.053626240585532815 AS "Score" UNION ALL SELECT 30 AS nid, -0.09116170108749538 AS "Score" UNION ALL SELECT 33 AS nid, 0.07061053165146967 AS "Score" UNION ALL SELECT 62 AS nid, -0.09118522049223562 AS "Score" UNION ALL SELECT 65 AS nid, 0.06721709885994537 AS "Score" UNION ALL SELECT 126 AS nid, -0.09118791961275645 AS "Score" UNION ALL SELECT 128 AS nid, 0.06672095141602419 AS "Score" UNION ALL SELECT 254 AS nid, -0.09118775972105311 AS "Score" UNION ALL SELECT 255 AS nid, -0.09118776175057841 AS "Score" UNION ALL SELECT 258 AS nid, 0.0666536205611004 AS "Score" UNION ALL SELECT 519 AS nid, 0.06661204580055682 AS "Score" UNION ALL SELECT 1037 AS nid, 0.0664917411434612 AS "Score" UNION ALL SELECT 2073 AS nid, 0.06637401898152047 AS "Score" UNION ALL SELECT 4145 AS nid, 0.06638555580222154 AS "Score" UNION ALL SELECT 8289 AS nid, 0.06638809813119005 AS "Score" UNION ALL SELECT 16576 AS nid, 0.06638858322803631 AS "Score" UNION ALL SELECT 16577 AS nid, 0.06638887983771675 AS "Score") AS "Values"), 
"DT_Output_7" AS 
(SELECT "DT_node_lookup_7"."KEY" AS "KEY", "DT_node_lookup_7".node_id_2 AS node_id_2, "DT_node_data_7".nid AS nid, "DT_node_data_7"."Score" AS "Score" 
FROM "DT_node_lookup_7" LEFT OUTER JOIN "DT_node_data_7" ON "DT_node_lookup_7".node_id_2 = "DT_node_data_7".nid), 
"LGBM_Model_0_7" AS 
(SELECT "DT_Output_7"."KEY" AS "KEY", "DT_Output_7"."Score" AS "Score_0" 
FROM "DT_Output_7"), 
"DT_node_lookup_8" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_27" <= 0.14545000000000005) THEN CASE WHEN ("ADS"."Feature_20" <= 17.645000000000007) THEN CASE WHEN ("ADS"."Feature_13" <= 32.85000000000001) THEN CASE WHEN ("ADS"."Feature_19" <= 0.0015535000000000002) THEN 16 ELSE CASE WHEN ("ADS"."Feature_20" <= 15.995000000000003) THEN CASE WHEN ("ADS"."Feature_27" <= 0.11510000000000002) THEN CASE WHEN ("ADS"."Feature_21" <= 29.470000000000002) THEN CASE WHEN ("ADS"."Feature_28" <= 0.22265000000000004) THEN 272 ELSE CASE WHEN ("ADS"."Feature_28" <= 0.3219) THEN CASE WHEN ("ADS"."Feature_14" <= 0.010375000000000002) THEN CASE WHEN ("ADS"."Feature_7" <= 0.028785) THEN CASE WHEN ("ADS"."Feature_19" <= 0.0020030000000000004) THEN 4368 ELSE CASE WHEN ("ADS"."Feature_11" <= 1.3340000000000003) THEN CASE WHEN ("ADS"."Feature_15" <= 0.016700000000000003) THEN 17476 ELSE 17477 END ELSE 8739 END END ELSE 2185 END ELSE 1093 END ELSE 547 END END ELSE 137 END ELSE 69 END ELSE 35 END END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS"."Feature_23" <= 822.8500000000001) THEN 6 ELSE CASE WHEN ("ADS"."Feature_2" <= 101.45000000000002) THEN 14 ELSE CASE WHEN ("ADS"."Feature_22" <= 134.20000000000002) THEN 30 ELSE CASE WHEN ("ADS"."Feature_24" <= 0.12665) THEN 62 ELSE CASE WHEN ("ADS"."Feature_12" <= 4.0950000000000015) THEN 126 ELSE CASE WHEN ("ADS"."Feature_0" <= 19.570000000000004) THEN 254 ELSE 255 END END END END END END END AS node_id_2 
FROM "BreastCancer" AS "ADS"), 
"DT_node_data_8" AS 
(SELECT "Values".nid AS nid, "Values"."Score" AS "Score" 
FROM (SELECT 5 AS nid, -0.06864383213017378 AS "Score" UNION ALL SELECT 6 AS nid, -0.04575937853464512 AS "Score" UNION ALL SELECT 9 AS nid, 0.02913465163388021 AS "Score" UNION ALL SELECT 14 AS nid, -0.0880494732101907 AS "Score" UNION ALL SELECT 16 AS nid, 0.05212635979643822 AS "Score" UNION ALL SELECT 30 AS nid, -0.08755672434087935 AS "Score" UNION ALL SELECT 35 AS nid, 0.06924891862166065 AS "Score" UNION ALL SELECT 62 AS nid, -0.087593214655873 AS "Score" UNION ALL SELECT 69 AS nid, 0.06616975377312563 AS "Score" UNION ALL SELECT 126 AS nid, -0.08759921674351656 AS "Score" UNION ALL SELECT 137 AS nid, 0.06573509062281938 AS "Score" UNION ALL SELECT 254 AS nid, -0.08759812543729652 AS "Score" UNION ALL SELECT 255 AS nid, -0.08759809096156229 AS "Score" UNION ALL SELECT 272 AS nid, 0.06560626641412103 AS "Score" UNION ALL SELECT 547 AS nid, 0.06557559885757092 AS "Score" UNION ALL SELECT 1093 AS nid, 0.06539815167926673 AS "Score" UNION ALL SELECT 2185 AS nid, 0.06532471412602998 AS "Score" UNION ALL SELECT 4368 AS nid, 0.06533188265939488 AS "Score" UNION ALL SELECT 8739 AS nid, 0.0653340805180857 AS "Score" UNION ALL SELECT 17476 AS nid, 0.06533616421695036 AS "Score" UNION ALL SELECT 17477 AS nid, 0.06533540991015906 AS "Score") AS "Values"), 
"DT_Output_8" AS 
(SELECT "DT_node_lookup_8"."KEY" AS "KEY", "DT_node_lookup_8".node_id_2 AS node_id_2, "DT_node_data_8".nid AS nid, "DT_node_data_8"."Score" AS "Score" 
FROM "DT_node_lookup_8" LEFT OUTER JOIN "DT_node_data_8" ON "DT_node_lookup_8".node_id_2 = "DT_node_data_8".nid), 
"LGBM_Model_0_8" AS 
(SELECT "DT_Output_8"."KEY" AS "KEY", "DT_Output_8"."Score" AS "Score_0" 
FROM "DT_Output_8"), 
"DT_node_lookup_9" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_7" <= 0.04840500000000001) THEN CASE WHEN ("ADS"."Feature_22" <= 111.80000000000001) THEN CASE WHEN ("ADS"."Feature_13" <= 32.85000000000001) THEN CASE WHEN ("ADS"."Feature_7" <= 0.038060000000000004) THEN CASE WHEN ("ADS"."Feature_19" <= 0.0016040000000000002) THEN 32 ELSE CASE WHEN ("ADS"."Feature_28" <= 0.32795) THEN CASE WHEN ("ADS"."Feature_21" <= 29.180000000000003) THEN CASE WHEN ("ADS"."Feature_28" <= 0.22495) THEN 264 ELSE CASE WHEN ("ADS"."Feature_14" <= 0.010130000000000002) THEN CASE WHEN ("ADS"."Feature_23" <= 682.0000000000001) THEN CASE WHEN ("ADS"."Feature_22" <= 88.16000000000001) THEN CASE WHEN ("ADS"."Feature_18" <= 0.020595000000000006) THEN CASE WHEN ("ADS"."Feature_1" <= 15.865000000000002) THEN 8480 ELSE 8481 END ELSE 4241 END ELSE 2121 END ELSE 1061 END ELSE 531 END END ELSE 133 END ELSE 67 END END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS"."Feature_20" <= 15.460000000000003) THEN 6 ELSE CASE WHEN ("ADS"."Feature_21" <= 21.925) THEN 14 ELSE CASE WHEN ("ADS"."Feature_2" <= 95.54500000000002) THEN 30 ELSE CASE WHEN ("ADS"."Feature_11" <= 1.6300000000000001) THEN CASE WHEN ("ADS"."Feature_27" <= 0.15555000000000002) THEN 124 ELSE CASE WHEN ("ADS"."Feature_8" <= 0.17925000000000002) THEN 250 ELSE CASE WHEN ("ADS"."Feature_22" <= 141.65000000000003) THEN 502 ELSE 503 END END END ELSE 63 END END END END END AS node_id_2 
FROM "BreastCancer" AS "ADS"), 
"DT_node_data_9" AS 
(SELECT "Values".nid AS nid, "Values"."Score" AS "Score" 
FROM (SELECT 5 AS nid, -0.005251752460652578 AS "Score" UNION ALL SELECT 6 AS nid, 0.029193625624556047 AS "Score" UNION ALL SELECT 9 AS nid, 0.0344801814270851 AS "Score" UNION ALL SELECT 14 AS nid, -0.02803945692838866 AS "Score" UNION ALL SELECT 17 AS nid, 0.07058345924417249 AS "Score" UNION ALL SELECT 30 AS nid, -0.10413535760645497 AS "Score" UNION ALL SELECT 32 AS nid, 0.0648799550805912 AS "Score" UNION ALL SELECT 63 AS nid, -0.0732146811554527 AS "Score" UNION ALL SELECT 67 AS nid, 0.0647142516724797 AS "Score" UNION ALL SELECT 124 AS nid, -0.09191080751913464 AS "Score" UNION ALL SELECT 133 AS nid, 0.06464960635517784 AS "Score" UNION ALL SELECT 250 AS nid, -0.08520491529019522 AS "Score" UNION ALL SELECT 264 AS nid, 0.06456963232494922 AS "Score" UNION ALL SELECT 502 AS nid, -0.08439060821431887 AS "Score" UNION ALL SELECT 503 AS nid, -0.08444497617636848 AS "Score" UNION ALL SELECT 531 AS nid, 0.06442454415058761 AS "Score" UNION ALL SELECT 1061 AS nid, 0.06431136508940531 AS "Score" UNION ALL SELECT 2121 AS nid, 0.06436126400938211 AS "Score" UNION ALL SELECT 4241 AS nid, 0.06436297573120685 AS "Score" UNION ALL SELECT 8480 AS nid, 0.06436624354424732 AS "Score" UNION ALL SELECT 8481 AS nid, 0.06436528822409095 AS "Score") AS "Values"), 
"DT_Output_9" AS 
(SELECT "DT_node_lookup_9"."KEY" AS "KEY", "DT_node_lookup_9".node_id_2 AS node_id_2, "DT_node_data_9".nid AS nid, "DT_node_data_9"."Score" AS "Score" 
FROM "DT_node_lookup_9" LEFT OUTER JOIN "DT_node_data_9" ON "DT_node_lookup_9".node_id_2 = "DT_node_data_9".nid), 
"LGBM_Model_0_9" AS 
(SELECT "DT_Output_9"."KEY" AS "KEY", "DT_Output_9"."Score" AS "Score_0" 
FROM "DT_Output_9")
 INSERT INTO "TMP_20221018185052_T8C9SXC_LGBM_B0" ("KEY", "Score_0") SELECT "T"."KEY", "T"."Score_0" 
FROM (SELECT "LGBM_B0"."KEY" AS "KEY", "LGBM_B0"."Score_0" AS "Score_0" 
FROM (SELECT "LGBM_esu_0"."KEY" AS "KEY", "LGBM_esu_0"."Score_0" AS "Score_0" 
FROM (SELECT "LGBM_Model_0_0"."KEY" AS "KEY", "LGBM_Model_0_0"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_0" UNION ALL SELECT "LGBM_Model_0_1"."KEY" AS "KEY", "LGBM_Model_0_1"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_1" UNION ALL SELECT "LGBM_Model_0_2"."KEY" AS "KEY", "LGBM_Model_0_2"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_2" UNION ALL SELECT "LGBM_Model_0_3"."KEY" AS "KEY", "LGBM_Model_0_3"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_3" UNION ALL SELECT "LGBM_Model_0_4"."KEY" AS "KEY", "LGBM_Model_0_4"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_4" UNION ALL SELECT "LGBM_Model_0_5"."KEY" AS "KEY", "LGBM_Model_0_5"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_5" UNION ALL SELECT "LGBM_Model_0_6"."KEY" AS "KEY", "LGBM_Model_0_6"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_6" UNION ALL SELECT "LGBM_Model_0_7"."KEY" AS "KEY", "LGBM_Model_0_7"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_7" UNION ALL SELECT "LGBM_Model_0_8"."KEY" AS "KEY", "LGBM_Model_0_8"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_8" UNION ALL SELECT "LGBM_Model_0_9"."KEY" AS "KEY", "LGBM_Model_0_9"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_9") AS "LGBM_esu_0") AS "LGBM_B0") AS "T"

-- Code For temporary table TMP_20221018185052_S9G3MZW_LGBM_B1 part 1. Create 


CREATE TEMPORARY TABLE "TMP_20221018185052_S9G3MZW_LGBM_B1" (
	"KEY" BIGINT, 
	"Score_0" FLOAT
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table TMP_20221018185052_S9G3MZW_LGBM_B1 part 2. Populate

WITH "DT_node_lookup_10" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_27" <= 0.14545000000000005) THEN CASE WHEN ("ADS"."Feature_20" <= 17.645000000000007) THEN CASE WHEN ("ADS"."Feature_13" <= 32.85000000000001) THEN CASE WHEN ("ADS"."Feature_28" <= 0.33055000000000007) THEN CASE WHEN ("ADS"."Feature_20" <= 16.155000000000005) THEN CASE WHEN ("ADS"."Feature_7" <= 0.04164) THEN CASE WHEN ("ADS"."Feature_19" <= 0.0016280000000000003) THEN 128 ELSE CASE WHEN ("ADS"."Feature_21" <= 30.200000000000006) THEN CASE WHEN ("ADS"."Feature_15" <= 0.03474000000000001) THEN CASE WHEN ("ADS"."Feature_28" <= 0.23030000000000003) THEN 1032 ELSE CASE WHEN ("ADS"."Feature_25" <= 0.09530500000000001) THEN 2066 ELSE CASE WHEN ("ADS"."Feature_7" <= 0.027855) THEN CASE WHEN ("ADS"."Feature_28" <= 0.3022500000000001) THEN CASE WHEN ("ADS"."Feature_11" <= 1.1995000000000002) THEN CASE WHEN ("ADS"."Feature_11" <= 0.7967000000000001) THEN 33072 ELSE 33073 END ELSE 16537 END ELSE 8269 END ELSE 4135 END END END ELSE 517 END ELSE 259 END END ELSE 65 END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS"."Feature_22" <= 112.80000000000001) THEN 6 ELSE CASE WHEN ("ADS"."Feature_18" <= 0.024230000000000005) THEN CASE WHEN ("ADS"."Feature_1" <= 18.605000000000004) THEN 28 ELSE CASE WHEN ("ADS"."Feature_1" <= 20.800000000000004) THEN 58 ELSE CASE WHEN ("ADS"."Feature_29" <= 0.08897500000000001) THEN 118 ELSE 119 END END END ELSE 15 END END END AS node_id_2 
FROM "BreastCancer" AS "ADS"), 
"DT_node_data_10" AS 
(SELECT "Values".nid AS nid, "Values"."Score" AS "Score" 
FROM (SELECT 5 AS nid, -0.06261542120562898 AS "Score" UNION ALL SELECT 6 AS nid, -0.04276822451253566 AS "Score" UNION ALL SELECT 9 AS nid, 0.027702479480146272 AS "Score" UNION ALL SELECT 15 AS nid, -0.08316189857924927 AS "Score" UNION ALL SELECT 17 AS nid, 0.049570699728030965 AS "Score" UNION ALL SELECT 28 AS nid, -0.08208882597766148 AS "Score" UNION ALL SELECT 33 AS nid, 0.067789698592583 AS "Score" UNION ALL SELECT 58 AS nid, -0.08144752650742007 AS "Score" UNION ALL SELECT 65 AS nid, 0.06433391068165573 AS "Score" UNION ALL SELECT 118 AS nid, -0.0818647051439352 AS "Score" UNION ALL SELECT 119 AS nid, -0.08161615640697711 AS "Score" UNION ALL SELECT 128 AS nid, 0.06390668850699559 AS "Score" UNION ALL SELECT 259 AS nid, 0.06377341199166885 AS "Score" UNION ALL SELECT 517 AS nid, 0.06367276899052438 AS "Score" UNION ALL SELECT 1032 AS nid, 0.06361529365997355 AS "Score" UNION ALL SELECT 2066 AS nid, 0.06349966019987167 AS "Score" UNION ALL SELECT 4135 AS nid, 0.06345144229681031 AS "Score" UNION ALL SELECT 8269 AS nid, 0.06346423993600915 AS "Score" UNION ALL SELECT 16537 AS nid, 0.06346803126804938 AS "Score" UNION ALL SELECT 33072 AS nid, 0.06347077339999263 AS "Score" UNION ALL SELECT 33073 AS nid, 0.0634704234946749 AS "Score") AS "Values"), 
"DT_Output_10" AS 
(SELECT "DT_node_lookup_10"."KEY" AS "KEY", "DT_node_lookup_10".node_id_2 AS node_id_2, "DT_node_data_10".nid AS nid, "DT_node_data_10"."Score" AS "Score" 
FROM "DT_node_lookup_10" LEFT OUTER JOIN "DT_node_data_10" ON "DT_node_lookup_10".node_id_2 = "DT_node_data_10".nid), 
"LGBM_Model_0_10" AS 
(SELECT "DT_Output_10"."KEY" AS "KEY", "DT_Output_10"."Score" AS "Score_0" 
FROM "DT_Output_10"), 
"DT_node_lookup_11" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_7" <= 0.04840500000000001) THEN CASE WHEN ("ADS"."Feature_22" <= 111.80000000000001) THEN CASE WHEN ("ADS"."Feature_13" <= 32.85000000000001) THEN CASE WHEN ("ADS"."Feature_27" <= 0.11510000000000002) THEN CASE WHEN ("ADS"."Feature_19" <= 0.0016040000000000002) THEN 32 ELSE CASE WHEN ("ADS"."Feature_28" <= 0.32245000000000007) THEN CASE WHEN ("ADS"."Feature_11" <= 1.8885000000000003) THEN CASE WHEN ("ADS"."Feature_28" <= 0.22495) THEN 264 ELSE CASE WHEN ("ADS"."Feature_1" <= 21.375000000000004) THEN CASE WHEN ("ADS"."Feature_22" <= 95.915) THEN CASE WHEN ("ADS"."Feature_5" <= 0.09170500000000002) THEN CASE WHEN ("ADS"."Feature_15" <= 0.010830000000000001) THEN 4240 ELSE CASE WHEN ("ADS"."Feature_18" <= 0.019370000000000002) THEN 8482 ELSE 8483 END END ELSE 2121 END ELSE 1061 END ELSE 531 END END ELSE 133 END ELSE 67 END END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS"."Feature_20" <= 16.155000000000005) THEN 6 ELSE CASE WHEN ("ADS"."Feature_1" <= 17.230000000000004) THEN 14 ELSE CASE WHEN ("ADS"."Feature_27" <= 0.15270000000000003) THEN 30 ELSE CASE WHEN ("ADS"."Feature_0" <= 15.415000000000001) THEN 62 ELSE CASE WHEN ("ADS"."Feature_18" <= 0.023295000000000003) THEN CASE WHEN ("ADS"."Feature_17" <= 0.015485000000000002) THEN 252 ELSE 253 END ELSE 127 END END END END END END AS node_id_2 
FROM "BreastCancer" AS "ADS"), 
"DT_node_data_11" AS 
(SELECT "Values".nid AS nid, "Values"."Score" AS "Score" 
FROM (SELECT 5 AS nid, -0.004407425347595121 AS "Score" UNION ALL SELECT 6 AS nid, 0.002415456033505883 AS "Score" UNION ALL SELECT 9 AS nid, 0.03250394404873004 AS "Score" UNION ALL SELECT 14 AS nid, -0.057523954849889175 AS "Score" UNION ALL SELECT 17 AS nid, 0.06959053945712546 AS "Score" UNION ALL SELECT 30 AS nid, -0.08963266729146047 AS "Score" UNION ALL SELECT 32 AS nid, 0.0630769736530714 AS "Score" UNION ALL SELECT 62 AS nid, -0.08165812862087318 AS "Score" UNION ALL SELECT 67 AS nid, 0.06298755689419841 AS "Score" UNION ALL SELECT 127 AS nid, -0.07944836026009504 AS "Score" UNION ALL SELECT 133 AS nid, 0.06292577004925685 AS "Score" UNION ALL SELECT 252 AS nid, -0.07915087822076633 AS "Score" UNION ALL SELECT 253 AS nid, -0.07924075674534398 AS "Score" UNION ALL SELECT 264 AS nid, 0.06276609792642028 AS "Score" UNION ALL SELECT 531 AS nid, 0.0627426159842205 AS "Score" UNION ALL SELECT 1061 AS nid, 0.06257610581794713 AS "Score" UNION ALL SELECT 2121 AS nid, 0.06262423219108197 AS "Score" UNION ALL SELECT 4240 AS nid, 0.0626387700676967 AS "Score" UNION ALL SELECT 8482 AS nid, 0.06264231314250228 AS "Score" UNION ALL SELECT 8483 AS nid, 0.06264121748386377 AS "Score") AS "Values"), 
"DT_Output_11" AS 
(SELECT "DT_node_lookup_11"."KEY" AS "KEY", "DT_node_lookup_11".node_id_2 AS node_id_2, "DT_node_data_11".nid AS nid, "DT_node_data_11"."Score" AS "Score" 
FROM "DT_node_lookup_11" LEFT OUTER JOIN "DT_node_data_11" ON "DT_node_lookup_11".node_id_2 = "DT_node_data_11".nid), 
"LGBM_Model_0_11" AS 
(SELECT "DT_Output_11"."KEY" AS "KEY", "DT_Output_11"."Score" AS "Score_0" 
FROM "DT_Output_11"), 
"DT_node_lookup_12" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_27" <= 0.14545000000000005) THEN CASE WHEN ("ADS"."Feature_20" <= 17.645000000000007) THEN CASE WHEN ("ADS"."Feature_13" <= 35.18500000000001) THEN CASE WHEN ("ADS"."Feature_27" <= 0.12665) THEN CASE WHEN ("ADS"."Feature_13" <= 30.055000000000003) THEN CASE WHEN ("ADS"."Feature_0" <= 14.15) THEN CASE WHEN ("ADS"."Feature_28" <= 0.32795) THEN CASE WHEN ("ADS"."Feature_19" <= 0.0016715000000000002) THEN 256 ELSE CASE WHEN ("ADS"."Feature_28" <= 0.22265000000000004) THEN 514 ELSE CASE WHEN ("ADS"."Feature_21" <= 28.895000000000007) THEN CASE WHEN ("ADS"."Feature_22" <= 70.96500000000002) THEN 2060 ELSE CASE WHEN ("ADS"."Feature_4" <= 0.10415) THEN CASE WHEN ("ADS"."Feature_21" <= 25.420000000000005) THEN CASE WHEN ("ADS"."Feature_27" <= 0.08221500000000001) THEN CASE WHEN ("ADS"."Feature_11" <= 0.9497000000000001) THEN 32976 ELSE 32977 END ELSE 16489 END ELSE 8245 END ELSE 4123 END END ELSE 1031 END END END ELSE 129 END ELSE 65 END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS"."Feature_21" <= 23.785000000000004) THEN 6 ELSE CASE WHEN ("ADS"."Feature_0" <= 14.415000000000001) THEN 14 ELSE CASE WHEN ("ADS"."Feature_1" <= 19.635) THEN 30 ELSE CASE WHEN ("ADS"."Feature_8" <= 0.17925000000000002) THEN 62 ELSE CASE WHEN ("ADS"."Feature_11" <= 1.4805000000000004) THEN 126 ELSE 127 END END END END END END AS node_id_2 
FROM "BreastCancer" AS "ADS"), 
"DT_node_data_12" AS 
(SELECT "Values".nid AS nid, "Values"."Score" AS "Score" 
FROM (SELECT 5 AS nid, -0.057425509092512296 AS "Score" UNION ALL SELECT 6 AS nid, -0.04117169090276096 AS "Score" UNION ALL SELECT 9 AS nid, 0.013967305681308937 AS "Score" UNION ALL SELECT 14 AS nid, -0.09112336544949062 AS "Score" UNION ALL SELECT 17 AS nid, 0.03617762853683719 AS "Score" UNION ALL SELECT 30 AS nid, -0.06779983728008025 AS "Score" UNION ALL SELECT 33 AS nid, 0.06525691417529794 AS "Score" UNION ALL SELECT 62 AS nid, -0.07800578316932644 AS "Score" UNION ALL SELECT 65 AS nid, 0.06440334346103573 AS "Score" UNION ALL SELECT 126 AS nid, -0.07685512875794424 AS "Score" UNION ALL SELECT 127 AS nid, -0.07713101444100391 AS "Score" UNION ALL SELECT 129 AS nid, 0.06230243969837939 AS "Score" UNION ALL SELECT 256 AS nid, 0.06218753360445848 AS "Score" UNION ALL SELECT 514 AS nid, 0.062123386665067705 AS "Score" UNION ALL SELECT 1031 AS nid, 0.062022499429641255 AS "Score" UNION ALL SELECT 2060 AS nid, 0.0619538931038822 AS "Score" UNION ALL SELECT 4123 AS nid, 0.06184842731300914 AS "Score" UNION ALL SELECT 8245 AS nid, 0.06185644876507049 AS "Score" UNION ALL SELECT 16489 AS nid, 0.061886149069992735 AS "Score" UNION ALL SELECT 32976 AS nid, 0.06187473923534072 AS "Score" UNION ALL SELECT 32977 AS nid, 0.061872889372233876 AS "Score") AS "Values"), 
"DT_Output_12" AS 
(SELECT "DT_node_lookup_12"."KEY" AS "KEY", "DT_node_lookup_12".node_id_2 AS node_id_2, "DT_node_data_12".nid AS nid, "DT_node_data_12"."Score" AS "Score" 
FROM "DT_node_lookup_12" LEFT OUTER JOIN "DT_node_data_12" ON "DT_node_lookup_12".node_id_2 = "DT_node_data_12".nid), 
"LGBM_Model_0_12" AS 
(SELECT "DT_Output_12"."KEY" AS "KEY", "DT_Output_12"."Score" AS "Score_0" 
FROM "DT_Output_12"), 
"DT_node_lookup_13" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_7" <= 0.04840500000000001) THEN CASE WHEN ("ADS"."Feature_22" <= 112.80000000000001) THEN CASE WHEN ("ADS"."Feature_13" <= 33.60500000000001) THEN CASE WHEN ("ADS"."Feature_27" <= 0.11325000000000002) THEN CASE WHEN ("ADS"."Feature_13" <= 28.565000000000005) THEN CASE WHEN ("ADS"."Feature_19" <= 0.0016280000000000003) THEN 64 ELSE CASE WHEN ("ADS"."Feature_28" <= 0.32245000000000007) THEN CASE WHEN ("ADS"."Feature_11" <= 1.6785000000000003) THEN CASE WHEN ("ADS"."Feature_8" <= 0.14695000000000003) THEN 520 ELSE CASE WHEN ("ADS"."Feature_22" <= 95.12000000000002) THEN CASE WHEN ("ADS"."Feature_1" <= 19.055000000000003) THEN CASE WHEN ("ADS"."Feature_25" <= 0.19775) THEN CASE WHEN ("ADS"."Feature_5" <= 0.07205000000000002) THEN 8336 ELSE 8337 END ELSE 4169 END ELSE 2085 END ELSE 1043 END END ELSE 261 END ELSE 131 END END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS"."Feature_20" <= 16.155000000000005) THEN 6 ELSE CASE WHEN ("ADS"."Feature_1" <= 17.230000000000004) THEN 14 ELSE CASE WHEN ("ADS"."Feature_27" <= 0.15270000000000003) THEN 30 ELSE CASE WHEN ("ADS"."Feature_20" <= 18.775000000000002) THEN 62 ELSE CASE WHEN ("ADS"."Feature_1" <= 19.950000000000006) THEN 126 ELSE CASE WHEN ("ADS"."Feature_17" <= 0.015485000000000002) THEN 254 ELSE 255 END END END END END END END AS node_id_2 
FROM "BreastCancer" AS "ADS"), 
"DT_node_data_13" AS 
(SELECT "Values".nid AS nid, "Values"."Score" AS "Score" 
FROM (SELECT 5 AS nid, -0.011364784331117088 AS "Score" UNION ALL SELECT 6 AS nid, 0.0032870431498609083 AS "Score" UNION ALL SELECT 9 AS nid, 0.02489192230774888 AS "Score" UNION ALL SELECT 14 AS nid, -0.05440686842252627 AS "Score" UNION ALL SELECT 17 AS nid, 0.06797538353365722 AS "Score" UNION ALL SELECT 30 AS nid, -0.08460556832007508 AS "Score" UNION ALL SELECT 33 AS nid, 0.06205762381767552 AS "Score" UNION ALL SELECT 62 AS nid, -0.07701372585207703 AS "Score" UNION ALL SELECT 64 AS nid, 0.061500343976065235 AS "Score" UNION ALL SELECT 126 AS nid, -0.07545015364557067 AS "Score" UNION ALL SELECT 131 AS nid, 0.06145294522030316 AS "Score" UNION ALL SELECT 254 AS nid, -0.0748830577281928 AS "Score" UNION ALL SELECT 255 AS nid, -0.07508019811237812 AS "Score" UNION ALL SELECT 261 AS nid, 0.06133026627321386 AS "Score" UNION ALL SELECT 520 AS nid, 0.061234485652621934 AS "Score" UNION ALL SELECT 1043 AS nid, 0.06109742663205007 AS "Score" UNION ALL SELECT 2085 AS nid, 0.06121040129387389 AS "Score" UNION ALL SELECT 4169 AS nid, 0.06114709104373928 AS "Score" UNION ALL SELECT 8336 AS nid, 0.06116012536349935 AS "Score" UNION ALL SELECT 8337 AS nid, 0.06116971741088906 AS "Score") AS "Values"), 
"DT_Output_13" AS 
(SELECT "DT_node_lookup_13"."KEY" AS "KEY", "DT_node_lookup_13".node_id_2 AS node_id_2, "DT_node_data_13".nid AS nid, "DT_node_data_13"."Score" AS "Score" 
FROM "DT_node_lookup_13" LEFT OUTER JOIN "DT_node_data_13" ON "DT_node_lookup_13".node_id_2 = "DT_node_data_13".nid), 
"LGBM_Model_0_13" AS 
(SELECT "DT_Output_13"."KEY" AS "KEY", "DT_Output_13"."Score" AS "Score_0" 
FROM "DT_Output_13"), 
"DT_node_lookup_14" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_27" <= 0.14545000000000005) THEN CASE WHEN ("ADS"."Feature_20" <= 19.125000000000004) THEN CASE WHEN ("ADS"."Feature_13" <= 35.18500000000001) THEN CASE WHEN ("ADS"."Feature_21" <= 31.630000000000006) THEN CASE WHEN ("ADS"."Feature_22" <= 105.95000000000002) THEN CASE WHEN ("ADS"."Feature_13" <= 30.055000000000003) THEN CASE WHEN ("ADS"."Feature_7" <= 0.037625000000000006) THEN CASE WHEN ("ADS"."Feature_28" <= 0.32795) THEN CASE WHEN ("ADS"."Feature_19" <= 0.0017070000000000004) THEN 512 ELSE CASE WHEN ("ADS"."Feature_28" <= 0.22560000000000002) THEN 1026 ELSE CASE WHEN ("ADS"."Feature_22" <= 90.45500000000001) THEN CASE WHEN ("ADS"."Feature_18" <= 0.026975000000000002) THEN CASE WHEN ("ADS"."Feature_9" <= 0.06080000000000001) THEN 8216 ELSE CASE WHEN ("ADS"."Feature_11" <= 1.3055) THEN CASE WHEN ("ADS"."Feature_12" <= 1.3965000000000003) THEN 32868 ELSE 32869 END ELSE 16435 END END ELSE 4109 END ELSE 2055 END END END ELSE 257 END ELSE 129 END ELSE 65 END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS"."Feature_21" <= 23.785000000000004) THEN 6 ELSE CASE WHEN ("ADS"."Feature_0" <= 14.415000000000001) THEN 14 ELSE CASE WHEN ("ADS"."Feature_17" <= 0.011910000000000002) THEN 30 ELSE CASE WHEN ("ADS"."Feature_12" <= 3.6360000000000006) THEN 62 ELSE CASE WHEN ("ADS"."Feature_11" <= 1.5495000000000003) THEN CASE WHEN ("ADS"."Feature_20" <= 24.435000000000002) THEN 252 ELSE 253 END ELSE 127 END END END END END END AS node_id_2 
FROM "BreastCancer" AS "ADS"), 
"DT_node_data_14" AS 
(SELECT "Values".nid AS nid, "Values"."Score" AS "Score" 
FROM (SELECT 5 AS nid, -0.08749787035297676 AS "Score" UNION ALL SELECT 6 AS nid, -0.03778810884870479 AS "Score" UNION ALL SELECT 9 AS nid, 0.013148409456641745 AS "Score" UNION ALL SELECT 14 AS nid, -0.08691220533118116 AS "Score" UNION ALL SELECT 17 AS nid, 0.02902896644146686 AS "Score" UNION ALL SELECT 30 AS nid, -0.06394216401469215 AS "Score" UNION ALL SELECT 33 AS nid, 0.07368799394870647 AS "Score" UNION ALL SELECT 62 AS nid, -0.07425423934893634 AS "Score" UNION ALL SELECT 65 AS nid, 0.06339519322291758 AS "Score" UNION ALL SELECT 127 AS nid, -0.07337909044210948 AS "Score" UNION ALL SELECT 129 AS nid, 0.061919060731599376 AS "Score" UNION ALL SELECT 252 AS nid, -0.07297694206374081 AS "Score" UNION ALL SELECT 253 AS nid, -0.07318118958166503 AS "Score" UNION ALL SELECT 257 AS nid, 0.060845903445930286 AS "Score" UNION ALL SELECT 512 AS nid, 0.06072162008977577 AS "Score" UNION ALL SELECT 1026 AS nid, 0.060609105125371036 AS "Score" UNION ALL SELECT 2055 AS nid, 0.060453327549324136 AS "Score" UNION ALL SELECT 4109 AS nid, 0.06055150203104637 AS "Score" UNION ALL SELECT 8216 AS nid, 0.060510599126051494 AS "Score" UNION ALL SELECT 16435 AS nid, 0.06048481405293202 AS "Score" UNION ALL SELECT 32868 AS nid, 0.0604986338359937 AS "Score" UNION ALL SELECT 32869 AS nid, 0.06049976917244602 AS "Score") AS "Values"), 
"DT_Output_14" AS 
(SELECT "DT_node_lookup_14"."KEY" AS "KEY", "DT_node_lookup_14".node_id_2 AS node_id_2, "DT_node_data_14".nid AS nid, "DT_node_data_14"."Score" AS "Score" 
FROM "DT_node_lookup_14" LEFT OUTER JOIN "DT_node_data_14" ON "DT_node_lookup_14".node_id_2 = "DT_node_data_14".nid), 
"LGBM_Model_0_14" AS 
(SELECT "DT_Output_14"."KEY" AS "KEY", "DT_Output_14"."Score" AS "Score_0" 
FROM "DT_Output_14"), 
"DT_node_lookup_15" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_7" <= 0.04840500000000001) THEN CASE WHEN ("ADS"."Feature_22" <= 112.80000000000001) THEN CASE WHEN ("ADS"."Feature_13" <= 33.60500000000001) THEN CASE WHEN ("ADS"."Feature_7" <= 0.039275000000000004) THEN CASE WHEN ("ADS"."Feature_13" <= 28.565000000000005) THEN CASE WHEN ("ADS"."Feature_27" <= 0.10490000000000001) THEN CASE WHEN ("ADS"."Feature_21" <= 29.180000000000003) THEN CASE WHEN ("ADS"."Feature_19" <= 0.0016975000000000002) THEN 256 ELSE CASE WHEN ("ADS"."Feature_28" <= 0.31775000000000003) THEN CASE WHEN ("ADS"."Feature_28" <= 0.22760000000000005) THEN 1028 ELSE CASE WHEN ("ADS"."Feature_22" <= 92.88000000000001) THEN CASE WHEN ("ADS"."Feature_14" <= 0.0095285) THEN CASE WHEN ("ADS"."Feature_18" <= 0.020115000000000004) THEN CASE WHEN ("ADS"."Feature_7" <= 0.017775000000000003) THEN 16464 ELSE 16465 END ELSE 8233 END ELSE 4117 END ELSE 2059 END END ELSE 515 END END ELSE 129 END ELSE 65 END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS"."Feature_20" <= 16.155000000000005) THEN 6 ELSE CASE WHEN ("ADS"."Feature_1" <= 17.230000000000004) THEN 14 ELSE CASE WHEN ("ADS"."Feature_27" <= 0.15270000000000003) THEN 30 ELSE CASE WHEN ("ADS"."Feature_27" <= 0.17765000000000003) THEN 62 ELSE CASE WHEN ("ADS"."Feature_21" <= 26.570000000000004) THEN 126 ELSE CASE WHEN ("ADS"."Feature_22" <= 143.65) THEN 254 ELSE 255 END END END END END END END AS node_id_2 
FROM "BreastCancer" AS "ADS"), 
"DT_node_data_15" AS 
(SELECT "Values".nid AS nid, "Values"."Score" AS "Score" 
FROM (SELECT 5 AS nid, -0.011041760319748226 AS "Score" UNION ALL SELECT 6 AS nid, 0.003939156813067979 AS "Score" UNION ALL SELECT 9 AS nid, 0.023373389566664522 AS "Score" UNION ALL SELECT 14 AS nid, -0.051800482021219056 AS "Score" UNION ALL SELECT 17 AS nid, 0.06733264996340457 AS "Score" UNION ALL SELECT 30 AS nid, -0.08021230779254652 AS "Score" UNION ALL SELECT 33 AS nid, 0.06085783523450279 AS "Score" UNION ALL SELECT 62 AS nid, -0.07306277407750049 AS "Score" UNION ALL SELECT 65 AS nid, 0.06051951629846444 AS "Score" UNION ALL SELECT 126 AS nid, -0.07203396647207629 AS "Score" UNION ALL SELECT 129 AS nid, 0.06037571273942094 AS "Score" UNION ALL SELECT 254 AS nid, -0.07129861195505996 AS "Score" UNION ALL SELECT 255 AS nid, -0.07159061133315853 AS "Score" UNION ALL SELECT 256 AS nid, 0.06009524116321058 AS "Score" UNION ALL SELECT 515 AS nid, 0.06003940095285033 AS "Score" UNION ALL SELECT 1028 AS nid, 0.0599815409465896 AS "Score" UNION ALL SELECT 2059 AS nid, 0.05982781518567856 AS "Score" UNION ALL SELECT 4117 AS nid, 0.05992268890495356 AS "Score" UNION ALL SELECT 8233 AS nid, 0.05988116703734725 AS "Score" UNION ALL SELECT 16464 AS nid, 0.05988285750521031 AS "Score" UNION ALL SELECT 16465 AS nid, 0.05988357384146309 AS "Score") AS "Values"), 
"DT_Output_15" AS 
(SELECT "DT_node_lookup_15"."KEY" AS "KEY", "DT_node_lookup_15".node_id_2 AS node_id_2, "DT_node_data_15".nid AS nid, "DT_node_data_15"."Score" AS "Score" 
FROM "DT_node_lookup_15" LEFT OUTER JOIN "DT_node_data_15" ON "DT_node_lookup_15".node_id_2 = "DT_node_data_15".nid), 
"LGBM_Model_0_15" AS 
(SELECT "DT_Output_15"."KEY" AS "KEY", "DT_Output_15"."Score" AS "Score_0" 
FROM "DT_Output_15")
 INSERT INTO "TMP_20221018185052_S9G3MZW_LGBM_B1" ("KEY", "Score_0") SELECT "T"."KEY", "T"."Score_0" 
FROM (SELECT "LGBM_B1"."KEY" AS "KEY", "LGBM_B1"."Score_0" AS "Score_0" 
FROM (SELECT "LGBM_esu_1"."KEY" AS "KEY", "LGBM_esu_1"."Score_0" AS "Score_0" 
FROM (SELECT "LGBM_Model_0_10"."KEY" AS "KEY", "LGBM_Model_0_10"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_10" UNION ALL SELECT "LGBM_Model_0_11"."KEY" AS "KEY", "LGBM_Model_0_11"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_11" UNION ALL SELECT "LGBM_Model_0_12"."KEY" AS "KEY", "LGBM_Model_0_12"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_12" UNION ALL SELECT "LGBM_Model_0_13"."KEY" AS "KEY", "LGBM_Model_0_13"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_13" UNION ALL SELECT "LGBM_Model_0_14"."KEY" AS "KEY", "LGBM_Model_0_14"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_14" UNION ALL SELECT "LGBM_Model_0_15"."KEY" AS "KEY", "LGBM_Model_0_15"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_15") AS "LGBM_esu_1") AS "LGBM_B1") AS "T"

-- Code For temporary table TMP_20221018185052_G0BZGU2_LGBM_sum part 1. Create 


CREATE TEMPORARY TABLE "TMP_20221018185052_G0BZGU2_LGBM_sum" (
	"KEY" BIGINT NOT NULL, 
	"Score_0" FLOAT, 
	PRIMARY KEY ("KEY")
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table TMP_20221018185052_G0BZGU2_LGBM_sum part 2. Populate

WITH "LGBM_Union" AS 
(SELECT "LGBM_EnsembleUnion"."KEY" AS "KEY", "LGBM_EnsembleUnion"."Score_0" AS "Score_0" 
FROM (SELECT "LGBM_B0"."KEY" AS "KEY", "LGBM_B0"."Score_0" AS "Score_0" 
FROM "TMP_20221018185052_T8C9SXC_LGBM_B0" AS "LGBM_B0" UNION ALL SELECT "LGBM_B1"."KEY" AS "KEY", "LGBM_B1"."Score_0" AS "Score_0" 
FROM "TMP_20221018185052_S9G3MZW_LGBM_B1" AS "LGBM_B1") AS "LGBM_EnsembleUnion")
 INSERT INTO "TMP_20221018185052_G0BZGU2_LGBM_sum" ("KEY", "Score_0") SELECT "T"."KEY", "T"."Score_0" 
FROM (SELECT "LGBM_sum"."KEY" AS "KEY", "LGBM_sum"."Score_0" AS "Score_0" 
FROM (SELECT "T"."KEY" AS "KEY", CAST("T"."Score_0" AS FLOAT) AS "Score_0" 
FROM (SELECT "LGBM_Union"."KEY" AS "KEY", sum("LGBM_Union"."Score_0") AS "Score_0" 
FROM "LGBM_Union" GROUP BY "LGBM_Union"."KEY") AS "T") AS "LGBM_sum") AS "T"

-- Code For temporary table TMP_20221018185052_G0BZGU2_LGBM_sum part 3. Create Index 

CREATE INDEX "ix_TMP_20221018185052_G0BZGU2_LGBM_sum_KEY" ON "TMP_20221018185052_G0BZGU2_LGBM_sum" ("KEY")

-- Model deployment code

WITH orig_cte AS 
(SELECT "LGBM_sum"."KEY" AS "KEY", "LGBM_sum"."Score_0" AS "Score_0", CAST(NULL AS FLOAT) AS "Score_1", 1.0 - 1.0 / (1.0 + exp(least(100.0, greatest(-100.0, -"LGBM_sum"."Score_0")))) AS "Proba_0", 1.0 / (1.0 + exp(least(100.0, greatest(-100.0, -"LGBM_sum"."Score_0")))) AS "Proba_1", CAST(NULL AS FLOAT) AS "LogProba_0", CAST(NULL AS FLOAT) AS "LogProba_1", CAST(NULL AS BIGINT) AS "Decision", CAST(NULL AS FLOAT) AS "DecisionProba" 
FROM "TMP_20221018185052_G0BZGU2_LGBM_sum" AS "LGBM_sum"), 
score_class_union AS 
(SELECT scu."KEY_u" AS "KEY_u", scu.class AS class, scu."LogProba" AS "LogProba", scu."Proba" AS "Proba", scu."Score" AS "Score" 
FROM (SELECT orig_cte."KEY" AS "KEY_u", 0 AS class, orig_cte."LogProba_0" AS "LogProba", orig_cte."Proba_0" AS "Proba", orig_cte."Score_0" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY_u", 1 AS class, orig_cte."LogProba_1" AS "LogProba", orig_cte."Proba_1" AS "Proba", orig_cte."Score_1" AS "Score" 
FROM orig_cte) AS scu), 
score_max AS 
(SELECT orig_cte."KEY" AS "KEY", orig_cte."Score_0" AS "Score_0", orig_cte."Score_1" AS "Score_1", orig_cte."Proba_0" AS "Proba_0", orig_cte."Proba_1" AS "Proba_1", orig_cte."LogProba_0" AS "LogProba_0", orig_cte."LogProba_1" AS "LogProba_1", orig_cte."Decision" AS "Decision", orig_cte."DecisionProba" AS "DecisionProba", max_select."KEY_m" AS "KEY_m", max_select."max_Proba" AS "max_Proba" 
FROM orig_cte LEFT OUTER JOIN (SELECT score_class_union."KEY_u" AS "KEY_m", max(score_class_union."Proba") AS "max_Proba" 
FROM score_class_union GROUP BY score_class_union."KEY_u") AS max_select ON orig_cte."KEY" = max_select."KEY_m"), 
union_with_max AS 
(SELECT score_class_union."KEY_u" AS "KEY_u", score_class_union.class AS class, score_class_union."LogProba" AS "LogProba", score_class_union."Proba" AS "Proba", score_class_union."Score" AS "Score", score_max."KEY" AS "KEY", score_max."Score_0" AS "Score_0", score_max."Score_1" AS "Score_1", score_max."Proba_0" AS "Proba_0", score_max."Proba_1" AS "Proba_1", score_max."LogProba_0" AS "LogProba_0", score_max."LogProba_1" AS "LogProba_1", score_max."Decision" AS "Decision", score_max."DecisionProba" AS "DecisionProba", score_max."KEY_m" AS "KEY_m", score_max."max_Proba" AS "max_Proba" 
FROM score_class_union LEFT OUTER JOIN score_max ON score_class_union."KEY_u" = score_max."KEY"), 
arg_max_cte AS 
(SELECT score_max."KEY" AS "KEY", score_max."Score_0" AS "Score_0", score_max."Score_1" AS "Score_1", score_max."Proba_0" AS "Proba_0", score_max."Proba_1" AS "Proba_1", score_max."LogProba_0" AS "LogProba_0", score_max."LogProba_1" AS "LogProba_1", score_max."Decision" AS "Decision", score_max."DecisionProba" AS "DecisionProba", score_max."KEY_m" AS "KEY_m", score_max."max_Proba" AS "max_Proba", "arg_max_t_Proba"."KEY_Proba" AS "KEY_Proba", "arg_max_t_Proba"."arg_max_Proba" AS "arg_max_Proba" 
FROM score_max LEFT OUTER JOIN (SELECT union_with_max."KEY" AS "KEY_Proba", max(union_with_max.class) AS "arg_max_Proba" 
FROM union_with_max 
WHERE union_with_max."max_Proba" <= union_with_max."Proba" GROUP BY union_with_max."KEY") AS "arg_max_t_Proba" ON score_max."KEY" = "arg_max_t_Proba"."KEY_Proba")
 SELECT arg_max_cte."KEY" AS "KEY", CAST(NULL AS FLOAT) AS "Score_0", CAST(NULL AS FLOAT) AS "Score_1", arg_max_cte."Proba_0" AS "Proba_0", arg_max_cte."Proba_1" AS "Proba_1", CASE WHEN (arg_max_cte."Proba_0" IS NULL OR arg_max_cte."Proba_0" > 0.0) THEN ln(arg_max_cte."Proba_0") ELSE '-Infinity'::float8 END AS "LogProba_0", CASE WHEN (arg_max_cte."Proba_1" IS NULL OR arg_max_cte."Proba_1" > 0.0) THEN ln(arg_max_cte."Proba_1") ELSE '-Infinity'::float8 END AS "LogProba_1", arg_max_cte."arg_max_Proba" AS "Decision", arg_max_cte."max_Proba" AS "DecisionProba" 
FROM arg_max_cte