-- This SQL code was generated by sklearn2sql (development version).
-- Copyright 2018

-- Model : LGBMRegressor_Pipeline
-- Dataset : california_housing
-- Database : duck


-- This SQL code can contain one or more statements, to be executed in the order they appear in this file.



-- Code For temporary table TMP_20221018185625_Q18K41C_ADS_imp_1_OUT part 1. Create 


CREATE TEMPORARY TABLE "TMP_20221018185625_Q18K41C_ADS_imp_1_OUT" (
	"KEY" BIGINT NOT NULL, 
	imputer_output_2 DOUBLE, 
	imputer_output_3 DOUBLE, 
	imputer_output_4 DOUBLE, 
	imputer_output_5 DOUBLE, 
	imputer_output_6 DOUBLE, 
	imputer_output_7 DOUBLE, 
	imputer_output_8 DOUBLE, 
	imputer_output_9 DOUBLE, 
	PRIMARY KEY ("KEY")
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table TMP_20221018185625_Q18K41C_ADS_imp_1_OUT part 2. Populate

INSERT INTO "TMP_20221018185625_Q18K41C_ADS_imp_1_OUT" ("KEY", imputer_output_2, imputer_output_3, imputer_output_4, imputer_output_5, imputer_output_6, imputer_output_7, imputer_output_8, imputer_output_9) SELECT "T"."KEY", "T".imputer_output_2, "T".imputer_output_3, "T".imputer_output_4, "T".imputer_output_5, "T".imputer_output_6, "T".imputer_output_7, "T".imputer_output_8, "T".imputer_output_9 
FROM (SELECT "ADS_imp_1_OUT"."KEY" AS "KEY", "ADS_imp_1_OUT".imputer_output_2 AS imputer_output_2, "ADS_imp_1_OUT".imputer_output_3 AS imputer_output_3, "ADS_imp_1_OUT".imputer_output_4 AS imputer_output_4, "ADS_imp_1_OUT".imputer_output_5 AS imputer_output_5, "ADS_imp_1_OUT".imputer_output_6 AS imputer_output_6, "ADS_imp_1_OUT".imputer_output_7 AS imputer_output_7, "ADS_imp_1_OUT".imputer_output_8 AS imputer_output_8, "ADS_imp_1_OUT".imputer_output_9 AS imputer_output_9 
FROM (SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_0" IS NULL) THEN 3.875277222625981 ELSE "ADS"."Feature_0" END AS imputer_output_2, CASE WHEN ("ADS"."Feature_1" IS NULL) THEN 28.659944282945737 ELSE "ADS"."Feature_1" END AS imputer_output_3, CASE WHEN ("ADS"."Feature_2" IS NULL) THEN 5.428657238393813 ELSE "ADS"."Feature_2" END AS imputer_output_4, CASE WHEN ("ADS"."Feature_3" IS NULL) THEN 1.096090907040768 ELSE "ADS"."Feature_3" END AS imputer_output_5, CASE WHEN ("ADS"."Feature_4" IS NULL) THEN 1423.4244186046512 ELSE "ADS"."Feature_4" END AS imputer_output_6, CASE WHEN ("ADS"."Feature_5" IS NULL) THEN 3.014227103131199 ELSE "ADS"."Feature_5" END AS imputer_output_7, CASE WHEN ("ADS"."Feature_6" IS NULL) THEN 35.62345445736438 ELSE "ADS"."Feature_6" END AS imputer_output_8, CASE WHEN ("ADS"."Feature_7" IS NULL) THEN -119.55986736918535 ELSE "ADS"."Feature_7" END AS imputer_output_9 
FROM california_housing AS "ADS") AS "ADS_imp_1_OUT") AS "T"

-- Code For temporary table TMP_20221018185625_Q18K41C_ADS_imp_1_OUT part 3. Create Index 

CREATE INDEX "ix_TMP_20221018185625_Q18K41C_ADS_imp_1_OUT_KEY" ON "TMP_20221018185625_Q18K41C_ADS_imp_1_OUT" ("KEY")

-- Code For temporary table TMP_20221018185625_DAVOS1J_ADS_sca_2_OUT part 1. Create 


CREATE TEMPORARY TABLE "TMP_20221018185625_DAVOS1J_ADS_sca_2_OUT" (
	"KEY" BIGINT NOT NULL, 
	scaler_output_2 DOUBLE, 
	scaler_output_3 DOUBLE, 
	scaler_output_4 DOUBLE, 
	scaler_output_5 DOUBLE, 
	scaler_output_6 DOUBLE, 
	scaler_output_7 DOUBLE, 
	scaler_output_8 DOUBLE, 
	scaler_output_9 DOUBLE, 
	PRIMARY KEY ("KEY")
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table TMP_20221018185625_DAVOS1J_ADS_sca_2_OUT part 2. Populate

INSERT INTO "TMP_20221018185625_DAVOS1J_ADS_sca_2_OUT" ("KEY", scaler_output_2, scaler_output_3, scaler_output_4, scaler_output_5, scaler_output_6, scaler_output_7, scaler_output_8, scaler_output_9) SELECT "T"."KEY", "T".scaler_output_2, "T".scaler_output_3, "T".scaler_output_4, "T".scaler_output_5, "T".scaler_output_6, "T".scaler_output_7, "T".scaler_output_8, "T".scaler_output_9 
FROM (SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", "ADS_sca_2_OUT".scaler_output_2 AS scaler_output_2, "ADS_sca_2_OUT".scaler_output_3 AS scaler_output_3, "ADS_sca_2_OUT".scaler_output_4 AS scaler_output_4, "ADS_sca_2_OUT".scaler_output_5 AS scaler_output_5, "ADS_sca_2_OUT".scaler_output_6 AS scaler_output_6, "ADS_sca_2_OUT".scaler_output_7 AS scaler_output_7, "ADS_sca_2_OUT".scaler_output_8 AS scaler_output_8, "ADS_sca_2_OUT".scaler_output_9 AS scaler_output_9 
FROM (SELECT "ADS_imp_1_OUT"."KEY" AS "KEY", (CAST("ADS_imp_1_OUT".imputer_output_2 AS DOUBLE) - 3.875277222625981) / 1.9053899472815896 AS scaler_output_2, (CAST("ADS_imp_1_OUT".imputer_output_3 AS DOUBLE) - 28.659944282945737) / 12.6088852253006 AS scaler_output_3, (CAST("ADS_imp_1_OUT".imputer_output_4 AS DOUBLE) - 5.428657238393813) / 2.5399058358138342 AS scaler_output_4, (CAST("ADS_imp_1_OUT".imputer_output_5 AS DOUBLE) - 1.096090907040768) / 0.4891610828680933 AS scaler_output_5, (CAST("ADS_imp_1_OUT".imputer_output_6 AS DOUBLE) - 1423.4244186046512) / 1119.3930591342048 AS scaler_output_6, (CAST("ADS_imp_1_OUT".imputer_output_7 AS DOUBLE) - 3.014227103131199) / 6.18082640740381 AS scaler_output_7, (CAST("ADS_imp_1_OUT".imputer_output_8 AS DOUBLE) - 35.62345445736438) / 2.1377165043713364 AS scaler_output_8, (CAST("ADS_imp_1_OUT".imputer_output_9 AS DOUBLE) - -119.55986736918535) / 2.003934000482767 AS scaler_output_9 
FROM "TMP_20221018185625_Q18K41C_ADS_imp_1_OUT" AS "ADS_imp_1_OUT") AS "ADS_sca_2_OUT") AS "T"

-- Code For temporary table TMP_20221018185625_DAVOS1J_ADS_sca_2_OUT part 3. Create Index 

CREATE INDEX "ix_TMP_20221018185625_DAVOS1J_ADS_sca_2_OUT_KEY" ON "TMP_20221018185625_DAVOS1J_ADS_sca_2_OUT" ("KEY")

-- Code For temporary table TMP_20221018185625_4I3606V_LGBM_B0 part 1. Create 


CREATE TEMPORARY TABLE "TMP_20221018185625_4I3606V_LGBM_B0" (
	"KEY" BIGINT, 
	"Estimator" DOUBLE
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table TMP_20221018185625_4I3606V_LGBM_B0 part 2. Populate

WITH "DT_node_lookup" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 0.6075778761327388) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -0.4227886390265121) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_4 <= -0.4394041316533341) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.1371708862913468) THEN 16 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -0.8691277210676095) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_4 <= -0.8301612332964686) THEN 68 ELSE 69 END ELSE 35 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -0.7966753602283203) THEN 18 ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.09975011453211675) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.72646741716434) THEN 20 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.0813152903618533) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 0.013211352043676418) THEN 84 ELSE 85 END ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 0.1266526978996154) THEN 22 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.016777692622491052) THEN 46 ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 1.4255206821307993) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.07118151778159366) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.72646741716434) THEN 24 ELSE 25 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 0.9509459100270162) THEN 26 ELSE 27 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 2.068748595529082) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.1713033503240762) THEN 28 ELSE 29 END ELSE 15 END END END AS node_id_2 
FROM "TMP_20221018185625_DAVOS1J_ADS_sca_2_OUT" AS "ADS_sca_2_OUT"), 
"DT_node_data" AS 
(SELECT "Values".nid AS nid, "Values"."Estimator" AS "Estimator" 
FROM (SELECT 15 AS nid, 2.1959408884701443 AS "Estimator" UNION ALL SELECT 16 AS nid, 2.07522269610049 AS "Estimator" UNION ALL SELECT 18 AS nid, 2.0152706735548733 AS "Estimator" UNION ALL SELECT 19 AS nid, 2.035273530391065 AS "Estimator" UNION ALL SELECT 20 AS nid, 2.074141698884329 AS "Estimator" UNION ALL SELECT 22 AS nid, 2.0528561430158443 AS "Estimator" UNION ALL SELECT 24 AS nid, 2.1133732361015696 AS "Estimator" UNION ALL SELECT 25 AS nid, 2.155049936410723 AS "Estimator" UNION ALL SELECT 26 AS nid, 2.0867761077195848 AS "Estimator" UNION ALL SELECT 27 AS nid, 2.1107630342767143 AS "Estimator" UNION ALL SELECT 28 AS nid, 2.136544078168909 AS "Estimator" UNION ALL SELECT 29 AS nid, 2.1777294960722893 AS "Estimator" UNION ALL SELECT 35 AS nid, 2.053822723358607 AS "Estimator" UNION ALL SELECT 43 AS nid, 2.057919539778521 AS "Estimator" UNION ALL SELECT 46 AS nid, 2.0847331056517273 AS "Estimator" UNION ALL SELECT 47 AS nid, 2.0626883354108907 AS "Estimator" UNION ALL SELECT 68 AS nid, 2.0558312053419323 AS "Estimator" UNION ALL SELECT 69 AS nid, 2.0245690794440714 AS "Estimator" UNION ALL SELECT 84 AS nid, 2.112267651670282 AS "Estimator" UNION ALL SELECT 85 AS nid, 2.146544208038409 AS "Estimator") AS "Values"), 
"DT_Output" AS 
(SELECT "DT_node_lookup"."KEY" AS "KEY", "DT_node_lookup".node_id_2 AS node_id_2, "DT_node_data".nid AS nid, "DT_node_data"."Estimator" AS "Estimator" 
FROM "DT_node_lookup" LEFT OUTER JOIN "DT_node_data" ON "DT_node_lookup".node_id_2 = "DT_node_data".nid), 
"LGBM_Model_0" AS 
(SELECT "DT_Output"."KEY" AS "KEY", "DT_Output"."Estimator" AS "Estimator" 
FROM "DT_Output"), 
"DT_node_lookup_1" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 0.6075778761327388) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -0.4227886390265121) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_4 <= -0.4394041316533341) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.09109870742947489) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.0719595128492119) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= 0.6561430510528757) THEN 64 ELSE 65 END ELSE 33 END ELSE 17 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -0.7966753602283203) THEN 18 ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.09975011453211675) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.5678491123528361) THEN 20 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.0813152903618533) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.16402739434683514) THEN 84 ELSE 85 END ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 0.0355427388869344) THEN 22 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.019926162282545463) THEN 46 ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 1.4255206821307993) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.043283558604192605) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.72646741716434) THEN 24 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.1371708862913468) THEN 50 ELSE 51 END END ELSE 13 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 2.068748595529082) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.1713033503240762) THEN 28 ELSE 29 END ELSE 15 END END END AS node_id_2 
FROM "TMP_20221018185625_DAVOS1J_ADS_sca_2_OUT" AS "ADS_sca_2_OUT"), 
"DT_node_data_1" AS 
(SELECT "Values".nid AS nid, "Values"."Estimator" AS "Estimator" 
FROM (SELECT 13 AS nid, 0.020713265142421527 AS "Estimator" UNION ALL SELECT 15 AS nid, 0.11850842429514559 AS "Estimator" UNION ALL SELECT 17 AS nid, -0.029163610390465774 AS "Estimator" UNION ALL SELECT 18 AS nid, -0.05312827560656951 AS "Estimator" UNION ALL SELECT 19 AS nid, -0.034125561343136504 AS "Estimator" UNION ALL SELECT 20 AS nid, 0.00618983846673652 AS "Estimator" UNION ALL SELECT 22 AS nid, -0.019231008529711664 AS "Estimator" UNION ALL SELECT 24 AS nid, 0.034411108343079554 AS "Estimator" UNION ALL SELECT 28 AS nid, 0.0620814585243043 AS "Estimator" UNION ALL SELECT 29 AS nid, 0.10120760145414548 AS "Estimator" UNION ALL SELECT 33 AS nid, -0.04215760289636605 AS "Estimator" UNION ALL SELECT 43 AS nid, -0.011762640007288645 AS "Estimator" UNION ALL SELECT 46 AS nid, 0.010651948087100897 AS "Estimator" UNION ALL SELECT 47 AS nid, -0.009440920342395525 AS "Estimator" UNION ALL SELECT 50 AS nid, 0.11058643087096837 AS "Estimator" UNION ALL SELECT 51 AS nid, 0.061463596473678606 AS "Estimator" UNION ALL SELECT 64 AS nid, 0.022732466739136727 AS "Estimator" UNION ALL SELECT 65 AS nid, -0.018918732973002644 AS "Estimator" UNION ALL SELECT 84 AS nid, 0.07856807792002497 AS "Estimator" UNION ALL SELECT 85 AS nid, 0.04088407793107309 AS "Estimator") AS "Values"), 
"DT_Output_1" AS 
(SELECT "DT_node_lookup_1"."KEY" AS "KEY", "DT_node_lookup_1".node_id_2 AS node_id_2, "DT_node_data_1".nid AS nid, "DT_node_data_1"."Estimator" AS "Estimator" 
FROM "DT_node_lookup_1" LEFT OUTER JOIN "DT_node_data_1" ON "DT_node_lookup_1".node_id_2 = "DT_node_data_1".nid), 
"LGBM_Model_1" AS 
(SELECT "DT_Output_1"."KEY" AS "KEY", "DT_Output_1"."Estimator" AS "Estimator" 
FROM "DT_Output_1"), 
"DT_node_lookup_2" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 0.6596407098542709) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -0.39318839888644735) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.13574794044030822) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.0859931791181747) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= 0.6561430510528757) THEN 32 ELSE 33 END ELSE 17 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= -0.5419121080814512) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= 0.8956718977535956) THEN 36 ELSE 37 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= -1.0554901659960325) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.0719595128492119) THEN 76 ELSE 77 END ELSE 39 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.10736767896119763) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.5678491123528361) THEN 20 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.0251806252860052) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.17190032096781402) THEN 84 ELSE 85 END ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 0.11660226175276708) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= 1.335570545385212) THEN 44 ELSE 45 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.029393229397362605) THEN 46 ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 1.6087902540618375) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.043283558604192605) THEN 12 ELSE 13 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 2.5525865633504563) THEN 14 ELSE 15 END END END AS node_id_2 
FROM "TMP_20221018185625_DAVOS1J_ADS_sca_2_OUT" AS "ADS_sca_2_OUT"), 
"DT_node_data_2" AS 
(SELECT "Values".nid AS nid, "Values"."Estimator" AS "Estimator" 
FROM (SELECT 12 AS nid, 0.06315647486065468 AS "Estimator" UNION ALL SELECT 13 AS nid, 0.02442103450776668 AS "Estimator" UNION ALL SELECT 14 AS nid, 0.08660030758874432 AS "Estimator" UNION ALL SELECT 15 AS nid, 0.12192212661296492 AS "Estimator" UNION ALL SELECT 17 AS nid, -0.03650166366815102 AS "Estimator" UNION ALL SELECT 20 AS nid, 0.007866187749963826 AS "Estimator" UNION ALL SELECT 32 AS nid, 0.020413627329913895 AS "Estimator" UNION ALL SELECT 33 AS nid, -0.019914574280443617 AS "Estimator" UNION ALL SELECT 36 AS nid, -0.016600091808491615 AS "Estimator" UNION ALL SELECT 37 AS nid, -0.044220221535466564 AS "Estimator" UNION ALL SELECT 39 AS nid, -0.05457478750451755 AS "Estimator" UNION ALL SELECT 43 AS nid, 0.005313120237888253 AS "Estimator" UNION ALL SELECT 44 AS nid, -0.01871241476218505 AS "Estimator" UNION ALL SELECT 45 AS nid, 0.013015674920060461 AS "Estimator" UNION ALL SELECT 46 AS nid, 0.01617132156725834 AS "Estimator" UNION ALL SELECT 47 AS nid, -0.006048393055246355 AS "Estimator" UNION ALL SELECT 76 AS nid, -0.010601798346464944 AS "Estimator" UNION ALL SELECT 77 AS nid, -0.048217801485425205 AS "Estimator" UNION ALL SELECT 84 AS nid, 0.0838842700297926 AS "Estimator" UNION ALL SELECT 85 AS nid, 0.04678701780167503 AS "Estimator") AS "Values"), 
"DT_Output_2" AS 
(SELECT "DT_node_lookup_2"."KEY" AS "KEY", "DT_node_lookup_2".node_id_2 AS node_id_2, "DT_node_data_2".nid AS nid, "DT_node_data_2"."Estimator" AS "Estimator" 
FROM "DT_node_lookup_2" LEFT OUTER JOIN "DT_node_data_2" ON "DT_node_lookup_2".node_id_2 = "DT_node_data_2".nid), 
"LGBM_Model_2" AS 
(SELECT "DT_Output_2"."KEY" AS "KEY", "DT_Output_2"."Estimator" AS "Estimator" 
FROM "DT_Output_2"), 
"DT_node_lookup_3" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 0.9029504851899789) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -0.3589696815614084) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.11660793509608845) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.0813152903618533) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= 0.6611332353591398) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= -0.45771011046767757) THEN 64 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= -0.541501182450734) THEN 130 ELSE 131 END END ELSE 33 END ELSE 17 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= -0.5419121080814512) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= 0.8956718977535956) THEN 36 ELSE 37 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= -1.0305392444647052) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.4274790583295907) THEN 76 ELSE 77 END ELSE 39 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.0964976015934282) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.72646741716434) THEN 20 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.0813152903618533) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.17190032096781402) THEN 84 ELSE 85 END ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 0.34369488424578043) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= 1.097643088167956) THEN 44 ELSE 45 END ELSE 23 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 1.9901032766463038) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.05790498081382539) THEN 12 ELSE 13 END ELSE 7 END END AS node_id_2 
FROM "TMP_20221018185625_DAVOS1J_ADS_sca_2_OUT" AS "ADS_sca_2_OUT"), 
"DT_node_data_3" AS 
(SELECT "Values".nid AS nid, "Values"."Estimator" AS "Estimator" 
FROM (SELECT 7 AS nid, 0.10480176960670365 AS "Estimator" UNION ALL SELECT 12 AS nid, 0.07757276439022998 AS "Estimator" UNION ALL SELECT 13 AS nid, 0.039516795257436906 AS "Estimator" UNION ALL SELECT 17 AS nid, -0.03581809982475741 AS "Estimator" UNION ALL SELECT 20 AS nid, 0.005200615655797135 AS "Estimator" UNION ALL SELECT 23 AS nid, 0.010341513527049182 AS "Estimator" UNION ALL SELECT 33 AS nid, -0.017769346166954154 AS "Estimator" UNION ALL SELECT 36 AS nid, -0.01636749748219684 AS "Estimator" UNION ALL SELECT 37 AS nid, -0.04273268103520623 AS "Estimator" UNION ALL SELECT 39 AS nid, -0.052313046349836204 AS "Estimator" UNION ALL SELECT 43 AS nid, -0.007274001520113567 AS "Estimator" UNION ALL SELECT 44 AS nid, -0.015448337068661855 AS "Estimator" UNION ALL SELECT 45 AS nid, 0.010380395295474696 AS "Estimator" UNION ALL SELECT 64 AS nid, 0.03956465073578963 AS "Estimator" UNION ALL SELECT 76 AS nid, -0.017624644731946346 AS "Estimator" UNION ALL SELECT 77 AS nid, -0.05384632842196675 AS "Estimator" UNION ALL SELECT 84 AS nid, 0.07963986361753017 AS "Estimator" UNION ALL SELECT 85 AS nid, 0.044355299503974634 AS "Estimator" UNION ALL SELECT 130 AS nid, 0.012782476401231466 AS "Estimator" UNION ALL SELECT 131 AS nid, -0.052860906720161444 AS "Estimator") AS "Values"), 
"DT_Output_3" AS 
(SELECT "DT_node_lookup_3"."KEY" AS "KEY", "DT_node_lookup_3".node_id_2 AS node_id_2, "DT_node_data_3".nid AS nid, "DT_node_data_3"."Estimator" AS "Estimator" 
FROM "DT_node_lookup_3" LEFT OUTER JOIN "DT_node_data_3" ON "DT_node_lookup_3".node_id_2 = "DT_node_data_3".nid), 
"LGBM_Model_3" AS 
(SELECT "DT_Output_3"."KEY" AS "KEY", "DT_Output_3"."Estimator" AS "Estimator" 
FROM "DT_Output_3"), 
"DT_node_lookup_4" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 0.9029504851899789) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -0.16381277914858902) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.1254491911766565) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -0.7080058465463362) THEN 16 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.5678491123528361) THEN 34 ELSE 35 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= -0.5419121080814512) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= 0.8956718977535956) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= 0.058737878958225694) THEN 72 ELSE 73 END ELSE 37 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= -1.0305392444647052) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.0719595128492119) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= -1.3798521459032551) THEN 152 ELSE 153 END ELSE 77 END ELSE 39 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.09750276889104369) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.72646741716434) THEN 20 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.15618532396705134) THEN 42 ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 0.34369488424578043) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= 1.097643088167956) THEN 44 ELSE 45 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.013581077869301966) THEN 46 ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 1.9901032766463038) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.05790498081382539) THEN 12 ELSE 13 END ELSE 7 END END AS node_id_2 
FROM "TMP_20221018185625_DAVOS1J_ADS_sca_2_OUT" AS "ADS_sca_2_OUT"), 
"DT_node_data_4" AS 
(SELECT "Values".nid AS nid, "Values"."Estimator" AS "Estimator" 
FROM (SELECT 7 AS nid, 0.09956167733956724 AS "Estimator" UNION ALL SELECT 12 AS nid, 0.07369412506976415 AS "Estimator" UNION ALL SELECT 13 AS nid, 0.037540955505362246 AS "Estimator" UNION ALL SELECT 16 AS nid, -0.02031526873891325 AS "Estimator" UNION ALL SELECT 20 AS nid, 0.008752674980427954 AS "Estimator" UNION ALL SELECT 34 AS nid, -0.009124449952023812 AS "Estimator" UNION ALL SELECT 35 AS nid, 0.02500474852795455 AS "Estimator" UNION ALL SELECT 37 AS nid, -0.03851928442635161 AS "Estimator" UNION ALL SELECT 39 AS nid, -0.04804070317994564 AS "Estimator" UNION ALL SELECT 42 AS nid, 0.07928297870610945 AS "Estimator" UNION ALL SELECT 43 AS nid, 0.039305267172850586 AS "Estimator" UNION ALL SELECT 44 AS nid, -0.011490708131708396 AS "Estimator" UNION ALL SELECT 45 AS nid, 0.01612071543653359 AS "Estimator" UNION ALL SELECT 46 AS nid, 0.020786331959649157 AS "Estimator" UNION ALL SELECT 47 AS nid, -0.0001236721990083993 AS "Estimator" UNION ALL SELECT 72 AS nid, -0.0009173585278353441 AS "Estimator" UNION ALL SELECT 73 AS nid, -0.02375411216218888 AS "Estimator" UNION ALL SELECT 77 AS nid, -0.0414569128429903 AS "Estimator" UNION ALL SELECT 152 AS nid, 0.031380778883284034 AS "Estimator" UNION ALL SELECT 153 AS nid, -0.014950538656031936 AS "Estimator") AS "Values"), 
"DT_Output_4" AS 
(SELECT "DT_node_lookup_4"."KEY" AS "KEY", "DT_node_lookup_4".node_id_2 AS node_id_2, "DT_node_data_4".nid AS nid, "DT_node_data_4"."Estimator" AS "Estimator" 
FROM "DT_node_lookup_4" LEFT OUTER JOIN "DT_node_data_4" ON "DT_node_lookup_4".node_id_2 = "DT_node_data_4".nid), 
"LGBM_Model_4" AS 
(SELECT "DT_Output_4"."KEY" AS "KEY", "DT_Output_4"."Estimator" AS "Estimator" 
FROM "DT_Output_4"), 
"DT_node_lookup_5" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 0.6596407098542709) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -0.5473038335873333) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_4 <= -0.6300771852284078) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= 0.015038462503827834) THEN 16 ELSE 17 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -0.8691277210676095) THEN 18 ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.12092211864606217) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.3299216551355802) THEN 20 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.0251806252860052) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -0.0982881340867618) THEN 84 ELSE 85 END ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 0.0355427388869344) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_4 <= -0.12318371839742172) THEN 44 ELSE 45 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.029393229397362605) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.0813152903618533) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= -1.319969934228076) THEN 184 ELSE 185 END ELSE 93 END ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 1.4255206821307993) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.06741512473613993) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.72646741716434) THEN 24 ELSE 25 END ELSE 13 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 2.5525865633504563) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.1713033503240762) THEN 28 ELSE 29 END ELSE 15 END END END AS node_id_2 
FROM "TMP_20221018185625_DAVOS1J_ADS_sca_2_OUT" AS "ADS_sca_2_OUT"), 
"DT_node_data_5" AS 
(SELECT "Values".nid AS nid, "Values"."Estimator" AS "Estimator" 
FROM (SELECT 13 AS nid, 0.02096352343741713 AS "Estimator" UNION ALL SELECT 15 AS nid, 0.10560784661625273 AS "Estimator" UNION ALL SELECT 16 AS nid, -0.0012325208771076803 AS "Estimator" UNION ALL SELECT 17 AS nid, -0.024204482140826083 AS "Estimator" UNION ALL SELECT 18 AS nid, -0.04426974240360867 AS "Estimator" UNION ALL SELECT 19 AS nid, -0.028082393903741162 AS "Estimator" UNION ALL SELECT 20 AS nid, 0.008848688272342663 AS "Estimator" UNION ALL SELECT 24 AS nid, 0.03058547596108507 AS "Estimator" UNION ALL SELECT 25 AS nid, 0.06817300392972196 AS "Estimator" UNION ALL SELECT 28 AS nid, 0.05473158861118152 AS "Estimator" UNION ALL SELECT 29 AS nid, 0.0917743368407454 AS "Estimator" UNION ALL SELECT 43 AS nid, 0.001652063756587151 AS "Estimator" UNION ALL SELECT 44 AS nid, -0.00771481146177459 AS "Estimator" UNION ALL SELECT 45 AS nid, -0.0236255665879025 AS "Estimator" UNION ALL SELECT 47 AS nid, -0.006787536921462917 AS "Estimator" UNION ALL SELECT 84 AS nid, 0.038153906720399394 AS "Estimator" UNION ALL SELECT 85 AS nid, 0.0727605314523344 AS "Estimator" UNION ALL SELECT 93 AS nid, -0.011305640266319613 AS "Estimator" UNION ALL SELECT 184 AS nid, 0.05540688783796721 AS "Estimator" UNION ALL SELECT 185 AS nid, 0.01574699102944192 AS "Estimator") AS "Values"), 
"DT_Output_5" AS 
(SELECT "DT_node_lookup_5"."KEY" AS "KEY", "DT_node_lookup_5".node_id_2 AS node_id_2, "DT_node_data_5".nid AS nid, "DT_node_data_5"."Estimator" AS "Estimator" 
FROM "DT_node_lookup_5" LEFT OUTER JOIN "DT_node_data_5" ON "DT_node_lookup_5".node_id_2 = "DT_node_data_5".nid), 
"LGBM_Model_5" AS 
(SELECT "DT_Output_5"."KEY" AS "KEY", "DT_Output_5"."Estimator" AS "Estimator" 
FROM "DT_Output_5"), 
"DT_node_lookup_6" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 0.9029504851899789) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -0.3589696815614084) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.15899639020455322) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.0813152903618533) THEN 16 ELSE 17 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= -0.5419121080814512) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= 0.6311921295215485) THEN 36 ELSE 37 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= -1.0554901659960325) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.4274790583295907) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= -1.4097932517408462) THEN 152 ELSE 153 END ELSE 77 END ELSE 39 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.10736767896119763) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.72646741716434) THEN 20 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.0906710678744962) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 0.04724637993522232) THEN 84 ELSE 85 END ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 0.34369488424578043) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= 1.335570545385212) THEN 44 ELSE 45 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.0071494803016106485) THEN 46 ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 2.068748595529082) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.010384383841361115) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.5678491123528361) THEN 24 ELSE 25 END ELSE 13 END ELSE 7 END END AS node_id_2 
FROM "TMP_20221018185625_DAVOS1J_ADS_sca_2_OUT" AS "ADS_sca_2_OUT"), 
"DT_node_data_6" AS 
(SELECT "Values".nid AS nid, "Values"."Estimator" AS "Estimator" 
FROM (SELECT 7 AS nid, 0.09237397848199663 AS "Estimator" UNION ALL SELECT 13 AS nid, 0.027251795551855265 AS "Estimator" UNION ALL SELECT 16 AS nid, 0.009369516252222059 AS "Estimator" UNION ALL SELECT 17 AS nid, -0.02788002204948238 AS "Estimator" UNION ALL SELECT 20 AS nid, 0.005995722654838405 AS "Estimator" UNION ALL SELECT 24 AS nid, 0.03886531733442098 AS "Estimator" UNION ALL SELECT 25 AS nid, 0.06868182311025114 AS "Estimator" UNION ALL SELECT 36 AS nid, 0.0019045388179069799 AS "Estimator" UNION ALL SELECT 37 AS nid, -0.025667059050068792 AS "Estimator" UNION ALL SELECT 39 AS nid, -0.04475062266429181 AS "Estimator" UNION ALL SELECT 43 AS nid, -0.007617340807337314 AS "Estimator" UNION ALL SELECT 44 AS nid, -0.012060388590089108 AS "Estimator" UNION ALL SELECT 45 AS nid, 0.017446440846610678 AS "Estimator" UNION ALL SELECT 46 AS nid, 0.019405355252713738 AS "Estimator" UNION ALL SELECT 47 AS nid, -0.0010147607737786813 AS "Estimator" UNION ALL SELECT 77 AS nid, -0.0473629963043935 AS "Estimator" UNION ALL SELECT 84 AS nid, 0.03492494193668232 AS "Estimator" UNION ALL SELECT 85 AS nid, 0.06593532950170719 AS "Estimator" UNION ALL SELECT 152 AS nid, 0.01703474750565417 AS "Estimator" UNION ALL SELECT 153 AS nid, -0.019182550398119693 AS "Estimator") AS "Values"), 
"DT_Output_6" AS 
(SELECT "DT_node_lookup_6"."KEY" AS "KEY", "DT_node_lookup_6".node_id_2 AS node_id_2, "DT_node_data_6".nid AS nid, "DT_node_data_6"."Estimator" AS "Estimator" 
FROM "DT_node_lookup_6" LEFT OUTER JOIN "DT_node_data_6" ON "DT_node_lookup_6".node_id_2 = "DT_node_data_6".nid), 
"LGBM_Model_6" AS 
(SELECT "DT_Output_6"."KEY" AS "KEY", "DT_Output_6"."Estimator" AS "Estimator" 
FROM "DT_Output_6"), 
"DT_node_lookup_7" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 0.6075778761327388) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -0.5473038335873333) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_4 <= -0.6300771852284078) THEN 8 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -1.0140849254414717) THEN 18 ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.0964976015934282) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.0813152903618533) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= 0.7808976587095015) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= -1.3948226988220507) THEN 80 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= -0.6869266595273958) THEN 162 ELSE 163 END END ELSE 41 END ELSE 21 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.0719595128492119) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= -1.3399306714531358) THEN 44 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= 0.8956718977535956) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.019926162282545463) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= -0.5091668867872056) THEN 360 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= -0.222129386849772) THEN 722 ELSE 723 END END ELSE 181 END ELSE 91 END END ELSE 23 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 1.4255206821307993) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.07118151778159366) THEN 12 ELSE 13 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 2.5525865633504563) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.1713033503240762) THEN 28 ELSE 29 END ELSE 15 END END END AS node_id_2 
FROM "TMP_20221018185625_DAVOS1J_ADS_sca_2_OUT" AS "ADS_sca_2_OUT"), 
"DT_node_data_7" AS 
(SELECT "Values".nid AS nid, "Values"."Estimator" AS "Estimator" 
FROM (SELECT 8 AS nid, -0.01188293420223226 AS "Estimator" UNION ALL SELECT 12 AS nid, 0.0522250044718685 AS "Estimator" UNION ALL SELECT 13 AS nid, 0.017611182118821917 AS "Estimator" UNION ALL SELECT 15 AS nid, 0.09570875502168891 AS "Estimator" UNION ALL SELECT 18 AS nid, -0.044382119320017406 AS "Estimator" UNION ALL SELECT 19 AS nid, -0.027759769055739392 AS "Estimator" UNION ALL SELECT 21 AS nid, -0.015267557725825607 AS "Estimator" UNION ALL SELECT 23 AS nid, -0.02529492140508163 AS "Estimator" UNION ALL SELECT 28 AS nid, 0.049445839779389524 AS "Estimator" UNION ALL SELECT 29 AS nid, 0.08358765033606584 AS "Estimator" UNION ALL SELECT 41 AS nid, 0.0018431605916571427 AS "Estimator" UNION ALL SELECT 44 AS nid, 0.0369277383554024 AS "Estimator" UNION ALL SELECT 80 AS nid, 0.07027053534784304 AS "Estimator" UNION ALL SELECT 91 AS nid, -0.022559903197665224 AS "Estimator" UNION ALL SELECT 162 AS nid, 0.05416097953926369 AS "Estimator" UNION ALL SELECT 163 AS nid, 0.01463427082384407 AS "Estimator" UNION ALL SELECT 181 AS nid, -0.010893869017048202 AS "Estimator" UNION ALL SELECT 360 AS nid, 0.01668349978877554 AS "Estimator" UNION ALL SELECT 722 AS nid, 0.004630942371306501 AS "Estimator" UNION ALL SELECT 723 AS nid, -0.04590005829416473 AS "Estimator") AS "Values"), 
"DT_Output_7" AS 
(SELECT "DT_node_lookup_7"."KEY" AS "KEY", "DT_node_lookup_7".node_id_2 AS node_id_2, "DT_node_data_7".nid AS nid, "DT_node_data_7"."Estimator" AS "Estimator" 
FROM "DT_node_lookup_7" LEFT OUTER JOIN "DT_node_data_7" ON "DT_node_lookup_7".node_id_2 = "DT_node_data_7".nid), 
"LGBM_Model_7" AS 
(SELECT "DT_Output_7"."KEY" AS "KEY", "DT_Output_7"."Estimator" AS "Estimator" 
FROM "DT_Output_7"), 
"DT_node_lookup_8" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 0.34369488424578043) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -0.6381251377759533) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_4 <= -0.6300771852284078) THEN 8 ELSE 9 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.12679746589299756) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.3299216551355802) THEN 20 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.0251806252860052) THEN 42 ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.0719595128492119) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= -1.369871777290727) THEN 44 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.03160611459535367) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= 0.9306031878974509) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= -0.5091668867872056) THEN 360 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= -0.4716386021630234) THEN 722 ELSE 723 END END ELSE 181 END ELSE 91 END END ELSE 23 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 1.301635279913384) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.0921524418745019) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.5678491123528361) THEN 24 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.15368363616288672) THEN 50 ELSE 51 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.0022069761809814367) THEN 26 ELSE 27 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 2.068748595529082) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.25061250272982816) THEN 28 ELSE 29 END ELSE 15 END END END AS node_id_2 
FROM "TMP_20221018185625_DAVOS1J_ADS_sca_2_OUT" AS "ADS_sca_2_OUT"), 
"DT_node_data_8" AS 
(SELECT "Values".nid AS nid, "Values"."Estimator" AS "Estimator" 
FROM (SELECT 8 AS nid, -0.012554175641045716 AS "Estimator" UNION ALL SELECT 9 AS nid, -0.03363711571271175 AS "Estimator" UNION ALL SELECT 15 AS nid, 0.08358220489295455 AS "Estimator" UNION ALL SELECT 20 AS nid, 0.0026222003364598993 AS "Estimator" UNION ALL SELECT 23 AS nid, -0.025915727957115928 AS "Estimator" UNION ALL SELECT 24 AS nid, 0.022909828759657105 AS "Estimator" UNION ALL SELECT 26 AS nid, 0.02130134075314785 AS "Estimator" UNION ALL SELECT 27 AS nid, 0.002966338347620725 AS "Estimator" UNION ALL SELECT 28 AS nid, 0.03991805000369464 AS "Estimator" UNION ALL SELECT 29 AS nid, 0.07171114499891416 AS "Estimator" UNION ALL SELECT 42 AS nid, 0.04439885288212249 AS "Estimator" UNION ALL SELECT 43 AS nid, -0.001744364999085121 AS "Estimator" UNION ALL SELECT 44 AS nid, 0.03971220809435181 AS "Estimator" UNION ALL SELECT 50 AS nid, 0.09194276588303703 AS "Estimator" UNION ALL SELECT 51 AS nid, 0.0507352274758823 AS "Estimator" UNION ALL SELECT 91 AS nid, -0.015801288154945838 AS "Estimator" UNION ALL SELECT 181 AS nid, -0.016745849831285832 AS "Estimator" UNION ALL SELECT 360 AS nid, 0.01621002374461489 AS "Estimator" UNION ALL SELECT 722 AS nid, 0.003700616594907938 AS "Estimator" UNION ALL SELECT 723 AS nid, -0.04114574707298521 AS "Estimator") AS "Values"), 
"DT_Output_8" AS 
(SELECT "DT_node_lookup_8"."KEY" AS "KEY", "DT_node_lookup_8".node_id_2 AS node_id_2, "DT_node_data_8".nid AS nid, "DT_node_data_8"."Estimator" AS "Estimator" 
FROM "DT_node_lookup_8" LEFT OUTER JOIN "DT_node_data_8" ON "DT_node_lookup_8".node_id_2 = "DT_node_data_8".nid), 
"LGBM_Model_8" AS 
(SELECT "DT_Output_8"."KEY" AS "KEY", "DT_Output_8"."Estimator" AS "Estimator" 
FROM "DT_Output_8"), 
"DT_node_lookup_9" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 0.9029504851899789) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -0.16381277914858902) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.1254491911766565) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.0813152903618533) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= 1.200073140435762) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= -1.3798521459032551) THEN 64 ELSE 65 END ELSE 33 END ELSE 17 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= -0.5419121080814512) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= 0.8956718977535956) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= 0.058737878958225694) THEN 72 ELSE 73 END ELSE 37 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= -1.0305392444647052) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.0719595128492119) THEN 76 ELSE 77 END ELSE 39 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.09750276889104369) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.72646741716434) THEN 20 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.15618532396705134) THEN 42 ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.020757375533991044) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.0719595128492119) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= 0.7709172900969699) THEN 88 ELSE 89 END ELSE 45 END ELSE 23 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 1.6087902540618375) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= 1.0000000180025095e-35) THEN 12 ELSE 13 END ELSE 7 END END AS node_id_2 
FROM "TMP_20221018185625_DAVOS1J_ADS_sca_2_OUT" AS "ADS_sca_2_OUT"), 
"DT_node_data_9" AS 
(SELECT "Values".nid AS nid, "Values"."Estimator" AS "Estimator" 
FROM (SELECT 7 AS nid, 0.07073064146003942 AS "Estimator" UNION ALL SELECT 12 AS nid, 0.04706179291005125 AS "Estimator" UNION ALL SELECT 13 AS nid, 0.015344128425453138 AS "Estimator" UNION ALL SELECT 17 AS nid, -0.02645211855240139 AS "Estimator" UNION ALL SELECT 20 AS nid, 0.0063127992032443216 AS "Estimator" UNION ALL SELECT 23 AS nid, -0.006948209921710512 AS "Estimator" UNION ALL SELECT 33 AS nid, -0.02845292906957061 AS "Estimator" UNION ALL SELECT 37 AS nid, -0.031625034076416446 AS "Estimator" UNION ALL SELECT 39 AS nid, -0.039331970534321074 AS "Estimator" UNION ALL SELECT 42 AS nid, 0.06517522115105638 AS "Estimator" UNION ALL SELECT 43 AS nid, 0.03100818425062949 AS "Estimator" UNION ALL SELECT 45 AS nid, -0.013508188586850267 AS "Estimator" UNION ALL SELECT 64 AS nid, 0.061675241557744946 AS "Estimator" UNION ALL SELECT 65 AS nid, 0.010070727407850442 AS "Estimator" UNION ALL SELECT 72 AS nid, 0.0013375362171132745 AS "Estimator" UNION ALL SELECT 73 AS nid, -0.01847021604376829 AS "Estimator" UNION ALL SELECT 76 AS nid, -0.001968579810595911 AS "Estimator" UNION ALL SELECT 77 AS nid, -0.03353548290839905 AS "Estimator" UNION ALL SELECT 88 AS nid, 0.02093967122301299 AS "Estimator" UNION ALL SELECT 89 AS nid, -0.003580124915191718 AS "Estimator") AS "Values"), 
"DT_Output_9" AS 
(SELECT "DT_node_lookup_9"."KEY" AS "KEY", "DT_node_lookup_9".node_id_2 AS node_id_2, "DT_node_data_9".nid AS nid, "DT_node_data_9"."Estimator" AS "Estimator" 
FROM "DT_node_lookup_9" LEFT OUTER JOIN "DT_node_data_9" ON "DT_node_lookup_9".node_id_2 = "DT_node_data_9".nid), 
"LGBM_Model_9" AS 
(SELECT "DT_Output_9"."KEY" AS "KEY", "DT_Output_9"."Estimator" AS "Estimator" 
FROM "DT_Output_9")
 INSERT INTO "TMP_20221018185625_4I3606V_LGBM_B0" ("KEY", "Estimator") SELECT "T"."KEY", "T"."Estimator" 
FROM (SELECT "LGBM_B0"."KEY" AS "KEY", "LGBM_B0"."Estimator" AS "Estimator" 
FROM (SELECT "LGBM_esu_0"."KEY" AS "KEY", "LGBM_esu_0"."Estimator" AS "Estimator" 
FROM (SELECT "LGBM_Model_0"."KEY" AS "KEY", "LGBM_Model_0"."Estimator" AS "Estimator" 
FROM "LGBM_Model_0" UNION ALL SELECT "LGBM_Model_1"."KEY" AS "KEY", "LGBM_Model_1"."Estimator" AS "Estimator" 
FROM "LGBM_Model_1" UNION ALL SELECT "LGBM_Model_2"."KEY" AS "KEY", "LGBM_Model_2"."Estimator" AS "Estimator" 
FROM "LGBM_Model_2" UNION ALL SELECT "LGBM_Model_3"."KEY" AS "KEY", "LGBM_Model_3"."Estimator" AS "Estimator" 
FROM "LGBM_Model_3" UNION ALL SELECT "LGBM_Model_4"."KEY" AS "KEY", "LGBM_Model_4"."Estimator" AS "Estimator" 
FROM "LGBM_Model_4" UNION ALL SELECT "LGBM_Model_5"."KEY" AS "KEY", "LGBM_Model_5"."Estimator" AS "Estimator" 
FROM "LGBM_Model_5" UNION ALL SELECT "LGBM_Model_6"."KEY" AS "KEY", "LGBM_Model_6"."Estimator" AS "Estimator" 
FROM "LGBM_Model_6" UNION ALL SELECT "LGBM_Model_7"."KEY" AS "KEY", "LGBM_Model_7"."Estimator" AS "Estimator" 
FROM "LGBM_Model_7" UNION ALL SELECT "LGBM_Model_8"."KEY" AS "KEY", "LGBM_Model_8"."Estimator" AS "Estimator" 
FROM "LGBM_Model_8" UNION ALL SELECT "LGBM_Model_9"."KEY" AS "KEY", "LGBM_Model_9"."Estimator" AS "Estimator" 
FROM "LGBM_Model_9") AS "LGBM_esu_0") AS "LGBM_B0") AS "T"

-- Code For temporary table TMP_20221018185625_EYQI8X0_LGBM_B1 part 1. Create 


CREATE TEMPORARY TABLE "TMP_20221018185625_EYQI8X0_LGBM_B1" (
	"KEY" BIGINT, 
	"Estimator" DOUBLE
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table TMP_20221018185625_EYQI8X0_LGBM_B1 part 2. Populate

WITH "DT_node_lookup_10" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 0.34369488424578043) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -0.6733672676590265) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_4 <= -0.7111553302164216) THEN 8 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -1.0140849254414717) THEN 18 ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.12679746589299756) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.3299216551355802) THEN 20 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.0251806252860052) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= -1.419773620353378) THEN 84 ELSE 85 END ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.0719595128492119) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= -1.369871777290727) THEN 44 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.03160611459535367) THEN 90 ELSE 91 END END ELSE 23 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 1.2688598367086492) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.0921524418745019) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.5678491123528361) THEN 24 ELSE 25 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.8850857219758442) THEN 26 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= -1.319969934228076) THEN 54 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.095348956630816) THEN 110 ELSE 111 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.1713033503240762) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 2.8054219478801747) THEN 28 ELSE 29 END ELSE 15 END END END AS node_id_2 
FROM "TMP_20221018185625_DAVOS1J_ADS_sca_2_OUT" AS "ADS_sca_2_OUT"), 
"DT_node_data_10" AS 
(SELECT "Values".nid AS nid, "Values"."Estimator" AS "Estimator" 
FROM (SELECT 8 AS nid, -0.007886219371890765 AS "Estimator" UNION ALL SELECT 15 AS nid, 0.07521492508912078 AS "Estimator" UNION ALL SELECT 18 AS nid, -0.03849096169288683 AS "Estimator" UNION ALL SELECT 19 AS nid, -0.025785264746926176 AS "Estimator" UNION ALL SELECT 20 AS nid, 0.0019278763716312824 AS "Estimator" UNION ALL SELECT 23 AS nid, -0.023831957898144976 AS "Estimator" UNION ALL SELECT 24 AS nid, 0.02046701660928663 AS "Estimator" UNION ALL SELECT 25 AS nid, 0.055737722454948374 AS "Estimator" UNION ALL SELECT 26 AS nid, -0.0018861465327208863 AS "Estimator" UNION ALL SELECT 28 AS nid, 0.039622733061742244 AS "Estimator" UNION ALL SELECT 29 AS nid, 0.08343258086222072 AS "Estimator" UNION ALL SELECT 43 AS nid, -0.0028672517872312003 AS "Estimator" UNION ALL SELECT 44 AS nid, 0.036659916819312334 AS "Estimator" UNION ALL SELECT 54 AS nid, 0.04143022886340582 AS "Estimator" UNION ALL SELECT 84 AS nid, 0.07462490477222712 AS "Estimator" UNION ALL SELECT 85 AS nid, 0.03410308274465254 AS "Estimator" UNION ALL SELECT 90 AS nid, -0.0005441141944754059 AS "Estimator" UNION ALL SELECT 91 AS nid, -0.014568097632494776 AS "Estimator" UNION ALL SELECT 110 AS nid, 0.01586682443266785 AS "Estimator" UNION ALL SELECT 111 AS nid, -0.021299013519688444 AS "Estimator") AS "Values"), 
"DT_Output_10" AS 
(SELECT "DT_node_lookup_10"."KEY" AS "KEY", "DT_node_lookup_10".node_id_2 AS node_id_2, "DT_node_data_10".nid AS nid, "DT_node_data_10"."Estimator" AS "Estimator" 
FROM "DT_node_lookup_10" LEFT OUTER JOIN "DT_node_data_10" ON "DT_node_lookup_10".node_id_2 = "DT_node_data_10".nid), 
"LGBM_Model_10" AS 
(SELECT "DT_Output_10"."KEY" AS "KEY", "DT_Output_10"."Estimator" AS "Estimator" 
FROM "DT_Output_10"), 
"DT_node_lookup_11" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 0.7364753757497575) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -0.29029607478255276) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.15899639020455322) THEN 8 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= -0.5419121080814512) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= 0.8956718977535956) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= 0.01989876494755527) THEN 72 ELSE 73 END ELSE 37 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= -1.0554901659960325) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.4274790583295907) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= -1.4097932517408462) THEN 152 ELSE 153 END ELSE 77 END ELSE 39 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.10736767896119763) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.72646741716434) THEN 20 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.0251806252860052) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.17190032096781402) THEN 84 ELSE 85 END ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.03428251044833724) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.0859931791181747) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= -1.319969934228076) THEN 88 ELSE 89 END ELSE 45 END ELSE 23 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 1.6087902540618375) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.043283558604192605) THEN 12 ELSE 13 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.5678491123528361) THEN 14 ELSE 15 END END END AS node_id_2 
FROM "TMP_20221018185625_DAVOS1J_ADS_sca_2_OUT" AS "ADS_sca_2_OUT"), 
"DT_node_data_11" AS 
(SELECT "Values".nid AS nid, "Values"."Estimator" AS "Estimator" 
FROM (SELECT 8 AS nid, 0.0040093959387846245 AS "Estimator" UNION ALL SELECT 12 AS nid, 0.04454911779969106 AS "Estimator" UNION ALL SELECT 13 AS nid, 0.01637281668162342 AS "Estimator" UNION ALL SELECT 14 AS nid, 0.04911036680278655 AS "Estimator" UNION ALL SELECT 15 AS nid, 0.07353576950719763 AS "Estimator" UNION ALL SELECT 20 AS nid, 0.0050900361881330005 AS "Estimator" UNION ALL SELECT 23 AS nid, -0.008235996839127938 AS "Estimator" UNION ALL SELECT 37 AS nid, -0.02888322638513552 AS "Estimator" UNION ALL SELECT 39 AS nid, -0.03594765442238849 AS "Estimator" UNION ALL SELECT 43 AS nid, 0.002758792159462197 AS "Estimator" UNION ALL SELECT 45 AS nid, -0.0139025542596784 AS "Estimator" UNION ALL SELECT 72 AS nid, 0.004945283012019415 AS "Estimator" UNION ALL SELECT 73 AS nid, -0.015739554564230467 AS "Estimator" UNION ALL SELECT 77 AS nid, -0.038706951257857926 AS "Estimator" UNION ALL SELECT 84 AS nid, 0.0640403183490038 AS "Estimator" UNION ALL SELECT 85 AS nid, 0.03501828553301588 AS "Estimator" UNION ALL SELECT 88 AS nid, 0.04258027832723063 AS "Estimator" UNION ALL SELECT 89 AS nid, 0.0073353920340732326 AS "Estimator" UNION ALL SELECT 152 AS nid, 0.017876735637218238 AS "Estimator" UNION ALL SELECT 153 AS nid, -0.013632976544551298 AS "Estimator") AS "Values"), 
"DT_Output_11" AS 
(SELECT "DT_node_lookup_11"."KEY" AS "KEY", "DT_node_lookup_11".node_id_2 AS node_id_2, "DT_node_data_11".nid AS nid, "DT_node_data_11"."Estimator" AS "Estimator" 
FROM "DT_node_lookup_11" LEFT OUTER JOIN "DT_node_data_11" ON "DT_node_lookup_11".node_id_2 = "DT_node_data_11".nid), 
"LGBM_Model_11" AS 
(SELECT "DT_Output_11"."KEY" AS "KEY", "DT_Output_11"."Estimator" AS "Estimator" 
FROM "DT_Output_11"), 
"DT_node_lookup_12" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 0.13426268871576671) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -0.6926808995234658) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_4 <= -0.8301612332964686) THEN 8 ELSE 9 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.14089223019242467) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.3299216551355802) THEN 20 ELSE 21 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.0719595128492119) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= -1.369871777290727) THEN 44 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= 0.8757111605285359) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= -0.5091668867872056) THEN 180 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= -0.2919919671374826) THEN 362 ELSE 363 END END ELSE 91 END END ELSE 23 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 1.2688598367086492) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.0921524418745019) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.9643948743815961) THEN 24 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.15368363616288672) THEN 50 ELSE 51 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= -1.1652742207338627) THEN 26 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= -0.45771011046767757) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= 0.8956718977535956) THEN 108 ELSE 109 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= -0.9457061112581989) THEN 110 ELSE 111 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 2.068748595529082) THEN 14 ELSE 15 END END END AS node_id_2 
FROM "TMP_20221018185625_DAVOS1J_ADS_sca_2_OUT" AS "ADS_sca_2_OUT"), 
"DT_node_data_12" AS 
(SELECT "Values".nid AS nid, "Values"."Estimator" AS "Estimator" 
FROM (SELECT 8 AS nid, -0.0015310817602586706 AS "Estimator" UNION ALL SELECT 9 AS nid, -0.02748085969500463 AS "Estimator" UNION ALL SELECT 14 AS nid, 0.04296027673067308 AS "Estimator" UNION ALL SELECT 15 AS nid, 0.06925445408582905 AS "Estimator" UNION ALL SELECT 20 AS nid, 0.0009895461046948277 AS "Estimator" UNION ALL SELECT 21 AS nid, 0.02917727834721763 AS "Estimator" UNION ALL SELECT 23 AS nid, -0.023763247986411523 AS "Estimator" UNION ALL SELECT 24 AS nid, 0.008216574402677632 AS "Estimator" UNION ALL SELECT 26 AS nid, 0.02060104297163207 AS "Estimator" UNION ALL SELECT 44 AS nid, 0.03575626479904019 AS "Estimator" UNION ALL SELECT 50 AS nid, 0.06961820311264906 AS "Estimator" UNION ALL SELECT 51 AS nid, 0.03673091109138711 AS "Estimator" UNION ALL SELECT 91 AS nid, -0.02139334607268929 AS "Estimator" UNION ALL SELECT 108 AS nid, 0.01497213196463351 AS "Estimator" UNION ALL SELECT 109 AS nid, -0.008263007743667216 AS "Estimator" UNION ALL SELECT 110 AS nid, 0.007364961656801148 AS "Estimator" UNION ALL SELECT 111 AS nid, -0.024648099951155678 AS "Estimator" UNION ALL SELECT 180 AS nid, 0.0008195057699579453 AS "Estimator" UNION ALL SELECT 362 AS nid, -0.00638909055346887 AS "Estimator" UNION ALL SELECT 363 AS nid, -0.04148429386976749 AS "Estimator") AS "Values"), 
"DT_Output_12" AS 
(SELECT "DT_node_lookup_12"."KEY" AS "KEY", "DT_node_lookup_12".node_id_2 AS node_id_2, "DT_node_data_12".nid AS nid, "DT_node_data_12"."Estimator" AS "Estimator" 
FROM "DT_node_lookup_12" LEFT OUTER JOIN "DT_node_data_12" ON "DT_node_lookup_12".node_id_2 = "DT_node_data_12".nid), 
"LGBM_Model_12" AS 
(SELECT "DT_Output_12"."KEY" AS "KEY", "DT_Output_12"."Estimator" AS "Estimator" 
FROM "DT_Output_12"), 
"DT_node_lookup_13" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 0.2681985270800304) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -0.6868553203469638) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_4 <= -0.8301612332964686) THEN 8 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= -0.1442915637941857) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= 0.6212117609090204) THEN 36 ELSE 37 END ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.12679746589299756) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.3299216551355802) THEN 20 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.0251806252860052) THEN 42 ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.0719595128492119) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= -1.369871777290727) THEN 44 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= 0.004717767265294272) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= -0.5419121080814512) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= 0.9306031878974509) THEN 360 ELSE 361 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= -0.2570606769936237) THEN 362 ELSE 363 END END ELSE 91 END END ELSE 23 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 1.301635279913384) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.0921524418745019) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.9643948743815961) THEN 24 ELSE 25 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= 0.7804064785449479) THEN 26 ELSE 27 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.5678491123528361) THEN 14 ELSE 15 END END END AS node_id_2 
FROM "TMP_20221018185625_DAVOS1J_ADS_sca_2_OUT" AS "ADS_sca_2_OUT"), 
"DT_node_data_13" AS 
(SELECT "Values".nid AS nid, "Values"."Estimator" AS "Estimator" 
FROM (SELECT 8 AS nid, -0.0015418432485741589 AS "Estimator" UNION ALL SELECT 14 AS nid, 0.03636256823208971 AS "Estimator" UNION ALL SELECT 15 AS nid, 0.062495415893037344 AS "Estimator" UNION ALL SELECT 19 AS nid, -0.031730334857905905 AS "Estimator" UNION ALL SELECT 20 AS nid, 0.000915067030409847 AS "Estimator" UNION ALL SELECT 23 AS nid, -0.02156745181713225 AS "Estimator" UNION ALL SELECT 24 AS nid, 0.010451313933177341 AS "Estimator" UNION ALL SELECT 25 AS nid, 0.046529721876817975 AS "Estimator" UNION ALL SELECT 26 AS nid, 0.006022350161206623 AS "Estimator" UNION ALL SELECT 27 AS nid, 0.033475286851401935 AS "Estimator" UNION ALL SELECT 36 AS nid, 0.0024209877192035495 AS "Estimator" UNION ALL SELECT 37 AS nid, -0.023211477314229727 AS "Estimator" UNION ALL SELECT 42 AS nid, 0.03353385219245305 AS "Estimator" UNION ALL SELECT 43 AS nid, -0.004932597452565899 AS "Estimator" UNION ALL SELECT 44 AS nid, 0.0314877085465317 AS "Estimator" UNION ALL SELECT 91 AS nid, -0.014980581322107181 AS "Estimator" UNION ALL SELECT 360 AS nid, 0.01099495619103853 AS "Estimator" UNION ALL SELECT 361 AS nid, -0.014033118649859148 AS "Estimator" UNION ALL SELECT 362 AS nid, -0.00027356503958898517 AS "Estimator" UNION ALL SELECT 363 AS nid, -0.038733133054706444 AS "Estimator") AS "Values"), 
"DT_Output_13" AS 
(SELECT "DT_node_lookup_13"."KEY" AS "KEY", "DT_node_lookup_13".node_id_2 AS node_id_2, "DT_node_data_13".nid AS nid, "DT_node_data_13"."Estimator" AS "Estimator" 
FROM "DT_node_lookup_13" LEFT OUTER JOIN "DT_node_data_13" ON "DT_node_lookup_13".node_id_2 = "DT_node_data_13".nid), 
"LGBM_Model_13" AS 
(SELECT "DT_Output_13"."KEY" AS "KEY", "DT_Output_13"."Estimator" AS "Estimator" 
FROM "DT_Output_13"), 
"DT_node_lookup_14" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 0.8703062487234536) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -0.16381277914858902) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.15899639020455322) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.1047047341434573) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= 0.6461626824403441) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= -0.6916045482837158) THEN 64 ELSE 65 END ELSE 33 END ELSE 17 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -0.8691277210676095) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_4 <= -0.8301612332964686) THEN 36 ELSE 37 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_4 <= -0.2862844055111865) THEN 38 ELSE 39 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.10736767896119763) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.72646741716434) THEN 20 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.17190032096781402) THEN 42 ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.006126843198908966) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.0719595128492119) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= 0.7709172900969699) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= -1.3549012243719314) THEN 176 ELSE 177 END ELSE 89 END ELSE 45 END ELSE 23 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 2.068748595529082) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.06741512473613993) THEN 12 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= 1.0000000180025095e-35) THEN 26 ELSE 27 END END ELSE 7 END END AS node_id_2 
FROM "TMP_20221018185625_DAVOS1J_ADS_sca_2_OUT" AS "ADS_sca_2_OUT"), 
"DT_node_data_14" AS 
(SELECT "Values".nid AS nid, "Values"."Estimator" AS "Estimator" 
FROM (SELECT 7 AS nid, 0.06313346777989955 AS "Estimator" UNION ALL SELECT 12 AS nid, 0.049756359141797595 AS "Estimator" UNION ALL SELECT 17 AS nid, -0.021712223584562495 AS "Estimator" UNION ALL SELECT 20 AS nid, 0.005183454631869473 AS "Estimator" UNION ALL SELECT 23 AS nid, -0.007373049780174993 AS "Estimator" UNION ALL SELECT 26 AS nid, 0.01683217815226633 AS "Estimator" UNION ALL SELECT 27 AS nid, 0.036746234171371905 AS "Estimator" UNION ALL SELECT 33 AS nid, -0.007408012394610923 AS "Estimator" UNION ALL SELECT 36 AS nid, -0.005770511805428771 AS "Estimator" UNION ALL SELECT 37 AS nid, -0.0297389294135897 AS "Estimator" UNION ALL SELECT 38 AS nid, -0.005736908141561383 AS "Estimator" UNION ALL SELECT 39 AS nid, -0.019416191872712332 AS "Estimator" UNION ALL SELECT 42 AS nid, 0.05839680363969492 AS "Estimator" UNION ALL SELECT 43 AS nid, 0.028810346908823937 AS "Estimator" UNION ALL SELECT 45 AS nid, -0.01130014302824358 AS "Estimator" UNION ALL SELECT 64 AS nid, 0.05241085611253793 AS "Estimator" UNION ALL SELECT 65 AS nid, 0.014554323265861348 AS "Estimator" UNION ALL SELECT 89 AS nid, -0.0033607443488693415 AS "Estimator" UNION ALL SELECT 176 AS nid, 0.04244726400005899 AS "Estimator" UNION ALL SELECT 177 AS nid, 0.01374652680187804 AS "Estimator") AS "Values"), 
"DT_Output_14" AS 
(SELECT "DT_node_lookup_14"."KEY" AS "KEY", "DT_node_lookup_14".node_id_2 AS node_id_2, "DT_node_data_14".nid AS nid, "DT_node_data_14"."Estimator" AS "Estimator" 
FROM "DT_node_lookup_14" LEFT OUTER JOIN "DT_node_data_14" ON "DT_node_lookup_14".node_id_2 = "DT_node_data_14".nid), 
"LGBM_Model_14" AS 
(SELECT "DT_Output_14"."KEY" AS "KEY", "DT_Output_14"."Estimator" AS "Estimator" 
FROM "DT_Output_14"), 
"DT_node_lookup_15" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 0.5252062858848109) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= -0.5473038335873333) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_4 <= -0.48185512636002653) THEN 8 ELSE 9 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.0921524418745019) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.1047047341434573) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= -1.3948226988220507) THEN 40 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= 1.200073140435762) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= -0.6775708820147529) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= 0.6012510236839607) THEN 328 ELSE 329 END ELSE 165 END ELSE 83 END END ELSE 21 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= -1.4097932517408462) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 1.4508685021111931) THEN 44 ELSE 45 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= -0.5419121080814512) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= 0.8956718977535956) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= 0.039159406493536754) THEN 184 ELSE 185 END ELSE 93 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_9 <= -0.9706570327895262) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_8 <= 0.9269449614032687) THEN 188 ELSE 189 END ELSE 95 END END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_2 <= 1.385345178891049) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_output_7 <= -0.03548479593104383) THEN 12 ELSE 13 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_output_3 <= -0.5678491123528361) THEN 14 ELSE 15 END END END AS node_id_2 
FROM "TMP_20221018185625_DAVOS1J_ADS_sca_2_OUT" AS "ADS_sca_2_OUT"), 
"DT_node_data_15" AS 
(SELECT "Values".nid AS nid, "Values"."Estimator" AS "Estimator" 
FROM (SELECT 8 AS nid, -0.010494508657356124 AS "Estimator" UNION ALL SELECT 9 AS nid, -0.02437754857370485 AS "Estimator" UNION ALL SELECT 12 AS nid, 0.029850302203900843 AS "Estimator" UNION ALL SELECT 13 AS nid, 0.007146646152493878 AS "Estimator" UNION ALL SELECT 14 AS nid, 0.034568902465064874 AS "Estimator" UNION ALL SELECT 15 AS nid, 0.058212233070725906 AS "Estimator" UNION ALL SELECT 21 AS nid, -0.014870740851242757 AS "Estimator" UNION ALL SELECT 40 AS nid, 0.053932426459460905 AS "Estimator" UNION ALL SELECT 44 AS nid, 0.020535306422389973 AS "Estimator" UNION ALL SELECT 45 AS nid, -0.030260961602996045 AS "Estimator" UNION ALL SELECT 83 AS nid, -0.021446666143440863 AS "Estimator" UNION ALL SELECT 93 AS nid, -0.016688769304170275 AS "Estimator" UNION ALL SELECT 95 AS nid, -0.025334748630237405 AS "Estimator" UNION ALL SELECT 165 AS nid, 0.0043498403024888116 AS "Estimator" UNION ALL SELECT 184 AS nid, 0.008717262807228952 AS "Estimator" UNION ALL SELECT 185 AS nid, -0.008645262526365358 AS "Estimator" UNION ALL SELECT 188 AS nid, 0.015693213389975962 AS "Estimator" UNION ALL SELECT 189 AS nid, -0.017122606990465774 AS "Estimator" UNION ALL SELECT 328 AS nid, 0.05555002442855375 AS "Estimator" UNION ALL SELECT 329 AS nid, 0.013851807411639556 AS "Estimator") AS "Values"), 
"DT_Output_15" AS 
(SELECT "DT_node_lookup_15"."KEY" AS "KEY", "DT_node_lookup_15".node_id_2 AS node_id_2, "DT_node_data_15".nid AS nid, "DT_node_data_15"."Estimator" AS "Estimator" 
FROM "DT_node_lookup_15" LEFT OUTER JOIN "DT_node_data_15" ON "DT_node_lookup_15".node_id_2 = "DT_node_data_15".nid), 
"LGBM_Model_15" AS 
(SELECT "DT_Output_15"."KEY" AS "KEY", "DT_Output_15"."Estimator" AS "Estimator" 
FROM "DT_Output_15")
 INSERT INTO "TMP_20221018185625_EYQI8X0_LGBM_B1" ("KEY", "Estimator") SELECT "T"."KEY", "T"."Estimator" 
FROM (SELECT "LGBM_B1"."KEY" AS "KEY", "LGBM_B1"."Estimator" AS "Estimator" 
FROM (SELECT "LGBM_esu_1"."KEY" AS "KEY", "LGBM_esu_1"."Estimator" AS "Estimator" 
FROM (SELECT "LGBM_Model_10"."KEY" AS "KEY", "LGBM_Model_10"."Estimator" AS "Estimator" 
FROM "LGBM_Model_10" UNION ALL SELECT "LGBM_Model_11"."KEY" AS "KEY", "LGBM_Model_11"."Estimator" AS "Estimator" 
FROM "LGBM_Model_11" UNION ALL SELECT "LGBM_Model_12"."KEY" AS "KEY", "LGBM_Model_12"."Estimator" AS "Estimator" 
FROM "LGBM_Model_12" UNION ALL SELECT "LGBM_Model_13"."KEY" AS "KEY", "LGBM_Model_13"."Estimator" AS "Estimator" 
FROM "LGBM_Model_13" UNION ALL SELECT "LGBM_Model_14"."KEY" AS "KEY", "LGBM_Model_14"."Estimator" AS "Estimator" 
FROM "LGBM_Model_14" UNION ALL SELECT "LGBM_Model_15"."KEY" AS "KEY", "LGBM_Model_15"."Estimator" AS "Estimator" 
FROM "LGBM_Model_15") AS "LGBM_esu_1") AS "LGBM_B1") AS "T"

-- Code For temporary table TMP_20221018185625_JMCLK1K_LGBM_sum part 1. Create 


CREATE TEMPORARY TABLE "TMP_20221018185625_JMCLK1K_LGBM_sum" (
	"KEY" BIGINT NOT NULL, 
	"Estimator" DOUBLE, 
	PRIMARY KEY ("KEY")
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table TMP_20221018185625_JMCLK1K_LGBM_sum part 2. Populate

WITH "LGBM_Union" AS 
(SELECT "LGBM_EnsembleUnion"."KEY" AS "KEY", "LGBM_EnsembleUnion"."Estimator" AS "Estimator" 
FROM (SELECT "LGBM_B0"."KEY" AS "KEY", "LGBM_B0"."Estimator" AS "Estimator" 
FROM "TMP_20221018185625_4I3606V_LGBM_B0" AS "LGBM_B0" UNION ALL SELECT "LGBM_B1"."KEY" AS "KEY", "LGBM_B1"."Estimator" AS "Estimator" 
FROM "TMP_20221018185625_EYQI8X0_LGBM_B1" AS "LGBM_B1") AS "LGBM_EnsembleUnion")
 INSERT INTO "TMP_20221018185625_JMCLK1K_LGBM_sum" ("KEY", "Estimator") SELECT "T"."KEY", "T"."Estimator" 
FROM (SELECT "LGBM_sum"."KEY" AS "KEY", "LGBM_sum"."Estimator" AS "Estimator" 
FROM (SELECT "T"."KEY" AS "KEY", CAST("T"."Estimator" AS DOUBLE) AS "Estimator" 
FROM (SELECT "LGBM_Union"."KEY" AS "KEY", sum("LGBM_Union"."Estimator") AS "Estimator" 
FROM "LGBM_Union" GROUP BY "LGBM_Union"."KEY") AS "T") AS "LGBM_sum") AS "T"

-- Code For temporary table TMP_20221018185625_JMCLK1K_LGBM_sum part 3. Create Index 

CREATE INDEX "ix_TMP_20221018185625_JMCLK1K_LGBM_sum_KEY" ON "TMP_20221018185625_JMCLK1K_LGBM_sum" ("KEY")

-- Model deployment code

SELECT "LGBM_sum"."KEY" AS "KEY", "LGBM_sum"."Estimator" AS "Estimator" 
FROM "TMP_20221018185625_JMCLK1K_LGBM_sum" AS "LGBM_sum"