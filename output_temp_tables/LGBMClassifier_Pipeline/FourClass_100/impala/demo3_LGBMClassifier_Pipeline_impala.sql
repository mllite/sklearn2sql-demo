-- This SQL code was generated by sklearn2sql (development version).
-- Copyright 2018

-- Model : LGBMClassifier_Pipeline
-- Dataset : FourClass_100
-- Database : impala


-- This SQL code can contain one or more statements, to be executed in the order they appear in this file.



-- Code For temporary table tmp_20180602143835_qdb_ads_imp_1_out part 1. Create 


CREATE TABLE tmp_20180602143835_qdb_ads_imp_1_out (
	`KEY` BIGINT, 
	impter_2 DOUBLE, 
	impter_3 DOUBLE, 
	impter_4 DOUBLE, 
	impter_5 DOUBLE, 
	impter_6 DOUBLE, 
	impter_7 DOUBLE, 
	impter_8 DOUBLE, 
	impter_9 DOUBLE, 
	impter_10 DOUBLE, 
	impter_11 DOUBLE, 
	impter_12 DOUBLE, 
	impter_13 DOUBLE, 
	impter_14 DOUBLE, 
	impter_15 DOUBLE, 
	impter_16 DOUBLE, 
	impter_17 DOUBLE, 
	impter_18 DOUBLE, 
	impter_19 DOUBLE, 
	impter_20 DOUBLE, 
	impter_21 DOUBLE, 
	impter_22 DOUBLE, 
	impter_23 DOUBLE, 
	impter_24 DOUBLE, 
	impter_25 DOUBLE, 
	impter_26 DOUBLE, 
	impter_27 DOUBLE, 
	impter_28 DOUBLE, 
	impter_29 DOUBLE, 
	impter_30 DOUBLE, 
	impter_31 DOUBLE, 
	impter_32 DOUBLE, 
	impter_33 DOUBLE, 
	impter_34 DOUBLE, 
	impter_35 DOUBLE, 
	impter_36 DOUBLE, 
	impter_37 DOUBLE, 
	impter_38 DOUBLE, 
	impter_39 DOUBLE, 
	impter_40 DOUBLE, 
	impter_41 DOUBLE, 
	impter_42 DOUBLE, 
	impter_43 DOUBLE, 
	impter_44 DOUBLE, 
	impter_45 DOUBLE, 
	impter_46 DOUBLE, 
	impter_47 DOUBLE, 
	impter_48 DOUBLE, 
	impter_49 DOUBLE, 
	impter_50 DOUBLE, 
	impter_51 DOUBLE, 
	impter_52 DOUBLE, 
	impter_53 DOUBLE, 
	impter_54 DOUBLE, 
	impter_55 DOUBLE, 
	impter_56 DOUBLE, 
	impter_57 DOUBLE, 
	impter_58 DOUBLE, 
	impter_59 DOUBLE, 
	impter_60 DOUBLE, 
	impter_61 DOUBLE, 
	impter_62 DOUBLE, 
	impter_63 DOUBLE, 
	impter_64 DOUBLE, 
	impter_65 DOUBLE, 
	impter_66 DOUBLE, 
	impter_67 DOUBLE, 
	impter_68 DOUBLE, 
	impter_69 DOUBLE, 
	impter_70 DOUBLE, 
	impter_71 DOUBLE, 
	impter_72 DOUBLE, 
	impter_73 DOUBLE, 
	impter_74 DOUBLE, 
	impter_75 DOUBLE, 
	impter_76 DOUBLE, 
	impter_77 DOUBLE, 
	impter_78 DOUBLE, 
	impter_79 DOUBLE, 
	impter_80 DOUBLE, 
	impter_81 DOUBLE, 
	impter_82 DOUBLE, 
	impter_83 DOUBLE, 
	impter_84 DOUBLE, 
	impter_85 DOUBLE, 
	impter_86 DOUBLE, 
	impter_87 DOUBLE, 
	impter_88 DOUBLE, 
	impter_89 DOUBLE, 
	impter_90 DOUBLE, 
	impter_91 DOUBLE, 
	impter_92 DOUBLE, 
	impter_93 DOUBLE, 
	impter_94 DOUBLE, 
	impter_95 DOUBLE, 
	impter_96 DOUBLE, 
	impter_97 DOUBLE, 
	impter_98 DOUBLE, 
	impter_99 DOUBLE, 
	impter_100 DOUBLE, 
	impter_101 DOUBLE
)

 CACHED IN 'one_gig_pool'

-- Code For temporary table tmp_20180602143835_qdb_ads_imp_1_out part 2. Populate

INSERT INTO tmp_20180602143835_qdb_ads_imp_1_out (`KEY`, impter_2, impter_3, impter_4, impter_5, impter_6, impter_7, impter_8, impter_9, impter_10, impter_11, impter_12, impter_13, impter_14, impter_15, impter_16, impter_17, impter_18, impter_19, impter_20, impter_21, impter_22, impter_23, impter_24, impter_25, impter_26, impter_27, impter_28, impter_29, impter_30, impter_31, impter_32, impter_33, impter_34, impter_35, impter_36, impter_37, impter_38, impter_39, impter_40, impter_41, impter_42, impter_43, impter_44, impter_45, impter_46, impter_47, impter_48, impter_49, impter_50, impter_51, impter_52, impter_53, impter_54, impter_55, impter_56, impter_57, impter_58, impter_59, impter_60, impter_61, impter_62, impter_63, impter_64, impter_65, impter_66, impter_67, impter_68, impter_69, impter_70, impter_71, impter_72, impter_73, impter_74, impter_75, impter_76, impter_77, impter_78, impter_79, impter_80, impter_81, impter_82, impter_83, impter_84, impter_85, impter_86, impter_87, impter_88, impter_89, impter_90, impter_91, impter_92, impter_93, impter_94, impter_95, impter_96, impter_97, impter_98, impter_99, impter_100, impter_101) SELECT `ADS_imp_1_OUT`.`KEY`, `ADS_imp_1_OUT`.impter_2, `ADS_imp_1_OUT`.impter_3, `ADS_imp_1_OUT`.impter_4, `ADS_imp_1_OUT`.impter_5, `ADS_imp_1_OUT`.impter_6, `ADS_imp_1_OUT`.impter_7, `ADS_imp_1_OUT`.impter_8, `ADS_imp_1_OUT`.impter_9, `ADS_imp_1_OUT`.impter_10, `ADS_imp_1_OUT`.impter_11, `ADS_imp_1_OUT`.impter_12, `ADS_imp_1_OUT`.impter_13, `ADS_imp_1_OUT`.impter_14, `ADS_imp_1_OUT`.impter_15, `ADS_imp_1_OUT`.impter_16, `ADS_imp_1_OUT`.impter_17, `ADS_imp_1_OUT`.impter_18, `ADS_imp_1_OUT`.impter_19, `ADS_imp_1_OUT`.impter_20, `ADS_imp_1_OUT`.impter_21, `ADS_imp_1_OUT`.impter_22, `ADS_imp_1_OUT`.impter_23, `ADS_imp_1_OUT`.impter_24, `ADS_imp_1_OUT`.impter_25, `ADS_imp_1_OUT`.impter_26, `ADS_imp_1_OUT`.impter_27, `ADS_imp_1_OUT`.impter_28, `ADS_imp_1_OUT`.impter_29, `ADS_imp_1_OUT`.impter_30, `ADS_imp_1_OUT`.impter_31, `ADS_imp_1_OUT`.impter_32, `ADS_imp_1_OUT`.impter_33, `ADS_imp_1_OUT`.impter_34, `ADS_imp_1_OUT`.impter_35, `ADS_imp_1_OUT`.impter_36, `ADS_imp_1_OUT`.impter_37, `ADS_imp_1_OUT`.impter_38, `ADS_imp_1_OUT`.impter_39, `ADS_imp_1_OUT`.impter_40, `ADS_imp_1_OUT`.impter_41, `ADS_imp_1_OUT`.impter_42, `ADS_imp_1_OUT`.impter_43, `ADS_imp_1_OUT`.impter_44, `ADS_imp_1_OUT`.impter_45, `ADS_imp_1_OUT`.impter_46, `ADS_imp_1_OUT`.impter_47, `ADS_imp_1_OUT`.impter_48, `ADS_imp_1_OUT`.impter_49, `ADS_imp_1_OUT`.impter_50, `ADS_imp_1_OUT`.impter_51, `ADS_imp_1_OUT`.impter_52, `ADS_imp_1_OUT`.impter_53, `ADS_imp_1_OUT`.impter_54, `ADS_imp_1_OUT`.impter_55, `ADS_imp_1_OUT`.impter_56, `ADS_imp_1_OUT`.impter_57, `ADS_imp_1_OUT`.impter_58, `ADS_imp_1_OUT`.impter_59, `ADS_imp_1_OUT`.impter_60, `ADS_imp_1_OUT`.impter_61, `ADS_imp_1_OUT`.impter_62, `ADS_imp_1_OUT`.impter_63, `ADS_imp_1_OUT`.impter_64, `ADS_imp_1_OUT`.impter_65, `ADS_imp_1_OUT`.impter_66, `ADS_imp_1_OUT`.impter_67, `ADS_imp_1_OUT`.impter_68, `ADS_imp_1_OUT`.impter_69, `ADS_imp_1_OUT`.impter_70, `ADS_imp_1_OUT`.impter_71, `ADS_imp_1_OUT`.impter_72, `ADS_imp_1_OUT`.impter_73, `ADS_imp_1_OUT`.impter_74, `ADS_imp_1_OUT`.impter_75, `ADS_imp_1_OUT`.impter_76, `ADS_imp_1_OUT`.impter_77, `ADS_imp_1_OUT`.impter_78, `ADS_imp_1_OUT`.impter_79, `ADS_imp_1_OUT`.impter_80, `ADS_imp_1_OUT`.impter_81, `ADS_imp_1_OUT`.impter_82, `ADS_imp_1_OUT`.impter_83, `ADS_imp_1_OUT`.impter_84, `ADS_imp_1_OUT`.impter_85, `ADS_imp_1_OUT`.impter_86, `ADS_imp_1_OUT`.impter_87, `ADS_imp_1_OUT`.impter_88, `ADS_imp_1_OUT`.impter_89, `ADS_imp_1_OUT`.impter_90, `ADS_imp_1_OUT`.impter_91, `ADS_imp_1_OUT`.impter_92, `ADS_imp_1_OUT`.impter_93, `ADS_imp_1_OUT`.impter_94, `ADS_imp_1_OUT`.impter_95, `ADS_imp_1_OUT`.impter_96, `ADS_imp_1_OUT`.impter_97, `ADS_imp_1_OUT`.impter_98, `ADS_imp_1_OUT`.impter_99, `ADS_imp_1_OUT`.impter_100, `ADS_imp_1_OUT`.impter_101 
FROM (SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_0` IS NULL) THEN -0.0014807007689716506 ELSE `ADS`.`Feature_0` END AS impter_2, CASE WHEN (`ADS`.`Feature_1` IS NULL) THEN 0.08599214990681354 ELSE `ADS`.`Feature_1` END AS impter_3, CASE WHEN (`ADS`.`Feature_2` IS NULL) THEN -0.006358164676411468 ELSE `ADS`.`Feature_2` END AS impter_4, CASE WHEN (`ADS`.`Feature_3` IS NULL) THEN -0.024301807422776375 ELSE `ADS`.`Feature_3` END AS impter_5, CASE WHEN (`ADS`.`Feature_4` IS NULL) THEN 0.015786548044298444 ELSE `ADS`.`Feature_4` END AS impter_6, CASE WHEN (`ADS`.`Feature_5` IS NULL) THEN -0.13959329445651672 ELSE `ADS`.`Feature_5` END AS impter_7, CASE WHEN (`ADS`.`Feature_6` IS NULL) THEN -0.06476745048019888 ELSE `ADS`.`Feature_6` END AS impter_8, CASE WHEN (`ADS`.`Feature_7` IS NULL) THEN 0.025579810774090658 ELSE `ADS`.`Feature_7` END AS impter_9, CASE WHEN (`ADS`.`Feature_8` IS NULL) THEN -0.03173937260977112 ELSE `ADS`.`Feature_8` END AS impter_10, CASE WHEN (`ADS`.`Feature_9` IS NULL) THEN -0.1518141420862488 ELSE `ADS`.`Feature_9` END AS impter_11, CASE WHEN (`ADS`.`Feature_10` IS NULL) THEN -0.13244576558492482 ELSE `ADS`.`Feature_10` END AS impter_12, CASE WHEN (`ADS`.`Feature_11` IS NULL) THEN 0.044172679762224144 ELSE `ADS`.`Feature_11` END AS impter_13, CASE WHEN (`ADS`.`Feature_12` IS NULL) THEN 0.010165946719810038 ELSE `ADS`.`Feature_12` END AS impter_14, CASE WHEN (`ADS`.`Feature_13` IS NULL) THEN -0.03645872019103299 ELSE `ADS`.`Feature_13` END AS impter_15, CASE WHEN (`ADS`.`Feature_14` IS NULL) THEN 0.06491512811593925 ELSE `ADS`.`Feature_14` END AS impter_16, CASE WHEN (`ADS`.`Feature_15` IS NULL) THEN -0.11930146867074032 ELSE `ADS`.`Feature_15` END AS impter_17, CASE WHEN (`ADS`.`Feature_16` IS NULL) THEN 0.007738863934852773 ELSE `ADS`.`Feature_16` END AS impter_18, CASE WHEN (`ADS`.`Feature_17` IS NULL) THEN -0.1226774060147726 ELSE `ADS`.`Feature_17` END AS impter_19, CASE WHEN (`ADS`.`Feature_18` IS NULL) THEN 0.019160881669086405 ELSE `ADS`.`Feature_18` END AS impter_20, CASE WHEN (`ADS`.`Feature_19` IS NULL) THEN -0.26340351121131067 ELSE `ADS`.`Feature_19` END AS impter_21, CASE WHEN (`ADS`.`Feature_20` IS NULL) THEN 0.035692361937735194 ELSE `ADS`.`Feature_20` END AS impter_22, CASE WHEN (`ADS`.`Feature_21` IS NULL) THEN -0.010021324964069293 ELSE `ADS`.`Feature_21` END AS impter_23, CASE WHEN (`ADS`.`Feature_22` IS NULL) THEN -0.1258614387723542 ELSE `ADS`.`Feature_22` END AS impter_24, CASE WHEN (`ADS`.`Feature_23` IS NULL) THEN 0.09372773898231128 ELSE `ADS`.`Feature_23` END AS impter_25, CASE WHEN (`ADS`.`Feature_24` IS NULL) THEN -0.1687929597880227 ELSE `ADS`.`Feature_24` END AS impter_26, CASE WHEN (`ADS`.`Feature_25` IS NULL) THEN 0.10006283199629364 ELSE `ADS`.`Feature_25` END AS impter_27, CASE WHEN (`ADS`.`Feature_26` IS NULL) THEN -0.10297858086822659 ELSE `ADS`.`Feature_26` END AS impter_28, CASE WHEN (`ADS`.`Feature_27` IS NULL) THEN 0.19240514535870415 ELSE `ADS`.`Feature_27` END AS impter_29, CASE WHEN (`ADS`.`Feature_28` IS NULL) THEN -0.052866434246092435 ELSE `ADS`.`Feature_28` END AS impter_30, CASE WHEN (`ADS`.`Feature_29` IS NULL) THEN 0.2624612146366151 ELSE `ADS`.`Feature_29` END AS impter_31, CASE WHEN (`ADS`.`Feature_30` IS NULL) THEN 0.002677575140361194 ELSE `ADS`.`Feature_30` END AS impter_32, CASE WHEN (`ADS`.`Feature_31` IS NULL) THEN 0.09707041941284063 ELSE `ADS`.`Feature_31` END AS impter_33, CASE WHEN (`ADS`.`Feature_32` IS NULL) THEN -0.032793219857333473 ELSE `ADS`.`Feature_32` END AS impter_34, CASE WHEN (`ADS`.`Feature_33` IS NULL) THEN -0.003130273745908922 ELSE `ADS`.`Feature_33` END AS impter_35, CASE WHEN (`ADS`.`Feature_34` IS NULL) THEN 0.053446276216279974 ELSE `ADS`.`Feature_34` END AS impter_36, CASE WHEN (`ADS`.`Feature_35` IS NULL) THEN -0.18668146437412367 ELSE `ADS`.`Feature_35` END AS impter_37, CASE WHEN (`ADS`.`Feature_36` IS NULL) THEN -0.029335964960866243 ELSE `ADS`.`Feature_36` END AS impter_38, CASE WHEN (`ADS`.`Feature_37` IS NULL) THEN 0.07219772199502426 ELSE `ADS`.`Feature_37` END AS impter_39, CASE WHEN (`ADS`.`Feature_38` IS NULL) THEN -0.0007762839781489412 ELSE `ADS`.`Feature_38` END AS impter_40, CASE WHEN (`ADS`.`Feature_39` IS NULL) THEN 0.08270823712098274 ELSE `ADS`.`Feature_39` END AS impter_41, CASE WHEN (`ADS`.`Feature_40` IS NULL) THEN 0.10432022852347983 ELSE `ADS`.`Feature_40` END AS impter_42, CASE WHEN (`ADS`.`Feature_41` IS NULL) THEN 0.07058566385022276 ELSE `ADS`.`Feature_41` END AS impter_43, CASE WHEN (`ADS`.`Feature_42` IS NULL) THEN 0.05096693098357383 ELSE `ADS`.`Feature_42` END AS impter_44, CASE WHEN (`ADS`.`Feature_43` IS NULL) THEN 0.0660758203367818 ELSE `ADS`.`Feature_43` END AS impter_45, CASE WHEN (`ADS`.`Feature_44` IS NULL) THEN -0.07075895636353369 ELSE `ADS`.`Feature_44` END AS impter_46, CASE WHEN (`ADS`.`Feature_45` IS NULL) THEN 0.08422536561649958 ELSE `ADS`.`Feature_45` END AS impter_47, CASE WHEN (`ADS`.`Feature_46` IS NULL) THEN 0.21367580667795616 ELSE `ADS`.`Feature_46` END AS impter_48, CASE WHEN (`ADS`.`Feature_47` IS NULL) THEN -0.055897457335624984 ELSE `ADS`.`Feature_47` END AS impter_49, CASE WHEN (`ADS`.`Feature_48` IS NULL) THEN -0.17453036726139817 ELSE `ADS`.`Feature_48` END AS impter_50, CASE WHEN (`ADS`.`Feature_49` IS NULL) THEN -0.054944001818473996 ELSE `ADS`.`Feature_49` END AS impter_51, CASE WHEN (`ADS`.`Feature_50` IS NULL) THEN -0.5961651261710368 ELSE `ADS`.`Feature_50` END AS impter_52, CASE WHEN (`ADS`.`Feature_51` IS NULL) THEN 0.5020404526565605 ELSE `ADS`.`Feature_51` END AS impter_53, CASE WHEN (`ADS`.`Feature_52` IS NULL) THEN -0.052340545201383926 ELSE `ADS`.`Feature_52` END AS impter_54, CASE WHEN (`ADS`.`Feature_53` IS NULL) THEN 0.05294307611674654 ELSE `ADS`.`Feature_53` END AS impter_55, CASE WHEN (`ADS`.`Feature_54` IS NULL) THEN 0.03835884479069335 ELSE `ADS`.`Feature_54` END AS impter_56, CASE WHEN (`ADS`.`Feature_55` IS NULL) THEN -0.13571979014964694 ELSE `ADS`.`Feature_55` END AS impter_57, CASE WHEN (`ADS`.`Feature_56` IS NULL) THEN -0.21903068431411843 ELSE `ADS`.`Feature_56` END AS impter_58, CASE WHEN (`ADS`.`Feature_57` IS NULL) THEN -0.1191752362029383 ELSE `ADS`.`Feature_57` END AS impter_59, CASE WHEN (`ADS`.`Feature_58` IS NULL) THEN 0.38058346912807667 ELSE `ADS`.`Feature_58` END AS impter_60, CASE WHEN (`ADS`.`Feature_59` IS NULL) THEN -0.12720928974168508 ELSE `ADS`.`Feature_59` END AS impter_61, CASE WHEN (`ADS`.`Feature_60` IS NULL) THEN -0.09072936496613782 ELSE `ADS`.`Feature_60` END AS impter_62, CASE WHEN (`ADS`.`Feature_61` IS NULL) THEN -0.03915125937954538 ELSE `ADS`.`Feature_61` END AS impter_63, CASE WHEN (`ADS`.`Feature_62` IS NULL) THEN 0.07075412393313481 ELSE `ADS`.`Feature_62` END AS impter_64, CASE WHEN (`ADS`.`Feature_63` IS NULL) THEN 0.10124894587016948 ELSE `ADS`.`Feature_63` END AS impter_65, CASE WHEN (`ADS`.`Feature_64` IS NULL) THEN -0.1945661449475579 ELSE `ADS`.`Feature_64` END AS impter_66, CASE WHEN (`ADS`.`Feature_65` IS NULL) THEN -0.1759482981261233 ELSE `ADS`.`Feature_65` END AS impter_67, CASE WHEN (`ADS`.`Feature_66` IS NULL) THEN 0.07473228971855511 ELSE `ADS`.`Feature_66` END AS impter_68, CASE WHEN (`ADS`.`Feature_67` IS NULL) THEN 0.0377705562115906 ELSE `ADS`.`Feature_67` END AS impter_69, CASE WHEN (`ADS`.`Feature_68` IS NULL) THEN 0.0139470898598917 ELSE `ADS`.`Feature_68` END AS impter_70, CASE WHEN (`ADS`.`Feature_69` IS NULL) THEN 0.2582685725145942 ELSE `ADS`.`Feature_69` END AS impter_71, CASE WHEN (`ADS`.`Feature_70` IS NULL) THEN 0.022975786233048922 ELSE `ADS`.`Feature_70` END AS impter_72, CASE WHEN (`ADS`.`Feature_71` IS NULL) THEN 0.17445434061949525 ELSE `ADS`.`Feature_71` END AS impter_73, CASE WHEN (`ADS`.`Feature_72` IS NULL) THEN -0.011413879692078346 ELSE `ADS`.`Feature_72` END AS impter_74, CASE WHEN (`ADS`.`Feature_73` IS NULL) THEN 0.07898984156871978 ELSE `ADS`.`Feature_73` END AS impter_75, CASE WHEN (`ADS`.`Feature_74` IS NULL) THEN 0.0952547273770713 ELSE `ADS`.`Feature_74` END AS impter_76, CASE WHEN (`ADS`.`Feature_75` IS NULL) THEN -0.03997776839639901 ELSE `ADS`.`Feature_75` END AS impter_77, CASE WHEN (`ADS`.`Feature_76` IS NULL) THEN -0.020839895874293496 ELSE `ADS`.`Feature_76` END AS impter_78, CASE WHEN (`ADS`.`Feature_77` IS NULL) THEN -0.07284631986613152 ELSE `ADS`.`Feature_77` END AS impter_79, CASE WHEN (`ADS`.`Feature_78` IS NULL) THEN -0.27389951764434384 ELSE `ADS`.`Feature_78` END AS impter_80, CASE WHEN (`ADS`.`Feature_79` IS NULL) THEN 0.08057287885287609 ELSE `ADS`.`Feature_79` END AS impter_81, CASE WHEN (`ADS`.`Feature_80` IS NULL) THEN -0.06244274245437891 ELSE `ADS`.`Feature_80` END AS impter_82, CASE WHEN (`ADS`.`Feature_81` IS NULL) THEN -0.12290855334066887 ELSE `ADS`.`Feature_81` END AS impter_83, CASE WHEN (`ADS`.`Feature_82` IS NULL) THEN 0.11639531793890918 ELSE `ADS`.`Feature_82` END AS impter_84, CASE WHEN (`ADS`.`Feature_83` IS NULL) THEN -0.03350462786128603 ELSE `ADS`.`Feature_83` END AS impter_85, CASE WHEN (`ADS`.`Feature_84` IS NULL) THEN -0.03914049968144583 ELSE `ADS`.`Feature_84` END AS impter_86, CASE WHEN (`ADS`.`Feature_85` IS NULL) THEN 0.24193903072305167 ELSE `ADS`.`Feature_85` END AS impter_87, CASE WHEN (`ADS`.`Feature_86` IS NULL) THEN -0.07389719862221904 ELSE `ADS`.`Feature_86` END AS impter_88, CASE WHEN (`ADS`.`Feature_87` IS NULL) THEN 0.1400756228320113 ELSE `ADS`.`Feature_87` END AS impter_89, CASE WHEN (`ADS`.`Feature_88` IS NULL) THEN 0.2765301935136145 ELSE `ADS`.`Feature_88` END AS impter_90, CASE WHEN (`ADS`.`Feature_89` IS NULL) THEN -0.07957147169250885 ELSE `ADS`.`Feature_89` END AS impter_91, CASE WHEN (`ADS`.`Feature_90` IS NULL) THEN 0.16295767680642717 ELSE `ADS`.`Feature_90` END AS impter_92, CASE WHEN (`ADS`.`Feature_91` IS NULL) THEN 0.07062813888509549 ELSE `ADS`.`Feature_91` END AS impter_93, CASE WHEN (`ADS`.`Feature_92` IS NULL) THEN 0.012995630151896219 ELSE `ADS`.`Feature_92` END AS impter_94, CASE WHEN (`ADS`.`Feature_93` IS NULL) THEN 0.1055212408190415 ELSE `ADS`.`Feature_93` END AS impter_95, CASE WHEN (`ADS`.`Feature_94` IS NULL) THEN -0.1408434425354362 ELSE `ADS`.`Feature_94` END AS impter_96, CASE WHEN (`ADS`.`Feature_95` IS NULL) THEN -0.1574012366732725 ELSE `ADS`.`Feature_95` END AS impter_97, CASE WHEN (`ADS`.`Feature_96` IS NULL) THEN 0.05477536676313335 ELSE `ADS`.`Feature_96` END AS impter_98, CASE WHEN (`ADS`.`Feature_97` IS NULL) THEN 0.05673272205919614 ELSE `ADS`.`Feature_97` END AS impter_99, CASE WHEN (`ADS`.`Feature_98` IS NULL) THEN -0.14226649213619527 ELSE `ADS`.`Feature_98` END AS impter_100, CASE WHEN (`ADS`.`Feature_99` IS NULL) THEN -0.04042675289131955 ELSE `ADS`.`Feature_99` END AS impter_101 
FROM `FourClass_100` AS `ADS`) AS `ADS_imp_1_OUT`

-- Code For temporary table tmp_20180602143835_h5c_ads_sca_2_out part 1. Create 


CREATE TABLE tmp_20180602143835_h5c_ads_sca_2_out (
	`KEY` BIGINT, 
	scaler_2 DOUBLE, 
	scaler_3 DOUBLE, 
	scaler_4 DOUBLE, 
	scaler_5 DOUBLE, 
	scaler_6 DOUBLE, 
	scaler_7 DOUBLE, 
	scaler_8 DOUBLE, 
	scaler_9 DOUBLE, 
	scaler_10 DOUBLE, 
	scaler_11 DOUBLE, 
	scaler_12 DOUBLE, 
	scaler_13 DOUBLE, 
	scaler_14 DOUBLE, 
	scaler_15 DOUBLE, 
	scaler_16 DOUBLE, 
	scaler_17 DOUBLE, 
	scaler_18 DOUBLE, 
	scaler_19 DOUBLE, 
	scaler_20 DOUBLE, 
	scaler_21 DOUBLE, 
	scaler_22 DOUBLE, 
	scaler_23 DOUBLE, 
	scaler_24 DOUBLE, 
	scaler_25 DOUBLE, 
	scaler_26 DOUBLE, 
	scaler_27 DOUBLE, 
	scaler_28 DOUBLE, 
	scaler_29 DOUBLE, 
	scaler_30 DOUBLE, 
	scaler_31 DOUBLE, 
	scaler_32 DOUBLE, 
	scaler_33 DOUBLE, 
	scaler_34 DOUBLE, 
	scaler_35 DOUBLE, 
	scaler_36 DOUBLE, 
	scaler_37 DOUBLE, 
	scaler_38 DOUBLE, 
	scaler_39 DOUBLE, 
	scaler_40 DOUBLE, 
	scaler_41 DOUBLE, 
	scaler_42 DOUBLE, 
	scaler_43 DOUBLE, 
	scaler_44 DOUBLE, 
	scaler_45 DOUBLE, 
	scaler_46 DOUBLE, 
	scaler_47 DOUBLE, 
	scaler_48 DOUBLE, 
	scaler_49 DOUBLE, 
	scaler_50 DOUBLE, 
	scaler_51 DOUBLE, 
	scaler_52 DOUBLE, 
	scaler_53 DOUBLE, 
	scaler_54 DOUBLE, 
	scaler_55 DOUBLE, 
	scaler_56 DOUBLE, 
	scaler_57 DOUBLE, 
	scaler_58 DOUBLE, 
	scaler_59 DOUBLE, 
	scaler_60 DOUBLE, 
	scaler_61 DOUBLE, 
	scaler_62 DOUBLE, 
	scaler_63 DOUBLE, 
	scaler_64 DOUBLE, 
	scaler_65 DOUBLE, 
	scaler_66 DOUBLE, 
	scaler_67 DOUBLE, 
	scaler_68 DOUBLE, 
	scaler_69 DOUBLE, 
	scaler_70 DOUBLE, 
	scaler_71 DOUBLE, 
	scaler_72 DOUBLE, 
	scaler_73 DOUBLE, 
	scaler_74 DOUBLE, 
	scaler_75 DOUBLE, 
	scaler_76 DOUBLE, 
	scaler_77 DOUBLE, 
	scaler_78 DOUBLE, 
	scaler_79 DOUBLE, 
	scaler_80 DOUBLE, 
	scaler_81 DOUBLE, 
	scaler_82 DOUBLE, 
	scaler_83 DOUBLE, 
	scaler_84 DOUBLE, 
	scaler_85 DOUBLE, 
	scaler_86 DOUBLE, 
	scaler_87 DOUBLE, 
	scaler_88 DOUBLE, 
	scaler_89 DOUBLE, 
	scaler_90 DOUBLE, 
	scaler_91 DOUBLE, 
	scaler_92 DOUBLE, 
	scaler_93 DOUBLE, 
	scaler_94 DOUBLE, 
	scaler_95 DOUBLE, 
	scaler_96 DOUBLE, 
	scaler_97 DOUBLE, 
	scaler_98 DOUBLE, 
	scaler_99 DOUBLE, 
	scaler_100 DOUBLE, 
	scaler_101 DOUBLE
)

 CACHED IN 'one_gig_pool'

-- Code For temporary table tmp_20180602143835_h5c_ads_sca_2_out part 2. Populate

INSERT INTO tmp_20180602143835_h5c_ads_sca_2_out (`KEY`, scaler_2, scaler_3, scaler_4, scaler_5, scaler_6, scaler_7, scaler_8, scaler_9, scaler_10, scaler_11, scaler_12, scaler_13, scaler_14, scaler_15, scaler_16, scaler_17, scaler_18, scaler_19, scaler_20, scaler_21, scaler_22, scaler_23, scaler_24, scaler_25, scaler_26, scaler_27, scaler_28, scaler_29, scaler_30, scaler_31, scaler_32, scaler_33, scaler_34, scaler_35, scaler_36, scaler_37, scaler_38, scaler_39, scaler_40, scaler_41, scaler_42, scaler_43, scaler_44, scaler_45, scaler_46, scaler_47, scaler_48, scaler_49, scaler_50, scaler_51, scaler_52, scaler_53, scaler_54, scaler_55, scaler_56, scaler_57, scaler_58, scaler_59, scaler_60, scaler_61, scaler_62, scaler_63, scaler_64, scaler_65, scaler_66, scaler_67, scaler_68, scaler_69, scaler_70, scaler_71, scaler_72, scaler_73, scaler_74, scaler_75, scaler_76, scaler_77, scaler_78, scaler_79, scaler_80, scaler_81, scaler_82, scaler_83, scaler_84, scaler_85, scaler_86, scaler_87, scaler_88, scaler_89, scaler_90, scaler_91, scaler_92, scaler_93, scaler_94, scaler_95, scaler_96, scaler_97, scaler_98, scaler_99, scaler_100, scaler_101) SELECT `ADS_sca_2_OUT`.`KEY`, `ADS_sca_2_OUT`.scaler_2, `ADS_sca_2_OUT`.scaler_3, `ADS_sca_2_OUT`.scaler_4, `ADS_sca_2_OUT`.scaler_5, `ADS_sca_2_OUT`.scaler_6, `ADS_sca_2_OUT`.scaler_7, `ADS_sca_2_OUT`.scaler_8, `ADS_sca_2_OUT`.scaler_9, `ADS_sca_2_OUT`.scaler_10, `ADS_sca_2_OUT`.scaler_11, `ADS_sca_2_OUT`.scaler_12, `ADS_sca_2_OUT`.scaler_13, `ADS_sca_2_OUT`.scaler_14, `ADS_sca_2_OUT`.scaler_15, `ADS_sca_2_OUT`.scaler_16, `ADS_sca_2_OUT`.scaler_17, `ADS_sca_2_OUT`.scaler_18, `ADS_sca_2_OUT`.scaler_19, `ADS_sca_2_OUT`.scaler_20, `ADS_sca_2_OUT`.scaler_21, `ADS_sca_2_OUT`.scaler_22, `ADS_sca_2_OUT`.scaler_23, `ADS_sca_2_OUT`.scaler_24, `ADS_sca_2_OUT`.scaler_25, `ADS_sca_2_OUT`.scaler_26, `ADS_sca_2_OUT`.scaler_27, `ADS_sca_2_OUT`.scaler_28, `ADS_sca_2_OUT`.scaler_29, `ADS_sca_2_OUT`.scaler_30, `ADS_sca_2_OUT`.scaler_31, `ADS_sca_2_OUT`.scaler_32, `ADS_sca_2_OUT`.scaler_33, `ADS_sca_2_OUT`.scaler_34, `ADS_sca_2_OUT`.scaler_35, `ADS_sca_2_OUT`.scaler_36, `ADS_sca_2_OUT`.scaler_37, `ADS_sca_2_OUT`.scaler_38, `ADS_sca_2_OUT`.scaler_39, `ADS_sca_2_OUT`.scaler_40, `ADS_sca_2_OUT`.scaler_41, `ADS_sca_2_OUT`.scaler_42, `ADS_sca_2_OUT`.scaler_43, `ADS_sca_2_OUT`.scaler_44, `ADS_sca_2_OUT`.scaler_45, `ADS_sca_2_OUT`.scaler_46, `ADS_sca_2_OUT`.scaler_47, `ADS_sca_2_OUT`.scaler_48, `ADS_sca_2_OUT`.scaler_49, `ADS_sca_2_OUT`.scaler_50, `ADS_sca_2_OUT`.scaler_51, `ADS_sca_2_OUT`.scaler_52, `ADS_sca_2_OUT`.scaler_53, `ADS_sca_2_OUT`.scaler_54, `ADS_sca_2_OUT`.scaler_55, `ADS_sca_2_OUT`.scaler_56, `ADS_sca_2_OUT`.scaler_57, `ADS_sca_2_OUT`.scaler_58, `ADS_sca_2_OUT`.scaler_59, `ADS_sca_2_OUT`.scaler_60, `ADS_sca_2_OUT`.scaler_61, `ADS_sca_2_OUT`.scaler_62, `ADS_sca_2_OUT`.scaler_63, `ADS_sca_2_OUT`.scaler_64, `ADS_sca_2_OUT`.scaler_65, `ADS_sca_2_OUT`.scaler_66, `ADS_sca_2_OUT`.scaler_67, `ADS_sca_2_OUT`.scaler_68, `ADS_sca_2_OUT`.scaler_69, `ADS_sca_2_OUT`.scaler_70, `ADS_sca_2_OUT`.scaler_71, `ADS_sca_2_OUT`.scaler_72, `ADS_sca_2_OUT`.scaler_73, `ADS_sca_2_OUT`.scaler_74, `ADS_sca_2_OUT`.scaler_75, `ADS_sca_2_OUT`.scaler_76, `ADS_sca_2_OUT`.scaler_77, `ADS_sca_2_OUT`.scaler_78, `ADS_sca_2_OUT`.scaler_79, `ADS_sca_2_OUT`.scaler_80, `ADS_sca_2_OUT`.scaler_81, `ADS_sca_2_OUT`.scaler_82, `ADS_sca_2_OUT`.scaler_83, `ADS_sca_2_OUT`.scaler_84, `ADS_sca_2_OUT`.scaler_85, `ADS_sca_2_OUT`.scaler_86, `ADS_sca_2_OUT`.scaler_87, `ADS_sca_2_OUT`.scaler_88, `ADS_sca_2_OUT`.scaler_89, `ADS_sca_2_OUT`.scaler_90, `ADS_sca_2_OUT`.scaler_91, `ADS_sca_2_OUT`.scaler_92, `ADS_sca_2_OUT`.scaler_93, `ADS_sca_2_OUT`.scaler_94, `ADS_sca_2_OUT`.scaler_95, `ADS_sca_2_OUT`.scaler_96, `ADS_sca_2_OUT`.scaler_97, `ADS_sca_2_OUT`.scaler_98, `ADS_sca_2_OUT`.scaler_99, `ADS_sca_2_OUT`.scaler_100, `ADS_sca_2_OUT`.scaler_101 
FROM (SELECT `ADS_imp_1_OUT`.`KEY` AS `KEY`, (CAST(`ADS_imp_1_OUT`.impter_2 AS DOUBLE) - -0.0014807007689716506) / 0.9211229790312512 AS scaler_2, (CAST(`ADS_imp_1_OUT`.impter_3 AS DOUBLE) - 0.08599214990681354) / 0.9627516809237073 AS scaler_3, (CAST(`ADS_imp_1_OUT`.impter_4 AS DOUBLE) - -0.006358164676411468) / 0.7890687835102894 AS scaler_4, (CAST(`ADS_imp_1_OUT`.impter_5 AS DOUBLE) - -0.024301807422776375) / 1.0265272189083172 AS scaler_5, (CAST(`ADS_imp_1_OUT`.impter_6 AS DOUBLE) - 0.015786548044298444) / 1.0198090908026474 AS scaler_6, (CAST(`ADS_imp_1_OUT`.impter_7 AS DOUBLE) - -0.13959329445651672) / 0.9185551763293686 AS scaler_7, (CAST(`ADS_imp_1_OUT`.impter_8 AS DOUBLE) - -0.06476745048019888) / 1.0393547249617474 AS scaler_8, (CAST(`ADS_imp_1_OUT`.impter_9 AS DOUBLE) - 0.025579810774090658) / 0.8722131294644917 AS scaler_9, (CAST(`ADS_imp_1_OUT`.impter_10 AS DOUBLE) - -0.03173937260977112) / 1.0164588299091024 AS scaler_10, (CAST(`ADS_imp_1_OUT`.impter_11 AS DOUBLE) - -0.1518141420862488) / 1.0075402114297496 AS scaler_11, (CAST(`ADS_imp_1_OUT`.impter_12 AS DOUBLE) - -0.13244576558492482) / 0.9215325459816371 AS scaler_12, (CAST(`ADS_imp_1_OUT`.impter_13 AS DOUBLE) - 0.044172679762224144) / 0.9053279964066308 AS scaler_13, (CAST(`ADS_imp_1_OUT`.impter_14 AS DOUBLE) - 0.010165946719810038) / 1.2190371046063362 AS scaler_14, (CAST(`ADS_imp_1_OUT`.impter_15 AS DOUBLE) - -0.03645872019103299) / 1.0879005786584215 AS scaler_15, (CAST(`ADS_imp_1_OUT`.impter_16 AS DOUBLE) - 0.06491512811593925) / 1.0274670201407186 AS scaler_16, (CAST(`ADS_imp_1_OUT`.impter_17 AS DOUBLE) - -0.11930146867074032) / 0.9506312349761404 AS scaler_17, (CAST(`ADS_imp_1_OUT`.impter_18 AS DOUBLE) - 0.007738863934852773) / 1.0928477585203984 AS scaler_18, (CAST(`ADS_imp_1_OUT`.impter_19 AS DOUBLE) - -0.1226774060147726) / 0.9830561715965196 AS scaler_19, (CAST(`ADS_imp_1_OUT`.impter_20 AS DOUBLE) - 0.019160881669086405) / 1.2117417920836373 AS scaler_20, (CAST(`ADS_imp_1_OUT`.impter_21 AS DOUBLE) - -0.26340351121131067) / 0.9807419262255984 AS scaler_21, (CAST(`ADS_imp_1_OUT`.impter_22 AS DOUBLE) - 0.035692361937735194) / 1.115824498468156 AS scaler_22, (CAST(`ADS_imp_1_OUT`.impter_23 AS DOUBLE) - -0.010021324964069293) / 1.0790959803413318 AS scaler_23, (CAST(`ADS_imp_1_OUT`.impter_24 AS DOUBLE) - -0.1258614387723542) / 1.0279672611547366 AS scaler_24, (CAST(`ADS_imp_1_OUT`.impter_25 AS DOUBLE) - 0.09372773898231128) / 0.9690760299303989 AS scaler_25, (CAST(`ADS_imp_1_OUT`.impter_26 AS DOUBLE) - -0.1687929597880227) / 0.8845858581996813 AS scaler_26, (CAST(`ADS_imp_1_OUT`.impter_27 AS DOUBLE) - 0.10006283199629364) / 0.9149346104000894 AS scaler_27, (CAST(`ADS_imp_1_OUT`.impter_28 AS DOUBLE) - -0.10297858086822659) / 1.0761397500557328 AS scaler_28, (CAST(`ADS_imp_1_OUT`.impter_29 AS DOUBLE) - 0.19240514535870415) / 2.089882492597775 AS scaler_29, (CAST(`ADS_imp_1_OUT`.impter_30 AS DOUBLE) - -0.052866434246092435) / 1.0030777529896888 AS scaler_30, (CAST(`ADS_imp_1_OUT`.impter_31 AS DOUBLE) - 0.2624612146366151) / 1.9778491038473625 AS scaler_31, (CAST(`ADS_imp_1_OUT`.impter_32 AS DOUBLE) - 0.002677575140361194) / 0.8833924915211555 AS scaler_32, (CAST(`ADS_imp_1_OUT`.impter_33 AS DOUBLE) - 0.09707041941284063) / 0.8720005351713555 AS scaler_33, (CAST(`ADS_imp_1_OUT`.impter_34 AS DOUBLE) - -0.032793219857333473) / 0.8745989090443193 AS scaler_34, (CAST(`ADS_imp_1_OUT`.impter_35 AS DOUBLE) - -0.003130273745908922) / 0.9967699097535561 AS scaler_35, (CAST(`ADS_imp_1_OUT`.impter_36 AS DOUBLE) - 0.053446276216279974) / 0.9997289112199433 AS scaler_36, (CAST(`ADS_imp_1_OUT`.impter_37 AS DOUBLE) - -0.18668146437412367) / 1.0272287171310865 AS scaler_37, (CAST(`ADS_imp_1_OUT`.impter_38 AS DOUBLE) - -0.029335964960866243) / 1.0427555960451658 AS scaler_38, (CAST(`ADS_imp_1_OUT`.impter_39 AS DOUBLE) - 0.07219772199502426) / 0.8328229890456742 AS scaler_39, (CAST(`ADS_imp_1_OUT`.impter_40 AS DOUBLE) - -0.0007762839781489412) / 0.9666524356457794 AS scaler_40, (CAST(`ADS_imp_1_OUT`.impter_41 AS DOUBLE) - 0.08270823712098274) / 1.083670494683493 AS scaler_41, (CAST(`ADS_imp_1_OUT`.impter_42 AS DOUBLE) - 0.10432022852347983) / 1.075472547982714 AS scaler_42, (CAST(`ADS_imp_1_OUT`.impter_43 AS DOUBLE) - 0.07058566385022276) / 0.9993462791463713 AS scaler_43, (CAST(`ADS_imp_1_OUT`.impter_44 AS DOUBLE) - 0.05096693098357383) / 0.8876971252794036 AS scaler_44, (CAST(`ADS_imp_1_OUT`.impter_45 AS DOUBLE) - 0.0660758203367818) / 1.041246125313479 AS scaler_45, (CAST(`ADS_imp_1_OUT`.impter_46 AS DOUBLE) - -0.07075895636353369) / 2.238310207242139 AS scaler_46, (CAST(`ADS_imp_1_OUT`.impter_47 AS DOUBLE) - 0.08422536561649958) / 0.9520959686676432 AS scaler_47, (CAST(`ADS_imp_1_OUT`.impter_48 AS DOUBLE) - 0.21367580667795616) / 0.9907230316111766 AS scaler_48, (CAST(`ADS_imp_1_OUT`.impter_49 AS DOUBLE) - -0.055897457335624984) / 1.0392400714320487 AS scaler_49, (CAST(`ADS_imp_1_OUT`.impter_50 AS DOUBLE) - -0.17453036726139817) / 2.001507098381001 AS scaler_50, (CAST(`ADS_imp_1_OUT`.impter_51 AS DOUBLE) - -0.054944001818473996) / 1.0041645540091246 AS scaler_51, (CAST(`ADS_imp_1_OUT`.impter_52 AS DOUBLE) - -0.5961651261710368) / 2.467511153399545 AS scaler_52, (CAST(`ADS_imp_1_OUT`.impter_53 AS DOUBLE) - 0.5020404526565605) / 2.1929325118287792 AS scaler_53, (CAST(`ADS_imp_1_OUT`.impter_54 AS DOUBLE) - -0.052340545201383926) / 0.98465558791252 AS scaler_54, (CAST(`ADS_imp_1_OUT`.impter_55 AS DOUBLE) - 0.05294307611674654) / 1.8137042567337183 AS scaler_55, (CAST(`ADS_imp_1_OUT`.impter_56 AS DOUBLE) - 0.03835884479069335) / 0.9241326354411343 AS scaler_56, (CAST(`ADS_imp_1_OUT`.impter_57 AS DOUBLE) - -0.13571979014964694) / 0.8679095755948701 AS scaler_57, (CAST(`ADS_imp_1_OUT`.impter_58 AS DOUBLE) - -0.21903068431411843) / 4.150428869748413 AS scaler_58, (CAST(`ADS_imp_1_OUT`.impter_59 AS DOUBLE) - -0.1191752362029383) / 0.9123333408128436 AS scaler_59, (CAST(`ADS_imp_1_OUT`.impter_60 AS DOUBLE) - 0.38058346912807667) / 3.5635011086986927 AS scaler_60, (CAST(`ADS_imp_1_OUT`.impter_61 AS DOUBLE) - -0.12720928974168508) / 0.9301024475991629 AS scaler_61, (CAST(`ADS_imp_1_OUT`.impter_62 AS DOUBLE) - -0.09072936496613782) / 0.9490501277306023 AS scaler_62, (CAST(`ADS_imp_1_OUT`.impter_63 AS DOUBLE) - -0.03915125937954538) / 0.9029504608473613 AS scaler_63, (CAST(`ADS_imp_1_OUT`.impter_64 AS DOUBLE) - 0.07075412393313481) / 0.9726561682528103 AS scaler_64, (CAST(`ADS_imp_1_OUT`.impter_65 AS DOUBLE) - 0.10124894587016948) / 0.9403075920249493 AS scaler_65, (CAST(`ADS_imp_1_OUT`.impter_66 AS DOUBLE) - -0.1945661449475579) / 0.9400903625732654 AS scaler_66, (CAST(`ADS_imp_1_OUT`.impter_67 AS DOUBLE) - -0.1759482981261233) / 0.9435422049943787 AS scaler_67, (CAST(`ADS_imp_1_OUT`.impter_68 AS DOUBLE) - 0.07473228971855511) / 0.8871003964319768 AS scaler_68, (CAST(`ADS_imp_1_OUT`.impter_69 AS DOUBLE) - 0.0377705562115906) / 1.0228978549196588 AS scaler_69, (CAST(`ADS_imp_1_OUT`.impter_70 AS DOUBLE) - 0.0139470898598917) / 0.9465728329079491 AS scaler_70, (CAST(`ADS_imp_1_OUT`.impter_71 AS DOUBLE) - 0.2582685725145942) / 1.1027232016521478 AS scaler_71, (CAST(`ADS_imp_1_OUT`.impter_72 AS DOUBLE) - 0.022975786233048922) / 0.9200436904809381 AS scaler_72, (CAST(`ADS_imp_1_OUT`.impter_73 AS DOUBLE) - 0.17445434061949525) / 0.9009964742482128 AS scaler_73, (CAST(`ADS_imp_1_OUT`.impter_74 AS DOUBLE) - -0.011413879692078346) / 0.9483377025565977 AS scaler_74, (CAST(`ADS_imp_1_OUT`.impter_75 AS DOUBLE) - 0.07898984156871978) / 0.9726668138861088 AS scaler_75, (CAST(`ADS_imp_1_OUT`.impter_76 AS DOUBLE) - 0.0952547273770713) / 0.9607867245873394 AS scaler_76, (CAST(`ADS_imp_1_OUT`.impter_77 AS DOUBLE) - -0.03997776839639901) / 1.0318828686080972 AS scaler_77, (CAST(`ADS_imp_1_OUT`.impter_78 AS DOUBLE) - -0.020839895874293496) / 0.945141993694461 AS scaler_78, (CAST(`ADS_imp_1_OUT`.impter_79 AS DOUBLE) - -0.07284631986613152) / 0.9103416784348913 AS scaler_79, (CAST(`ADS_imp_1_OUT`.impter_80 AS DOUBLE) - -0.27389951764434384) / 2.0362603862996735 AS scaler_80, (CAST(`ADS_imp_1_OUT`.impter_81 AS DOUBLE) - 0.08057287885287609) / 0.9919292944224015 AS scaler_81, (CAST(`ADS_imp_1_OUT`.impter_82 AS DOUBLE) - -0.06244274245437891) / 0.8113039293824552 AS scaler_82, (CAST(`ADS_imp_1_OUT`.impter_83 AS DOUBLE) - -0.12290855334066887) / 1.0307302654711112 AS scaler_83, (CAST(`ADS_imp_1_OUT`.impter_84 AS DOUBLE) - 0.11639531793890918) / 0.9993591951135242 AS scaler_84, (CAST(`ADS_imp_1_OUT`.impter_85 AS DOUBLE) - -0.03350462786128603) / 1.0197598648594488 AS scaler_85, (CAST(`ADS_imp_1_OUT`.impter_86 AS DOUBLE) - -0.03914049968144583) / 0.9022051622058084 AS scaler_86, (CAST(`ADS_imp_1_OUT`.impter_87 AS DOUBLE) - 0.24193903072305167) / 0.9625742678392476 AS scaler_87, (CAST(`ADS_imp_1_OUT`.impter_88 AS DOUBLE) - -0.07389719862221904) / 1.0080070985430696 AS scaler_88, (CAST(`ADS_imp_1_OUT`.impter_89 AS DOUBLE) - 0.1400756228320113) / 0.9315791274848828 AS scaler_89, (CAST(`ADS_imp_1_OUT`.impter_90 AS DOUBLE) - 0.2765301935136145) / 1.9455982323178656 AS scaler_90, (CAST(`ADS_imp_1_OUT`.impter_91 AS DOUBLE) - -0.07957147169250885) / 0.9688848077884671 AS scaler_91, (CAST(`ADS_imp_1_OUT`.impter_92 AS DOUBLE) - 0.16295767680642717) / 0.8952741904110189 AS scaler_92, (CAST(`ADS_imp_1_OUT`.impter_93 AS DOUBLE) - 0.07062813888509549) / 0.8331748322730601 AS scaler_93, (CAST(`ADS_imp_1_OUT`.impter_94 AS DOUBLE) - 0.012995630151896219) / 1.059167248118017 AS scaler_94, (CAST(`ADS_imp_1_OUT`.impter_95 AS DOUBLE) - 0.1055212408190415) / 1.0525988978000902 AS scaler_95, (CAST(`ADS_imp_1_OUT`.impter_96 AS DOUBLE) - -0.1408434425354362) / 0.9172372033996682 AS scaler_96, (CAST(`ADS_imp_1_OUT`.impter_97 AS DOUBLE) - -0.1574012366732725) / 0.9930125433643069 AS scaler_97, (CAST(`ADS_imp_1_OUT`.impter_98 AS DOUBLE) - 0.05477536676313335) / 0.9803136353653645 AS scaler_98, (CAST(`ADS_imp_1_OUT`.impter_99 AS DOUBLE) - 0.05673272205919614) / 0.9296338032188498 AS scaler_99, (CAST(`ADS_imp_1_OUT`.impter_100 AS DOUBLE) - -0.14226649213619527) / 1.174442941822933 AS scaler_100, (CAST(`ADS_imp_1_OUT`.impter_101 AS DOUBLE) - -0.04042675289131955) / 1.983747550989713 AS scaler_101 
FROM tmp_20180602143835_qdb_ads_imp_1_out AS `ADS_imp_1_OUT`) AS `ADS_sca_2_OUT`

-- Code For temporary table tmp_20180602143835_6y5_lgbm_b0 part 1. Create 


CREATE TABLE tmp_20180602143835_6y5_lgbm_b0 (
	`KEY` BIGINT, 
	`Score_0` DOUBLE, 
	`Score_1` DOUBLE, 
	`Score_2` DOUBLE, 
	`Score_3` DOUBLE
)

 CACHED IN 'one_gig_pool'

-- Code For temporary table tmp_20180602143835_6y5_lgbm_b0 part 2. Populate

WITH `DT_node_lookup` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_80 <= -0.20659892002321142) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_5 <= -0.14268115411255844) THEN 4 ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_50 <= 1.0000000180025095e-35) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 4 AS nid, -0.01999999999999999 AS `Score` UNION ALL SELECT 5 AS nid, -0.03333333333333333 AS `Score` UNION ALL SELECT 6 AS nid, 0.05757575757575755 AS `Score` UNION ALL SELECT 7 AS nid, -0.0011494252873563218 AS `Score`) AS `Values`), 
`DT_Output` AS 
(SELECT `DT_node_lookup`.`KEY` AS `KEY`, `DT_node_lookup`.node_id_2 AS node_id_2, `DT_node_data`.nid AS nid, `DT_node_data`.`Score` AS `Score` 
FROM `DT_node_lookup` LEFT OUTER JOIN `DT_node_data` ON `DT_node_lookup`.node_id_2 = `DT_node_data`.nid), 
`LGBM_Model_0_0` AS 
(SELECT `DT_Output`.`KEY` AS `KEY`, `DT_Output`.`Score` AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output`), 
`DT_node_lookup_1` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_94 <= 0.7422130423340411) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_11 <= -0.16760702855928997) THEN 4 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_96 <= 0.0909658923333073) THEN 10 ELSE 11 END END ELSE 3 END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_1` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 3 AS nid, 0.04000000000000001 AS `Score` UNION ALL SELECT 4 AS nid, -0.029629629629629624 AS `Score` UNION ALL SELECT 10 AS nid, -0.013333333333333336 AS `Score` UNION ALL SELECT 11 AS nid, 0.03333333333333333 AS `Score`) AS `Values`), 
`DT_Output_1` AS 
(SELECT `DT_node_lookup_1`.`KEY` AS `KEY`, `DT_node_lookup_1`.node_id_2 AS node_id_2, `DT_node_data_1`.nid AS nid, `DT_node_data_1`.`Score` AS `Score` 
FROM `DT_node_lookup_1` LEFT OUTER JOIN `DT_node_data_1` ON `DT_node_lookup_1`.node_id_2 = `DT_node_data_1`.nid), 
`LGBM_Model_1_0` AS 
(SELECT `DT_Output_1`.`KEY` AS `KEY`, 0.0 AS `Score_0`, `DT_Output_1`.`Score` AS `Score_1`, 0.0 AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_1`), 
`DT_node_lookup_2` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_46 <= -0.7837116766399931) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_21 <= -0.25420272015856016) THEN 6 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_4 <= 1.0000000180025095e-35) THEN 14 ELSE 15 END END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_2` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 2 AS nid, 0.049206349206349205 AS `Score` UNION ALL SELECT 6 AS nid, 0.0030303030303030294 AS `Score` UNION ALL SELECT 14 AS nid, -0.02666666666666667 AS `Score` UNION ALL SELECT 15 AS nid, -0.03333333333333333 AS `Score`) AS `Values`), 
`DT_Output_2` AS 
(SELECT `DT_node_lookup_2`.`KEY` AS `KEY`, `DT_node_lookup_2`.node_id_2 AS node_id_2, `DT_node_data_2`.nid AS nid, `DT_node_data_2`.`Score` AS `Score` 
FROM `DT_node_lookup_2` LEFT OUTER JOIN `DT_node_data_2` ON `DT_node_lookup_2`.node_id_2 = `DT_node_data_2`.nid), 
`LGBM_Model_2_0` AS 
(SELECT `DT_Output_2`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, `DT_Output_2`.`Score` AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_2`), 
`DT_node_lookup_3` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_31 <= 0.36901699791788345) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_46 <= 0.06978065000800054) THEN 4 ELSE 5 END ELSE 3 END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_3` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 3 AS nid, 0.027619047619047623 AS `Score` UNION ALL SELECT 4 AS nid, -0.033333333333333326 AS `Score` UNION ALL SELECT 5 AS nid, 0.006172839506172839 AS `Score`) AS `Values`), 
`DT_Output_3` AS 
(SELECT `DT_node_lookup_3`.`KEY` AS `KEY`, `DT_node_lookup_3`.node_id_2 AS node_id_2, `DT_node_data_3`.nid AS nid, `DT_node_data_3`.`Score` AS `Score` 
FROM `DT_node_lookup_3` LEFT OUTER JOIN `DT_node_data_3` ON `DT_node_lookup_3`.node_id_2 = `DT_node_data_3`.nid), 
`LGBM_Model_3_0` AS 
(SELECT `DT_Output_3`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2`, `DT_Output_3`.`Score` AS `Score_3` 
FROM `DT_Output_3`), 
`DT_node_lookup_4` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_80 <= -0.20659892002321142) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_81 <= -0.19852706625085706) THEN 4 ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_94 <= 0.07659678856147197) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_4` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 4 AS nid, -0.01950137705240332 AS `Score` UNION ALL SELECT 5 AS nid, -0.033116866801664334 AS `Score` UNION ALL SELECT 6 AS nid, 0.04781539670855374 AS `Score` UNION ALL SELECT 7 AS nid, -0.009422123523754237 AS `Score`) AS `Values`), 
`DT_Output_4` AS 
(SELECT `DT_node_lookup_4`.`KEY` AS `KEY`, `DT_node_lookup_4`.node_id_2 AS node_id_2, `DT_node_data_4`.nid AS nid, `DT_node_data_4`.`Score` AS `Score` 
FROM `DT_node_lookup_4` LEFT OUTER JOIN `DT_node_data_4` ON `DT_node_lookup_4`.node_id_2 = `DT_node_data_4`.nid), 
`LGBM_Model_0_1` AS 
(SELECT `DT_Output_4`.`KEY` AS `KEY`, `DT_Output_4`.`Score` AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_4`), 
`DT_node_lookup_5` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_94 <= 0.7422130423340411) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_11 <= -0.16760702855928997) THEN 4 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_96 <= 0.0909658923333073) THEN 10 ELSE 11 END END ELSE 3 END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_5` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 3 AS nid, 0.03801363088997682 AS `Score` UNION ALL SELECT 4 AS nid, -0.02932448464318399 AS `Score` UNION ALL SELECT 10 AS nid, -0.013031594356816707 AS `Score` UNION ALL SELECT 11 AS nid, 0.03196767946224493 AS `Score`) AS `Values`), 
`DT_Output_5` AS 
(SELECT `DT_node_lookup_5`.`KEY` AS `KEY`, `DT_node_lookup_5`.node_id_2 AS node_id_2, `DT_node_data_5`.nid AS nid, `DT_node_data_5`.`Score` AS `Score` 
FROM `DT_node_lookup_5` LEFT OUTER JOIN `DT_node_data_5` ON `DT_node_lookup_5`.node_id_2 = `DT_node_data_5`.nid), 
`LGBM_Model_1_1` AS 
(SELECT `DT_Output_5`.`KEY` AS `KEY`, 0.0 AS `Score_0`, `DT_Output_5`.`Score` AS `Score_1`, 0.0 AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_5`), 
`DT_node_lookup_6` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_46 <= -0.7837116766399931) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_58 <= 1.0000000180025095e-35) THEN 6 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_85 <= -0.06705978689096498) THEN 14 ELSE 15 END END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_6` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 2 AS nid, 0.04638783591701232 AS `Score` UNION ALL SELECT 6 AS nid, 0.0034657951744659385 AS `Score` UNION ALL SELECT 14 AS nid, -0.02634969149111432 AS `Score` UNION ALL SELECT 15 AS nid, -0.033209690833556266 AS `Score`) AS `Values`), 
`DT_Output_6` AS 
(SELECT `DT_node_lookup_6`.`KEY` AS `KEY`, `DT_node_lookup_6`.node_id_2 AS node_id_2, `DT_node_data_6`.nid AS nid, `DT_node_data_6`.`Score` AS `Score` 
FROM `DT_node_lookup_6` LEFT OUTER JOIN `DT_node_data_6` ON `DT_node_lookup_6`.node_id_2 = `DT_node_data_6`.nid), 
`LGBM_Model_2_1` AS 
(SELECT `DT_Output_6`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, `DT_Output_6`.`Score` AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_6`), 
`DT_node_lookup_7` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_46 <= 0.3111670739918176) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_56 <= 0.43876687599494696) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_7 <= 0.20916239470271483) THEN 8 ELSE 9 END ELSE 5 END ELSE 3 END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_7` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 3 AS nid, 0.02675748219394763 AS `Score` UNION ALL SELECT 5 AS nid, 0.011240839547350058 AS `Score` UNION ALL SELECT 8 AS nid, -0.02634310269199366 AS `Score` UNION ALL SELECT 9 AS nid, -0.033280777876280025 AS `Score`) AS `Values`), 
`DT_Output_7` AS 
(SELECT `DT_node_lookup_7`.`KEY` AS `KEY`, `DT_node_lookup_7`.node_id_2 AS node_id_2, `DT_node_data_7`.nid AS nid, `DT_node_data_7`.`Score` AS `Score` 
FROM `DT_node_lookup_7` LEFT OUTER JOIN `DT_node_data_7` ON `DT_node_lookup_7`.node_id_2 = `DT_node_data_7`.nid), 
`LGBM_Model_3_1` AS 
(SELECT `DT_Output_7`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2`, `DT_Output_7`.`Score` AS `Score_3` 
FROM `DT_Output_7`), 
`DT_node_lookup_8` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_80 <= -0.20659892002321142) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_6 <= 0.14608860188308426) THEN 4 ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_94 <= 0.07659678856147197) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_8` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 4 AS nid, -0.03288932934129021 AS `Score` UNION ALL SELECT 5 AS nid, -0.018979159650187077 AS `Score` UNION ALL SELECT 6 AS nid, 0.04528919771027677 AS `Score` UNION ALL SELECT 7 AS nid, -0.00923136933403049 AS `Score`) AS `Values`), 
`DT_Output_8` AS 
(SELECT `DT_node_lookup_8`.`KEY` AS `KEY`, `DT_node_lookup_8`.node_id_2 AS node_id_2, `DT_node_data_8`.nid AS nid, `DT_node_data_8`.`Score` AS `Score` 
FROM `DT_node_lookup_8` LEFT OUTER JOIN `DT_node_data_8` ON `DT_node_lookup_8`.node_id_2 = `DT_node_data_8`.nid), 
`LGBM_Model_0_2` AS 
(SELECT `DT_Output_8`.`KEY` AS `KEY`, `DT_Output_8`.`Score` AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_8`), 
`DT_node_lookup_9` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_94 <= 0.7422130423340411) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_11 <= -0.16760702855928997) THEN 4 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_96 <= 0.0909658923333073) THEN 10 ELSE 11 END END ELSE 3 END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_9` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 3 AS nid, 0.03601188358369819 AS `Score` UNION ALL SELECT 4 AS nid, -0.02901065244136429 AS `Score` UNION ALL SELECT 10 AS nid, -0.012779393567827178 AS `Score` UNION ALL SELECT 11 AS nid, 0.03082650742811993 AS `Score`) AS `Values`), 
`DT_Output_9` AS 
(SELECT `DT_node_lookup_9`.`KEY` AS `KEY`, `DT_node_lookup_9`.node_id_2 AS node_id_2, `DT_node_data_9`.nid AS nid, `DT_node_data_9`.`Score` AS `Score` 
FROM `DT_node_lookup_9` LEFT OUTER JOIN `DT_node_data_9` ON `DT_node_lookup_9`.node_id_2 = `DT_node_data_9`.nid), 
`LGBM_Model_1_2` AS 
(SELECT `DT_Output_9`.`KEY` AS `KEY`, 0.0 AS `Score_0`, `DT_Output_9`.`Score` AS `Score_1`, 0.0 AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_9`)
 INSERT INTO tmp_20180602143835_6y5_lgbm_b0 (`KEY`, `Score_0`, `Score_1`, `Score_2`, `Score_3`) SELECT `LGBM_B0`.`KEY`, `LGBM_B0`.`Score_0`, `LGBM_B0`.`Score_1`, `LGBM_B0`.`Score_2`, `LGBM_B0`.`Score_3` 
FROM (SELECT `LGBM_esu_0`.`KEY` AS `KEY`, `LGBM_esu_0`.`Score_0` AS `Score_0`, `LGBM_esu_0`.`Score_1` AS `Score_1`, `LGBM_esu_0`.`Score_2` AS `Score_2`, `LGBM_esu_0`.`Score_3` AS `Score_3` 
FROM (SELECT `LGBM_Model_0_0`.`KEY` AS `KEY`, `LGBM_Model_0_0`.`Score_0` AS `Score_0`, `LGBM_Model_0_0`.`Score_1` AS `Score_1`, `LGBM_Model_0_0`.`Score_2` AS `Score_2`, `LGBM_Model_0_0`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_0_0` UNION ALL SELECT `LGBM_Model_1_0`.`KEY` AS `KEY`, `LGBM_Model_1_0`.`Score_0` AS `Score_0`, `LGBM_Model_1_0`.`Score_1` AS `Score_1`, `LGBM_Model_1_0`.`Score_2` AS `Score_2`, `LGBM_Model_1_0`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_1_0` UNION ALL SELECT `LGBM_Model_2_0`.`KEY` AS `KEY`, `LGBM_Model_2_0`.`Score_0` AS `Score_0`, `LGBM_Model_2_0`.`Score_1` AS `Score_1`, `LGBM_Model_2_0`.`Score_2` AS `Score_2`, `LGBM_Model_2_0`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_2_0` UNION ALL SELECT `LGBM_Model_3_0`.`KEY` AS `KEY`, `LGBM_Model_3_0`.`Score_0` AS `Score_0`, `LGBM_Model_3_0`.`Score_1` AS `Score_1`, `LGBM_Model_3_0`.`Score_2` AS `Score_2`, `LGBM_Model_3_0`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_3_0` UNION ALL SELECT `LGBM_Model_0_1`.`KEY` AS `KEY`, `LGBM_Model_0_1`.`Score_0` AS `Score_0`, `LGBM_Model_0_1`.`Score_1` AS `Score_1`, `LGBM_Model_0_1`.`Score_2` AS `Score_2`, `LGBM_Model_0_1`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_0_1` UNION ALL SELECT `LGBM_Model_1_1`.`KEY` AS `KEY`, `LGBM_Model_1_1`.`Score_0` AS `Score_0`, `LGBM_Model_1_1`.`Score_1` AS `Score_1`, `LGBM_Model_1_1`.`Score_2` AS `Score_2`, `LGBM_Model_1_1`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_1_1` UNION ALL SELECT `LGBM_Model_2_1`.`KEY` AS `KEY`, `LGBM_Model_2_1`.`Score_0` AS `Score_0`, `LGBM_Model_2_1`.`Score_1` AS `Score_1`, `LGBM_Model_2_1`.`Score_2` AS `Score_2`, `LGBM_Model_2_1`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_2_1` UNION ALL SELECT `LGBM_Model_3_1`.`KEY` AS `KEY`, `LGBM_Model_3_1`.`Score_0` AS `Score_0`, `LGBM_Model_3_1`.`Score_1` AS `Score_1`, `LGBM_Model_3_1`.`Score_2` AS `Score_2`, `LGBM_Model_3_1`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_3_1` UNION ALL SELECT `LGBM_Model_0_2`.`KEY` AS `KEY`, `LGBM_Model_0_2`.`Score_0` AS `Score_0`, `LGBM_Model_0_2`.`Score_1` AS `Score_1`, `LGBM_Model_0_2`.`Score_2` AS `Score_2`, `LGBM_Model_0_2`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_0_2` UNION ALL SELECT `LGBM_Model_1_2`.`KEY` AS `KEY`, `LGBM_Model_1_2`.`Score_0` AS `Score_0`, `LGBM_Model_1_2`.`Score_1` AS `Score_1`, `LGBM_Model_1_2`.`Score_2` AS `Score_2`, `LGBM_Model_1_2`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_1_2`) AS `LGBM_esu_0`) AS `LGBM_B0`

-- Code For temporary table tmp_20180602143835_sm9_lgbm_b1 part 1. Create 


CREATE TABLE tmp_20180602143835_sm9_lgbm_b1 (
	`KEY` BIGINT, 
	`Score_0` DOUBLE, 
	`Score_1` DOUBLE, 
	`Score_2` DOUBLE, 
	`Score_3` DOUBLE
)

 CACHED IN 'one_gig_pool'

-- Code For temporary table tmp_20180602143835_sm9_lgbm_b1 part 2. Populate

WITH `DT_node_lookup_10` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_46 <= -0.7837116766399931) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_21 <= -0.25420272015856016) THEN 6 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_56 <= 0.1835813454500901) THEN 14 ELSE 15 END END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_10` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 2 AS nid, 0.04392797619813257 AS `Score` UNION ALL SELECT 6 AS nid, 0.0034995312760598384 AS `Score` UNION ALL SELECT 14 AS nid, -0.025947628685301028 AS `Score` UNION ALL SELECT 15 AS nid, -0.03298520699909284 AS `Score`) AS `Values`), 
`DT_Output_10` AS 
(SELECT `DT_node_lookup_10`.`KEY` AS `KEY`, `DT_node_lookup_10`.node_id_2 AS node_id_2, `DT_node_data_10`.nid AS nid, `DT_node_data_10`.`Score` AS `Score` 
FROM `DT_node_lookup_10` LEFT OUTER JOIN `DT_node_data_10` ON `DT_node_lookup_10`.node_id_2 = `DT_node_data_10`.nid), 
`LGBM_Model_2_2` AS 
(SELECT `DT_Output_10`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, `DT_Output_10`.`Score` AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_10`), 
`DT_node_lookup_11` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_31 <= 0.36901699791788345) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_46 <= 0.06978065000800054) THEN 4 ELSE 5 END ELSE 3 END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_11` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 3 AS nid, 0.02602074371562861 AS `Score` UNION ALL SELECT 4 AS nid, -0.03282433362550692 AS `Score` UNION ALL SELECT 5 AS nid, 0.0055247378514521606 AS `Score`) AS `Values`), 
`DT_Output_11` AS 
(SELECT `DT_node_lookup_11`.`KEY` AS `KEY`, `DT_node_lookup_11`.node_id_2 AS node_id_2, `DT_node_data_11`.nid AS nid, `DT_node_data_11`.`Score` AS `Score` 
FROM `DT_node_lookup_11` LEFT OUTER JOIN `DT_node_data_11` ON `DT_node_lookup_11`.node_id_2 = `DT_node_data_11`.nid), 
`LGBM_Model_3_2` AS 
(SELECT `DT_Output_11`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2`, `DT_Output_11`.`Score` AS `Score_3` 
FROM `DT_Output_11`), 
`DT_node_lookup_12` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_80 <= -0.20659892002321142) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_30 <= 0.4060519987109669) THEN 4 ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_50 <= 1.0000000180025095e-35) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_12` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 4 AS nid, -0.03264995365787314 AS `Score` UNION ALL SELECT 5 AS nid, -0.018595830886695815 AS `Score` UNION ALL SELECT 6 AS nid, 0.050425691987455085 AS `Score` UNION ALL SELECT 7 AS nid, -0.001749296984293454 AS `Score`) AS `Values`), 
`DT_Output_12` AS 
(SELECT `DT_node_lookup_12`.`KEY` AS `KEY`, `DT_node_lookup_12`.node_id_2 AS node_id_2, `DT_node_data_12`.nid AS nid, `DT_node_data_12`.`Score` AS `Score` 
FROM `DT_node_lookup_12` LEFT OUTER JOIN `DT_node_data_12` ON `DT_node_lookup_12`.node_id_2 = `DT_node_data_12`.nid), 
`LGBM_Model_0_3` AS 
(SELECT `DT_Output_12`.`KEY` AS `KEY`, `DT_Output_12`.`Score` AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_12`), 
`DT_node_lookup_13` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_46 <= -0.227315336240404) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_90 <= -0.3502806381050438) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_13` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 2 AS nid, -0.021949004218140684 AS `Score` UNION ALL SELECT 6 AS nid, -0.0157961023443223 AS `Score` UNION ALL SELECT 7 AS nid, 0.03348313811293968 AS `Score`) AS `Values`), 
`DT_Output_13` AS 
(SELECT `DT_node_lookup_13`.`KEY` AS `KEY`, `DT_node_lookup_13`.node_id_2 AS node_id_2, `DT_node_data_13`.nid AS nid, `DT_node_data_13`.`Score` AS `Score` 
FROM `DT_node_lookup_13` LEFT OUTER JOIN `DT_node_data_13` ON `DT_node_lookup_13`.node_id_2 = `DT_node_data_13`.nid), 
`LGBM_Model_1_3` AS 
(SELECT `DT_Output_13`.`KEY` AS `KEY`, 0.0 AS `Score_0`, `DT_Output_13`.`Score` AS `Score_1`, 0.0 AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_13`), 
`DT_node_lookup_14` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_58 <= -0.22148632814087912) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_56 <= 0.20615032458101307) THEN 4 ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_97 <= 0.2681499738371736) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_14` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 4 AS nid, 0.05918926165394689 AS `Score` UNION ALL SELECT 5 AS nid, -0.013161794876484953 AS `Score` UNION ALL SELECT 6 AS nid, -0.032972000921317655 AS `Score` UNION ALL SELECT 7 AS nid, -0.00737896830596874 AS `Score`) AS `Values`), 
`DT_Output_14` AS 
(SELECT `DT_node_lookup_14`.`KEY` AS `KEY`, `DT_node_lookup_14`.node_id_2 AS node_id_2, `DT_node_data_14`.nid AS nid, `DT_node_data_14`.`Score` AS `Score` 
FROM `DT_node_lookup_14` LEFT OUTER JOIN `DT_node_data_14` ON `DT_node_lookup_14`.node_id_2 = `DT_node_data_14`.nid), 
`LGBM_Model_2_3` AS 
(SELECT `DT_Output_14`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, `DT_Output_14`.`Score` AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_14`), 
`DT_node_lookup_15` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_46 <= 0.3111670739918176) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_56 <= 0.43876687599494696) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_7 <= 0.20916239470271483) THEN 8 ELSE 9 END ELSE 5 END ELSE 3 END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_15` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 3 AS nid, 0.024883342651118974 AS `Score` UNION ALL SELECT 5 AS nid, 0.011209397650172129 AS `Score` UNION ALL SELECT 8 AS nid, -0.02574125662263579 AS `Score` UNION ALL SELECT 9 AS nid, -0.03297883402734973 AS `Score`) AS `Values`), 
`DT_Output_15` AS 
(SELECT `DT_node_lookup_15`.`KEY` AS `KEY`, `DT_node_lookup_15`.node_id_2 AS node_id_2, `DT_node_data_15`.nid AS nid, `DT_node_data_15`.`Score` AS `Score` 
FROM `DT_node_lookup_15` LEFT OUTER JOIN `DT_node_data_15` ON `DT_node_lookup_15`.node_id_2 = `DT_node_data_15`.nid), 
`LGBM_Model_3_3` AS 
(SELECT `DT_Output_15`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2`, `DT_Output_15`.`Score` AS `Score_3` 
FROM `DT_Output_15`), 
`DT_node_lookup_16` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_80 <= -0.20659892002321142) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_6 <= 0.14608860188308426) THEN 4 ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_94 <= 0.07659678856147197) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_16` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 4 AS nid, -0.032430851677658405 AS `Score` UNION ALL SELECT 5 AS nid, -0.018123846889430296 AS `Score` UNION ALL SELECT 6 AS nid, 0.04170977978319426 AS `Score` UNION ALL SELECT 7 AS nid, -0.009273140804504107 AS `Score`) AS `Values`), 
`DT_Output_16` AS 
(SELECT `DT_node_lookup_16`.`KEY` AS `KEY`, `DT_node_lookup_16`.node_id_2 AS node_id_2, `DT_node_data_16`.nid AS nid, `DT_node_data_16`.`Score` AS `Score` 
FROM `DT_node_lookup_16` LEFT OUTER JOIN `DT_node_data_16` ON `DT_node_lookup_16`.node_id_2 = `DT_node_data_16`.nid), 
`LGBM_Model_0_4` AS 
(SELECT `DT_Output_16`.`KEY` AS `KEY`, `DT_Output_16`.`Score` AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_16`), 
`DT_node_lookup_17` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_46 <= -0.227315336240404) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_90 <= -0.3502806381050438) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_17` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 2 AS nid, -0.021626484496901358 AS `Score` UNION ALL SELECT 6 AS nid, -0.015503980862153691 AS `Score` UNION ALL SELECT 7 AS nid, 0.032075414127692256 AS `Score`) AS `Values`), 
`DT_Output_17` AS 
(SELECT `DT_node_lookup_17`.`KEY` AS `KEY`, `DT_node_lookup_17`.node_id_2 AS node_id_2, `DT_node_data_17`.nid AS nid, `DT_node_data_17`.`Score` AS `Score` 
FROM `DT_node_lookup_17` LEFT OUTER JOIN `DT_node_data_17` ON `DT_node_lookup_17`.node_id_2 = `DT_node_data_17`.nid), 
`LGBM_Model_1_4` AS 
(SELECT `DT_Output_17`.`KEY` AS `KEY`, 0.0 AS `Score_0`, `DT_Output_17`.`Score` AS `Score_1`, 0.0 AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_17`), 
`DT_node_lookup_18` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_46 <= -0.49464367730743913) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_21 <= -0.5141132779893817) THEN 6 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_65 <= 1.0000000180025095e-35) THEN 14 ELSE 15 END END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_18` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 2 AS nid, 0.03421543959311732 AS `Score` UNION ALL SELECT 6 AS nid, 0.00487014039315363 AS `Score` UNION ALL SELECT 14 AS nid, -0.03268338788831202 AS `Score` UNION ALL SELECT 15 AS nid, -0.025388920964320674 AS `Score`) AS `Values`), 
`DT_Output_18` AS 
(SELECT `DT_node_lookup_18`.`KEY` AS `KEY`, `DT_node_lookup_18`.node_id_2 AS node_id_2, `DT_node_data_18`.nid AS nid, `DT_node_data_18`.`Score` AS `Score` 
FROM `DT_node_lookup_18` LEFT OUTER JOIN `DT_node_data_18` ON `DT_node_lookup_18`.node_id_2 = `DT_node_data_18`.nid), 
`LGBM_Model_2_4` AS 
(SELECT `DT_Output_18`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, `DT_Output_18`.`Score` AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_18`), 
`DT_node_lookup_19` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_31 <= 0.36901699791788345) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_46 <= 0.06978065000800054) THEN 4 ELSE 5 END ELSE 3 END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_19` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 3 AS nid, 0.024617499910754504 AS `Score` UNION ALL SELECT 4 AS nid, -0.032396812397344085 AS `Score` UNION ALL SELECT 5 AS nid, 0.005050332513611498 AS `Score`) AS `Values`), 
`DT_Output_19` AS 
(SELECT `DT_node_lookup_19`.`KEY` AS `KEY`, `DT_node_lookup_19`.node_id_2 AS node_id_2, `DT_node_data_19`.nid AS nid, `DT_node_data_19`.`Score` AS `Score` 
FROM `DT_node_lookup_19` LEFT OUTER JOIN `DT_node_data_19` ON `DT_node_lookup_19`.node_id_2 = `DT_node_data_19`.nid), 
`LGBM_Model_3_4` AS 
(SELECT `DT_Output_19`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2`, `DT_Output_19`.`Score` AS `Score_3` 
FROM `DT_Output_19`)
 INSERT INTO tmp_20180602143835_sm9_lgbm_b1 (`KEY`, `Score_0`, `Score_1`, `Score_2`, `Score_3`) SELECT `LGBM_B1`.`KEY`, `LGBM_B1`.`Score_0`, `LGBM_B1`.`Score_1`, `LGBM_B1`.`Score_2`, `LGBM_B1`.`Score_3` 
FROM (SELECT `LGBM_esu_1`.`KEY` AS `KEY`, `LGBM_esu_1`.`Score_0` AS `Score_0`, `LGBM_esu_1`.`Score_1` AS `Score_1`, `LGBM_esu_1`.`Score_2` AS `Score_2`, `LGBM_esu_1`.`Score_3` AS `Score_3` 
FROM (SELECT `LGBM_Model_2_2`.`KEY` AS `KEY`, `LGBM_Model_2_2`.`Score_0` AS `Score_0`, `LGBM_Model_2_2`.`Score_1` AS `Score_1`, `LGBM_Model_2_2`.`Score_2` AS `Score_2`, `LGBM_Model_2_2`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_2_2` UNION ALL SELECT `LGBM_Model_3_2`.`KEY` AS `KEY`, `LGBM_Model_3_2`.`Score_0` AS `Score_0`, `LGBM_Model_3_2`.`Score_1` AS `Score_1`, `LGBM_Model_3_2`.`Score_2` AS `Score_2`, `LGBM_Model_3_2`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_3_2` UNION ALL SELECT `LGBM_Model_0_3`.`KEY` AS `KEY`, `LGBM_Model_0_3`.`Score_0` AS `Score_0`, `LGBM_Model_0_3`.`Score_1` AS `Score_1`, `LGBM_Model_0_3`.`Score_2` AS `Score_2`, `LGBM_Model_0_3`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_0_3` UNION ALL SELECT `LGBM_Model_1_3`.`KEY` AS `KEY`, `LGBM_Model_1_3`.`Score_0` AS `Score_0`, `LGBM_Model_1_3`.`Score_1` AS `Score_1`, `LGBM_Model_1_3`.`Score_2` AS `Score_2`, `LGBM_Model_1_3`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_1_3` UNION ALL SELECT `LGBM_Model_2_3`.`KEY` AS `KEY`, `LGBM_Model_2_3`.`Score_0` AS `Score_0`, `LGBM_Model_2_3`.`Score_1` AS `Score_1`, `LGBM_Model_2_3`.`Score_2` AS `Score_2`, `LGBM_Model_2_3`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_2_3` UNION ALL SELECT `LGBM_Model_3_3`.`KEY` AS `KEY`, `LGBM_Model_3_3`.`Score_0` AS `Score_0`, `LGBM_Model_3_3`.`Score_1` AS `Score_1`, `LGBM_Model_3_3`.`Score_2` AS `Score_2`, `LGBM_Model_3_3`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_3_3` UNION ALL SELECT `LGBM_Model_0_4`.`KEY` AS `KEY`, `LGBM_Model_0_4`.`Score_0` AS `Score_0`, `LGBM_Model_0_4`.`Score_1` AS `Score_1`, `LGBM_Model_0_4`.`Score_2` AS `Score_2`, `LGBM_Model_0_4`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_0_4` UNION ALL SELECT `LGBM_Model_1_4`.`KEY` AS `KEY`, `LGBM_Model_1_4`.`Score_0` AS `Score_0`, `LGBM_Model_1_4`.`Score_1` AS `Score_1`, `LGBM_Model_1_4`.`Score_2` AS `Score_2`, `LGBM_Model_1_4`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_1_4` UNION ALL SELECT `LGBM_Model_2_4`.`KEY` AS `KEY`, `LGBM_Model_2_4`.`Score_0` AS `Score_0`, `LGBM_Model_2_4`.`Score_1` AS `Score_1`, `LGBM_Model_2_4`.`Score_2` AS `Score_2`, `LGBM_Model_2_4`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_2_4` UNION ALL SELECT `LGBM_Model_3_4`.`KEY` AS `KEY`, `LGBM_Model_3_4`.`Score_0` AS `Score_0`, `LGBM_Model_3_4`.`Score_1` AS `Score_1`, `LGBM_Model_3_4`.`Score_2` AS `Score_2`, `LGBM_Model_3_4`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_3_4`) AS `LGBM_esu_1`) AS `LGBM_B1`

-- Code For temporary table tmp_20180602143835_k8n_lgbm_b2 part 1. Create 


CREATE TABLE tmp_20180602143835_k8n_lgbm_b2 (
	`KEY` BIGINT, 
	`Score_0` DOUBLE, 
	`Score_1` DOUBLE, 
	`Score_2` DOUBLE, 
	`Score_3` DOUBLE
)

 CACHED IN 'one_gig_pool'

-- Code For temporary table tmp_20180602143835_k8n_lgbm_b2 part 2. Populate

WITH `DT_node_lookup_20` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_80 <= -0.20659892002321142) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_81 <= -0.19852706625085706) THEN 4 ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_35 <= -0.19856138664745998) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_20` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 4 AS nid, -0.01775222720740029 AS `Score` UNION ALL SELECT 5 AS nid, -0.03221277551225128 AS `Score` UNION ALL SELECT 6 AS nid, 0.04694754208658461 AS `Score` UNION ALL SELECT 7 AS nid, -0.0026131372933433754 AS `Score`) AS `Values`), 
`DT_Output_20` AS 
(SELECT `DT_node_lookup_20`.`KEY` AS `KEY`, `DT_node_lookup_20`.node_id_2 AS node_id_2, `DT_node_data_20`.nid AS nid, `DT_node_data_20`.`Score` AS `Score` 
FROM `DT_node_lookup_20` LEFT OUTER JOIN `DT_node_data_20` ON `DT_node_lookup_20`.node_id_2 = `DT_node_data_20`.nid), 
`LGBM_Model_0_5` AS 
(SELECT `DT_Output_20`.`KEY` AS `KEY`, `DT_Output_20`.`Score` AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_20`), 
`DT_node_lookup_21` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_50 <= -0.20437877954345876) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_90 <= -0.3502806381050438) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_21` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 2 AS nid, -0.019702425673491817 AS `Score` UNION ALL SELECT 6 AS nid, -0.016999640407648977 AS `Score` UNION ALL SELECT 7 AS nid, 0.04084800650737508 AS `Score`) AS `Values`), 
`DT_Output_21` AS 
(SELECT `DT_node_lookup_21`.`KEY` AS `KEY`, `DT_node_lookup_21`.node_id_2 AS node_id_2, `DT_node_data_21`.nid AS nid, `DT_node_data_21`.`Score` AS `Score` 
FROM `DT_node_lookup_21` LEFT OUTER JOIN `DT_node_data_21` ON `DT_node_lookup_21`.node_id_2 = `DT_node_data_21`.nid), 
`LGBM_Model_1_5` AS 
(SELECT `DT_Output_21`.`KEY` AS `KEY`, 0.0 AS `Score_0`, `DT_Output_21`.`Score` AS `Score_1`, 0.0 AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_21`), 
`DT_node_lookup_22` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_58 <= -0.22148632814087912) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_56 <= 0.20615032458101307) THEN 4 ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_97 <= 0.2681499738371736) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_22` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 4 AS nid, 0.054354714566359146 AS `Score` UNION ALL SELECT 5 AS nid, -0.012728726983595277 AS `Score` UNION ALL SELECT 6 AS nid, -0.032577907328825005 AS `Score` UNION ALL SELECT 7 AS nid, -0.00712695224663154 AS `Score`) AS `Values`), 
`DT_Output_22` AS 
(SELECT `DT_node_lookup_22`.`KEY` AS `KEY`, `DT_node_lookup_22`.node_id_2 AS node_id_2, `DT_node_data_22`.nid AS nid, `DT_node_data_22`.`Score` AS `Score` 
FROM `DT_node_lookup_22` LEFT OUTER JOIN `DT_node_data_22` ON `DT_node_lookup_22`.node_id_2 = `DT_node_data_22`.nid), 
`LGBM_Model_2_5` AS 
(SELECT `DT_Output_22`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, `DT_Output_22`.`Score` AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_22`), 
`DT_node_lookup_23` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_101 <= 1.0000000180025095e-35) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_21 <= -0.3420785268148518) THEN 4 ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_2 <= 0.21817166411542668) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_23` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 4 AS nid, -0.01541499384979074 AS `Score` UNION ALL SELECT 5 AS nid, 0.04875831694517585 AS `Score` UNION ALL SELECT 6 AS nid, -0.03329191878814407 AS `Score` UNION ALL SELECT 7 AS nid, 0.0008424509870639216 AS `Score`) AS `Values`), 
`DT_Output_23` AS 
(SELECT `DT_node_lookup_23`.`KEY` AS `KEY`, `DT_node_lookup_23`.node_id_2 AS node_id_2, `DT_node_data_23`.nid AS nid, `DT_node_data_23`.`Score` AS `Score` 
FROM `DT_node_lookup_23` LEFT OUTER JOIN `DT_node_data_23` ON `DT_node_lookup_23`.node_id_2 = `DT_node_data_23`.nid), 
`LGBM_Model_3_5` AS 
(SELECT `DT_Output_23`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2`, `DT_Output_23`.`Score` AS `Score_3` 
FROM `DT_Output_23`), 
`DT_node_lookup_24` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_80 <= -0.20659892002321142) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_6 <= 0.14608860188308426) THEN 4 ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_50 <= -0.12128768947636989) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_24` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 4 AS nid, -0.032003459482789993 AS `Score` UNION ALL SELECT 5 AS nid, -0.017356620302595844 AS `Score` UNION ALL SELECT 6 AS nid, 0.04770528095183903 AS `Score` UNION ALL SELECT 7 AS nid, -0.0006797085272083525 AS `Score`) AS `Values`), 
`DT_Output_24` AS 
(SELECT `DT_node_lookup_24`.`KEY` AS `KEY`, `DT_node_lookup_24`.node_id_2 AS node_id_2, `DT_node_data_24`.nid AS nid, `DT_node_data_24`.`Score` AS `Score` 
FROM `DT_node_lookup_24` LEFT OUTER JOIN `DT_node_data_24` ON `DT_node_lookup_24`.node_id_2 = `DT_node_data_24`.nid), 
`LGBM_Model_0_6` AS 
(SELECT `DT_Output_24`.`KEY` AS `KEY`, `DT_Output_24`.`Score` AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_24`), 
`DT_node_lookup_25` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_50 <= -0.20437877954345876) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_90 <= -0.3502806381050438) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_25` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 2 AS nid, -0.019371272894301267 AS `Score` UNION ALL SELECT 6 AS nid, -0.016721247478611947 AS `Score` UNION ALL SELECT 7 AS nid, 0.03899686638528799 AS `Score`) AS `Values`), 
`DT_Output_25` AS 
(SELECT `DT_node_lookup_25`.`KEY` AS `KEY`, `DT_node_lookup_25`.node_id_2 AS node_id_2, `DT_node_data_25`.nid AS nid, `DT_node_data_25`.`Score` AS `Score` 
FROM `DT_node_lookup_25` LEFT OUTER JOIN `DT_node_data_25` ON `DT_node_lookup_25`.node_id_2 = `DT_node_data_25`.nid), 
`LGBM_Model_1_6` AS 
(SELECT `DT_Output_25`.`KEY` AS `KEY`, 0.0 AS `Score_0`, `DT_Output_25`.`Score` AS `Score_1`, 0.0 AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_25`), 
`DT_node_lookup_26` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_58 <= -0.22148632814087912) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_56 <= 0.20615032458101307) THEN 4 ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_72 <= 0.23247911005260363) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_26` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 4 AS nid, 0.05149522314283292 AS `Score` UNION ALL SELECT 5 AS nid, -0.012504544603488288 AS `Score` UNION ALL SELECT 6 AS nid, -0.032328547542213336 AS `Score` UNION ALL SELECT 7 AS nid, -0.006774197240865256 AS `Score`) AS `Values`), 
`DT_Output_26` AS 
(SELECT `DT_node_lookup_26`.`KEY` AS `KEY`, `DT_node_lookup_26`.node_id_2 AS node_id_2, `DT_node_data_26`.nid AS nid, `DT_node_data_26`.`Score` AS `Score` 
FROM `DT_node_lookup_26` LEFT OUTER JOIN `DT_node_data_26` ON `DT_node_lookup_26`.node_id_2 = `DT_node_data_26`.nid), 
`LGBM_Model_2_6` AS 
(SELECT `DT_Output_26`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, `DT_Output_26`.`Score` AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_26`), 
`DT_node_lookup_27` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_31 <= 0.36901699791788345) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_46 <= 0.06978065000800054) THEN 4 ELSE 5 END ELSE 3 END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_27` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 3 AS nid, 0.023376036454596696 AS `Score` UNION ALL SELECT 4 AS nid, -0.03207537004744958 AS `Score` UNION ALL SELECT 5 AS nid, 0.004883438224411979 AS `Score`) AS `Values`), 
`DT_Output_27` AS 
(SELECT `DT_node_lookup_27`.`KEY` AS `KEY`, `DT_node_lookup_27`.node_id_2 AS node_id_2, `DT_node_data_27`.nid AS nid, `DT_node_data_27`.`Score` AS `Score` 
FROM `DT_node_lookup_27` LEFT OUTER JOIN `DT_node_data_27` ON `DT_node_lookup_27`.node_id_2 = `DT_node_data_27`.nid), 
`LGBM_Model_3_6` AS 
(SELECT `DT_Output_27`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2`, `DT_Output_27`.`Score` AS `Score_3` 
FROM `DT_Output_27`), 
`DT_node_lookup_28` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_80 <= -0.20659892002321142) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_8 <= 0.15851073706032173) THEN 4 ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_94 <= 0.07659678856147197) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_28` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 4 AS nid, -0.03181411183123618 AS `Score` UNION ALL SELECT 5 AS nid, -0.016933666524256135 AS `Score` UNION ALL SELECT 6 AS nid, 0.03772860917958193 AS `Score` UNION ALL SELECT 7 AS nid, -0.009573319152340823 AS `Score`) AS `Values`), 
`DT_Output_28` AS 
(SELECT `DT_node_lookup_28`.`KEY` AS `KEY`, `DT_node_lookup_28`.node_id_2 AS node_id_2, `DT_node_data_28`.nid AS nid, `DT_node_data_28`.`Score` AS `Score` 
FROM `DT_node_lookup_28` LEFT OUTER JOIN `DT_node_data_28` ON `DT_node_lookup_28`.node_id_2 = `DT_node_data_28`.nid), 
`LGBM_Model_0_7` AS 
(SELECT `DT_Output_28`.`KEY` AS `KEY`, `DT_Output_28`.`Score` AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_28`), 
`DT_node_lookup_29` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_46 <= -0.227315336240404) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_66 <= -0.16160014838154277) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_29` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 2 AS nid, -0.02120590996883151 AS `Score` UNION ALL SELECT 6 AS nid, -0.010137523496834167 AS `Score` UNION ALL SELECT 7 AS nid, 0.03392735655650109 AS `Score`) AS `Values`), 
`DT_Output_29` AS 
(SELECT `DT_node_lookup_29`.`KEY` AS `KEY`, `DT_node_lookup_29`.node_id_2 AS node_id_2, `DT_node_data_29`.nid AS nid, `DT_node_data_29`.`Score` AS `Score` 
FROM `DT_node_lookup_29` LEFT OUTER JOIN `DT_node_data_29` ON `DT_node_lookup_29`.node_id_2 = `DT_node_data_29`.nid), 
`LGBM_Model_1_7` AS 
(SELECT `DT_Output_29`.`KEY` AS `KEY`, 0.0 AS `Score_0`, `DT_Output_29`.`Score` AS `Score_1`, 0.0 AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_29`)
 INSERT INTO tmp_20180602143835_k8n_lgbm_b2 (`KEY`, `Score_0`, `Score_1`, `Score_2`, `Score_3`) SELECT `LGBM_B2`.`KEY`, `LGBM_B2`.`Score_0`, `LGBM_B2`.`Score_1`, `LGBM_B2`.`Score_2`, `LGBM_B2`.`Score_3` 
FROM (SELECT `LGBM_esu_2`.`KEY` AS `KEY`, `LGBM_esu_2`.`Score_0` AS `Score_0`, `LGBM_esu_2`.`Score_1` AS `Score_1`, `LGBM_esu_2`.`Score_2` AS `Score_2`, `LGBM_esu_2`.`Score_3` AS `Score_3` 
FROM (SELECT `LGBM_Model_0_5`.`KEY` AS `KEY`, `LGBM_Model_0_5`.`Score_0` AS `Score_0`, `LGBM_Model_0_5`.`Score_1` AS `Score_1`, `LGBM_Model_0_5`.`Score_2` AS `Score_2`, `LGBM_Model_0_5`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_0_5` UNION ALL SELECT `LGBM_Model_1_5`.`KEY` AS `KEY`, `LGBM_Model_1_5`.`Score_0` AS `Score_0`, `LGBM_Model_1_5`.`Score_1` AS `Score_1`, `LGBM_Model_1_5`.`Score_2` AS `Score_2`, `LGBM_Model_1_5`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_1_5` UNION ALL SELECT `LGBM_Model_2_5`.`KEY` AS `KEY`, `LGBM_Model_2_5`.`Score_0` AS `Score_0`, `LGBM_Model_2_5`.`Score_1` AS `Score_1`, `LGBM_Model_2_5`.`Score_2` AS `Score_2`, `LGBM_Model_2_5`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_2_5` UNION ALL SELECT `LGBM_Model_3_5`.`KEY` AS `KEY`, `LGBM_Model_3_5`.`Score_0` AS `Score_0`, `LGBM_Model_3_5`.`Score_1` AS `Score_1`, `LGBM_Model_3_5`.`Score_2` AS `Score_2`, `LGBM_Model_3_5`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_3_5` UNION ALL SELECT `LGBM_Model_0_6`.`KEY` AS `KEY`, `LGBM_Model_0_6`.`Score_0` AS `Score_0`, `LGBM_Model_0_6`.`Score_1` AS `Score_1`, `LGBM_Model_0_6`.`Score_2` AS `Score_2`, `LGBM_Model_0_6`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_0_6` UNION ALL SELECT `LGBM_Model_1_6`.`KEY` AS `KEY`, `LGBM_Model_1_6`.`Score_0` AS `Score_0`, `LGBM_Model_1_6`.`Score_1` AS `Score_1`, `LGBM_Model_1_6`.`Score_2` AS `Score_2`, `LGBM_Model_1_6`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_1_6` UNION ALL SELECT `LGBM_Model_2_6`.`KEY` AS `KEY`, `LGBM_Model_2_6`.`Score_0` AS `Score_0`, `LGBM_Model_2_6`.`Score_1` AS `Score_1`, `LGBM_Model_2_6`.`Score_2` AS `Score_2`, `LGBM_Model_2_6`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_2_6` UNION ALL SELECT `LGBM_Model_3_6`.`KEY` AS `KEY`, `LGBM_Model_3_6`.`Score_0` AS `Score_0`, `LGBM_Model_3_6`.`Score_1` AS `Score_1`, `LGBM_Model_3_6`.`Score_2` AS `Score_2`, `LGBM_Model_3_6`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_3_6` UNION ALL SELECT `LGBM_Model_0_7`.`KEY` AS `KEY`, `LGBM_Model_0_7`.`Score_0` AS `Score_0`, `LGBM_Model_0_7`.`Score_1` AS `Score_1`, `LGBM_Model_0_7`.`Score_2` AS `Score_2`, `LGBM_Model_0_7`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_0_7` UNION ALL SELECT `LGBM_Model_1_7`.`KEY` AS `KEY`, `LGBM_Model_1_7`.`Score_0` AS `Score_0`, `LGBM_Model_1_7`.`Score_1` AS `Score_1`, `LGBM_Model_1_7`.`Score_2` AS `Score_2`, `LGBM_Model_1_7`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_1_7`) AS `LGBM_esu_2`) AS `LGBM_B2`

-- Code For temporary table tmp_20180602143835_cns_lgbm_b3 part 1. Create 


CREATE TABLE tmp_20180602143835_cns_lgbm_b3 (
	`KEY` BIGINT, 
	`Score_0` DOUBLE, 
	`Score_1` DOUBLE, 
	`Score_2` DOUBLE, 
	`Score_3` DOUBLE
)

 CACHED IN 'one_gig_pool'

-- Code For temporary table tmp_20180602143835_cns_lgbm_b3 part 2. Populate

WITH `DT_node_lookup_30` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_58 <= -0.22148632814087912) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_56 <= 0.20615032458101307) THEN 4 ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_97 <= 0.2681499738371736) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_30` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 4 AS nid, 0.049041201469898654 AS `Score` UNION ALL SELECT 5 AS nid, -0.012216631427201374 AS `Score` UNION ALL SELECT 6 AS nid, -0.03208452504859873 AS `Score` UNION ALL SELECT 7 AS nid, -0.006682050585242594 AS `Score`) AS `Values`), 
`DT_Output_30` AS 
(SELECT `DT_node_lookup_30`.`KEY` AS `KEY`, `DT_node_lookup_30`.node_id_2 AS node_id_2, `DT_node_data_30`.nid AS nid, `DT_node_data_30`.`Score` AS `Score` 
FROM `DT_node_lookup_30` LEFT OUTER JOIN `DT_node_data_30` ON `DT_node_lookup_30`.node_id_2 = `DT_node_data_30`.nid), 
`LGBM_Model_2_7` AS 
(SELECT `DT_Output_30`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, `DT_Output_30`.`Score` AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_30`), 
`DT_node_lookup_31` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_101 <= 1.0000000180025095e-35) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_21 <= -0.3420785268148518) THEN 4 ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_2 <= 0.21817166411542668) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_31` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 4 AS nid, -0.015126519234631425 AS `Score` UNION ALL SELECT 5 AS nid, 0.04550586119432775 AS `Score` UNION ALL SELECT 6 AS nid, -0.03294298315599817 AS `Score` UNION ALL SELECT 7 AS nid, 0.0009464242182587762 AS `Score`) AS `Values`), 
`DT_Output_31` AS 
(SELECT `DT_node_lookup_31`.`KEY` AS `KEY`, `DT_node_lookup_31`.node_id_2 AS node_id_2, `DT_node_data_31`.nid AS nid, `DT_node_data_31`.`Score` AS `Score` 
FROM `DT_node_lookup_31` LEFT OUTER JOIN `DT_node_data_31` ON `DT_node_lookup_31`.node_id_2 = `DT_node_data_31`.nid), 
`LGBM_Model_3_7` AS 
(SELECT `DT_Output_31`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2`, `DT_Output_31`.`Score` AS `Score_3` 
FROM `DT_Output_31`), 
`DT_node_lookup_32` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_80 <= -0.20659892002321142) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_2 <= 0.18396981255684525) THEN 4 ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_35 <= -0.19856138664745998) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_32` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 4 AS nid, -0.03159959372480136 AS `Score` UNION ALL SELECT 5 AS nid, -0.01654230089557483 AS `Score` UNION ALL SELECT 6 AS nid, 0.04238156603142348 AS `Score` UNION ALL SELECT 7 AS nid, -0.0032544268823302826 AS `Score`) AS `Values`), 
`DT_Output_32` AS 
(SELECT `DT_node_lookup_32`.`KEY` AS `KEY`, `DT_node_lookup_32`.node_id_2 AS node_id_2, `DT_node_data_32`.nid AS nid, `DT_node_data_32`.`Score` AS `Score` 
FROM `DT_node_lookup_32` LEFT OUTER JOIN `DT_node_data_32` ON `DT_node_lookup_32`.node_id_2 = `DT_node_data_32`.nid), 
`LGBM_Model_0_8` AS 
(SELECT `DT_Output_32`.`KEY` AS `KEY`, `DT_Output_32`.`Score` AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_32`), 
`DT_node_lookup_33` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_46 <= -0.227315336240404) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_66 <= -0.16160014838154277) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_33` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 2 AS nid, -0.020853887712922344 AS `Score` UNION ALL SELECT 6 AS nid, -0.009952491556638608 AS `Score` UNION ALL SELECT 7 AS nid, 0.03242662126086929 AS `Score`) AS `Values`), 
`DT_Output_33` AS 
(SELECT `DT_node_lookup_33`.`KEY` AS `KEY`, `DT_node_lookup_33`.node_id_2 AS node_id_2, `DT_node_data_33`.nid AS nid, `DT_node_data_33`.`Score` AS `Score` 
FROM `DT_node_lookup_33` LEFT OUTER JOIN `DT_node_data_33` ON `DT_node_lookup_33`.node_id_2 = `DT_node_data_33`.nid), 
`LGBM_Model_1_8` AS 
(SELECT `DT_Output_33`.`KEY` AS `KEY`, 0.0 AS `Score_0`, `DT_Output_33`.`Score` AS `Score_1`, 0.0 AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_33`), 
`DT_node_lookup_34` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_46 <= -0.49464367730743913) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_21 <= -0.5141132779893817) THEN 6 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_26 <= -0.15329324850824405) THEN 14 ELSE 15 END END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_34` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 2 AS nid, 0.030120644069081312 AS `Score` UNION ALL SELECT 6 AS nid, 0.0055838147715844035 AS `Score` UNION ALL SELECT 14 AS nid, -0.02433246104415448 AS `Score` UNION ALL SELECT 15 AS nid, -0.032351120287786805 AS `Score`) AS `Values`), 
`DT_Output_34` AS 
(SELECT `DT_node_lookup_34`.`KEY` AS `KEY`, `DT_node_lookup_34`.node_id_2 AS node_id_2, `DT_node_data_34`.nid AS nid, `DT_node_data_34`.`Score` AS `Score` 
FROM `DT_node_lookup_34` LEFT OUTER JOIN `DT_node_data_34` ON `DT_node_lookup_34`.node_id_2 = `DT_node_data_34`.nid), 
`LGBM_Model_2_8` AS 
(SELECT `DT_Output_34`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, `DT_Output_34`.`Score` AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_34`), 
`DT_node_lookup_35` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_31 <= 0.36901699791788345) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_46 <= 0.06978065000800054) THEN 4 ELSE 5 END ELSE 3 END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_35` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 3 AS nid, 0.02230557425093129 AS `Score` UNION ALL SELECT 4 AS nid, -0.03178711507999351 AS `Score` UNION ALL SELECT 5 AS nid, 0.00471309946423601 AS `Score`) AS `Values`), 
`DT_Output_35` AS 
(SELECT `DT_node_lookup_35`.`KEY` AS `KEY`, `DT_node_lookup_35`.node_id_2 AS node_id_2, `DT_node_data_35`.nid AS nid, `DT_node_data_35`.`Score` AS `Score` 
FROM `DT_node_lookup_35` LEFT OUTER JOIN `DT_node_data_35` ON `DT_node_lookup_35`.node_id_2 = `DT_node_data_35`.nid), 
`LGBM_Model_3_8` AS 
(SELECT `DT_Output_35`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2`, `DT_Output_35`.`Score` AS `Score_3` 
FROM `DT_Output_35`), 
`DT_node_lookup_36` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_80 <= -0.20659892002321142) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_8 <= 0.15851073706032173) THEN 4 ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_66 <= -0.16160014838154277) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_36` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 4 AS nid, -0.031419953156448625 AS `Score` UNION ALL SELECT 5 AS nid, -0.016160339201189446 AS `Score` UNION ALL SELECT 6 AS nid, 0.0407848697202845 AS `Score` UNION ALL SELECT 7 AS nid, -0.0033154890000054605 AS `Score`) AS `Values`), 
`DT_Output_36` AS 
(SELECT `DT_node_lookup_36`.`KEY` AS `KEY`, `DT_node_lookup_36`.node_id_2 AS node_id_2, `DT_node_data_36`.nid AS nid, `DT_node_data_36`.`Score` AS `Score` 
FROM `DT_node_lookup_36` LEFT OUTER JOIN `DT_node_data_36` ON `DT_node_lookup_36`.node_id_2 = `DT_node_data_36`.nid), 
`LGBM_Model_0_9` AS 
(SELECT `DT_Output_36`.`KEY` AS `KEY`, `DT_Output_36`.`Score` AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_36`), 
`DT_node_lookup_37` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_50 <= -0.20437877954345876) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_90 <= -0.3502806381050438) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_37` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 2 AS nid, -0.01886606867743569 AS `Score` UNION ALL SELECT 6 AS nid, -0.016543330666217416 AS `Score` UNION ALL SELECT 7 AS nid, 0.03670950125929424 AS `Score`) AS `Values`), 
`DT_Output_37` AS 
(SELECT `DT_node_lookup_37`.`KEY` AS `KEY`, `DT_node_lookup_37`.node_id_2 AS node_id_2, `DT_node_data_37`.nid AS nid, `DT_node_data_37`.`Score` AS `Score` 
FROM `DT_node_lookup_37` LEFT OUTER JOIN `DT_node_data_37` ON `DT_node_lookup_37`.node_id_2 = `DT_node_data_37`.nid), 
`LGBM_Model_1_9` AS 
(SELECT `DT_Output_37`.`KEY` AS `KEY`, 0.0 AS `Score_0`, `DT_Output_37`.`Score` AS `Score_1`, 0.0 AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_37`), 
`DT_node_lookup_38` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_58 <= -0.22148632814087912) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_56 <= 0.20615032458101307) THEN 4 ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_72 <= 0.23247911005260363) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_38` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 4 AS nid, 0.04558233201544677 AS `Score` UNION ALL SELECT 5 AS nid, -0.011852613171158027 AS `Score` UNION ALL SELECT 6 AS nid, -0.03177444071856066 AS `Score` UNION ALL SELECT 7 AS nid, -0.006245418426760709 AS `Score`) AS `Values`), 
`DT_Output_38` AS 
(SELECT `DT_node_lookup_38`.`KEY` AS `KEY`, `DT_node_lookup_38`.node_id_2 AS node_id_2, `DT_node_data_38`.nid AS nid, `DT_node_data_38`.`Score` AS `Score` 
FROM `DT_node_lookup_38` LEFT OUTER JOIN `DT_node_data_38` ON `DT_node_lookup_38`.node_id_2 = `DT_node_data_38`.nid), 
`LGBM_Model_2_9` AS 
(SELECT `DT_Output_38`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, `DT_Output_38`.`Score` AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_38`), 
`DT_node_lookup_39` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_101 <= 1.0000000180025095e-35) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_46 <= 0.17601081361933138) THEN 4 ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_2 <= 0.21817166411542668) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_39` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 4 AS nid, -0.011621861430621161 AS `Score` UNION ALL SELECT 5 AS nid, 0.046614583679068414 AS `Score` UNION ALL SELECT 6 AS nid, -0.032699323902063655 AS `Score` UNION ALL SELECT 7 AS nid, 0.0011222275259279407 AS `Score`) AS `Values`), 
`DT_Output_39` AS 
(SELECT `DT_node_lookup_39`.`KEY` AS `KEY`, `DT_node_lookup_39`.node_id_2 AS node_id_2, `DT_node_data_39`.nid AS nid, `DT_node_data_39`.`Score` AS `Score` 
FROM `DT_node_lookup_39` LEFT OUTER JOIN `DT_node_data_39` ON `DT_node_lookup_39`.node_id_2 = `DT_node_data_39`.nid), 
`LGBM_Model_3_9` AS 
(SELECT `DT_Output_39`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2`, `DT_Output_39`.`Score` AS `Score_3` 
FROM `DT_Output_39`)
 INSERT INTO tmp_20180602143835_cns_lgbm_b3 (`KEY`, `Score_0`, `Score_1`, `Score_2`, `Score_3`) SELECT `LGBM_B3`.`KEY`, `LGBM_B3`.`Score_0`, `LGBM_B3`.`Score_1`, `LGBM_B3`.`Score_2`, `LGBM_B3`.`Score_3` 
FROM (SELECT `LGBM_esu_3`.`KEY` AS `KEY`, `LGBM_esu_3`.`Score_0` AS `Score_0`, `LGBM_esu_3`.`Score_1` AS `Score_1`, `LGBM_esu_3`.`Score_2` AS `Score_2`, `LGBM_esu_3`.`Score_3` AS `Score_3` 
FROM (SELECT `LGBM_Model_2_7`.`KEY` AS `KEY`, `LGBM_Model_2_7`.`Score_0` AS `Score_0`, `LGBM_Model_2_7`.`Score_1` AS `Score_1`, `LGBM_Model_2_7`.`Score_2` AS `Score_2`, `LGBM_Model_2_7`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_2_7` UNION ALL SELECT `LGBM_Model_3_7`.`KEY` AS `KEY`, `LGBM_Model_3_7`.`Score_0` AS `Score_0`, `LGBM_Model_3_7`.`Score_1` AS `Score_1`, `LGBM_Model_3_7`.`Score_2` AS `Score_2`, `LGBM_Model_3_7`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_3_7` UNION ALL SELECT `LGBM_Model_0_8`.`KEY` AS `KEY`, `LGBM_Model_0_8`.`Score_0` AS `Score_0`, `LGBM_Model_0_8`.`Score_1` AS `Score_1`, `LGBM_Model_0_8`.`Score_2` AS `Score_2`, `LGBM_Model_0_8`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_0_8` UNION ALL SELECT `LGBM_Model_1_8`.`KEY` AS `KEY`, `LGBM_Model_1_8`.`Score_0` AS `Score_0`, `LGBM_Model_1_8`.`Score_1` AS `Score_1`, `LGBM_Model_1_8`.`Score_2` AS `Score_2`, `LGBM_Model_1_8`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_1_8` UNION ALL SELECT `LGBM_Model_2_8`.`KEY` AS `KEY`, `LGBM_Model_2_8`.`Score_0` AS `Score_0`, `LGBM_Model_2_8`.`Score_1` AS `Score_1`, `LGBM_Model_2_8`.`Score_2` AS `Score_2`, `LGBM_Model_2_8`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_2_8` UNION ALL SELECT `LGBM_Model_3_8`.`KEY` AS `KEY`, `LGBM_Model_3_8`.`Score_0` AS `Score_0`, `LGBM_Model_3_8`.`Score_1` AS `Score_1`, `LGBM_Model_3_8`.`Score_2` AS `Score_2`, `LGBM_Model_3_8`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_3_8` UNION ALL SELECT `LGBM_Model_0_9`.`KEY` AS `KEY`, `LGBM_Model_0_9`.`Score_0` AS `Score_0`, `LGBM_Model_0_9`.`Score_1` AS `Score_1`, `LGBM_Model_0_9`.`Score_2` AS `Score_2`, `LGBM_Model_0_9`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_0_9` UNION ALL SELECT `LGBM_Model_1_9`.`KEY` AS `KEY`, `LGBM_Model_1_9`.`Score_0` AS `Score_0`, `LGBM_Model_1_9`.`Score_1` AS `Score_1`, `LGBM_Model_1_9`.`Score_2` AS `Score_2`, `LGBM_Model_1_9`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_1_9` UNION ALL SELECT `LGBM_Model_2_9`.`KEY` AS `KEY`, `LGBM_Model_2_9`.`Score_0` AS `Score_0`, `LGBM_Model_2_9`.`Score_1` AS `Score_1`, `LGBM_Model_2_9`.`Score_2` AS `Score_2`, `LGBM_Model_2_9`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_2_9` UNION ALL SELECT `LGBM_Model_3_9`.`KEY` AS `KEY`, `LGBM_Model_3_9`.`Score_0` AS `Score_0`, `LGBM_Model_3_9`.`Score_1` AS `Score_1`, `LGBM_Model_3_9`.`Score_2` AS `Score_2`, `LGBM_Model_3_9`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_3_9`) AS `LGBM_esu_3`) AS `LGBM_B3`

-- Code For temporary table tmp_20180602143835_ix4_lgbm_b4 part 1. Create 


CREATE TABLE tmp_20180602143835_ix4_lgbm_b4 (
	`KEY` BIGINT, 
	`Score_0` DOUBLE, 
	`Score_1` DOUBLE, 
	`Score_2` DOUBLE, 
	`Score_3` DOUBLE
)

 CACHED IN 'one_gig_pool'

-- Code For temporary table tmp_20180602143835_ix4_lgbm_b4 part 2. Populate

WITH `DT_node_lookup_40` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_80 <= -0.20659892002321142) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_81 <= -0.19852706625085706) THEN 4 ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_50 <= -1.0000000180025095e-35) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_40` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 4 AS nid, -0.015743868724441747 AS `Score` UNION ALL SELECT 5 AS nid, -0.031249718673060718 AS `Score` UNION ALL SELECT 6 AS nid, 0.03998234890426754 AS `Score` UNION ALL SELECT 7 AS nid, -0.0032482950525118803 AS `Score`) AS `Values`), 
`DT_Output_40` AS 
(SELECT `DT_node_lookup_40`.`KEY` AS `KEY`, `DT_node_lookup_40`.node_id_2 AS node_id_2, `DT_node_data_40`.nid AS nid, `DT_node_data_40`.`Score` AS `Score` 
FROM `DT_node_lookup_40` LEFT OUTER JOIN `DT_node_data_40` ON `DT_node_lookup_40`.node_id_2 = `DT_node_data_40`.nid), 
`LGBM_Model_0_10` AS 
(SELECT `DT_Output_40`.`KEY` AS `KEY`, `DT_Output_40`.`Score` AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_40`), 
`DT_node_lookup_41` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_94 <= 0.7422130423340411) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_11 <= -0.16760702855928997) THEN 4 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_96 <= 0.0909658923333073) THEN 10 ELSE 11 END END ELSE 3 END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_41` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 3 AS nid, 0.02986321925216749 AS `Score` UNION ALL SELECT 4 AS nid, -0.02821410798213432 AS `Score` UNION ALL SELECT 10 AS nid, -0.012626279568975203 AS `Score` UNION ALL SELECT 11 AS nid, 0.02979847522652436 AS `Score`) AS `Values`), 
`DT_Output_41` AS 
(SELECT `DT_node_lookup_41`.`KEY` AS `KEY`, `DT_node_lookup_41`.node_id_2 AS node_id_2, `DT_node_data_41`.nid AS nid, `DT_node_data_41`.`Score` AS `Score` 
FROM `DT_node_lookup_41` LEFT OUTER JOIN `DT_node_data_41` ON `DT_node_lookup_41`.node_id_2 = `DT_node_data_41`.nid), 
`LGBM_Model_1_10` AS 
(SELECT `DT_Output_41`.`KEY` AS `KEY`, 0.0 AS `Score_0`, `DT_Output_41`.`Score` AS `Score_1`, 0.0 AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_41`), 
`DT_node_lookup_42` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_58 <= -0.22148632814087912) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_56 <= 0.20615032458101307) THEN 4 ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_97 <= 0.2681499738371736) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_42` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 4 AS nid, 0.04353130429727434 AS `Score` UNION ALL SELECT 5 AS nid, -0.011636476982560352 AS `Score` UNION ALL SELECT 6 AS nid, -0.031578771619088064 AS `Score` UNION ALL SELECT 7 AS nid, -0.005960066850569324 AS `Score`) AS `Values`), 
`DT_Output_42` AS 
(SELECT `DT_node_lookup_42`.`KEY` AS `KEY`, `DT_node_lookup_42`.node_id_2 AS node_id_2, `DT_node_data_42`.nid AS nid, `DT_node_data_42`.`Score` AS `Score` 
FROM `DT_node_lookup_42` LEFT OUTER JOIN `DT_node_data_42` ON `DT_node_lookup_42`.node_id_2 = `DT_node_data_42`.nid), 
`LGBM_Model_2_10` AS 
(SELECT `DT_Output_42`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, `DT_Output_42`.`Score` AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_42`), 
`DT_node_lookup_43` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_31 <= 0.36901699791788345) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_44 <= 0.04822483077311236) THEN 4 ELSE 5 END ELSE 3 END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_43` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 3 AS nid, 0.02127179462958491 AS `Score` UNION ALL SELECT 4 AS nid, -0.03199590808682975 AS `Score` UNION ALL SELECT 5 AS nid, 0.003968421351352446 AS `Score`) AS `Values`), 
`DT_Output_43` AS 
(SELECT `DT_node_lookup_43`.`KEY` AS `KEY`, `DT_node_lookup_43`.node_id_2 AS node_id_2, `DT_node_data_43`.nid AS nid, `DT_node_data_43`.`Score` AS `Score` 
FROM `DT_node_lookup_43` LEFT OUTER JOIN `DT_node_data_43` ON `DT_node_lookup_43`.node_id_2 = `DT_node_data_43`.nid), 
`LGBM_Model_3_10` AS 
(SELECT `DT_Output_43`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2`, `DT_Output_43`.`Score` AS `Score_3` 
FROM `DT_Output_43`), 
`DT_node_lookup_44` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_80 <= -0.20659892002321142) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_6 <= 0.14608860188308426) THEN 4 ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_35 <= -0.19856138664745998) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_44` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 4 AS nid, -0.0310908654140684 AS `Score` UNION ALL SELECT 5 AS nid, -0.015279135329961432 AS `Score` UNION ALL SELECT 6 AS nid, 0.03880354145307677 AS `Score` UNION ALL SELECT 7 AS nid, -0.00391134735279519 AS `Score`) AS `Values`), 
`DT_Output_44` AS 
(SELECT `DT_node_lookup_44`.`KEY` AS `KEY`, `DT_node_lookup_44`.node_id_2 AS node_id_2, `DT_node_data_44`.nid AS nid, `DT_node_data_44`.`Score` AS `Score` 
FROM `DT_node_lookup_44` LEFT OUTER JOIN `DT_node_data_44` ON `DT_node_lookup_44`.node_id_2 = `DT_node_data_44`.nid), 
`LGBM_Model_0_11` AS 
(SELECT `DT_Output_44`.`KEY` AS `KEY`, `DT_Output_44`.`Score` AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_44`), 
`DT_node_lookup_45` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_46 <= -0.227315336240404) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_90 <= -0.3502806381050438) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_45` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 2 AS nid, -0.020420313781114086 AS `Score` UNION ALL SELECT 6 AS nid, -0.014726013237717382 AS `Score` UNION ALL SELECT 7 AS nid, 0.027470639315244978 AS `Score`) AS `Values`), 
`DT_Output_45` AS 
(SELECT `DT_node_lookup_45`.`KEY` AS `KEY`, `DT_node_lookup_45`.node_id_2 AS node_id_2, `DT_node_data_45`.nid AS nid, `DT_node_data_45`.`Score` AS `Score` 
FROM `DT_node_lookup_45` LEFT OUTER JOIN `DT_node_data_45` ON `DT_node_lookup_45`.node_id_2 = `DT_node_data_45`.nid), 
`LGBM_Model_1_11` AS 
(SELECT `DT_Output_45`.`KEY` AS `KEY`, 0.0 AS `Score_0`, `DT_Output_45`.`Score` AS `Score_1`, 0.0 AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_45`), 
`DT_node_lookup_46` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_58 <= 0.06628692254685489) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_56 <= 0.0440720522097763) THEN 4 ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_33 <= 0.07507482016009438) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_46` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 4 AS nid, 0.042739183805542674 AS `Score` UNION ALL SELECT 5 AS nid, -0.00894612657642856 AS `Score` UNION ALL SELECT 6 AS nid, -0.03171787287192134 AS `Score` UNION ALL SELECT 7 AS nid, -0.016152772496959986 AS `Score`) AS `Values`), 
`DT_Output_46` AS 
(SELECT `DT_node_lookup_46`.`KEY` AS `KEY`, `DT_node_lookup_46`.node_id_2 AS node_id_2, `DT_node_data_46`.nid AS nid, `DT_node_data_46`.`Score` AS `Score` 
FROM `DT_node_lookup_46` LEFT OUTER JOIN `DT_node_data_46` ON `DT_node_lookup_46`.node_id_2 = `DT_node_data_46`.nid), 
`LGBM_Model_2_11` AS 
(SELECT `DT_Output_46`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, `DT_Output_46`.`Score` AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_46`), 
`DT_node_lookup_47` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_101 <= 1.0000000180025095e-35) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_21 <= -0.3420785268148518) THEN 4 ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_2 <= 0.21817166411542668) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_47` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 4 AS nid, -0.014910353817675186 AS `Score` UNION ALL SELECT 5 AS nid, 0.041084924059791056 AS `Score` UNION ALL SELECT 6 AS nid, -0.03233600981842487 AS `Score` UNION ALL SELECT 7 AS nid, 0.0012034387694043048 AS `Score`) AS `Values`), 
`DT_Output_47` AS 
(SELECT `DT_node_lookup_47`.`KEY` AS `KEY`, `DT_node_lookup_47`.node_id_2 AS node_id_2, `DT_node_data_47`.nid AS nid, `DT_node_data_47`.`Score` AS `Score` 
FROM `DT_node_lookup_47` LEFT OUTER JOIN `DT_node_data_47` ON `DT_node_lookup_47`.node_id_2 = `DT_node_data_47`.nid), 
`LGBM_Model_3_11` AS 
(SELECT `DT_Output_47`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2`, `DT_Output_47`.`Score` AS `Score_3` 
FROM `DT_Output_47`), 
`DT_node_lookup_48` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_80 <= -0.20659892002321142) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_8 <= 0.15851073706032173) THEN 4 ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_78 <= 0.055758777690439555) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_48` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 4 AS nid, -0.03090305305251158 AS `Score` UNION ALL SELECT 5 AS nid, -0.014939394868731635 AS `Score` UNION ALL SELECT 6 AS nid, 0.03382129840405984 AS `Score` UNION ALL SELECT 7 AS nid, -0.008206307592326621 AS `Score`) AS `Values`), 
`DT_Output_48` AS 
(SELECT `DT_node_lookup_48`.`KEY` AS `KEY`, `DT_node_lookup_48`.node_id_2 AS node_id_2, `DT_node_data_48`.nid AS nid, `DT_node_data_48`.`Score` AS `Score` 
FROM `DT_node_lookup_48` LEFT OUTER JOIN `DT_node_data_48` ON `DT_node_lookup_48`.node_id_2 = `DT_node_data_48`.nid), 
`LGBM_Model_0_12` AS 
(SELECT `DT_Output_48`.`KEY` AS `KEY`, `DT_Output_48`.`Score` AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_48`), 
`DT_node_lookup_49` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_50 <= -0.20437877954345876) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_90 <= -0.3502806381050438) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_49` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 2 AS nid, -0.018526138619979884 AS `Score` UNION ALL SELECT 6 AS nid, -0.01588077468488255 AS `Score` UNION ALL SELECT 7 AS nid, 0.03428883703950263 AS `Score`) AS `Values`), 
`DT_Output_49` AS 
(SELECT `DT_node_lookup_49`.`KEY` AS `KEY`, `DT_node_lookup_49`.node_id_2 AS node_id_2, `DT_node_data_49`.nid AS nid, `DT_node_data_49`.`Score` AS `Score` 
FROM `DT_node_lookup_49` LEFT OUTER JOIN `DT_node_data_49` ON `DT_node_lookup_49`.node_id_2 = `DT_node_data_49`.nid), 
`LGBM_Model_1_12` AS 
(SELECT `DT_Output_49`.`KEY` AS `KEY`, 0.0 AS `Score_0`, `DT_Output_49`.`Score` AS `Score_1`, 0.0 AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_49`)
 INSERT INTO tmp_20180602143835_ix4_lgbm_b4 (`KEY`, `Score_0`, `Score_1`, `Score_2`, `Score_3`) SELECT `LGBM_B4`.`KEY`, `LGBM_B4`.`Score_0`, `LGBM_B4`.`Score_1`, `LGBM_B4`.`Score_2`, `LGBM_B4`.`Score_3` 
FROM (SELECT `LGBM_esu_4`.`KEY` AS `KEY`, `LGBM_esu_4`.`Score_0` AS `Score_0`, `LGBM_esu_4`.`Score_1` AS `Score_1`, `LGBM_esu_4`.`Score_2` AS `Score_2`, `LGBM_esu_4`.`Score_3` AS `Score_3` 
FROM (SELECT `LGBM_Model_0_10`.`KEY` AS `KEY`, `LGBM_Model_0_10`.`Score_0` AS `Score_0`, `LGBM_Model_0_10`.`Score_1` AS `Score_1`, `LGBM_Model_0_10`.`Score_2` AS `Score_2`, `LGBM_Model_0_10`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_0_10` UNION ALL SELECT `LGBM_Model_1_10`.`KEY` AS `KEY`, `LGBM_Model_1_10`.`Score_0` AS `Score_0`, `LGBM_Model_1_10`.`Score_1` AS `Score_1`, `LGBM_Model_1_10`.`Score_2` AS `Score_2`, `LGBM_Model_1_10`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_1_10` UNION ALL SELECT `LGBM_Model_2_10`.`KEY` AS `KEY`, `LGBM_Model_2_10`.`Score_0` AS `Score_0`, `LGBM_Model_2_10`.`Score_1` AS `Score_1`, `LGBM_Model_2_10`.`Score_2` AS `Score_2`, `LGBM_Model_2_10`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_2_10` UNION ALL SELECT `LGBM_Model_3_10`.`KEY` AS `KEY`, `LGBM_Model_3_10`.`Score_0` AS `Score_0`, `LGBM_Model_3_10`.`Score_1` AS `Score_1`, `LGBM_Model_3_10`.`Score_2` AS `Score_2`, `LGBM_Model_3_10`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_3_10` UNION ALL SELECT `LGBM_Model_0_11`.`KEY` AS `KEY`, `LGBM_Model_0_11`.`Score_0` AS `Score_0`, `LGBM_Model_0_11`.`Score_1` AS `Score_1`, `LGBM_Model_0_11`.`Score_2` AS `Score_2`, `LGBM_Model_0_11`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_0_11` UNION ALL SELECT `LGBM_Model_1_11`.`KEY` AS `KEY`, `LGBM_Model_1_11`.`Score_0` AS `Score_0`, `LGBM_Model_1_11`.`Score_1` AS `Score_1`, `LGBM_Model_1_11`.`Score_2` AS `Score_2`, `LGBM_Model_1_11`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_1_11` UNION ALL SELECT `LGBM_Model_2_11`.`KEY` AS `KEY`, `LGBM_Model_2_11`.`Score_0` AS `Score_0`, `LGBM_Model_2_11`.`Score_1` AS `Score_1`, `LGBM_Model_2_11`.`Score_2` AS `Score_2`, `LGBM_Model_2_11`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_2_11` UNION ALL SELECT `LGBM_Model_3_11`.`KEY` AS `KEY`, `LGBM_Model_3_11`.`Score_0` AS `Score_0`, `LGBM_Model_3_11`.`Score_1` AS `Score_1`, `LGBM_Model_3_11`.`Score_2` AS `Score_2`, `LGBM_Model_3_11`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_3_11` UNION ALL SELECT `LGBM_Model_0_12`.`KEY` AS `KEY`, `LGBM_Model_0_12`.`Score_0` AS `Score_0`, `LGBM_Model_0_12`.`Score_1` AS `Score_1`, `LGBM_Model_0_12`.`Score_2` AS `Score_2`, `LGBM_Model_0_12`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_0_12` UNION ALL SELECT `LGBM_Model_1_12`.`KEY` AS `KEY`, `LGBM_Model_1_12`.`Score_0` AS `Score_0`, `LGBM_Model_1_12`.`Score_1` AS `Score_1`, `LGBM_Model_1_12`.`Score_2` AS `Score_2`, `LGBM_Model_1_12`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_1_12`) AS `LGBM_esu_4`) AS `LGBM_B4`

-- Code For temporary table tmp_20180602143835_5mw_lgbm_b5 part 1. Create 


CREATE TABLE tmp_20180602143835_5mw_lgbm_b5 (
	`KEY` BIGINT, 
	`Score_0` DOUBLE, 
	`Score_1` DOUBLE, 
	`Score_2` DOUBLE, 
	`Score_3` DOUBLE
)

 CACHED IN 'one_gig_pool'

-- Code For temporary table tmp_20180602143835_5mw_lgbm_b5 part 2. Populate

WITH `DT_node_lookup_50` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_58 <= 0.06628692254685489) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_56 <= 0.0440720522097763) THEN 4 ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_54 <= -0.10941893924022757) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_50` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 4 AS nid, 0.040817250224576766 AS `Score` UNION ALL SELECT 5 AS nid, -0.008790049401806242 AS `Score` UNION ALL SELECT 6 AS nid, -0.015871302752483933 AS `Score` UNION ALL SELECT 7 AS nid, -0.031483714350811424 AS `Score`) AS `Values`), 
`DT_Output_50` AS 
(SELECT `DT_node_lookup_50`.`KEY` AS `KEY`, `DT_node_lookup_50`.node_id_2 AS node_id_2, `DT_node_data_50`.nid AS nid, `DT_node_data_50`.`Score` AS `Score` 
FROM `DT_node_lookup_50` LEFT OUTER JOIN `DT_node_data_50` ON `DT_node_lookup_50`.node_id_2 = `DT_node_data_50`.nid), 
`LGBM_Model_2_12` AS 
(SELECT `DT_Output_50`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, `DT_Output_50`.`Score` AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_50`), 
`DT_node_lookup_51` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_46 <= 0.3111670739918176) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_56 <= 0.43876687599494696) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_52 <= 1.0000000180025095e-35) THEN 8 ELSE 9 END ELSE 5 END ELSE 3 END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_51` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 3 AS nid, 0.0205064249734117 AS `Score` UNION ALL SELECT 5 AS nid, 0.01043540245880489 AS `Score` UNION ALL SELECT 8 AS nid, -0.02386062596300417 AS `Score` UNION ALL SELECT 9 AS nid, -0.03236334009426657 AS `Score`) AS `Values`), 
`DT_Output_51` AS 
(SELECT `DT_node_lookup_51`.`KEY` AS `KEY`, `DT_node_lookup_51`.node_id_2 AS node_id_2, `DT_node_data_51`.nid AS nid, `DT_node_data_51`.`Score` AS `Score` 
FROM `DT_node_lookup_51` LEFT OUTER JOIN `DT_node_data_51` ON `DT_node_lookup_51`.node_id_2 = `DT_node_data_51`.nid), 
`LGBM_Model_3_12` AS 
(SELECT `DT_Output_51`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2`, `DT_Output_51`.`Score` AS `Score_3` 
FROM `DT_Output_51`), 
`DT_node_lookup_52` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_80 <= -0.20659892002321142) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_2 <= 0.18396981255684525) THEN 4 ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_94 <= 0.07659678856147197) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_52` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 4 AS nid, -0.030747030661008867 AS `Score` UNION ALL SELECT 5 AS nid, -0.014555792926882772 AS `Score` UNION ALL SELECT 6 AS nid, 0.031573895596735624 AS `Score` UNION ALL SELECT 7 AS nid, -0.010175005233875134 AS `Score`) AS `Values`), 
`DT_Output_52` AS 
(SELECT `DT_node_lookup_52`.`KEY` AS `KEY`, `DT_node_lookup_52`.node_id_2 AS node_id_2, `DT_node_data_52`.nid AS nid, `DT_node_data_52`.`Score` AS `Score` 
FROM `DT_node_lookup_52` LEFT OUTER JOIN `DT_node_data_52` ON `DT_node_lookup_52`.node_id_2 = `DT_node_data_52`.nid), 
`LGBM_Model_0_13` AS 
(SELECT `DT_Output_52`.`KEY` AS `KEY`, `DT_Output_52`.`Score` AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_52`), 
`DT_node_lookup_53` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_50 <= -0.20437877954345876) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_90 <= -0.3502806381050438) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_53` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 2 AS nid, -0.0182582081209416 AS `Score` UNION ALL SELECT 6 AS nid, -0.015596687636521743 AS `Score` UNION ALL SELECT 7 AS nid, 0.033090334673929765 AS `Score`) AS `Values`), 
`DT_Output_53` AS 
(SELECT `DT_node_lookup_53`.`KEY` AS `KEY`, `DT_node_lookup_53`.node_id_2 AS node_id_2, `DT_node_data_53`.nid AS nid, `DT_node_data_53`.`Score` AS `Score` 
FROM `DT_node_lookup_53` LEFT OUTER JOIN `DT_node_data_53` ON `DT_node_lookup_53`.node_id_2 = `DT_node_data_53`.nid), 
`LGBM_Model_1_13` AS 
(SELECT `DT_Output_53`.`KEY` AS `KEY`, 0.0 AS `Score_0`, `DT_Output_53`.`Score` AS `Score_1`, 0.0 AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_53`), 
`DT_node_lookup_54` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_40 <= -0.5337063693982357) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_101 <= -0.3079092197802202) THEN 6 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_46 <= -0.18872736207147425) THEN 14 ELSE 15 END END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_54` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 2 AS nid, -0.03203660225084873 AS `Score` UNION ALL SELECT 6 AS nid, -0.026071125113543425 AS `Score` UNION ALL SELECT 14 AS nid, 0.05100082011196845 AS `Score` UNION ALL SELECT 15 AS nid, 0.0030984754684367025 AS `Score`) AS `Values`), 
`DT_Output_54` AS 
(SELECT `DT_node_lookup_54`.`KEY` AS `KEY`, `DT_node_lookup_54`.node_id_2 AS node_id_2, `DT_node_data_54`.nid AS nid, `DT_node_data_54`.`Score` AS `Score` 
FROM `DT_node_lookup_54` LEFT OUTER JOIN `DT_node_data_54` ON `DT_node_lookup_54`.node_id_2 = `DT_node_data_54`.nid), 
`LGBM_Model_2_13` AS 
(SELECT `DT_Output_54`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, `DT_Output_54`.`Score` AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_54`), 
`DT_node_lookup_55` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_31 <= 0.36901699791788345) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_69 <= 0.12950619410491884) THEN 4 ELSE 5 END ELSE 3 END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_55` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 3 AS nid, 0.020099509826441427 AS `Score` UNION ALL SELECT 4 AS nid, -0.03189536515463107 AS `Score` UNION ALL SELECT 5 AS nid, 0.0036767730116769887 AS `Score`) AS `Values`), 
`DT_Output_55` AS 
(SELECT `DT_node_lookup_55`.`KEY` AS `KEY`, `DT_node_lookup_55`.node_id_2 AS node_id_2, `DT_node_data_55`.nid AS nid, `DT_node_data_55`.`Score` AS `Score` 
FROM `DT_node_lookup_55` LEFT OUTER JOIN `DT_node_data_55` ON `DT_node_lookup_55`.node_id_2 = `DT_node_data_55`.nid), 
`LGBM_Model_3_13` AS 
(SELECT `DT_Output_55`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2`, `DT_Output_55`.`Score` AS `Score_3` 
FROM `DT_Output_55`), 
`DT_node_lookup_56` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_80 <= -0.20659892002321142) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_8 <= 0.15851073706032173) THEN 4 ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_66 <= -0.16160014838154277) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_56` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 4 AS nid, -0.03060751890436594 AS `Score` UNION ALL SELECT 5 AS nid, -0.014150078595797873 AS `Score` UNION ALL SELECT 6 AS nid, 0.03573203558143081 AS `Score` UNION ALL SELECT 7 AS nid, -0.0044581153413860665 AS `Score`) AS `Values`), 
`DT_Output_56` AS 
(SELECT `DT_node_lookup_56`.`KEY` AS `KEY`, `DT_node_lookup_56`.node_id_2 AS node_id_2, `DT_node_data_56`.nid AS nid, `DT_node_data_56`.`Score` AS `Score` 
FROM `DT_node_lookup_56` LEFT OUTER JOIN `DT_node_data_56` ON `DT_node_lookup_56`.node_id_2 = `DT_node_data_56`.nid), 
`LGBM_Model_0_14` AS 
(SELECT `DT_Output_56`.`KEY` AS `KEY`, `DT_Output_56`.`Score` AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_56`), 
`DT_node_lookup_57` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_46 <= -0.227315336240404) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_66 <= -0.16160014838154277) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_57` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 2 AS nid, -0.01998261413617107 AS `Score` UNION ALL SELECT 6 AS nid, -0.009748624080525037 AS `Score` UNION ALL SELECT 7 AS nid, 0.0292959498894432 AS `Score`) AS `Values`), 
`DT_Output_57` AS 
(SELECT `DT_node_lookup_57`.`KEY` AS `KEY`, `DT_node_lookup_57`.node_id_2 AS node_id_2, `DT_node_data_57`.nid AS nid, `DT_node_data_57`.`Score` AS `Score` 
FROM `DT_node_lookup_57` LEFT OUTER JOIN `DT_node_data_57` ON `DT_node_lookup_57`.node_id_2 = `DT_node_data_57`.nid), 
`LGBM_Model_1_14` AS 
(SELECT `DT_Output_57`.`KEY` AS `KEY`, 0.0 AS `Score_0`, `DT_Output_57`.`Score` AS `Score_1`, 0.0 AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_57`), 
`DT_node_lookup_58` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_40 <= -0.5337063693982357) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_101 <= -0.3079092197802202) THEN 6 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_33 <= 1.0000000180025095e-35) THEN 14 ELSE 15 END END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_58` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 2 AS nid, -0.0318125040411655 AS `Score` UNION ALL SELECT 6 AS nid, -0.02578061038935473 AS `Score` UNION ALL SELECT 14 AS nid, 0.002089881713252583 AS `Score` UNION ALL SELECT 15 AS nid, 0.04878045633913547 AS `Score`) AS `Values`), 
`DT_Output_58` AS 
(SELECT `DT_node_lookup_58`.`KEY` AS `KEY`, `DT_node_lookup_58`.node_id_2 AS node_id_2, `DT_node_data_58`.nid AS nid, `DT_node_data_58`.`Score` AS `Score` 
FROM `DT_node_lookup_58` LEFT OUTER JOIN `DT_node_data_58` ON `DT_node_lookup_58`.node_id_2 = `DT_node_data_58`.nid), 
`LGBM_Model_2_14` AS 
(SELECT `DT_Output_58`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, `DT_Output_58`.`Score` AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_58`), 
`DT_node_lookup_59` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_101 <= 1.0000000180025095e-35) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_21 <= -0.3420785268148518) THEN 4 ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_2 <= 0.21817166411542668) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_59` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 4 AS nid, -0.014753650054128554 AS `Score` UNION ALL SELECT 5 AS nid, 0.03817297064500252 AS `Score` UNION ALL SELECT 6 AS nid, -0.03202510022630165 AS `Score` UNION ALL SELECT 7 AS nid, 0.0018751524215349189 AS `Score`) AS `Values`), 
`DT_Output_59` AS 
(SELECT `DT_node_lookup_59`.`KEY` AS `KEY`, `DT_node_lookup_59`.node_id_2 AS node_id_2, `DT_node_data_59`.nid AS nid, `DT_node_data_59`.`Score` AS `Score` 
FROM `DT_node_lookup_59` LEFT OUTER JOIN `DT_node_data_59` ON `DT_node_lookup_59`.node_id_2 = `DT_node_data_59`.nid), 
`LGBM_Model_3_14` AS 
(SELECT `DT_Output_59`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2`, `DT_Output_59`.`Score` AS `Score_3` 
FROM `DT_Output_59`)
 INSERT INTO tmp_20180602143835_5mw_lgbm_b5 (`KEY`, `Score_0`, `Score_1`, `Score_2`, `Score_3`) SELECT `LGBM_B5`.`KEY`, `LGBM_B5`.`Score_0`, `LGBM_B5`.`Score_1`, `LGBM_B5`.`Score_2`, `LGBM_B5`.`Score_3` 
FROM (SELECT `LGBM_esu_5`.`KEY` AS `KEY`, `LGBM_esu_5`.`Score_0` AS `Score_0`, `LGBM_esu_5`.`Score_1` AS `Score_1`, `LGBM_esu_5`.`Score_2` AS `Score_2`, `LGBM_esu_5`.`Score_3` AS `Score_3` 
FROM (SELECT `LGBM_Model_2_12`.`KEY` AS `KEY`, `LGBM_Model_2_12`.`Score_0` AS `Score_0`, `LGBM_Model_2_12`.`Score_1` AS `Score_1`, `LGBM_Model_2_12`.`Score_2` AS `Score_2`, `LGBM_Model_2_12`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_2_12` UNION ALL SELECT `LGBM_Model_3_12`.`KEY` AS `KEY`, `LGBM_Model_3_12`.`Score_0` AS `Score_0`, `LGBM_Model_3_12`.`Score_1` AS `Score_1`, `LGBM_Model_3_12`.`Score_2` AS `Score_2`, `LGBM_Model_3_12`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_3_12` UNION ALL SELECT `LGBM_Model_0_13`.`KEY` AS `KEY`, `LGBM_Model_0_13`.`Score_0` AS `Score_0`, `LGBM_Model_0_13`.`Score_1` AS `Score_1`, `LGBM_Model_0_13`.`Score_2` AS `Score_2`, `LGBM_Model_0_13`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_0_13` UNION ALL SELECT `LGBM_Model_1_13`.`KEY` AS `KEY`, `LGBM_Model_1_13`.`Score_0` AS `Score_0`, `LGBM_Model_1_13`.`Score_1` AS `Score_1`, `LGBM_Model_1_13`.`Score_2` AS `Score_2`, `LGBM_Model_1_13`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_1_13` UNION ALL SELECT `LGBM_Model_2_13`.`KEY` AS `KEY`, `LGBM_Model_2_13`.`Score_0` AS `Score_0`, `LGBM_Model_2_13`.`Score_1` AS `Score_1`, `LGBM_Model_2_13`.`Score_2` AS `Score_2`, `LGBM_Model_2_13`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_2_13` UNION ALL SELECT `LGBM_Model_3_13`.`KEY` AS `KEY`, `LGBM_Model_3_13`.`Score_0` AS `Score_0`, `LGBM_Model_3_13`.`Score_1` AS `Score_1`, `LGBM_Model_3_13`.`Score_2` AS `Score_2`, `LGBM_Model_3_13`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_3_13` UNION ALL SELECT `LGBM_Model_0_14`.`KEY` AS `KEY`, `LGBM_Model_0_14`.`Score_0` AS `Score_0`, `LGBM_Model_0_14`.`Score_1` AS `Score_1`, `LGBM_Model_0_14`.`Score_2` AS `Score_2`, `LGBM_Model_0_14`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_0_14` UNION ALL SELECT `LGBM_Model_1_14`.`KEY` AS `KEY`, `LGBM_Model_1_14`.`Score_0` AS `Score_0`, `LGBM_Model_1_14`.`Score_1` AS `Score_1`, `LGBM_Model_1_14`.`Score_2` AS `Score_2`, `LGBM_Model_1_14`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_1_14` UNION ALL SELECT `LGBM_Model_2_14`.`KEY` AS `KEY`, `LGBM_Model_2_14`.`Score_0` AS `Score_0`, `LGBM_Model_2_14`.`Score_1` AS `Score_1`, `LGBM_Model_2_14`.`Score_2` AS `Score_2`, `LGBM_Model_2_14`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_2_14` UNION ALL SELECT `LGBM_Model_3_14`.`KEY` AS `KEY`, `LGBM_Model_3_14`.`Score_0` AS `Score_0`, `LGBM_Model_3_14`.`Score_1` AS `Score_1`, `LGBM_Model_3_14`.`Score_2` AS `Score_2`, `LGBM_Model_3_14`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_3_14`) AS `LGBM_esu_5`) AS `LGBM_B5`

-- Code For temporary table tmp_20180602143835_zrv_lgbm_b6 part 1. Create 


CREATE TABLE tmp_20180602143835_zrv_lgbm_b6 (
	`KEY` BIGINT, 
	`Score_0` DOUBLE, 
	`Score_1` DOUBLE, 
	`Score_2` DOUBLE, 
	`Score_3` DOUBLE
)

 CACHED IN 'one_gig_pool'

-- Code For temporary table tmp_20180602143835_zrv_lgbm_b6 part 2. Populate

WITH `DT_node_lookup_60` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_80 <= -0.20659892002321142) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_43 <= -0.2582857805819058) THEN 4 ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_35 <= -0.19856138664745998) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_60` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 4 AS nid, -0.013689615874156992 AS `Score` UNION ALL SELECT 5 AS nid, -0.030449564866642423 AS `Score` UNION ALL SELECT 6 AS nid, 0.03490078493210116 AS `Score` UNION ALL SELECT 7 AS nid, -0.004664885985751203 AS `Score`) AS `Values`), 
`DT_Output_60` AS 
(SELECT `DT_node_lookup_60`.`KEY` AS `KEY`, `DT_node_lookup_60`.node_id_2 AS node_id_2, `DT_node_data_60`.nid AS nid, `DT_node_data_60`.`Score` AS `Score` 
FROM `DT_node_lookup_60` LEFT OUTER JOIN `DT_node_data_60` ON `DT_node_lookup_60`.node_id_2 = `DT_node_data_60`.nid), 
`LGBM_Model_0_15` AS 
(SELECT `DT_Output_60`.`KEY` AS `KEY`, `DT_Output_60`.`Score` AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_60`), 
`DT_node_lookup_61` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_70 <= -0.7274469808060616) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_50 <= -0.20437877954345876) THEN 6 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_52 <= 1.0000000180025095e-35) THEN 14 ELSE 15 END END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_61` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 2 AS nid, -0.02628140917315637 AS `Score` UNION ALL SELECT 6 AS nid, -0.01777674979451851 AS `Score` UNION ALL SELECT 14 AS nid, 0.052027314115713534 AS `Score` UNION ALL SELECT 15 AS nid, -0.004217682524032953 AS `Score`) AS `Values`), 
`DT_Output_61` AS 
(SELECT `DT_node_lookup_61`.`KEY` AS `KEY`, `DT_node_lookup_61`.node_id_2 AS node_id_2, `DT_node_data_61`.nid AS nid, `DT_node_data_61`.`Score` AS `Score` 
FROM `DT_node_lookup_61` LEFT OUTER JOIN `DT_node_data_61` ON `DT_node_lookup_61`.node_id_2 = `DT_node_data_61`.nid), 
`LGBM_Model_1_15` AS 
(SELECT `DT_Output_61`.`KEY` AS `KEY`, 0.0 AS `Score_0`, `DT_Output_61`.`Score` AS `Score_1`, 0.0 AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_61`), 
`DT_node_lookup_62` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_40 <= -0.5337063693982357) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_101 <= -0.3079092197802202) THEN 6 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_46 <= -0.18872736207147425) THEN 14 ELSE 15 END END END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_62` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 2 AS nid, -0.03162941178263455 AS `Score` UNION ALL SELECT 6 AS nid, -0.02543211348171276 AS `Score` UNION ALL SELECT 14 AS nid, 0.04728314963131467 AS `Score` UNION ALL SELECT 15 AS nid, 0.0025346518318884884 AS `Score`) AS `Values`), 
`DT_Output_62` AS 
(SELECT `DT_node_lookup_62`.`KEY` AS `KEY`, `DT_node_lookup_62`.node_id_2 AS node_id_2, `DT_node_data_62`.nid AS nid, `DT_node_data_62`.`Score` AS `Score` 
FROM `DT_node_lookup_62` LEFT OUTER JOIN `DT_node_data_62` ON `DT_node_lookup_62`.node_id_2 = `DT_node_data_62`.nid), 
`LGBM_Model_2_15` AS 
(SELECT `DT_Output_62`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, `DT_Output_62`.`Score` AS `Score_2`, 0.0 AS `Score_3` 
FROM `DT_Output_62`), 
`DT_node_lookup_63` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_31 <= 0.36901699791788345) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_46 <= 0.06978065000800054) THEN 4 ELSE 5 END ELSE 3 END AS node_id_2 
FROM tmp_20180602143835_h5c_ads_sca_2_out AS `ADS_sca_2_OUT`), 
`DT_node_data_63` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 3 AS nid, 0.019286844860131692 AS `Score` UNION ALL SELECT 4 AS nid, -0.03102628577513182 AS `Score` UNION ALL SELECT 5 AS nid, 0.00427368528143657 AS `Score`) AS `Values`), 
`DT_Output_63` AS 
(SELECT `DT_node_lookup_63`.`KEY` AS `KEY`, `DT_node_lookup_63`.node_id_2 AS node_id_2, `DT_node_data_63`.nid AS nid, `DT_node_data_63`.`Score` AS `Score` 
FROM `DT_node_lookup_63` LEFT OUTER JOIN `DT_node_data_63` ON `DT_node_lookup_63`.node_id_2 = `DT_node_data_63`.nid), 
`LGBM_Model_3_15` AS 
(SELECT `DT_Output_63`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2`, `DT_Output_63`.`Score` AS `Score_3` 
FROM `DT_Output_63`)
 INSERT INTO tmp_20180602143835_zrv_lgbm_b6 (`KEY`, `Score_0`, `Score_1`, `Score_2`, `Score_3`) SELECT `LGBM_B6`.`KEY`, `LGBM_B6`.`Score_0`, `LGBM_B6`.`Score_1`, `LGBM_B6`.`Score_2`, `LGBM_B6`.`Score_3` 
FROM (SELECT `LGBM_esu_6`.`KEY` AS `KEY`, `LGBM_esu_6`.`Score_0` AS `Score_0`, `LGBM_esu_6`.`Score_1` AS `Score_1`, `LGBM_esu_6`.`Score_2` AS `Score_2`, `LGBM_esu_6`.`Score_3` AS `Score_3` 
FROM (SELECT `LGBM_Model_0_15`.`KEY` AS `KEY`, `LGBM_Model_0_15`.`Score_0` AS `Score_0`, `LGBM_Model_0_15`.`Score_1` AS `Score_1`, `LGBM_Model_0_15`.`Score_2` AS `Score_2`, `LGBM_Model_0_15`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_0_15` UNION ALL SELECT `LGBM_Model_1_15`.`KEY` AS `KEY`, `LGBM_Model_1_15`.`Score_0` AS `Score_0`, `LGBM_Model_1_15`.`Score_1` AS `Score_1`, `LGBM_Model_1_15`.`Score_2` AS `Score_2`, `LGBM_Model_1_15`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_1_15` UNION ALL SELECT `LGBM_Model_2_15`.`KEY` AS `KEY`, `LGBM_Model_2_15`.`Score_0` AS `Score_0`, `LGBM_Model_2_15`.`Score_1` AS `Score_1`, `LGBM_Model_2_15`.`Score_2` AS `Score_2`, `LGBM_Model_2_15`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_2_15` UNION ALL SELECT `LGBM_Model_3_15`.`KEY` AS `KEY`, `LGBM_Model_3_15`.`Score_0` AS `Score_0`, `LGBM_Model_3_15`.`Score_1` AS `Score_1`, `LGBM_Model_3_15`.`Score_2` AS `Score_2`, `LGBM_Model_3_15`.`Score_3` AS `Score_3` 
FROM `LGBM_Model_3_15`) AS `LGBM_esu_6`) AS `LGBM_B6`

-- Code For temporary table tmp_20180602143835_u2z_lgbm_sum part 1. Create 


CREATE TABLE tmp_20180602143835_u2z_lgbm_sum (
	`KEY` BIGINT, 
	`Score_0` DOUBLE, 
	`Score_1` DOUBLE, 
	`Score_2` DOUBLE, 
	`Score_3` DOUBLE
)

 CACHED IN 'one_gig_pool'

-- Code For temporary table tmp_20180602143835_u2z_lgbm_sum part 2. Populate

WITH `LGBM_Union` AS 
(SELECT `LGBM_EnsembleUnion`.`KEY` AS `KEY`, `LGBM_EnsembleUnion`.`Score_0` AS `Score_0`, `LGBM_EnsembleUnion`.`Score_1` AS `Score_1`, `LGBM_EnsembleUnion`.`Score_2` AS `Score_2`, `LGBM_EnsembleUnion`.`Score_3` AS `Score_3` 
FROM (SELECT `LGBM_B0`.`KEY` AS `KEY`, `LGBM_B0`.`Score_0` AS `Score_0`, `LGBM_B0`.`Score_1` AS `Score_1`, `LGBM_B0`.`Score_2` AS `Score_2`, `LGBM_B0`.`Score_3` AS `Score_3` 
FROM tmp_20180602143835_6y5_lgbm_b0 AS `LGBM_B0` UNION ALL SELECT `LGBM_B1`.`KEY` AS `KEY`, `LGBM_B1`.`Score_0` AS `Score_0`, `LGBM_B1`.`Score_1` AS `Score_1`, `LGBM_B1`.`Score_2` AS `Score_2`, `LGBM_B1`.`Score_3` AS `Score_3` 
FROM tmp_20180602143835_sm9_lgbm_b1 AS `LGBM_B1` UNION ALL SELECT `LGBM_B2`.`KEY` AS `KEY`, `LGBM_B2`.`Score_0` AS `Score_0`, `LGBM_B2`.`Score_1` AS `Score_1`, `LGBM_B2`.`Score_2` AS `Score_2`, `LGBM_B2`.`Score_3` AS `Score_3` 
FROM tmp_20180602143835_k8n_lgbm_b2 AS `LGBM_B2` UNION ALL SELECT `LGBM_B3`.`KEY` AS `KEY`, `LGBM_B3`.`Score_0` AS `Score_0`, `LGBM_B3`.`Score_1` AS `Score_1`, `LGBM_B3`.`Score_2` AS `Score_2`, `LGBM_B3`.`Score_3` AS `Score_3` 
FROM tmp_20180602143835_cns_lgbm_b3 AS `LGBM_B3` UNION ALL SELECT `LGBM_B4`.`KEY` AS `KEY`, `LGBM_B4`.`Score_0` AS `Score_0`, `LGBM_B4`.`Score_1` AS `Score_1`, `LGBM_B4`.`Score_2` AS `Score_2`, `LGBM_B4`.`Score_3` AS `Score_3` 
FROM tmp_20180602143835_ix4_lgbm_b4 AS `LGBM_B4` UNION ALL SELECT `LGBM_B5`.`KEY` AS `KEY`, `LGBM_B5`.`Score_0` AS `Score_0`, `LGBM_B5`.`Score_1` AS `Score_1`, `LGBM_B5`.`Score_2` AS `Score_2`, `LGBM_B5`.`Score_3` AS `Score_3` 
FROM tmp_20180602143835_5mw_lgbm_b5 AS `LGBM_B5` UNION ALL SELECT `LGBM_B6`.`KEY` AS `KEY`, `LGBM_B6`.`Score_0` AS `Score_0`, `LGBM_B6`.`Score_1` AS `Score_1`, `LGBM_B6`.`Score_2` AS `Score_2`, `LGBM_B6`.`Score_3` AS `Score_3` 
FROM tmp_20180602143835_zrv_lgbm_b6 AS `LGBM_B6`) AS `LGBM_EnsembleUnion`)
 INSERT INTO tmp_20180602143835_u2z_lgbm_sum (`KEY`, `Score_0`, `Score_1`, `Score_2`, `Score_3`) SELECT `LGBM_sum`.`KEY`, `LGBM_sum`.`Score_0`, `LGBM_sum`.`Score_1`, `LGBM_sum`.`Score_2`, `LGBM_sum`.`Score_3` 
FROM (SELECT `T`.`KEY` AS `KEY`, CAST(`T`.`Score_0` AS DOUBLE) AS `Score_0`, CAST(`T`.`Score_1` AS DOUBLE) AS `Score_1`, CAST(`T`.`Score_2` AS DOUBLE) AS `Score_2`, CAST(`T`.`Score_3` AS DOUBLE) AS `Score_3` 
FROM (SELECT `LGBM_Union`.`KEY` AS `KEY`, sum(`LGBM_Union`.`Score_0`) AS `Score_0`, sum(`LGBM_Union`.`Score_1`) AS `Score_1`, sum(`LGBM_Union`.`Score_2`) AS `Score_2`, sum(`LGBM_Union`.`Score_3`) AS `Score_3` 
FROM `LGBM_Union` GROUP BY `LGBM_Union`.`KEY`) AS `T`) AS `LGBM_sum`

-- Model deployment code

WITH orig_cte AS 
(SELECT `LGBM_sum`.`KEY` AS `KEY`, `LGBM_sum`.`Score_0` AS `Score_0`, `LGBM_sum`.`Score_1` AS `Score_1`, `LGBM_sum`.`Score_2` AS `Score_2`, `LGBM_sum`.`Score_3` AS `Score_3`, CAST(NULL AS DOUBLE) AS `Proba_0`, CAST(NULL AS DOUBLE) AS `Proba_1`, CAST(NULL AS DOUBLE) AS `Proba_2`, CAST(NULL AS DOUBLE) AS `Proba_3`, CAST(NULL AS DOUBLE) AS `LogProba_0`, CAST(NULL AS DOUBLE) AS `LogProba_1`, CAST(NULL AS DOUBLE) AS `LogProba_2`, CAST(NULL AS DOUBLE) AS `LogProba_3`, CAST(NULL AS BIGINT) AS `Decision`, CAST(NULL AS DOUBLE) AS `DecisionProba` 
FROM tmp_20180602143835_u2z_lgbm_sum AS `LGBM_sum`), 
score_class_union AS 
(SELECT scu.`KEY_u` AS `KEY_u`, scu.`class` AS `class`, scu.`LogProba` AS `LogProba`, scu.`Proba` AS `Proba`, scu.`Score` AS `Score` 
FROM (SELECT orig_cte.`KEY` AS `KEY_u`, 0 AS `class`, orig_cte.`LogProba_0` AS `LogProba`, orig_cte.`Proba_0` AS `Proba`, orig_cte.`Score_0` AS `Score` 
FROM orig_cte UNION ALL SELECT orig_cte.`KEY` AS `KEY_u`, 1 AS `class`, orig_cte.`LogProba_1` AS `LogProba`, orig_cte.`Proba_1` AS `Proba`, orig_cte.`Score_1` AS `Score` 
FROM orig_cte UNION ALL SELECT orig_cte.`KEY` AS `KEY_u`, 2 AS `class`, orig_cte.`LogProba_2` AS `LogProba`, orig_cte.`Proba_2` AS `Proba`, orig_cte.`Score_2` AS `Score` 
FROM orig_cte UNION ALL SELECT orig_cte.`KEY` AS `KEY_u`, 3 AS `class`, orig_cte.`LogProba_3` AS `LogProba`, orig_cte.`Proba_3` AS `Proba`, orig_cte.`Score_3` AS `Score` 
FROM orig_cte) AS scu), 
score_max AS 
(SELECT orig_cte.`KEY` AS `KEY`, orig_cte.`Score_0` AS `Score_0`, orig_cte.`Score_1` AS `Score_1`, orig_cte.`Score_2` AS `Score_2`, orig_cte.`Score_3` AS `Score_3`, orig_cte.`Proba_0` AS `Proba_0`, orig_cte.`Proba_1` AS `Proba_1`, orig_cte.`Proba_2` AS `Proba_2`, orig_cte.`Proba_3` AS `Proba_3`, orig_cte.`LogProba_0` AS `LogProba_0`, orig_cte.`LogProba_1` AS `LogProba_1`, orig_cte.`LogProba_2` AS `LogProba_2`, orig_cte.`LogProba_3` AS `LogProba_3`, orig_cte.`Decision` AS `Decision`, orig_cte.`DecisionProba` AS `DecisionProba`, max_select.`KEY_m` AS `KEY_m`, max_select.`max_Score` AS `max_Score` 
FROM orig_cte LEFT OUTER JOIN (SELECT score_class_union.`KEY_u` AS `KEY_m`, max(score_class_union.`Score`) AS `max_Score` 
FROM score_class_union GROUP BY score_class_union.`KEY_u`) AS max_select ON orig_cte.`KEY` = max_select.`KEY_m`), 
score_soft_max_deltas AS 
(SELECT score_max.`KEY` AS `KEY`, score_max.`Score_0` AS `Score_0`, score_max.`Score_1` AS `Score_1`, score_max.`Score_2` AS `Score_2`, score_max.`Score_3` AS `Score_3`, score_max.`Proba_0` AS `Proba_0`, score_max.`Proba_1` AS `Proba_1`, score_max.`Proba_2` AS `Proba_2`, score_max.`Proba_3` AS `Proba_3`, score_max.`LogProba_0` AS `LogProba_0`, score_max.`LogProba_1` AS `LogProba_1`, score_max.`LogProba_2` AS `LogProba_2`, score_max.`LogProba_3` AS `LogProba_3`, score_max.`Decision` AS `Decision`, score_max.`DecisionProba` AS `DecisionProba`, score_max.`KEY_m` AS `KEY_m`, score_max.`max_Score` AS `max_Score`, exp(CASE WHEN (-100.0 <= score_max.`Score_0` - score_max.`max_Score`) THEN score_max.`Score_0` - score_max.`max_Score` ELSE -100.0 END) AS `exp_delta_Score_0`, exp(CASE WHEN (-100.0 <= score_max.`Score_1` - score_max.`max_Score`) THEN score_max.`Score_1` - score_max.`max_Score` ELSE -100.0 END) AS `exp_delta_Score_1`, exp(CASE WHEN (-100.0 <= score_max.`Score_2` - score_max.`max_Score`) THEN score_max.`Score_2` - score_max.`max_Score` ELSE -100.0 END) AS `exp_delta_Score_2`, exp(CASE WHEN (-100.0 <= score_max.`Score_3` - score_max.`max_Score`) THEN score_max.`Score_3` - score_max.`max_Score` ELSE -100.0 END) AS `exp_delta_Score_3` 
FROM score_max), 
score_class_union_soft AS 
(SELECT soft_scu.`KEY` AS `KEY`, soft_scu.`class` AS `class`, soft_scu.`exp_delta_Score` AS `exp_delta_Score` 
FROM (SELECT score_soft_max_deltas.`KEY` AS `KEY`, 0 AS `class`, score_soft_max_deltas.`exp_delta_Score_0` AS `exp_delta_Score` 
FROM score_soft_max_deltas UNION ALL SELECT score_soft_max_deltas.`KEY` AS `KEY`, 1 AS `class`, score_soft_max_deltas.`exp_delta_Score_1` AS `exp_delta_Score` 
FROM score_soft_max_deltas UNION ALL SELECT score_soft_max_deltas.`KEY` AS `KEY`, 2 AS `class`, score_soft_max_deltas.`exp_delta_Score_2` AS `exp_delta_Score` 
FROM score_soft_max_deltas UNION ALL SELECT score_soft_max_deltas.`KEY` AS `KEY`, 3 AS `class`, score_soft_max_deltas.`exp_delta_Score_3` AS `exp_delta_Score` 
FROM score_soft_max_deltas) AS soft_scu), 
score_soft_max AS 
(SELECT score_soft_max_deltas.`KEY` AS `KEY`, score_soft_max_deltas.`Score_0` AS `Score_0`, score_soft_max_deltas.`Score_1` AS `Score_1`, score_soft_max_deltas.`Score_2` AS `Score_2`, score_soft_max_deltas.`Score_3` AS `Score_3`, score_soft_max_deltas.`Proba_0` AS `Proba_0`, score_soft_max_deltas.`Proba_1` AS `Proba_1`, score_soft_max_deltas.`Proba_2` AS `Proba_2`, score_soft_max_deltas.`Proba_3` AS `Proba_3`, score_soft_max_deltas.`LogProba_0` AS `LogProba_0`, score_soft_max_deltas.`LogProba_1` AS `LogProba_1`, score_soft_max_deltas.`LogProba_2` AS `LogProba_2`, score_soft_max_deltas.`LogProba_3` AS `LogProba_3`, score_soft_max_deltas.`Decision` AS `Decision`, score_soft_max_deltas.`DecisionProba` AS `DecisionProba`, score_soft_max_deltas.`KEY_m` AS `KEY_m`, score_soft_max_deltas.`max_Score` AS `max_Score`, score_soft_max_deltas.`exp_delta_Score_0` AS `exp_delta_Score_0`, score_soft_max_deltas.`exp_delta_Score_1` AS `exp_delta_Score_1`, score_soft_max_deltas.`exp_delta_Score_2` AS `exp_delta_Score_2`, score_soft_max_deltas.`exp_delta_Score_3` AS `exp_delta_Score_3`, sum_exp_t.`KEY_sum` AS `KEY_sum`, sum_exp_t.`sum_ExpDeltaScore` AS `sum_ExpDeltaScore` 
FROM score_soft_max_deltas LEFT OUTER JOIN (SELECT score_class_union_soft.`KEY` AS `KEY_sum`, sum(score_class_union_soft.`exp_delta_Score`) AS `sum_ExpDeltaScore` 
FROM score_class_union_soft GROUP BY score_class_union_soft.`KEY`) AS sum_exp_t ON score_soft_max_deltas.`KEY` = sum_exp_t.`KEY_sum`), 
union_with_max AS 
(SELECT score_class_union.`KEY_u` AS `KEY_u`, score_class_union.`class` AS `class`, score_class_union.`LogProba` AS `LogProba`, score_class_union.`Proba` AS `Proba`, score_class_union.`Score` AS `Score`, score_soft_max.`KEY` AS `KEY`, score_soft_max.`Score_0` AS `Score_0`, score_soft_max.`Score_1` AS `Score_1`, score_soft_max.`Score_2` AS `Score_2`, score_soft_max.`Score_3` AS `Score_3`, score_soft_max.`Proba_0` AS `Proba_0`, score_soft_max.`Proba_1` AS `Proba_1`, score_soft_max.`Proba_2` AS `Proba_2`, score_soft_max.`Proba_3` AS `Proba_3`, score_soft_max.`LogProba_0` AS `LogProba_0`, score_soft_max.`LogProba_1` AS `LogProba_1`, score_soft_max.`LogProba_2` AS `LogProba_2`, score_soft_max.`LogProba_3` AS `LogProba_3`, score_soft_max.`Decision` AS `Decision`, score_soft_max.`DecisionProba` AS `DecisionProba`, score_soft_max.`KEY_m` AS `KEY_m`, score_soft_max.`max_Score` AS `max_Score`, score_soft_max.`exp_delta_Score_0` AS `exp_delta_Score_0`, score_soft_max.`exp_delta_Score_1` AS `exp_delta_Score_1`, score_soft_max.`exp_delta_Score_2` AS `exp_delta_Score_2`, score_soft_max.`exp_delta_Score_3` AS `exp_delta_Score_3`, score_soft_max.`KEY_sum` AS `KEY_sum`, score_soft_max.`sum_ExpDeltaScore` AS `sum_ExpDeltaScore` 
FROM score_class_union LEFT OUTER JOIN score_soft_max ON score_class_union.`KEY_u` = score_soft_max.`KEY`), 
arg_max_cte AS 
(SELECT score_soft_max.`KEY` AS `KEY`, score_soft_max.`Score_0` AS `Score_0`, score_soft_max.`Score_1` AS `Score_1`, score_soft_max.`Score_2` AS `Score_2`, score_soft_max.`Score_3` AS `Score_3`, score_soft_max.`Proba_0` AS `Proba_0`, score_soft_max.`Proba_1` AS `Proba_1`, score_soft_max.`Proba_2` AS `Proba_2`, score_soft_max.`Proba_3` AS `Proba_3`, score_soft_max.`LogProba_0` AS `LogProba_0`, score_soft_max.`LogProba_1` AS `LogProba_1`, score_soft_max.`LogProba_2` AS `LogProba_2`, score_soft_max.`LogProba_3` AS `LogProba_3`, score_soft_max.`Decision` AS `Decision`, score_soft_max.`DecisionProba` AS `DecisionProba`, score_soft_max.`KEY_m` AS `KEY_m`, score_soft_max.`max_Score` AS `max_Score`, score_soft_max.`exp_delta_Score_0` AS `exp_delta_Score_0`, score_soft_max.`exp_delta_Score_1` AS `exp_delta_Score_1`, score_soft_max.`exp_delta_Score_2` AS `exp_delta_Score_2`, score_soft_max.`exp_delta_Score_3` AS `exp_delta_Score_3`, score_soft_max.`KEY_sum` AS `KEY_sum`, score_soft_max.`sum_ExpDeltaScore` AS `sum_ExpDeltaScore`, `arg_max_t_Score`.`KEY_Score` AS `KEY_Score`, `arg_max_t_Score`.`arg_max_Score` AS `arg_max_Score`, soft_max_comp.`KEY_softmax` AS `KEY_softmax`, soft_max_comp.`SoftProba_0` AS `SoftProba_0`, soft_max_comp.`SoftProba_1` AS `SoftProba_1`, soft_max_comp.`SoftProba_2` AS `SoftProba_2`, soft_max_comp.`SoftProba_3` AS `SoftProba_3` 
FROM score_soft_max LEFT OUTER JOIN (SELECT union_with_max.`KEY` AS `KEY_Score`, min(union_with_max.`class`) AS `arg_max_Score` 
FROM union_with_max 
WHERE union_with_max.`Score` >= union_with_max.`max_Score` GROUP BY union_with_max.`KEY`) AS `arg_max_t_Score` ON score_soft_max.`KEY` = `arg_max_t_Score`.`KEY_Score` LEFT OUTER JOIN (SELECT score_soft_max.`KEY` AS `KEY_softmax`, score_soft_max.`exp_delta_Score_0` / score_soft_max.`sum_ExpDeltaScore` AS `SoftProba_0`, score_soft_max.`exp_delta_Score_1` / score_soft_max.`sum_ExpDeltaScore` AS `SoftProba_1`, score_soft_max.`exp_delta_Score_2` / score_soft_max.`sum_ExpDeltaScore` AS `SoftProba_2`, score_soft_max.`exp_delta_Score_3` / score_soft_max.`sum_ExpDeltaScore` AS `SoftProba_3` 
FROM score_soft_max) AS soft_max_comp ON soft_max_comp.`KEY_softmax` = `arg_max_t_Score`.`KEY_Score`)
 SELECT arg_max_cte.`KEY` AS `KEY`, CAST(NULL AS DOUBLE) AS `Score_0`, CAST(NULL AS DOUBLE) AS `Score_1`, CAST(NULL AS DOUBLE) AS `Score_2`, CAST(NULL AS DOUBLE) AS `Score_3`, arg_max_cte.`SoftProba_0` AS `Proba_0`, arg_max_cte.`SoftProba_1` AS `Proba_1`, arg_max_cte.`SoftProba_2` AS `Proba_2`, arg_max_cte.`SoftProba_3` AS `Proba_3`, CASE WHEN (arg_max_cte.`SoftProba_0` IS NULL OR arg_max_cte.`SoftProba_0` > 0.0) THEN ln(arg_max_cte.`SoftProba_0`) ELSE -1.79769313486231e+308 END AS `LogProba_0`, CASE WHEN (arg_max_cte.`SoftProba_1` IS NULL OR arg_max_cte.`SoftProba_1` > 0.0) THEN ln(arg_max_cte.`SoftProba_1`) ELSE -1.79769313486231e+308 END AS `LogProba_1`, CASE WHEN (arg_max_cte.`SoftProba_2` IS NULL OR arg_max_cte.`SoftProba_2` > 0.0) THEN ln(arg_max_cte.`SoftProba_2`) ELSE -1.79769313486231e+308 END AS `LogProba_2`, CASE WHEN (arg_max_cte.`SoftProba_3` IS NULL OR arg_max_cte.`SoftProba_3` > 0.0) THEN ln(arg_max_cte.`SoftProba_3`) ELSE -1.79769313486231e+308 END AS `LogProba_3`, arg_max_cte.`arg_max_Score` AS `Decision`, CASE WHEN (arg_max_cte.`SoftProba_0` <= CASE WHEN (arg_max_cte.`SoftProba_1` <= CASE WHEN (arg_max_cte.`SoftProba_2` <= arg_max_cte.`SoftProba_3`) THEN arg_max_cte.`SoftProba_3` ELSE arg_max_cte.`SoftProba_2` END) THEN CASE WHEN (arg_max_cte.`SoftProba_2` <= arg_max_cte.`SoftProba_3`) THEN arg_max_cte.`SoftProba_3` ELSE arg_max_cte.`SoftProba_2` END ELSE arg_max_cte.`SoftProba_1` END) THEN CASE WHEN (arg_max_cte.`SoftProba_1` <= CASE WHEN (arg_max_cte.`SoftProba_2` <= arg_max_cte.`SoftProba_3`) THEN arg_max_cte.`SoftProba_3` ELSE arg_max_cte.`SoftProba_2` END) THEN CASE WHEN (arg_max_cte.`SoftProba_2` <= arg_max_cte.`SoftProba_3`) THEN arg_max_cte.`SoftProba_3` ELSE arg_max_cte.`SoftProba_2` END ELSE arg_max_cte.`SoftProba_1` END ELSE arg_max_cte.`SoftProba_0` END AS `DecisionProba` 
FROM arg_max_cte