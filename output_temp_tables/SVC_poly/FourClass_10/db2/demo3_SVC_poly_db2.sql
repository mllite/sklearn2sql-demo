-- This SQL code was generated by sklearn2sql (development version).
-- Copyright 2018

-- Model : SVC_poly
-- Dataset : FourClass_10
-- Database : db2


-- This SQL code can contain one or more statements, to be executed in the order they appear in this file.



-- Code For temporary table tmp_20180602143451_wth_kernagg_b0 part 1. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180602143451_wth_kernagg_b0 (
	"KEY" BIGINT, 
	"OVO_Class1" BIGINT, 
	"OVO_Class2" BIGINT, 
	"OVO_Decision" BIGINT, 
	"OVO_Conf" DOUBLE
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180602143451_wth_kernagg_b0 part 2. Populate

INSERT INTO tmp_20180602143451_wth_kernagg_b0 WITH kernel_input AS 
(SELECT "ADS"."KEY" AS "KEY", CAST("ADS"."Feature_0" AS DOUBLE) AS "Feature_0", CAST("ADS"."Feature_1" AS DOUBLE) AS "Feature_1", CAST("ADS"."Feature_2" AS DOUBLE) AS "Feature_2", CAST("ADS"."Feature_3" AS DOUBLE) AS "Feature_3", CAST("ADS"."Feature_4" AS DOUBLE) AS "Feature_4", CAST("ADS"."Feature_5" AS DOUBLE) AS "Feature_5", CAST("ADS"."Feature_6" AS DOUBLE) AS "Feature_6", CAST("ADS"."Feature_7" AS DOUBLE) AS "Feature_7", CAST("ADS"."Feature_8" AS DOUBLE) AS "Feature_8", CAST("ADS"."Feature_9" AS DOUBLE) AS "Feature_9", CAST("ADS"."TGT" AS DOUBLE) AS "TGT" 
FROM "FOURCLASS_10" AS "ADS"), 
"SV_data_0_1" AS 
(SELECT "Values".sv_idx AS sv_idx, CAST("Values".dual_coeff AS DOUBLE) AS dual_coeff, CAST("Values".sv_0 AS DOUBLE) AS sv_0, CAST("Values".sv_1 AS DOUBLE) AS sv_1, CAST("Values".sv_2 AS DOUBLE) AS sv_2, CAST("Values".sv_3 AS DOUBLE) AS sv_3, CAST("Values".sv_4 AS DOUBLE) AS sv_4, CAST("Values".sv_5 AS DOUBLE) AS sv_5, CAST("Values".sv_6 AS DOUBLE) AS sv_6, CAST("Values".sv_7 AS DOUBLE) AS sv_7, CAST("Values".sv_8 AS DOUBLE) AS sv_8, CAST("Values".sv_9 AS DOUBLE) AS sv_9 
FROM (SELECT 0 AS sv_idx, 0.35733746600219607 AS dual_coeff, 0.9475980125219733 AS sv_0, -0.9643064202047436 AS sv_1, 2.155773785219882 AS sv_2, 1.161788643602634 AS sv_3, 2.259484322098266 AS sv_4, -1.3631221654569208 AS sv_5, -0.5670401540483618 AS sv_6, 1.064763318975707 AS sv_7, -0.9017238789248192 AS sv_8, 0.6299116301591762 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 1 AS sv_idx, 1.0 AS dual_coeff, 0.710438044049209 AS sv_0, -0.13308577718727133 AS sv_1, -0.49757401197791185 AS sv_2, -0.16999952256748307 AS sv_3, 0.8650066471139324 AS sv_4, -0.025872082992278587 AS sv_5, 0.050915290986185135 AS sv_6, 1.1434694960402423 AS sv_7, 0.14213492779170553 AS sv_8, 0.8116567839201924 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 2 AS sv_idx, 0.2579078599853403 AS dual_coeff, 0.501049774810359 AS sv_0, -0.5961901615133112 AS sv_1, -0.3221335224724159 AS sv_2, -1.0936933061321839 AS sv_3, -0.6936954365490924 AS sv_4, -0.0650419737088196 AS sv_5, 0.4124557016912783 AS sv_6, -0.8355104604074135 AS sv_7, 0.2479598674358872 AS sv_8, 2.614818878550584 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 3 AS sv_idx, 1.0 AS dual_coeff, 0.7319977152616035 AS sv_0, -0.6566767729612742 AS sv_1, 0.4696551666263632 AS sv_2, 0.5012739150165972 AS sv_3, -0.08578609526370284 AS sv_4, 0.2313907955512947 AS sv_5, -0.3746170442342454 AS sv_6, 1.0638503563752586 AS sv_7, 0.8053668932168558 AS sv_8, -0.48598849209747075 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 4 AS sv_idx, 0.0 AS dual_coeff, -0.7604854545960222 AS sv_0, -1.5020204115280527 AS sv_1, -0.06096180450902078 AS sv_2, -1.1477207008984605 AS sv_3, 0.456107072554643 AS sv_4, 0.1357802035153995 AS sv_5, 0.31155055276142957 AS sv_6, 0.5727213227724846 AS sv_7, -0.48017811399063987 AS sv_8, 0.11294939926527063 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 5 AS sv_idx, 0.7120285591189816 AS dual_coeff, -1.6226254382964573 AS sv_0, -0.7596683802292789 AS sv_1, -0.4703152545550393 AS sv_2, -0.3469071105983828 AS sv_3, -1.1704310209824391 AS sv_4, 0.8650836338581496 AS sv_5, -0.05783750341403021 AS sv_6, 0.7409487790591895 AS sv_7, -0.9779584193508374 AS sv_8, -0.1318742310367551 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 6 AS sv_idx, 0.0 AS dual_coeff, 0.9122481516887383 AS sv_0, -2.086829118765322 AS sv_1, 0.30374569568859777 AS sv_2, -1.1101853767875844 AS sv_3, 1.1199464129897319 AS sv_4, -0.08196737041614892 AS sv_5, 0.22153247584060065 AS sv_6, 1.2484437895872367 AS sv_7, 1.810402402770992 AS sv_8, -0.9773916285069058 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 7 AS sv_idx, 1.0 AS dual_coeff, -0.32383965502683 AS sv_0, -0.879424981847306 AS sv_1, 0.5018815162656954 AS sv_2, 0.39630665474052246 AS sv_3, 0.16945831666292244 AS sv_4, -0.8712378800310411 AS sv_5, -0.3534800987233465 AS sv_6, 1.2876104962684052 AS sv_7, 0.47501051078812284 AS sv_8, 0.39361012248315863 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 8 AS sv_idx, 0.0 AS dual_coeff, 0.7613972728564218 AS sv_0, 1.4976227618008826 AS sv_1, -1.3100089131847823 AS sv_2, -1.3990827743820908 AS sv_3, 1.428589673725849 AS sv_4, 0.08356159071541129 AS sv_5, 1.0162726026593867 AS sv_6, -1.8820030863521087 AS sv_7, 0.6647997056493935 AS sv_8, 1.270641951361375 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 9 AS sv_idx, 0.0 AS dual_coeff, 0.3634169263838288 AS sv_0, 0.7380946344924997 AS sv_1, -1.6780617708843482 AS sv_2, -0.8873223080134054 AS sv_3, 0.7194864694405145 AS sv_4, -0.016060972879918152 AS sv_5, 0.5180550429352353 AS sv_6, 0.4309500677762681 AS sv_7, 0.6151679794075329 AS sv_8, -0.2215306594419873 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 10 AS sv_idx, 0.039878594949182125 AS dual_coeff, -2.0059250471778616 AS sv_0, 2.845674045044503 AS sv_1, -2.3629070565905566 AS sv_2, -1.22481267287389 AS sv_3, 2.3004363265777963 AS sv_4, -1.1837022225187166 AS sv_5, 1.149504587617434 AS sv_6, -1.4564711326674875 AS sv_7, 3.070620490630201 AS sv_8, 0.3319921748636244 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 11 AS sv_idx, 0.4524974405515119 AS dual_coeff, -0.8862663250298513 AS sv_0, -0.3659068953820186 AS sv_1, -0.24970499570935745 AS sv_2, 0.4375873727011609 AS sv_3, 0.5964178346474455 AS sv_4, -0.3986449371602447 AS sv_5, -0.3164998658203096 AS sv_6, 2.028875965999351 AS sv_7, -0.81831930171055 AS sv_8, -1.322897896328765 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 12 AS sv_idx, 0.15499588384128551 AS dual_coeff, 1.583422676885443 AS sv_0, 0.9570212487597022 AS sv_1, 0.3025736234705221 AS sv_2, -1.2343434735377932 AS sv_3, 1.0205033436127353 AS sv_4, -0.26049856698744567 AS sv_5, 0.9379983351214948 AS sv_6, -3.6271833750675224 AS sv_7, -0.2481794932367823 AS sv_8, 1.1881458623855992 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 13 AS sv_idx, 0.35607508572886093 AS dual_coeff, -2.0083220499426875 AS sv_0, 0.64560303672471 AS sv_1, -0.644199123074621 AS sv_2, 0.15384108691219223 AS sv_3, 1.5517629157580322 AS sv_4, -0.2860802529640444 AS sv_5, 0.05387355326706872 AS sv_6, 1.112552517400386 AS sv_7, 0.7865124927013015 AS sv_8, 1.3687931066777703 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 14 AS sv_idx, 0.0 AS dual_coeff, 2.8107702281511435 AS sv_0, -0.20115883154819825 AS sv_1, -1.5076678901406049 AS sv_2, -1.6380941321507068 AS sv_3, -0.3409411072732176 AS sv_4, -0.23487363635190292 AS sv_5, 0.7010311726774048 AS sv_6, -0.2700233899457545 AS sv_7, 1.996147651770403 AS sv_8, 0.8693112756683995 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 15 AS sv_idx, 1.0 AS dual_coeff, -0.1682619880379936 AS sv_0, -0.23180216175619872 AS sv_1, 1.21796040423015 AS sv_2, 1.4832006456873041 AS sv_3, 0.8542604543022632 AS sv_4, -0.3870102338535069 AS sv_5, -0.7169358680355282 AS sv_6, 1.3802210747969648 AS sv_7, -0.7542825692024804 AS sv_8, -1.753119623650515 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 16 AS sv_idx, 1.0 AS dual_coeff, -0.6042951551042015 AS sv_0, -1.0533070326682672 AS sv_1, 0.2959483111996122 AS sv_2, 0.20667994839921966 AS sv_3, 0.0934547248693196 AS sv_4, 0.43359156063777593 AS sv_5, -0.30868808858325686 AS sv_6, 1.5182889668182828 AS sv_7, 1.209321437249917 AS sv_8, 0.5156105986092256 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 17 AS sv_idx, -1.0 AS dual_coeff, -0.5303271526476072 AS sv_0, -0.39902275690339284 AS sv_1, 2.2542580477977574 AS sv_2, 1.952364684433529 AS sv_3, 0.5442916548471909 AS sv_4, -0.3653894159197561 AS sv_5, -0.9274136659129909 AS sv_6, 0.6035860072728193 AS sv_7, -0.872761441196829 AS sv_8, -0.019092341726665664 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 18 AS sv_idx, -1.0 AS dual_coeff, -0.6292571849498783 AS sv_0, 1.6129018683024596 AS sv_1, -0.0012566208533661971 AS sv_2, 1.2249147941676752 AS sv_3, 0.1612508267281394 AS sv_4, 0.43505579564303826 AS sv_5, -0.31305093825907737 AS sv_6, -0.2003734845557561 AS sv_7, 1.0204981928097123 AS sv_8, 0.5023258289185895 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 19 AS sv_idx, -1.0 AS dual_coeff, -0.5026674914419033 AS sv_0, 2.2434337746144606 AS sv_1, -0.6828152974955397 AS sv_2, 0.7502184625094492 AS sv_3, 1.4937630456998632 AS sv_4, -0.3401373446391501 AS sv_5, 0.06749385821108089 AS sv_6, -0.21972211316755863 AS sv_7, 0.7409637700356684 AS sv_8, -1.1057905836314752 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 20 AS sv_idx, -0.0 AS dual_coeff, 1.2533880835073579 AS sv_0, -0.026060260987763817 AS sv_1, 4.44155500903782 AS sv_2, 4.836549828838538 AS sv_3, -0.9837688619301492 AS sv_4, 0.1888688624711014 AS sv_5, -2.2748049385374123 AS sv_6, 0.7801171786650409 AS sv_7, 1.0177323969292706 AS sv_8, 1.0225965404741875 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 21 AS sv_idx, -0.0 AS dual_coeff, 1.4639499794023008 AS sv_0, 2.6841045885761528 AS sv_1, -1.333164862031727 AS sv_2, 1.8325767769281724 AS sv_3, -1.6720369718436399 AS sv_4, 0.1109836453347228 AS sv_5, -0.5955346344038657 AS sv_6, 0.547026927091312 AS sv_7, 1.0197140596407803 AS sv_8, -1.4265880639004551 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 22 AS sv_idx, -1.0 AS dual_coeff, -0.6080326284525016 AS sv_0, 0.31308976510870745 AS sv_1, 0.7219797206802061 AS sv_2, 1.192551632100606 AS sv_3, 0.4260114911806969 AS sv_4, -2.019076907942007 AS sv_5, -0.5012555453180462 AS sv_6, 0.6495539532064387 AS sv_7, -0.8003673053468898 AS sv_8, -0.20086204414810277 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 23 AS sv_idx, -0.0 AS dual_coeff, -0.4595236871795928 AS sv_0, 2.2977181868776735 AS sv_1, 0.25762042285226083 AS sv_2, 3.2607254044298646 AS sv_3, -0.4388723539678616 AS sv_4, -0.5362164085336691 AS sv_5, -1.269463881964628 AS sv_6, 1.6354470579619798 AS sv_7, -1.277994412610604 AS sv_8, 1.43629280498466 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 24 AS sv_idx, -0.0 AS dual_coeff, 0.005572703655874979 AS sv_0, 2.308181057340788 AS sv_1, 3.6518554142988924 AS sv_2, 7.30307216309809 AS sv_3, -3.750315814533895 AS sv_4, -1.189570689903679 AS sv_5, -3.2807179937157755 AS sv_6, 1.546094534719291 AS sv_7, 0.19378283133606997 AS sv_8, 0.21636519172841728 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 25 AS sv_idx, -0.0 AS dual_coeff, -0.7073458532617333 AS sv_0, 1.2774020382451352 AS sv_1, 0.3628280157551792 AS sv_2, 3.375831172834355 AS sv_3, -1.13003668545944 AS sv_4, -0.5273034378934962 AS sv_5, -1.5661912395277175 AS sv_6, 2.872921317009621 AS sv_7, -1.1351433835074642 AS sv_8, 0.7375569752405429 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 26 AS sv_idx, -0.3884157857720957 AS dual_coeff, -0.38130269865003463 AS sv_0, 0.14289427501914298 AS sv_1, 1.766774815777937 AS sv_2, 2.235787179574087 AS sv_3, 1.6161608048712348 AS sv_4, -0.5979733826917706 AS sv_5, -0.9694724002162947 AS sv_6, 1.609333047616631 AS sv_7, 0.143574433900628 AS sv_8, -0.24282406881234603 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 27 AS sv_idx, -0.9314080122569103 AS dual_coeff, -1.2701421722716257 AS sv_0, 1.3976002974561887 AS sv_1, 0.05346065112855358 AS sv_2, 1.6409760431068108 AS sv_3, 0.5643071217519879 AS sv_4, 1.456377543159662 AS sv_5, -0.5657493721179311 AS sv_6, 0.966704046659169 AS sv_7, 0.6172442977370132 AS sv_8, 0.552805168880046 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 28 AS sv_idx, -1.0 AS dual_coeff, 0.3621419246928801 AS sv_0, 1.1485510551048872 AS sv_1, 0.38138419913560284 AS sv_2, 1.8338347251707456 AS sv_3, -0.766983073167534 AS sv_4, -0.41932073881689574 AS sv_5, -0.742584426392529 AS sv_6, 0.49385147181181677 AS sv_7, 0.5470800628024794 AS sv_8, -1.2738681089740524 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 29 AS sv_idx, -1.0 AS dual_coeff, 0.12240188653634958 AS sv_0, 1.5196190830489715 AS sv_1, -0.2996663162360911 AS sv_2, 1.5433763658513409 AS sv_3, -1.0926183374809733 AS sv_4, 0.8587294067401514 AS sv_5, -0.5768704811864983 AS sv_6, 0.3816398489464562 AS sv_7, -1.4901396843996222 AS sv_8, -0.19753543035285562 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 30 AS sv_idx, -0.010897092148352416 AS dual_coeff, -0.5135675470364792 AS sv_0, -1.4995221392547151 AS sv_1, 3.6810007245463314 AS sv_2, 1.6093090280815916 AS sv_3, 0.024684048707124706 AS sv_4, 1.0965351526985396 AS sv_5, -0.8705560301091113 AS sv_6, -0.9381804046303728 AS sv_7, -0.32058268918214206 AS sv_8, 1.46903207688595 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 31 AS sv_idx, -0.0 AS dual_coeff, 1.9378098213560637 AS sv_0, 2.063038682551624 AS sv_1, 1.799702287317565 AS sv_2, 5.7759924858623615 AS sv_3, -2.7663958717467656 AS sv_4, -0.7573078864848414 AS sv_5, -2.6322482266181773 AS sv_6, 2.753067320210772 AS sv_7, 1.9009645965187745 AS sv_8, -1.3637383386684128 AS sv_9 FROM SYSIBM.SYSDUMMY1) AS "Values"), 
kernel_dp_0_1 AS 
(SELECT t."KEY" AS "KEY", t.dot_product AS dot_product 
FROM (SELECT full_join_data_sv."KEY" AS "KEY", sum(CAST(full_join_data_sv.dot_prod1 AS DOUBLE)) + 0.7568369196542597 AS dot_product 
FROM (SELECT kernel_input."KEY" AS "KEY", "SV_data_0_1".dual_coeff * power(0.1 * (kernel_input."Feature_0" * "SV_data_0_1".sv_0 + kernel_input."Feature_1" * "SV_data_0_1".sv_1 + kernel_input."Feature_2" * "SV_data_0_1".sv_2 + kernel_input."Feature_3" * "SV_data_0_1".sv_3 + kernel_input."Feature_4" * "SV_data_0_1".sv_4 + kernel_input."Feature_5" * "SV_data_0_1".sv_5 + kernel_input."Feature_6" * "SV_data_0_1".sv_6 + kernel_input."Feature_7" * "SV_data_0_1".sv_7 + kernel_input."Feature_8" * "SV_data_0_1".sv_8 + kernel_input."Feature_9" * "SV_data_0_1".sv_9) + 0.0, 3) AS dot_prod1 
FROM kernel_input, "SV_data_0_1") AS full_join_data_sv GROUP BY full_join_data_sv."KEY") AS t), 
kernel_cte_0_1 AS 
(SELECT kernel_dp_0_1."KEY" AS "KEY", 0 AS "OVO_Class1", 1 AS "OVO_Class2", CASE WHEN (-kernel_dp_0_1.dot_product >= 0.0) THEN 1 ELSE 0 END AS "OVO_Decision", coalesce(-kernel_dp_0_1.dot_product, 1.0 / (1.0 + exp(least(greatest(-100.0, -(-((-kernel_dp_0_1.dot_product) * -0.6311043266407186 + -0.1860004873318276))), 100.0)))) AS "OVO_Conf" 
FROM kernel_dp_0_1)
 SELECT "KernAgg_B0"."KEY", "KernAgg_B0"."OVO_Class1", "KernAgg_B0"."OVO_Class2", "KernAgg_B0"."OVO_Decision", "KernAgg_B0"."OVO_Conf" 
FROM (SELECT "KernAgg_esu_0"."KEY" AS "KEY", "KernAgg_esu_0"."OVO_Class1" AS "OVO_Class1", "KernAgg_esu_0"."OVO_Class2" AS "OVO_Class2", "KernAgg_esu_0"."OVO_Decision" AS "OVO_Decision", "KernAgg_esu_0"."OVO_Conf" AS "OVO_Conf" 
FROM (SELECT kernel_cte_0_1."KEY" AS "KEY", kernel_cte_0_1."OVO_Class1" AS "OVO_Class1", kernel_cte_0_1."OVO_Class2" AS "OVO_Class2", kernel_cte_0_1."OVO_Decision" AS "OVO_Decision", kernel_cte_0_1."OVO_Conf" AS "OVO_Conf" 
FROM kernel_cte_0_1) AS "KernAgg_esu_0") AS "KernAgg_B0"

-- Code For temporary table tmp_20180602143451_ze9_kernagg_b1 part 1. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180602143451_ze9_kernagg_b1 (
	"KEY" BIGINT, 
	"OVO_Class1" BIGINT, 
	"OVO_Class2" BIGINT, 
	"OVO_Decision" BIGINT, 
	"OVO_Conf" DOUBLE
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180602143451_ze9_kernagg_b1 part 2. Populate

INSERT INTO tmp_20180602143451_ze9_kernagg_b1 WITH kernel_input AS 
(SELECT "ADS"."KEY" AS "KEY", CAST("ADS"."Feature_0" AS DOUBLE) AS "Feature_0", CAST("ADS"."Feature_1" AS DOUBLE) AS "Feature_1", CAST("ADS"."Feature_2" AS DOUBLE) AS "Feature_2", CAST("ADS"."Feature_3" AS DOUBLE) AS "Feature_3", CAST("ADS"."Feature_4" AS DOUBLE) AS "Feature_4", CAST("ADS"."Feature_5" AS DOUBLE) AS "Feature_5", CAST("ADS"."Feature_6" AS DOUBLE) AS "Feature_6", CAST("ADS"."Feature_7" AS DOUBLE) AS "Feature_7", CAST("ADS"."Feature_8" AS DOUBLE) AS "Feature_8", CAST("ADS"."Feature_9" AS DOUBLE) AS "Feature_9", CAST("ADS"."TGT" AS DOUBLE) AS "TGT" 
FROM "FOURCLASS_10" AS "ADS"), 
"SV_data_0_2" AS 
(SELECT "Values".sv_idx AS sv_idx, CAST("Values".dual_coeff AS DOUBLE) AS dual_coeff, CAST("Values".sv_0 AS DOUBLE) AS sv_0, CAST("Values".sv_1 AS DOUBLE) AS sv_1, CAST("Values".sv_2 AS DOUBLE) AS sv_2, CAST("Values".sv_3 AS DOUBLE) AS sv_3, CAST("Values".sv_4 AS DOUBLE) AS sv_4, CAST("Values".sv_5 AS DOUBLE) AS sv_5, CAST("Values".sv_6 AS DOUBLE) AS sv_6, CAST("Values".sv_7 AS DOUBLE) AS sv_7, CAST("Values".sv_8 AS DOUBLE) AS sv_8, CAST("Values".sv_9 AS DOUBLE) AS sv_9 
FROM (SELECT 0 AS sv_idx, 0.0 AS dual_coeff, 0.9475980125219733 AS sv_0, -0.9643064202047436 AS sv_1, 2.155773785219882 AS sv_2, 1.161788643602634 AS sv_3, 2.259484322098266 AS sv_4, -1.3631221654569208 AS sv_5, -0.5670401540483618 AS sv_6, 1.064763318975707 AS sv_7, -0.9017238789248192 AS sv_8, 0.6299116301591762 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 1 AS sv_idx, 1.0 AS dual_coeff, 0.710438044049209 AS sv_0, -0.13308577718727133 AS sv_1, -0.49757401197791185 AS sv_2, -0.16999952256748307 AS sv_3, 0.8650066471139324 AS sv_4, -0.025872082992278587 AS sv_5, 0.050915290986185135 AS sv_6, 1.1434694960402423 AS sv_7, 0.14213492779170553 AS sv_8, 0.8116567839201924 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 2 AS sv_idx, 0.0 AS dual_coeff, 0.501049774810359 AS sv_0, -0.5961901615133112 AS sv_1, -0.3221335224724159 AS sv_2, -1.0936933061321839 AS sv_3, -0.6936954365490924 AS sv_4, -0.0650419737088196 AS sv_5, 0.4124557016912783 AS sv_6, -0.8355104604074135 AS sv_7, 0.2479598674358872 AS sv_8, 2.614818878550584 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 3 AS sv_idx, 0.8771329668892687 AS dual_coeff, 0.7319977152616035 AS sv_0, -0.6566767729612742 AS sv_1, 0.4696551666263632 AS sv_2, 0.5012739150165972 AS sv_3, -0.08578609526370284 AS sv_4, 0.2313907955512947 AS sv_5, -0.3746170442342454 AS sv_6, 1.0638503563752586 AS sv_7, 0.8053668932168558 AS sv_8, -0.48598849209747075 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 4 AS sv_idx, 1.0 AS dual_coeff, -0.7604854545960222 AS sv_0, -1.5020204115280527 AS sv_1, -0.06096180450902078 AS sv_2, -1.1477207008984605 AS sv_3, 0.456107072554643 AS sv_4, 0.1357802035153995 AS sv_5, 0.31155055276142957 AS sv_6, 0.5727213227724846 AS sv_7, -0.48017811399063987 AS sv_8, 0.11294939926527063 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 5 AS sv_idx, 1.0 AS dual_coeff, -1.6226254382964573 AS sv_0, -0.7596683802292789 AS sv_1, -0.4703152545550393 AS sv_2, -0.3469071105983828 AS sv_3, -1.1704310209824391 AS sv_4, 0.8650836338581496 AS sv_5, -0.05783750341403021 AS sv_6, 0.7409487790591895 AS sv_7, -0.9779584193508374 AS sv_8, -0.1318742310367551 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 6 AS sv_idx, 0.17488197106396425 AS dual_coeff, 0.9122481516887383 AS sv_0, -2.086829118765322 AS sv_1, 0.30374569568859777 AS sv_2, -1.1101853767875844 AS sv_3, 1.1199464129897319 AS sv_4, -0.08196737041614892 AS sv_5, 0.22153247584060065 AS sv_6, 1.2484437895872367 AS sv_7, 1.810402402770992 AS sv_8, -0.9773916285069058 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 7 AS sv_idx, 1.0 AS dual_coeff, -0.32383965502683 AS sv_0, -0.879424981847306 AS sv_1, 0.5018815162656954 AS sv_2, 0.39630665474052246 AS sv_3, 0.16945831666292244 AS sv_4, -0.8712378800310411 AS sv_5, -0.3534800987233465 AS sv_6, 1.2876104962684052 AS sv_7, 0.47501051078812284 AS sv_8, 0.39361012248315863 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 8 AS sv_idx, 0.41554594448743587 AS dual_coeff, 0.7613972728564218 AS sv_0, 1.4976227618008826 AS sv_1, -1.3100089131847823 AS sv_2, -1.3990827743820908 AS sv_3, 1.428589673725849 AS sv_4, 0.08356159071541129 AS sv_5, 1.0162726026593867 AS sv_6, -1.8820030863521087 AS sv_7, 0.6647997056493935 AS sv_8, 1.270641951361375 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 9 AS sv_idx, 1.0 AS dual_coeff, 0.3634169263838288 AS sv_0, 0.7380946344924997 AS sv_1, -1.6780617708843482 AS sv_2, -0.8873223080134054 AS sv_3, 0.7194864694405145 AS sv_4, -0.016060972879918152 AS sv_5, 0.5180550429352353 AS sv_6, 0.4309500677762681 AS sv_7, 0.6151679794075329 AS sv_8, -0.2215306594419873 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 10 AS sv_idx, 0.02591785710594518 AS dual_coeff, -2.0059250471778616 AS sv_0, 2.845674045044503 AS sv_1, -2.3629070565905566 AS sv_2, -1.22481267287389 AS sv_3, 2.3004363265777963 AS sv_4, -1.1837022225187166 AS sv_5, 1.149504587617434 AS sv_6, -1.4564711326674875 AS sv_7, 3.070620490630201 AS sv_8, 0.3319921748636244 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 11 AS sv_idx, 0.21357754954889732 AS dual_coeff, -0.8862663250298513 AS sv_0, -0.3659068953820186 AS sv_1, -0.24970499570935745 AS sv_2, 0.4375873727011609 AS sv_3, 0.5964178346474455 AS sv_4, -0.3986449371602447 AS sv_5, -0.3164998658203096 AS sv_6, 2.028875965999351 AS sv_7, -0.81831930171055 AS sv_8, -1.322897896328765 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 12 AS sv_idx, 0.0 AS dual_coeff, 1.583422676885443 AS sv_0, 0.9570212487597022 AS sv_1, 0.3025736234705221 AS sv_2, -1.2343434735377932 AS sv_3, 1.0205033436127353 AS sv_4, -0.26049856698744567 AS sv_5, 0.9379983351214948 AS sv_6, -3.6271833750675224 AS sv_7, -0.2481794932367823 AS sv_8, 1.1881458623855992 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 13 AS sv_idx, 0.05905740165576013 AS dual_coeff, -2.0083220499426875 AS sv_0, 0.64560303672471 AS sv_1, -0.644199123074621 AS sv_2, 0.15384108691219223 AS sv_3, 1.5517629157580322 AS sv_4, -0.2860802529640444 AS sv_5, 0.05387355326706872 AS sv_6, 1.112552517400386 AS sv_7, 0.7865124927013015 AS sv_8, 1.3687931066777703 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 14 AS sv_idx, 0.09850032597381558 AS dual_coeff, 2.8107702281511435 AS sv_0, -0.20115883154819825 AS sv_1, -1.5076678901406049 AS sv_2, -1.6380941321507068 AS sv_3, -0.3409411072732176 AS sv_4, -0.23487363635190292 AS sv_5, 0.7010311726774048 AS sv_6, -0.2700233899457545 AS sv_7, 1.996147651770403 AS sv_8, 0.8693112756683995 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 15 AS sv_idx, 0.0 AS dual_coeff, -0.1682619880379936 AS sv_0, -0.23180216175619872 AS sv_1, 1.21796040423015 AS sv_2, 1.4832006456873041 AS sv_3, 0.8542604543022632 AS sv_4, -0.3870102338535069 AS sv_5, -0.7169358680355282 AS sv_6, 1.3802210747969648 AS sv_7, -0.7542825692024804 AS sv_8, -1.753119623650515 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 16 AS sv_idx, 0.0 AS dual_coeff, -0.6042951551042015 AS sv_0, -1.0533070326682672 AS sv_1, 0.2959483111996122 AS sv_2, 0.20667994839921966 AS sv_3, 0.0934547248693196 AS sv_4, 0.43359156063777593 AS sv_5, -0.30868808858325686 AS sv_6, 1.5182889668182828 AS sv_7, 1.209321437249917 AS sv_8, 0.5156105986092256 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 32 AS sv_idx, -1.0 AS dual_coeff, 0.36130330235485497 AS sv_0, 0.914175466575273 AS sv_1, 0.16838808367570435 AS sv_2, 2.4112097556724965 AS sv_3, -1.6645583007217701 AS sv_4, 0.5363879326031334 AS sv_5, -1.1569010620687188 AS sv_6, 1.77985878165691 AS sv_7, 1.0597774221088758 AS sv_8, 0.6916038439055038 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 33 AS sv_idx, -0.03404387176149907 AS dual_coeff, 1.379437953273724 AS sv_0, 1.8469596379044633 AS sv_1, -2.8607406789191976 AS sv_2, 0.5965850704118241 AS sv_3, -1.5264086564240316 AS sv_4, -2.594699659221376 AS sv_5, -0.23341381129125588 AS sv_6, 2.2202487716002484 AS sv_7, -1.117434817605979 AS sv_8, -0.8234440790714608 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 34 AS sv_idx, -0.4654888699722383 AS dual_coeff, -0.62021156059666 AS sv_0, 0.881017178904949 AS sv_1, -2.7159480239324174 AS sv_2, -1.0936327377464863 AS sv_3, 0.4953175346533387 AS sv_4, 1.662672460930335 AS sv_5, 0.5614743934752178 AS sv_6, 1.4498814917370577 AS sv_7, 0.11846602683614461 AS sv_8, 1.0793443975291446 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 35 AS sv_idx, -0.027219925738270805 AS dual_coeff, 0.32341826959648295 AS sv_0, -3.085841957318085 AS sv_1, 0.1601563291591006 AS sv_2, -3.567935865688834 AS sv_3, -0.41912601395925453 AS sv_4, 0.4365104476539064 AS sv_5, 1.273152505631734 AS sv_6, -2.091028647908177 AS sv_7, 0.9380136904955607 AS sv_8, 1.7226040722993716 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 36 AS sv_idx, -0.6910244747010736 AS dual_coeff, 0.26152125787538144 AS sv_0, -2.2347824540402286 AS sv_1, -0.636827993972484 AS sv_2, -3.0578929674358024 AS sv_3, 1.2878625083487787 AS sv_4, 0.33291056374103883 AS sv_5, 1.1699543942540505 AS sv_6, -0.33367022715257466 AS sv_7, 0.46238060129166486 AS sv_8, -0.18440779099069243 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 37 AS sv_idx, -0.13793356209154942 AS dual_coeff, 0.7024601634400496 AS sv_0, 2.640972044465206 AS sv_1, 0.1027410075082742 AS sv_2, 4.723622290474969 AS sv_3, -1.0410581965660897 AS sv_4, -1.0080192103774277 AS sv_5, -2.024695828837066 AS sv_6, 3.6578641512239396 AS sv_7, -0.35992947582286433 AS sv_8, 1.173904485168846 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 38 AS sv_idx, -1.0 AS dual_coeff, -2.3121256842155526 AS sv_0, 0.1947097073987245 AS sv_1, -0.4271770163741134 AS sv_2, 0.21452098434669165 AS sv_3, -0.5137521642728706 AS sv_4, 0.3001204991813368 AS sv_5, -0.13051759138989738 AS sv_6, 0.5360475052618674 AS sv_7, -0.3792582630656641 AS sv_8, 0.3038362285511924 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 39 AS sv_idx, -1.0 AS dual_coeff, -0.23929647235393137 AS sv_0, -1.4123057644794093 AS sv_1, -0.629603334857446 AS sv_2, -2.1704959808451947 AS sv_3, -0.9661491492139072 AS sv_4, -0.50121130930097 AS sv_5, 0.7849292549421616 AS sv_6, -1.12648702476171 AS sv_7, -0.9541511016410574 AS sv_8, -0.34219217399760216 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 40 AS sv_idx, -0.0 AS dual_coeff, 0.877453233191471 AS sv_0, 0.8525193105074779 AS sv_1, -0.04551289005763226 AS sv_2, 1.9531712424427383 AS sv_3, -1.8900235307107218 AS sv_4, 2.1349324856704786 AS sv_5, -0.9484538356942613 AS sv_6, 1.3070285707327143 AS sv_7, 1.6687535011141577 AS sv_8, 0.4344720049661924 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 41 AS sv_idx, -0.0 AS dual_coeff, 0.5223126891662067 AS sv_0, -0.5843921966466941 AS sv_1, -1.9523695782846908 AS sv_2, -1.9063488113635043 AS sv_3, -1.971790117746107 AS sv_4, 1.2677590217581047 AS sv_5, 0.6670384111794657 AS sv_6, -0.2275034822836477 AS sv_7, 0.5957530556545604 AS sv_8, -0.8100836790794957 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 42 AS sv_idx, -0.49963969440165074 AS dual_coeff, -1.0495224376120962 AS sv_0, 0.7644998516500521 AS sv_1, -2.012503187694194 AS sv_2, -1.397852313787251 AS sv_3, -0.7965208902169653 AS sv_4, -2.040113803171429 AS sv_5, 0.7171488802260655 AS sv_6, -0.6998926993071393 AS sv_7, -0.26852046676993463 AS sv_8, -0.08032563816377523 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 43 AS sv_idx, -0.17612624838597737 AS dual_coeff, 0.6594088240218963 AS sv_0, 2.1053465280655477 AS sv_1, 0.8276349141508204 AS sv_2, 4.619051035933396 AS sv_3, -0.4276787870229203 AS sv_4, 0.9959381235678008 AS sv_5, -1.9972343053097106 AS sv_6, 3.390607716535005 AS sv_7, 1.0503797085149378 AS sv_8, -2.7844237984466416 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 44 AS sv_idx, -0.6496473207958648 AS dual_coeff, 0.7359394469163053 AS sv_0, -1.174155399148166 AS sv_1, -1.275663903865864 AS sv_2, -1.3866074910092223 AS sv_3, -2.707463441114933 AS sv_4, 0.6433592121809218 AS sv_5, 0.29170510226664415 AS sv_6, 0.10916594596880769 AS sv_7, 0.22885481609230923 AS sv_8, 0.10715851196782991 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 45 AS sv_idx, -0.18349004887696255 AS dual_coeff, -1.4113130571285446 AS sv_0, -1.0778743852854968 AS sv_1, 0.08705338956130237 AS sv_2, -3.6359776100369197 AS sv_3, 0.5909495686464183 AS sv_4, -1.2710077669151731 AS sv_5, 1.770367863655151 AS sv_6, -4.638300055036927 AS sv_7, 0.999564916000194 AS sv_8, 0.6430072393302189 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 46 AS sv_idx, -1.0 AS dual_coeff, -0.032340697730724274 AS sv_0, -0.2818439528912402 AS sv_1, -1.6288404200191777 AS sv_2, -2.8734125262164922 AS sv_3, 1.2114404534709755 AS sv_4, -0.14466184364459408 AS sv_5, 1.3988165181657142 AS sv_6, -1.3697485464371022 AS sv_7, -0.03277253020320722 AS sv_8, 0.45828793876616447 AS sv_9 FROM SYSIBM.SYSDUMMY1) AS "Values"), 
kernel_dp_0_2 AS 
(SELECT t_1."KEY" AS "KEY", t_1.dot_product AS dot_product 
FROM (SELECT full_join_data_sv_1."KEY" AS "KEY", sum(CAST(full_join_data_sv_1.dot_prod1 AS DOUBLE)) + 0.9194490888152925 AS dot_product 
FROM (SELECT kernel_input."KEY" AS "KEY", "SV_data_0_2".dual_coeff * power(0.1 * (kernel_input."Feature_0" * "SV_data_0_2".sv_0 + kernel_input."Feature_1" * "SV_data_0_2".sv_1 + kernel_input."Feature_2" * "SV_data_0_2".sv_2 + kernel_input."Feature_3" * "SV_data_0_2".sv_3 + kernel_input."Feature_4" * "SV_data_0_2".sv_4 + kernel_input."Feature_5" * "SV_data_0_2".sv_5 + kernel_input."Feature_6" * "SV_data_0_2".sv_6 + kernel_input."Feature_7" * "SV_data_0_2".sv_7 + kernel_input."Feature_8" * "SV_data_0_2".sv_8 + kernel_input."Feature_9" * "SV_data_0_2".sv_9) + 0.0, 3) AS dot_prod1 
FROM kernel_input, "SV_data_0_2") AS full_join_data_sv_1 GROUP BY full_join_data_sv_1."KEY") AS t_1), 
kernel_cte_0_2 AS 
(SELECT kernel_dp_0_2."KEY" AS "KEY", 0 AS "OVO_Class1", 2 AS "OVO_Class2", CASE WHEN (-kernel_dp_0_2.dot_product >= 0.0) THEN 1 ELSE 0 END AS "OVO_Decision", coalesce(-kernel_dp_0_2.dot_product, 1.0 / (1.0 + exp(least(greatest(-100.0, -(-((-kernel_dp_0_2.dot_product) * -0.15579087564617883 + 0.18825983896350545))), 100.0)))) AS "OVO_Conf" 
FROM kernel_dp_0_2)
 SELECT "KernAgg_B1"."KEY", "KernAgg_B1"."OVO_Class1", "KernAgg_B1"."OVO_Class2", "KernAgg_B1"."OVO_Decision", "KernAgg_B1"."OVO_Conf" 
FROM (SELECT "KernAgg_esu_1"."KEY" AS "KEY", "KernAgg_esu_1"."OVO_Class1" AS "OVO_Class1", "KernAgg_esu_1"."OVO_Class2" AS "OVO_Class2", "KernAgg_esu_1"."OVO_Decision" AS "OVO_Decision", "KernAgg_esu_1"."OVO_Conf" AS "OVO_Conf" 
FROM (SELECT kernel_cte_0_2."KEY" AS "KEY", kernel_cte_0_2."OVO_Class1" AS "OVO_Class1", kernel_cte_0_2."OVO_Class2" AS "OVO_Class2", kernel_cte_0_2."OVO_Decision" AS "OVO_Decision", kernel_cte_0_2."OVO_Conf" AS "OVO_Conf" 
FROM kernel_cte_0_2) AS "KernAgg_esu_1") AS "KernAgg_B1"

-- Code For temporary table tmp_20180602143451_vh4_kernagg_b2 part 1. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180602143451_vh4_kernagg_b2 (
	"KEY" BIGINT, 
	"OVO_Class1" BIGINT, 
	"OVO_Class2" BIGINT, 
	"OVO_Decision" BIGINT, 
	"OVO_Conf" DOUBLE
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180602143451_vh4_kernagg_b2 part 2. Populate

INSERT INTO tmp_20180602143451_vh4_kernagg_b2 WITH kernel_input AS 
(SELECT "ADS"."KEY" AS "KEY", CAST("ADS"."Feature_0" AS DOUBLE) AS "Feature_0", CAST("ADS"."Feature_1" AS DOUBLE) AS "Feature_1", CAST("ADS"."Feature_2" AS DOUBLE) AS "Feature_2", CAST("ADS"."Feature_3" AS DOUBLE) AS "Feature_3", CAST("ADS"."Feature_4" AS DOUBLE) AS "Feature_4", CAST("ADS"."Feature_5" AS DOUBLE) AS "Feature_5", CAST("ADS"."Feature_6" AS DOUBLE) AS "Feature_6", CAST("ADS"."Feature_7" AS DOUBLE) AS "Feature_7", CAST("ADS"."Feature_8" AS DOUBLE) AS "Feature_8", CAST("ADS"."Feature_9" AS DOUBLE) AS "Feature_9", CAST("ADS"."TGT" AS DOUBLE) AS "TGT" 
FROM "FOURCLASS_10" AS "ADS"), 
"SV_data_0_3" AS 
(SELECT "Values".sv_idx AS sv_idx, CAST("Values".dual_coeff AS DOUBLE) AS dual_coeff, CAST("Values".sv_0 AS DOUBLE) AS sv_0, CAST("Values".sv_1 AS DOUBLE) AS sv_1, CAST("Values".sv_2 AS DOUBLE) AS sv_2, CAST("Values".sv_3 AS DOUBLE) AS sv_3, CAST("Values".sv_4 AS DOUBLE) AS sv_4, CAST("Values".sv_5 AS DOUBLE) AS sv_5, CAST("Values".sv_6 AS DOUBLE) AS sv_6, CAST("Values".sv_7 AS DOUBLE) AS sv_7, CAST("Values".sv_8 AS DOUBLE) AS sv_8, CAST("Values".sv_9 AS DOUBLE) AS sv_9 
FROM (SELECT 0 AS sv_idx, 0.0 AS dual_coeff, 0.9475980125219733 AS sv_0, -0.9643064202047436 AS sv_1, 2.155773785219882 AS sv_2, 1.161788643602634 AS sv_3, 2.259484322098266 AS sv_4, -1.3631221654569208 AS sv_5, -0.5670401540483618 AS sv_6, 1.064763318975707 AS sv_7, -0.9017238789248192 AS sv_8, 0.6299116301591762 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 1 AS sv_idx, 1.0 AS dual_coeff, 0.710438044049209 AS sv_0, -0.13308577718727133 AS sv_1, -0.49757401197791185 AS sv_2, -0.16999952256748307 AS sv_3, 0.8650066471139324 AS sv_4, -0.025872082992278587 AS sv_5, 0.050915290986185135 AS sv_6, 1.1434694960402423 AS sv_7, 0.14213492779170553 AS sv_8, 0.8116567839201924 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 2 AS sv_idx, 0.5792780576891949 AS dual_coeff, 0.501049774810359 AS sv_0, -0.5961901615133112 AS sv_1, -0.3221335224724159 AS sv_2, -1.0936933061321839 AS sv_3, -0.6936954365490924 AS sv_4, -0.0650419737088196 AS sv_5, 0.4124557016912783 AS sv_6, -0.8355104604074135 AS sv_7, 0.2479598674358872 AS sv_8, 2.614818878550584 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 3 AS sv_idx, 1.0 AS dual_coeff, 0.7319977152616035 AS sv_0, -0.6566767729612742 AS sv_1, 0.4696551666263632 AS sv_2, 0.5012739150165972 AS sv_3, -0.08578609526370284 AS sv_4, 0.2313907955512947 AS sv_5, -0.3746170442342454 AS sv_6, 1.0638503563752586 AS sv_7, 0.8053668932168558 AS sv_8, -0.48598849209747075 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 4 AS sv_idx, 0.0 AS dual_coeff, -0.7604854545960222 AS sv_0, -1.5020204115280527 AS sv_1, -0.06096180450902078 AS sv_2, -1.1477207008984605 AS sv_3, 0.456107072554643 AS sv_4, 0.1357802035153995 AS sv_5, 0.31155055276142957 AS sv_6, 0.5727213227724846 AS sv_7, -0.48017811399063987 AS sv_8, 0.11294939926527063 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 5 AS sv_idx, 1.0 AS dual_coeff, -1.6226254382964573 AS sv_0, -0.7596683802292789 AS sv_1, -0.4703152545550393 AS sv_2, -0.3469071105983828 AS sv_3, -1.1704310209824391 AS sv_4, 0.8650836338581496 AS sv_5, -0.05783750341403021 AS sv_6, 0.7409487790591895 AS sv_7, -0.9779584193508374 AS sv_8, -0.1318742310367551 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 6 AS sv_idx, 0.0 AS dual_coeff, 0.9122481516887383 AS sv_0, -2.086829118765322 AS sv_1, 0.30374569568859777 AS sv_2, -1.1101853767875844 AS sv_3, 1.1199464129897319 AS sv_4, -0.08196737041614892 AS sv_5, 0.22153247584060065 AS sv_6, 1.2484437895872367 AS sv_7, 1.810402402770992 AS sv_8, -0.9773916285069058 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 7 AS sv_idx, 1.0 AS dual_coeff, -0.32383965502683 AS sv_0, -0.879424981847306 AS sv_1, 0.5018815162656954 AS sv_2, 0.39630665474052246 AS sv_3, 0.16945831666292244 AS sv_4, -0.8712378800310411 AS sv_5, -0.3534800987233465 AS sv_6, 1.2876104962684052 AS sv_7, 0.47501051078812284 AS sv_8, 0.39361012248315863 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 8 AS sv_idx, 0.12702871093524834 AS dual_coeff, 0.7613972728564218 AS sv_0, 1.4976227618008826 AS sv_1, -1.3100089131847823 AS sv_2, -1.3990827743820908 AS sv_3, 1.428589673725849 AS sv_4, 0.08356159071541129 AS sv_5, 1.0162726026593867 AS sv_6, -1.8820030863521087 AS sv_7, 0.6647997056493935 AS sv_8, 1.270641951361375 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 9 AS sv_idx, 1.0 AS dual_coeff, 0.3634169263838288 AS sv_0, 0.7380946344924997 AS sv_1, -1.6780617708843482 AS sv_2, -0.8873223080134054 AS sv_3, 0.7194864694405145 AS sv_4, -0.016060972879918152 AS sv_5, 0.5180550429352353 AS sv_6, 0.4309500677762681 AS sv_7, 0.6151679794075329 AS sv_8, -0.2215306594419873 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 10 AS sv_idx, 0.0 AS dual_coeff, -2.0059250471778616 AS sv_0, 2.845674045044503 AS sv_1, -2.3629070565905566 AS sv_2, -1.22481267287389 AS sv_3, 2.3004363265777963 AS sv_4, -1.1837022225187166 AS sv_5, 1.149504587617434 AS sv_6, -1.4564711326674875 AS sv_7, 3.070620490630201 AS sv_8, 0.3319921748636244 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 11 AS sv_idx, 0.1870935279157979 AS dual_coeff, -0.8862663250298513 AS sv_0, -0.3659068953820186 AS sv_1, -0.24970499570935745 AS sv_2, 0.4375873727011609 AS sv_3, 0.5964178346474455 AS sv_4, -0.3986449371602447 AS sv_5, -0.3164998658203096 AS sv_6, 2.028875965999351 AS sv_7, -0.81831930171055 AS sv_8, -1.322897896328765 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 12 AS sv_idx, 0.2957996195238168 AS dual_coeff, 1.583422676885443 AS sv_0, 0.9570212487597022 AS sv_1, 0.3025736234705221 AS sv_2, -1.2343434735377932 AS sv_3, 1.0205033436127353 AS sv_4, -0.26049856698744567 AS sv_5, 0.9379983351214948 AS sv_6, -3.6271833750675224 AS sv_7, -0.2481794932367823 AS sv_8, 1.1881458623855992 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 13 AS sv_idx, 0.18584478519870715 AS dual_coeff, -2.0083220499426875 AS sv_0, 0.64560303672471 AS sv_1, -0.644199123074621 AS sv_2, 0.15384108691219223 AS sv_3, 1.5517629157580322 AS sv_4, -0.2860802529640444 AS sv_5, 0.05387355326706872 AS sv_6, 1.112552517400386 AS sv_7, 0.7865124927013015 AS sv_8, 1.3687931066777703 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 14 AS sv_idx, 0.0 AS dual_coeff, 2.8107702281511435 AS sv_0, -0.20115883154819825 AS sv_1, -1.5076678901406049 AS sv_2, -1.6380941321507068 AS sv_3, -0.3409411072732176 AS sv_4, -0.23487363635190292 AS sv_5, 0.7010311726774048 AS sv_6, -0.2700233899457545 AS sv_7, 1.996147651770403 AS sv_8, 0.8693112756683995 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 15 AS sv_idx, 0.3245569494386219 AS dual_coeff, -0.1682619880379936 AS sv_0, -0.23180216175619872 AS sv_1, 1.21796040423015 AS sv_2, 1.4832006456873041 AS sv_3, 0.8542604543022632 AS sv_4, -0.3870102338535069 AS sv_5, -0.7169358680355282 AS sv_6, 1.3802210747969648 AS sv_7, -0.7542825692024804 AS sv_8, -1.753119623650515 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 16 AS sv_idx, 0.31815912076914726 AS dual_coeff, -0.6042951551042015 AS sv_0, -1.0533070326682672 AS sv_1, 0.2959483111996122 AS sv_2, 0.20667994839921966 AS sv_3, 0.0934547248693196 AS sv_4, 0.43359156063777593 AS sv_5, -0.30868808858325686 AS sv_6, 1.5182889668182828 AS sv_7, 1.209321437249917 AS sv_8, 0.5156105986092256 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 47 AS sv_idx, -1.0 AS dual_coeff, -0.5583924823639528 AS sv_0, 1.3105809038966716 AS sv_1, -0.9010613373281338 AS sv_2, 0.16811173144963457 AS sv_3, -0.8601545422423352 AS sv_4, 0.9444309886480903 AS sv_5, 0.07996100917631371 AS sv_6, -0.6247704016426961 AS sv_7, -1.635627281588523 AS sv_8, 0.4913350109051379 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 48 AS sv_idx, -0.005686700635633282 AS dual_coeff, -0.0030773090682687846 AS sv_0, 2.031845553628207 AS sv_1, -1.5233434071313563 AS sv_2, 0.41249531056248123 AS sv_3, -0.738633992984463 AS sv_4, 0.7554488928463763 AS sv_5, 0.05173478990443278 AS sv_6, -0.20186971626669759 AS sv_7, -2.0693302021355904 AS sv_8, 0.0942146697818402 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 49 AS sv_idx, -0.2759505593853746 AS dual_coeff, 0.5616515631128071 AS sv_0, 0.5493274399760499 AS sv_1, -1.7878413174418595 AS sv_2, -1.5923360797427266 AS sv_3, -0.9688017317645672 AS sv_4, 1.5547544560226256 AS sv_5, 0.7900975908946064 AS sv_6, -1.1712969041252344 AS sv_7, -1.6702920432003687 AS sv_8, 0.1206207624047862 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 50 AS sv_idx, -0.0 AS dual_coeff, 0.636305156382388 AS sv_0, 1.743788490051133 AS sv_1, 0.7657178011346493 AS sv_2, 2.546249335882604 AS sv_3, -2.097832522439988 AS sv_4, 1.7550829759782132 AS sv_5, -1.0152827920260847 AS sv_6, -0.43351762342622036 AS sv_7, 0.5407473106323089 AS sv_8, 0.8382817661390957 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 51 AS sv_idx, -0.0 AS dual_coeff, -2.063295162834261 AS sv_0, 2.733808388165165 AS sv_1, 2.988845446966221 AS sv_2, 5.185680756371328 AS sv_3, 0.519963941902523 AS sv_4, -0.14752596910266838 AS sv_5, -1.9462058561466646 AS sv_6, 0.34305762508309656 AS sv_7, -0.2227444485320821 AS sv_8, -0.5058003865138625 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 52 AS sv_idx, -1.0 AS dual_coeff, 0.32142977152454844 AS sv_0, 1.8222247993794864 AS sv_1, -0.7073418994129459 AS sv_2, 0.6944120719563062 AS sv_3, -0.43754698285221816 AS sv_4, 0.15853523281812312 AS sv_5, -0.063747299055815 AS sv_6, -0.5834418123310803 AS sv_7, -0.07117113335021549 AS sv_8, 0.008195345837626634 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 53 AS sv_idx, -0.09857444319867792 AS dual_coeff, -1.11848880136501 AS sv_0, -0.16886845845772447 AS sv_1, -0.22317353662117534 AS sv_2, -1.6455595291328824 AS sv_3, -1.357151578902304 AS sv_4, 1.1349097915558093 AS sv_5, 0.7884938954829066 AS sv_6, -2.9435946753046762 AS sv_7, -0.6120665005682058 AS sv_8, -0.8300214134281432 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 54 AS sv_idx, -0.7666923073374418 AS dual_coeff, -0.49432436559262044 AS sv_0, 1.1201943283614226 AS sv_1, 0.35732031563747113 AS sv_2, 0.9155571579456978 AS sv_3, -1.8276378039297505 AS sv_4, 0.48828125906256004 AS sv_5, -0.29046880198183805 AS sv_6, -1.5621703381255334 AS sv_7, 1.1330277779829447 AS sv_8, 0.4982022211777723 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 55 AS sv_idx, -1.0 AS dual_coeff, -0.2982856641323979 AS sv_0, 1.6562219161262264 AS sv_1, -1.520806340019603 AS sv_2, -0.3011692975758643 AS sv_3, -0.3687415194448771 AS sv_4, -0.09904085910169363 AS sv_5, 0.37183524572602944 AS sv_6, -0.7158002063509326 AS sv_7, -0.08798278697012904 AS sv_8, 1.4746098318690724 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 56 AS sv_idx, -0.0025629272120327646 AS dual_coeff, -0.7260115874357913 AS sv_0, 0.3091925787532015 AS sv_1, 0.6856143149432006 AS sv_2, 1.7628547984407819 AS sv_3, -3.346410143785196 AS sv_4, -0.5438633888600009 AS sv_5, -0.9495598916075549 AS sv_6, -0.1213231886342635 AS sv_7, -1.6415017006911274 AS sv_8, -1.085697803504388 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 57 AS sv_idx, -0.0 AS dual_coeff, -0.2900040524105142 AS sv_0, 2.0360084584890425 AS sv_1, 1.378378409904958 AS sv_2, 3.223910378373741 AS sv_3, -0.6916242881817921 AS sv_4, -1.7885360709318514 AS sv_5, -1.2162158976508866 AS sv_6, -0.002060551323300075 AS sv_7, 1.3419906953654295 AS sv_8, -0.3463541301131144 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 58 AS sv_idx, -0.0 AS dual_coeff, -0.01685310360797014 AS sv_0, 2.316746380081147 AS sv_1, -0.9145894888183488 AS sv_2, 0.678559483208915 AS sv_3, -1.1570157010481386 AS sv_4, 0.8644006299002615 AS sv_5, 0.0069849164343332715 AS sv_6, -1.3706117853921598 AS sv_7, -0.92259520661707 AS sv_8, -1.7654497366924988 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 59 AS sv_idx, -0.8327196865348113 AS dual_coeff, 0.01663158436200757 AS sv_0, 0.9134541210429848 AS sv_1, 0.6733974908050593 AS sv_2, -0.1309807615835813 AS sv_3, -0.6154093447799145 AS sv_4, -0.548574995285362 AS sv_5, 0.3041014092154993 AS sv_6, -3.024010503018774 AS sv_7, -0.08042811833495835 AS sv_8, 0.6392020587185764 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 60 AS sv_idx, -0.02176516431792634 AS dual_coeff, -1.2939361435540477 AS sv_0, 0.5334337099280959 AS sv_1, -0.17111036327254592 AS sv_2, -0.11445734021171539 AS sv_3, -2.4176616736141963 AS sv_4, -2.1277947525067775 AS sv_5, 0.07504669003754644 AS sv_6, -1.9092594687584343 AS sv_7, -1.6533000080360474 AS sv_8, 0.01559558553610639 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 61 AS sv_idx, -0.3551139576337055 AS dual_coeff, -0.29157358796271793 AS sv_0, 0.8718283154141734 AS sv_1, 1.830615634433919 AS sv_2, 2.86104823525729 AS sv_3, -0.3208216917495872 AS sv_4, 0.5522043442253135 AS sv_5, -1.2160275125466646 AS sv_6, 0.5572789015962594 AS sv_7, 0.4715198809820012 AS sv_8, 0.22418695911281536 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 62 AS sv_idx, -1.0 AS dual_coeff, -0.24873961548043694 AS sv_0, 1.1799894309571168 AS sv_1, 0.962583719288496 AS sv_2, 1.2681579598995851 AS sv_3, -0.6706564722197105 AS sv_4, 0.7379869754948905 AS sv_5, -0.37443842616850687 AS sv_6, -1.4618942488143614 AS sv_7, -0.21472348589688536 AS sv_8, -0.7706707136524124 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 63 AS sv_idx, -0.0 AS dual_coeff, -0.2662260018709619 AS sv_0, 3.476140303869601 AS sv_1, -0.7841689567750048 AS sv_2, 2.4671502296035337 AS sv_3, -0.9744959022134798 AS sv_4, 0.03698694704325669 AS sv_5, -0.696826922632134 AS sv_6, -0.09590682638869219 AS sv_7, 1.5454270693209808 AS sv_8, 0.4434717408763967 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 64 AS sv_idx, -0.6586950252149303 AS dual_coeff, 0.4329310829188612 AS sv_0, 1.9918112811865791 AS sv_1, -1.1782163644120425 AS sv_2, 1.6050707449774766 AS sv_3, -0.8105369757192677 AS sv_4, -0.9630387748738439 AS sv_5, -0.5761579830428114 AS sv_6, 1.359790384484652 AS sv_7, 0.5485049111325756 AS sv_8, 0.7491792114879661 AS sv_9 FROM SYSIBM.SYSDUMMY1) AS "Values"), 
kernel_dp_0_3 AS 
(SELECT t_2."KEY" AS "KEY", t_2.dot_product AS dot_product 
FROM (SELECT full_join_data_sv_2."KEY" AS "KEY", sum(CAST(full_join_data_sv_2.dot_prod1 AS DOUBLE)) + 0.6450223918740093 AS dot_product 
FROM (SELECT kernel_input."KEY" AS "KEY", "SV_data_0_3".dual_coeff * power(0.1 * (kernel_input."Feature_0" * "SV_data_0_3".sv_0 + kernel_input."Feature_1" * "SV_data_0_3".sv_1 + kernel_input."Feature_2" * "SV_data_0_3".sv_2 + kernel_input."Feature_3" * "SV_data_0_3".sv_3 + kernel_input."Feature_4" * "SV_data_0_3".sv_4 + kernel_input."Feature_5" * "SV_data_0_3".sv_5 + kernel_input."Feature_6" * "SV_data_0_3".sv_6 + kernel_input."Feature_7" * "SV_data_0_3".sv_7 + kernel_input."Feature_8" * "SV_data_0_3".sv_8 + kernel_input."Feature_9" * "SV_data_0_3".sv_9) + 0.0, 3) AS dot_prod1 
FROM kernel_input, "SV_data_0_3") AS full_join_data_sv_2 GROUP BY full_join_data_sv_2."KEY") AS t_2), 
kernel_cte_0_3 AS 
(SELECT kernel_dp_0_3."KEY" AS "KEY", 0 AS "OVO_Class1", 3 AS "OVO_Class2", CASE WHEN (-kernel_dp_0_3.dot_product >= 0.0) THEN 1 ELSE 0 END AS "OVO_Decision", coalesce(-kernel_dp_0_3.dot_product, 1.0 / (1.0 + exp(least(greatest(-100.0, -(-((-kernel_dp_0_3.dot_product) * -1.9775378665464947 + 0.4095369184403113))), 100.0)))) AS "OVO_Conf" 
FROM kernel_dp_0_3)
 SELECT "KernAgg_B2"."KEY", "KernAgg_B2"."OVO_Class1", "KernAgg_B2"."OVO_Class2", "KernAgg_B2"."OVO_Decision", "KernAgg_B2"."OVO_Conf" 
FROM (SELECT "KernAgg_esu_2"."KEY" AS "KEY", "KernAgg_esu_2"."OVO_Class1" AS "OVO_Class1", "KernAgg_esu_2"."OVO_Class2" AS "OVO_Class2", "KernAgg_esu_2"."OVO_Decision" AS "OVO_Decision", "KernAgg_esu_2"."OVO_Conf" AS "OVO_Conf" 
FROM (SELECT kernel_cte_0_3."KEY" AS "KEY", kernel_cte_0_3."OVO_Class1" AS "OVO_Class1", kernel_cte_0_3."OVO_Class2" AS "OVO_Class2", kernel_cte_0_3."OVO_Decision" AS "OVO_Decision", kernel_cte_0_3."OVO_Conf" AS "OVO_Conf" 
FROM kernel_cte_0_3) AS "KernAgg_esu_2") AS "KernAgg_B2"

-- Code For temporary table tmp_20180602143451_m4z_kernagg_b3 part 1. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180602143451_m4z_kernagg_b3 (
	"KEY" BIGINT, 
	"OVO_Class1" BIGINT, 
	"OVO_Class2" BIGINT, 
	"OVO_Decision" BIGINT, 
	"OVO_Conf" DOUBLE
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180602143451_m4z_kernagg_b3 part 2. Populate

INSERT INTO tmp_20180602143451_m4z_kernagg_b3 WITH kernel_input AS 
(SELECT "ADS"."KEY" AS "KEY", CAST("ADS"."Feature_0" AS DOUBLE) AS "Feature_0", CAST("ADS"."Feature_1" AS DOUBLE) AS "Feature_1", CAST("ADS"."Feature_2" AS DOUBLE) AS "Feature_2", CAST("ADS"."Feature_3" AS DOUBLE) AS "Feature_3", CAST("ADS"."Feature_4" AS DOUBLE) AS "Feature_4", CAST("ADS"."Feature_5" AS DOUBLE) AS "Feature_5", CAST("ADS"."Feature_6" AS DOUBLE) AS "Feature_6", CAST("ADS"."Feature_7" AS DOUBLE) AS "Feature_7", CAST("ADS"."Feature_8" AS DOUBLE) AS "Feature_8", CAST("ADS"."Feature_9" AS DOUBLE) AS "Feature_9", CAST("ADS"."TGT" AS DOUBLE) AS "TGT" 
FROM "FOURCLASS_10" AS "ADS"), 
"SV_data_1_2" AS 
(SELECT "Values".sv_idx AS sv_idx, CAST("Values".dual_coeff AS DOUBLE) AS dual_coeff, CAST("Values".sv_0 AS DOUBLE) AS sv_0, CAST("Values".sv_1 AS DOUBLE) AS sv_1, CAST("Values".sv_2 AS DOUBLE) AS sv_2, CAST("Values".sv_3 AS DOUBLE) AS sv_3, CAST("Values".sv_4 AS DOUBLE) AS sv_4, CAST("Values".sv_5 AS DOUBLE) AS sv_5, CAST("Values".sv_6 AS DOUBLE) AS sv_6, CAST("Values".sv_7 AS DOUBLE) AS sv_7, CAST("Values".sv_8 AS DOUBLE) AS sv_8, CAST("Values".sv_9 AS DOUBLE) AS sv_9 
FROM (SELECT 17 AS sv_idx, 0.0 AS dual_coeff, -0.5303271526476072 AS sv_0, -0.39902275690339284 AS sv_1, 2.2542580477977574 AS sv_2, 1.952364684433529 AS sv_3, 0.5442916548471909 AS sv_4, -0.3653894159197561 AS sv_5, -0.9274136659129909 AS sv_6, 0.6035860072728193 AS sv_7, -0.872761441196829 AS sv_8, -0.019092341726665664 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 18 AS sv_idx, 1.0 AS dual_coeff, -0.6292571849498783 AS sv_0, 1.6129018683024596 AS sv_1, -0.0012566208533661971 AS sv_2, 1.2249147941676752 AS sv_3, 0.1612508267281394 AS sv_4, 0.43505579564303826 AS sv_5, -0.31305093825907737 AS sv_6, -0.2003734845557561 AS sv_7, 1.0204981928097123 AS sv_8, 0.5023258289185895 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 19 AS sv_idx, 0.2887798235181213 AS dual_coeff, -0.5026674914419033 AS sv_0, 2.2434337746144606 AS sv_1, -0.6828152974955397 AS sv_2, 0.7502184625094492 AS sv_3, 1.4937630456998632 AS sv_4, -0.3401373446391501 AS sv_5, 0.06749385821108089 AS sv_6, -0.21972211316755863 AS sv_7, 0.7409637700356684 AS sv_8, -1.1057905836314752 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 20 AS sv_idx, 0.0 AS dual_coeff, 1.2533880835073579 AS sv_0, -0.026060260987763817 AS sv_1, 4.44155500903782 AS sv_2, 4.836549828838538 AS sv_3, -0.9837688619301492 AS sv_4, 0.1888688624711014 AS sv_5, -2.2748049385374123 AS sv_6, 0.7801171786650409 AS sv_7, 1.0177323969292706 AS sv_8, 1.0225965404741875 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 21 AS sv_idx, 0.16941205590255506 AS dual_coeff, 1.4639499794023008 AS sv_0, 2.6841045885761528 AS sv_1, -1.333164862031727 AS sv_2, 1.8325767769281724 AS sv_3, -1.6720369718436399 AS sv_4, 0.1109836453347228 AS sv_5, -0.5955346344038657 AS sv_6, 0.547026927091312 AS sv_7, 1.0197140596407803 AS sv_8, -1.4265880639004551 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 22 AS sv_idx, 1.0 AS dual_coeff, -0.6080326284525016 AS sv_0, 0.31308976510870745 AS sv_1, 0.7219797206802061 AS sv_2, 1.192551632100606 AS sv_3, 0.4260114911806969 AS sv_4, -2.019076907942007 AS sv_5, -0.5012555453180462 AS sv_6, 0.6495539532064387 AS sv_7, -0.8003673053468898 AS sv_8, -0.20086204414810277 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 23 AS sv_idx, 0.0 AS dual_coeff, -0.4595236871795928 AS sv_0, 2.2977181868776735 AS sv_1, 0.25762042285226083 AS sv_2, 3.2607254044298646 AS sv_3, -0.4388723539678616 AS sv_4, -0.5362164085336691 AS sv_5, -1.269463881964628 AS sv_6, 1.6354470579619798 AS sv_7, -1.277994412610604 AS sv_8, 1.43629280498466 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 24 AS sv_idx, 0.0 AS dual_coeff, 0.005572703655874979 AS sv_0, 2.308181057340788 AS sv_1, 3.6518554142988924 AS sv_2, 7.30307216309809 AS sv_3, -3.750315814533895 AS sv_4, -1.189570689903679 AS sv_5, -3.2807179937157755 AS sv_6, 1.546094534719291 AS sv_7, 0.19378283133606997 AS sv_8, 0.21636519172841728 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 25 AS sv_idx, 0.03906862010286039 AS dual_coeff, -0.7073458532617333 AS sv_0, 1.2774020382451352 AS sv_1, 0.3628280157551792 AS sv_2, 3.375831172834355 AS sv_3, -1.13003668545944 AS sv_4, -0.5273034378934962 AS sv_5, -1.5661912395277175 AS sv_6, 2.872921317009621 AS sv_7, -1.1351433835074642 AS sv_8, 0.7375569752405429 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 26 AS sv_idx, 0.0 AS dual_coeff, -0.38130269865003463 AS sv_0, 0.14289427501914298 AS sv_1, 1.766774815777937 AS sv_2, 2.235787179574087 AS sv_3, 1.6161608048712348 AS sv_4, -0.5979733826917706 AS sv_5, -0.9694724002162947 AS sv_6, 1.609333047616631 AS sv_7, 0.143574433900628 AS sv_8, -0.24282406881234603 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 27 AS sv_idx, 0.3203903820862708 AS dual_coeff, -1.2701421722716257 AS sv_0, 1.3976002974561887 AS sv_1, 0.05346065112855358 AS sv_2, 1.6409760431068108 AS sv_3, 0.5643071217519879 AS sv_4, 1.456377543159662 AS sv_5, -0.5657493721179311 AS sv_6, 0.966704046659169 AS sv_7, 0.6172442977370132 AS sv_8, 0.552805168880046 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 28 AS sv_idx, 1.0 AS dual_coeff, 0.3621419246928801 AS sv_0, 1.1485510551048872 AS sv_1, 0.38138419913560284 AS sv_2, 1.8338347251707456 AS sv_3, -0.766983073167534 AS sv_4, -0.41932073881689574 AS sv_5, -0.742584426392529 AS sv_6, 0.49385147181181677 AS sv_7, 0.5470800628024794 AS sv_8, -1.2738681089740524 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 29 AS sv_idx, 0.8251048891530586 AS dual_coeff, 0.12240188653634958 AS sv_0, 1.5196190830489715 AS sv_1, -0.2996663162360911 AS sv_2, 1.5433763658513409 AS sv_3, -1.0926183374809733 AS sv_4, 0.8587294067401514 AS sv_5, -0.5768704811864983 AS sv_6, 0.3816398489464562 AS sv_7, -1.4901396843996222 AS sv_8, -0.19753543035285562 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 30 AS sv_idx, 0.0 AS dual_coeff, -0.5135675470364792 AS sv_0, -1.4995221392547151 AS sv_1, 3.6810007245463314 AS sv_2, 1.6093090280815916 AS sv_3, 0.024684048707124706 AS sv_4, 1.0965351526985396 AS sv_5, -0.8705560301091113 AS sv_6, -0.9381804046303728 AS sv_7, -0.32058268918214206 AS sv_8, 1.46903207688595 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 31 AS sv_idx, 0.01676677508213024 AS dual_coeff, 1.9378098213560637 AS sv_0, 2.063038682551624 AS sv_1, 1.799702287317565 AS sv_2, 5.7759924858623615 AS sv_3, -2.7663958717467656 AS sv_4, -0.7573078864848414 AS sv_5, -2.6322482266181773 AS sv_6, 2.753067320210772 AS sv_7, 1.9009645965187745 AS sv_8, -1.3637383386684128 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 32 AS sv_idx, -0.813961398891704 AS dual_coeff, 0.36130330235485497 AS sv_0, 0.914175466575273 AS sv_1, 0.16838808367570435 AS sv_2, 2.4112097556724965 AS sv_3, -1.6645583007217701 AS sv_4, 0.5363879326031334 AS sv_5, -1.1569010620687188 AS sv_6, 1.77985878165691 AS sv_7, 1.0597774221088758 AS sv_8, 0.6916038439055038 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 33 AS sv_idx, -0.06127487764457365 AS dual_coeff, 1.379437953273724 AS sv_0, 1.8469596379044633 AS sv_1, -2.8607406789191976 AS sv_2, 0.5965850704118241 AS sv_3, -1.5264086564240316 AS sv_4, -2.594699659221376 AS sv_5, -0.23341381129125588 AS sv_6, 2.2202487716002484 AS sv_7, -1.117434817605979 AS sv_8, -0.8234440790714608 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 34 AS sv_idx, -0.17115737894112273 AS dual_coeff, -0.62021156059666 AS sv_0, 0.881017178904949 AS sv_1, -2.7159480239324174 AS sv_2, -1.0936327377464863 AS sv_3, 0.4953175346533387 AS sv_4, 1.662672460930335 AS sv_5, 0.5614743934752178 AS sv_6, 1.4498814917370577 AS sv_7, 0.11846602683614461 AS sv_8, 1.0793443975291446 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 35 AS sv_idx, -0.0 AS dual_coeff, 0.32341826959648295 AS sv_0, -3.085841957318085 AS sv_1, 0.1601563291591006 AS sv_2, -3.567935865688834 AS sv_3, -0.41912601395925453 AS sv_4, 0.4365104476539064 AS sv_5, 1.273152505631734 AS sv_6, -2.091028647908177 AS sv_7, 0.9380136904955607 AS sv_8, 1.7226040722993716 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 36 AS sv_idx, -0.0 AS dual_coeff, 0.26152125787538144 AS sv_0, -2.2347824540402286 AS sv_1, -0.636827993972484 AS sv_2, -3.0578929674358024 AS sv_3, 1.2878625083487787 AS sv_4, 0.33291056374103883 AS sv_5, 1.1699543942540505 AS sv_6, -0.33367022715257466 AS sv_7, 0.46238060129166486 AS sv_8, -0.18440779099069243 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 37 AS sv_idx, -0.10049353179686508 AS dual_coeff, 0.7024601634400496 AS sv_0, 2.640972044465206 AS sv_1, 0.1027410075082742 AS sv_2, 4.723622290474969 AS sv_3, -1.0410581965660897 AS sv_4, -1.0080192103774277 AS sv_5, -2.024695828837066 AS sv_6, 3.6578641512239396 AS sv_7, -0.35992947582286433 AS sv_8, 1.173904485168846 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 38 AS sv_idx, -1.0 AS dual_coeff, -2.3121256842155526 AS sv_0, 0.1947097073987245 AS sv_1, -0.4271770163741134 AS sv_2, 0.21452098434669165 AS sv_3, -0.5137521642728706 AS sv_4, 0.3001204991813368 AS sv_5, -0.13051759138989738 AS sv_6, 0.5360475052618674 AS sv_7, -0.3792582630656641 AS sv_8, 0.3038362285511924 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 39 AS sv_idx, -1.0 AS dual_coeff, -0.23929647235393137 AS sv_0, -1.4123057644794093 AS sv_1, -0.629603334857446 AS sv_2, -2.1704959808451947 AS sv_3, -0.9661491492139072 AS sv_4, -0.50121130930097 AS sv_5, 0.7849292549421616 AS sv_6, -1.12648702476171 AS sv_7, -0.9541511016410574 AS sv_8, -0.34219217399760216 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 40 AS sv_idx, -0.015110948325186344 AS dual_coeff, 0.877453233191471 AS sv_0, 0.8525193105074779 AS sv_1, -0.04551289005763226 AS sv_2, 1.9531712424427383 AS sv_3, -1.8900235307107218 AS sv_4, 2.1349324856704786 AS sv_5, -0.9484538356942613 AS sv_6, 1.3070285707327143 AS sv_7, 1.6687535011141577 AS sv_8, 0.4344720049661924 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 41 AS sv_idx, -0.0 AS dual_coeff, 0.5223126891662067 AS sv_0, -0.5843921966466941 AS sv_1, -1.9523695782846908 AS sv_2, -1.9063488113635043 AS sv_3, -1.971790117746107 AS sv_4, 1.2677590217581047 AS sv_5, 0.6670384111794657 AS sv_6, -0.2275034822836477 AS sv_7, 0.5957530556545604 AS sv_8, -0.8100836790794957 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 42 AS sv_idx, -0.296092457010326 AS dual_coeff, -1.0495224376120962 AS sv_0, 0.7644998516500521 AS sv_1, -2.012503187694194 AS sv_2, -1.397852313787251 AS sv_3, -0.7965208902169653 AS sv_4, -2.040113803171429 AS sv_5, 0.7171488802260655 AS sv_6, -0.6998926993071393 AS sv_7, -0.26852046676993463 AS sv_8, -0.08032563816377523 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 43 AS sv_idx, -0.2051932660667093 AS dual_coeff, 0.6594088240218963 AS sv_0, 2.1053465280655477 AS sv_1, 0.8276349141508204 AS sv_2, 4.619051035933396 AS sv_3, -0.4276787870229203 AS sv_4, 0.9959381235678008 AS sv_5, -1.9972343053097106 AS sv_6, 3.390607716535005 AS sv_7, 1.0503797085149378 AS sv_8, -2.7844237984466416 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 44 AS sv_idx, -0.1948303864418707 AS dual_coeff, 0.7359394469163053 AS sv_0, -1.174155399148166 AS sv_1, -1.275663903865864 AS sv_2, -1.3866074910092223 AS sv_3, -2.707463441114933 AS sv_4, 0.6433592121809218 AS sv_5, 0.29170510226664415 AS sv_6, 0.10916594596880769 AS sv_7, 0.22885481609230923 AS sv_8, 0.10715851196782991 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 45 AS sv_idx, -0.14453338908003435 AS dual_coeff, -1.4113130571285446 AS sv_0, -1.0778743852854968 AS sv_1, 0.08705338956130237 AS sv_2, -3.6359776100369197 AS sv_3, 0.5909495686464183 AS sv_4, -1.2710077669151731 AS sv_5, 1.770367863655151 AS sv_6, -4.638300055036927 AS sv_7, 0.999564916000194 AS sv_8, 0.6430072393302189 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 46 AS sv_idx, -0.656874911646604 AS dual_coeff, -0.032340697730724274 AS sv_0, -0.2818439528912402 AS sv_1, -1.6288404200191777 AS sv_2, -2.8734125262164922 AS sv_3, 1.2114404534709755 AS sv_4, -0.14466184364459408 AS sv_5, 1.3988165181657142 AS sv_6, -1.3697485464371022 AS sv_7, -0.03277253020320722 AS sv_8, 0.45828793876616447 AS sv_9 FROM SYSIBM.SYSDUMMY1) AS "Values"), 
kernel_dp_1_2 AS 
(SELECT t_3."KEY" AS "KEY", t_3.dot_product AS dot_product 
FROM (SELECT full_join_data_sv_3."KEY" AS "KEY", sum(CAST(full_join_data_sv_3.dot_prod1 AS DOUBLE)) + 0.27574411891592854 AS dot_product 
FROM (SELECT kernel_input."KEY" AS "KEY", "SV_data_1_2".dual_coeff * power(0.1 * (kernel_input."Feature_0" * "SV_data_1_2".sv_0 + kernel_input."Feature_1" * "SV_data_1_2".sv_1 + kernel_input."Feature_2" * "SV_data_1_2".sv_2 + kernel_input."Feature_3" * "SV_data_1_2".sv_3 + kernel_input."Feature_4" * "SV_data_1_2".sv_4 + kernel_input."Feature_5" * "SV_data_1_2".sv_5 + kernel_input."Feature_6" * "SV_data_1_2".sv_6 + kernel_input."Feature_7" * "SV_data_1_2".sv_7 + kernel_input."Feature_8" * "SV_data_1_2".sv_8 + kernel_input."Feature_9" * "SV_data_1_2".sv_9) + 0.0, 3) AS dot_prod1 
FROM kernel_input, "SV_data_1_2") AS full_join_data_sv_3 GROUP BY full_join_data_sv_3."KEY") AS t_3), 
kernel_cte_1_2 AS 
(SELECT kernel_dp_1_2."KEY" AS "KEY", 1 AS "OVO_Class1", 2 AS "OVO_Class2", CASE WHEN (-kernel_dp_1_2.dot_product >= 0.0) THEN 1 ELSE 0 END AS "OVO_Decision", coalesce(-kernel_dp_1_2.dot_product, 1.0 / (1.0 + exp(least(greatest(-100.0, -(-((-kernel_dp_1_2.dot_product) * -0.2922345892705013 + 0.3183059555779065))), 100.0)))) AS "OVO_Conf" 
FROM kernel_dp_1_2)
 SELECT "KernAgg_B3"."KEY", "KernAgg_B3"."OVO_Class1", "KernAgg_B3"."OVO_Class2", "KernAgg_B3"."OVO_Decision", "KernAgg_B3"."OVO_Conf" 
FROM (SELECT "KernAgg_esu_3"."KEY" AS "KEY", "KernAgg_esu_3"."OVO_Class1" AS "OVO_Class1", "KernAgg_esu_3"."OVO_Class2" AS "OVO_Class2", "KernAgg_esu_3"."OVO_Decision" AS "OVO_Decision", "KernAgg_esu_3"."OVO_Conf" AS "OVO_Conf" 
FROM (SELECT kernel_cte_1_2."KEY" AS "KEY", kernel_cte_1_2."OVO_Class1" AS "OVO_Class1", kernel_cte_1_2."OVO_Class2" AS "OVO_Class2", kernel_cte_1_2."OVO_Decision" AS "OVO_Decision", kernel_cte_1_2."OVO_Conf" AS "OVO_Conf" 
FROM kernel_cte_1_2) AS "KernAgg_esu_3") AS "KernAgg_B3"

-- Code For temporary table tmp_20180602143451_fol_kernagg_b4 part 1. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180602143451_fol_kernagg_b4 (
	"KEY" BIGINT, 
	"OVO_Class1" BIGINT, 
	"OVO_Class2" BIGINT, 
	"OVO_Decision" BIGINT, 
	"OVO_Conf" DOUBLE
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180602143451_fol_kernagg_b4 part 2. Populate

INSERT INTO tmp_20180602143451_fol_kernagg_b4 WITH kernel_input AS 
(SELECT "ADS"."KEY" AS "KEY", CAST("ADS"."Feature_0" AS DOUBLE) AS "Feature_0", CAST("ADS"."Feature_1" AS DOUBLE) AS "Feature_1", CAST("ADS"."Feature_2" AS DOUBLE) AS "Feature_2", CAST("ADS"."Feature_3" AS DOUBLE) AS "Feature_3", CAST("ADS"."Feature_4" AS DOUBLE) AS "Feature_4", CAST("ADS"."Feature_5" AS DOUBLE) AS "Feature_5", CAST("ADS"."Feature_6" AS DOUBLE) AS "Feature_6", CAST("ADS"."Feature_7" AS DOUBLE) AS "Feature_7", CAST("ADS"."Feature_8" AS DOUBLE) AS "Feature_8", CAST("ADS"."Feature_9" AS DOUBLE) AS "Feature_9", CAST("ADS"."TGT" AS DOUBLE) AS "TGT" 
FROM "FOURCLASS_10" AS "ADS"), 
"SV_data_1_3" AS 
(SELECT "Values".sv_idx AS sv_idx, CAST("Values".dual_coeff AS DOUBLE) AS dual_coeff, CAST("Values".sv_0 AS DOUBLE) AS sv_0, CAST("Values".sv_1 AS DOUBLE) AS sv_1, CAST("Values".sv_2 AS DOUBLE) AS sv_2, CAST("Values".sv_3 AS DOUBLE) AS sv_3, CAST("Values".sv_4 AS DOUBLE) AS sv_4, CAST("Values".sv_5 AS DOUBLE) AS sv_5, CAST("Values".sv_6 AS DOUBLE) AS sv_6, CAST("Values".sv_7 AS DOUBLE) AS sv_7, CAST("Values".sv_8 AS DOUBLE) AS sv_8, CAST("Values".sv_9 AS DOUBLE) AS sv_9 
FROM (SELECT 17 AS sv_idx, 0.7752452023957036 AS dual_coeff, -0.5303271526476072 AS sv_0, -0.39902275690339284 AS sv_1, 2.2542580477977574 AS sv_2, 1.952364684433529 AS sv_3, 0.5442916548471909 AS sv_4, -0.3653894159197561 AS sv_5, -0.9274136659129909 AS sv_6, 0.6035860072728193 AS sv_7, -0.872761441196829 AS sv_8, -0.019092341726665664 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 18 AS sv_idx, 1.0 AS dual_coeff, -0.6292571849498783 AS sv_0, 1.6129018683024596 AS sv_1, -0.0012566208533661971 AS sv_2, 1.2249147941676752 AS sv_3, 0.1612508267281394 AS sv_4, 0.43505579564303826 AS sv_5, -0.31305093825907737 AS sv_6, -0.2003734845557561 AS sv_7, 1.0204981928097123 AS sv_8, 0.5023258289185895 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 19 AS sv_idx, 0.940150389808836 AS dual_coeff, -0.5026674914419033 AS sv_0, 2.2434337746144606 AS sv_1, -0.6828152974955397 AS sv_2, 0.7502184625094492 AS sv_3, 1.4937630456998632 AS sv_4, -0.3401373446391501 AS sv_5, 0.06749385821108089 AS sv_6, -0.21972211316755863 AS sv_7, 0.7409637700356684 AS sv_8, -1.1057905836314752 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 20 AS sv_idx, 0.02875332817709831 AS dual_coeff, 1.2533880835073579 AS sv_0, -0.026060260987763817 AS sv_1, 4.44155500903782 AS sv_2, 4.836549828838538 AS sv_3, -0.9837688619301492 AS sv_4, 0.1888688624711014 AS sv_5, -2.2748049385374123 AS sv_6, 0.7801171786650409 AS sv_7, 1.0177323969292706 AS sv_8, 1.0225965404741875 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 21 AS sv_idx, 0.20554342160218086 AS dual_coeff, 1.4639499794023008 AS sv_0, 2.6841045885761528 AS sv_1, -1.333164862031727 AS sv_2, 1.8325767769281724 AS sv_3, -1.6720369718436399 AS sv_4, 0.1109836453347228 AS sv_5, -0.5955346344038657 AS sv_6, 0.547026927091312 AS sv_7, 1.0197140596407803 AS sv_8, -1.4265880639004551 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 22 AS sv_idx, 1.0 AS dual_coeff, -0.6080326284525016 AS sv_0, 0.31308976510870745 AS sv_1, 0.7219797206802061 AS sv_2, 1.192551632100606 AS sv_3, 0.4260114911806969 AS sv_4, -2.019076907942007 AS sv_5, -0.5012555453180462 AS sv_6, 0.6495539532064387 AS sv_7, -0.8003673053468898 AS sv_8, -0.20086204414810277 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 23 AS sv_idx, 0.07629353243456058 AS dual_coeff, -0.4595236871795928 AS sv_0, 2.2977181868776735 AS sv_1, 0.25762042285226083 AS sv_2, 3.2607254044298646 AS sv_3, -0.4388723539678616 AS sv_4, -0.5362164085336691 AS sv_5, -1.269463881964628 AS sv_6, 1.6354470579619798 AS sv_7, -1.277994412610604 AS sv_8, 1.43629280498466 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 24 AS sv_idx, 0.031936508518704054 AS dual_coeff, 0.005572703655874979 AS sv_0, 2.308181057340788 AS sv_1, 3.6518554142988924 AS sv_2, 7.30307216309809 AS sv_3, -3.750315814533895 AS sv_4, -1.189570689903679 AS sv_5, -3.2807179937157755 AS sv_6, 1.546094534719291 AS sv_7, 0.19378283133606997 AS sv_8, 0.21636519172841728 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 25 AS sv_idx, 0.0 AS dual_coeff, -0.7073458532617333 AS sv_0, 1.2774020382451352 AS sv_1, 0.3628280157551792 AS sv_2, 3.375831172834355 AS sv_3, -1.13003668545944 AS sv_4, -0.5273034378934962 AS sv_5, -1.5661912395277175 AS sv_6, 2.872921317009621 AS sv_7, -1.1351433835074642 AS sv_8, 0.7375569752405429 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 26 AS sv_idx, 0.0 AS dual_coeff, -0.38130269865003463 AS sv_0, 0.14289427501914298 AS sv_1, 1.766774815777937 AS sv_2, 2.235787179574087 AS sv_3, 1.6161608048712348 AS sv_4, -0.5979733826917706 AS sv_5, -0.9694724002162947 AS sv_6, 1.609333047616631 AS sv_7, 0.143574433900628 AS sv_8, -0.24282406881234603 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 27 AS sv_idx, 1.0 AS dual_coeff, -1.2701421722716257 AS sv_0, 1.3976002974561887 AS sv_1, 0.05346065112855358 AS sv_2, 1.6409760431068108 AS sv_3, 0.5643071217519879 AS sv_4, 1.456377543159662 AS sv_5, -0.5657493721179311 AS sv_6, 0.966704046659169 AS sv_7, 0.6172442977370132 AS sv_8, 0.552805168880046 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 28 AS sv_idx, 1.0 AS dual_coeff, 0.3621419246928801 AS sv_0, 1.1485510551048872 AS sv_1, 0.38138419913560284 AS sv_2, 1.8338347251707456 AS sv_3, -0.766983073167534 AS sv_4, -0.41932073881689574 AS sv_5, -0.742584426392529 AS sv_6, 0.49385147181181677 AS sv_7, 0.5470800628024794 AS sv_8, -1.2738681089740524 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 29 AS sv_idx, 1.0 AS dual_coeff, 0.12240188653634958 AS sv_0, 1.5196190830489715 AS sv_1, -0.2996663162360911 AS sv_2, 1.5433763658513409 AS sv_3, -1.0926183374809733 AS sv_4, 0.8587294067401514 AS sv_5, -0.5768704811864983 AS sv_6, 0.3816398489464562 AS sv_7, -1.4901396843996222 AS sv_8, -0.19753543035285562 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 30 AS sv_idx, 0.047410766366217015 AS dual_coeff, -0.5135675470364792 AS sv_0, -1.4995221392547151 AS sv_1, 3.6810007245463314 AS sv_2, 1.6093090280815916 AS sv_3, 0.024684048707124706 AS sv_4, 1.0965351526985396 AS sv_5, -0.8705560301091113 AS sv_6, -0.9381804046303728 AS sv_7, -0.32058268918214206 AS sv_8, 1.46903207688595 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 31 AS sv_idx, 0.0 AS dual_coeff, 1.9378098213560637 AS sv_0, 2.063038682551624 AS sv_1, 1.799702287317565 AS sv_2, 5.7759924858623615 AS sv_3, -2.7663958717467656 AS sv_4, -0.7573078864848414 AS sv_5, -2.6322482266181773 AS sv_6, 2.753067320210772 AS sv_7, 1.9009645965187745 AS sv_8, -1.3637383386684128 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 47 AS sv_idx, -1.0 AS dual_coeff, -0.5583924823639528 AS sv_0, 1.3105809038966716 AS sv_1, -0.9010613373281338 AS sv_2, 0.16811173144963457 AS sv_3, -0.8601545422423352 AS sv_4, 0.9444309886480903 AS sv_5, 0.07996100917631371 AS sv_6, -0.6247704016426961 AS sv_7, -1.635627281588523 AS sv_8, 0.4913350109051379 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 48 AS sv_idx, -0.13555603456584434 AS dual_coeff, -0.0030773090682687846 AS sv_0, 2.031845553628207 AS sv_1, -1.5233434071313563 AS sv_2, 0.41249531056248123 AS sv_3, -0.738633992984463 AS sv_4, 0.7554488928463763 AS sv_5, 0.05173478990443278 AS sv_6, -0.20186971626669759 AS sv_7, -2.0693302021355904 AS sv_8, 0.0942146697818402 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 49 AS sv_idx, -0.0 AS dual_coeff, 0.5616515631128071 AS sv_0, 0.5493274399760499 AS sv_1, -1.7878413174418595 AS sv_2, -1.5923360797427266 AS sv_3, -0.9688017317645672 AS sv_4, 1.5547544560226256 AS sv_5, 0.7900975908946064 AS sv_6, -1.1712969041252344 AS sv_7, -1.6702920432003687 AS sv_8, 0.1206207624047862 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 50 AS sv_idx, -0.0021817200938028364 AS dual_coeff, 0.636305156382388 AS sv_0, 1.743788490051133 AS sv_1, 0.7657178011346493 AS sv_2, 2.546249335882604 AS sv_3, -2.097832522439988 AS sv_4, 1.7550829759782132 AS sv_5, -1.0152827920260847 AS sv_6, -0.43351762342622036 AS sv_7, 0.5407473106323089 AS sv_8, 0.8382817661390957 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 51 AS sv_idx, -0.04200007064381653 AS dual_coeff, -2.063295162834261 AS sv_0, 2.733808388165165 AS sv_1, 2.988845446966221 AS sv_2, 5.185680756371328 AS sv_3, 0.519963941902523 AS sv_4, -0.14752596910266838 AS sv_5, -1.9462058561466646 AS sv_6, 0.34305762508309656 AS sv_7, -0.2227444485320821 AS sv_8, -0.5058003865138625 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 52 AS sv_idx, -1.0 AS dual_coeff, 0.32142977152454844 AS sv_0, 1.8222247993794864 AS sv_1, -0.7073418994129459 AS sv_2, 0.6944120719563062 AS sv_3, -0.43754698285221816 AS sv_4, 0.15853523281812312 AS sv_5, -0.063747299055815 AS sv_6, -0.5834418123310803 AS sv_7, -0.07117113335021549 AS sv_8, 0.008195345837626634 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 53 AS sv_idx, -0.07770136067231508 AS dual_coeff, -1.11848880136501 AS sv_0, -0.16886845845772447 AS sv_1, -0.22317353662117534 AS sv_2, -1.6455595291328824 AS sv_3, -1.357151578902304 AS sv_4, 1.1349097915558093 AS sv_5, 0.7884938954829066 AS sv_6, -2.9435946753046762 AS sv_7, -0.6120665005682058 AS sv_8, -0.8300214134281432 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 54 AS sv_idx, -0.3775502916523366 AS dual_coeff, -0.49432436559262044 AS sv_0, 1.1201943283614226 AS sv_1, 0.35732031563747113 AS sv_2, 0.9155571579456978 AS sv_3, -1.8276378039297505 AS sv_4, 0.48828125906256004 AS sv_5, -0.29046880198183805 AS sv_6, -1.5621703381255334 AS sv_7, 1.1330277779829447 AS sv_8, 0.4982022211777723 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 55 AS sv_idx, -0.7428609301054601 AS dual_coeff, -0.2982856641323979 AS sv_0, 1.6562219161262264 AS sv_1, -1.520806340019603 AS sv_2, -0.3011692975758643 AS sv_3, -0.3687415194448771 AS sv_4, -0.09904085910169363 AS sv_5, 0.37183524572602944 AS sv_6, -0.7158002063509326 AS sv_7, -0.08798278697012904 AS sv_8, 1.4746098318690724 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 56 AS sv_idx, -0.2477893089497763 AS dual_coeff, -0.7260115874357913 AS sv_0, 0.3091925787532015 AS sv_1, 0.6856143149432006 AS sv_2, 1.7628547984407819 AS sv_3, -3.346410143785196 AS sv_4, -0.5438633888600009 AS sv_5, -0.9495598916075549 AS sv_6, -0.1213231886342635 AS sv_7, -1.6415017006911274 AS sv_8, -1.085697803504388 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 57 AS sv_idx, -0.14875587103921942 AS dual_coeff, -0.2900040524105142 AS sv_0, 2.0360084584890425 AS sv_1, 1.378378409904958 AS sv_2, 3.223910378373741 AS sv_3, -0.6916242881817921 AS sv_4, -1.7885360709318514 AS sv_5, -1.2162158976508866 AS sv_6, -0.002060551323300075 AS sv_7, 1.3419906953654295 AS sv_8, -0.3463541301131144 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 58 AS sv_idx, -0.11503161702660077 AS dual_coeff, -0.01685310360797014 AS sv_0, 2.316746380081147 AS sv_1, -0.9145894888183488 AS sv_2, 0.678559483208915 AS sv_3, -1.1570157010481386 AS sv_4, 0.8644006299002615 AS sv_5, 0.0069849164343332715 AS sv_6, -1.3706117853921598 AS sv_7, -0.92259520661707 AS sv_8, -1.7654497366924988 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 59 AS sv_idx, -0.2752010045835025 AS dual_coeff, 0.01663158436200757 AS sv_0, 0.9134541210429848 AS sv_1, 0.6733974908050593 AS sv_2, -0.1309807615835813 AS sv_3, -0.6154093447799145 AS sv_4, -0.548574995285362 AS sv_5, 0.3041014092154993 AS sv_6, -3.024010503018774 AS sv_7, -0.08042811833495835 AS sv_8, 0.6392020587185764 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 60 AS sv_idx, -0.0 AS dual_coeff, -1.2939361435540477 AS sv_0, 0.5334337099280959 AS sv_1, -0.17111036327254592 AS sv_2, -0.11445734021171539 AS sv_3, -2.4176616736141963 AS sv_4, -2.1277947525067775 AS sv_5, 0.07504669003754644 AS sv_6, -1.9092594687584343 AS sv_7, -1.6533000080360474 AS sv_8, 0.01559558553610639 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 61 AS sv_idx, -1.0 AS dual_coeff, -0.29157358796271793 AS sv_0, 0.8718283154141734 AS sv_1, 1.830615634433919 AS sv_2, 2.86104823525729 AS sv_3, -0.3208216917495872 AS sv_4, 0.5522043442253135 AS sv_5, -1.2160275125466646 AS sv_6, 0.5572789015962594 AS sv_7, 0.4715198809820012 AS sv_8, 0.22418695911281536 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 62 AS sv_idx, -1.0 AS dual_coeff, -0.24873961548043694 AS sv_0, 1.1799894309571168 AS sv_1, 0.962583719288496 AS sv_2, 1.2681579598995851 AS sv_3, -0.6706564722197105 AS sv_4, 0.7379869754948905 AS sv_5, -0.37443842616850687 AS sv_6, -1.4618942488143614 AS sv_7, -0.21472348589688536 AS sv_8, -0.7706707136524124 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 63 AS sv_idx, -0.08907192410699463 AS dual_coeff, -0.2662260018709619 AS sv_0, 3.476140303869601 AS sv_1, -0.7841689567750048 AS sv_2, 2.4671502296035337 AS sv_3, -0.9744959022134798 AS sv_4, 0.03698694704325669 AS sv_5, -0.696826922632134 AS sv_6, -0.09590682638869219 AS sv_7, 1.5454270693209808 AS sv_8, 0.4434717408763967 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 64 AS sv_idx, -0.8516330158636312 AS dual_coeff, 0.4329310829188612 AS sv_0, 1.9918112811865791 AS sv_1, -1.1782163644120425 AS sv_2, 1.6050707449774766 AS sv_3, -0.8105369757192677 AS sv_4, -0.9630387748738439 AS sv_5, -0.5761579830428114 AS sv_6, 1.359790384484652 AS sv_7, 0.5485049111325756 AS sv_8, 0.7491792114879661 AS sv_9 FROM SYSIBM.SYSDUMMY1) AS "Values"), 
kernel_dp_1_3 AS 
(SELECT t_4."KEY" AS "KEY", t_4.dot_product AS dot_product 
FROM (SELECT full_join_data_sv_4."KEY" AS "KEY", sum(CAST(full_join_data_sv_4.dot_prod1 AS DOUBLE)) + -0.09796783757535443 AS dot_product 
FROM (SELECT kernel_input."KEY" AS "KEY", "SV_data_1_3".dual_coeff * power(0.1 * (kernel_input."Feature_0" * "SV_data_1_3".sv_0 + kernel_input."Feature_1" * "SV_data_1_3".sv_1 + kernel_input."Feature_2" * "SV_data_1_3".sv_2 + kernel_input."Feature_3" * "SV_data_1_3".sv_3 + kernel_input."Feature_4" * "SV_data_1_3".sv_4 + kernel_input."Feature_5" * "SV_data_1_3".sv_5 + kernel_input."Feature_6" * "SV_data_1_3".sv_6 + kernel_input."Feature_7" * "SV_data_1_3".sv_7 + kernel_input."Feature_8" * "SV_data_1_3".sv_8 + kernel_input."Feature_9" * "SV_data_1_3".sv_9) + 0.0, 3) AS dot_prod1 
FROM kernel_input, "SV_data_1_3") AS full_join_data_sv_4 GROUP BY full_join_data_sv_4."KEY") AS t_4), 
kernel_cte_1_3 AS 
(SELECT kernel_dp_1_3."KEY" AS "KEY", 1 AS "OVO_Class1", 3 AS "OVO_Class2", CASE WHEN (-kernel_dp_1_3.dot_product >= 0.0) THEN 1 ELSE 0 END AS "OVO_Decision", coalesce(-kernel_dp_1_3.dot_product, 1.0 / (1.0 + exp(least(greatest(-100.0, -(-((-kernel_dp_1_3.dot_product) * -0.6388765426000913 + 0.08011756577115753))), 100.0)))) AS "OVO_Conf" 
FROM kernel_dp_1_3)
 SELECT "KernAgg_B4"."KEY", "KernAgg_B4"."OVO_Class1", "KernAgg_B4"."OVO_Class2", "KernAgg_B4"."OVO_Decision", "KernAgg_B4"."OVO_Conf" 
FROM (SELECT "KernAgg_esu_4"."KEY" AS "KEY", "KernAgg_esu_4"."OVO_Class1" AS "OVO_Class1", "KernAgg_esu_4"."OVO_Class2" AS "OVO_Class2", "KernAgg_esu_4"."OVO_Decision" AS "OVO_Decision", "KernAgg_esu_4"."OVO_Conf" AS "OVO_Conf" 
FROM (SELECT kernel_cte_1_3."KEY" AS "KEY", kernel_cte_1_3."OVO_Class1" AS "OVO_Class1", kernel_cte_1_3."OVO_Class2" AS "OVO_Class2", kernel_cte_1_3."OVO_Decision" AS "OVO_Decision", kernel_cte_1_3."OVO_Conf" AS "OVO_Conf" 
FROM kernel_cte_1_3) AS "KernAgg_esu_4") AS "KernAgg_B4"

-- Code For temporary table tmp_20180602143451_m1d_kernagg_b5 part 1. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180602143451_m1d_kernagg_b5 (
	"KEY" BIGINT, 
	"OVO_Class1" BIGINT, 
	"OVO_Class2" BIGINT, 
	"OVO_Decision" BIGINT, 
	"OVO_Conf" DOUBLE
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180602143451_m1d_kernagg_b5 part 2. Populate

INSERT INTO tmp_20180602143451_m1d_kernagg_b5 WITH kernel_input AS 
(SELECT "ADS"."KEY" AS "KEY", CAST("ADS"."Feature_0" AS DOUBLE) AS "Feature_0", CAST("ADS"."Feature_1" AS DOUBLE) AS "Feature_1", CAST("ADS"."Feature_2" AS DOUBLE) AS "Feature_2", CAST("ADS"."Feature_3" AS DOUBLE) AS "Feature_3", CAST("ADS"."Feature_4" AS DOUBLE) AS "Feature_4", CAST("ADS"."Feature_5" AS DOUBLE) AS "Feature_5", CAST("ADS"."Feature_6" AS DOUBLE) AS "Feature_6", CAST("ADS"."Feature_7" AS DOUBLE) AS "Feature_7", CAST("ADS"."Feature_8" AS DOUBLE) AS "Feature_8", CAST("ADS"."Feature_9" AS DOUBLE) AS "Feature_9", CAST("ADS"."TGT" AS DOUBLE) AS "TGT" 
FROM "FOURCLASS_10" AS "ADS"), 
"SV_data_2_3" AS 
(SELECT "Values".sv_idx AS sv_idx, CAST("Values".dual_coeff AS DOUBLE) AS dual_coeff, CAST("Values".sv_0 AS DOUBLE) AS sv_0, CAST("Values".sv_1 AS DOUBLE) AS sv_1, CAST("Values".sv_2 AS DOUBLE) AS sv_2, CAST("Values".sv_3 AS DOUBLE) AS sv_3, CAST("Values".sv_4 AS DOUBLE) AS sv_4, CAST("Values".sv_5 AS DOUBLE) AS sv_5, CAST("Values".sv_6 AS DOUBLE) AS sv_6, CAST("Values".sv_7 AS DOUBLE) AS sv_7, CAST("Values".sv_8 AS DOUBLE) AS sv_8, CAST("Values".sv_9 AS DOUBLE) AS sv_9 
FROM (SELECT 32 AS sv_idx, 0.940751869490941 AS dual_coeff, 0.36130330235485497 AS sv_0, 0.914175466575273 AS sv_1, 0.16838808367570435 AS sv_2, 2.4112097556724965 AS sv_3, -1.6645583007217701 AS sv_4, 0.5363879326031334 AS sv_5, -1.1569010620687188 AS sv_6, 1.77985878165691 AS sv_7, 1.0597774221088758 AS sv_8, 0.6916038439055038 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 33 AS sv_idx, 0.11526913621353063 AS dual_coeff, 1.379437953273724 AS sv_0, 1.8469596379044633 AS sv_1, -2.8607406789191976 AS sv_2, 0.5965850704118241 AS sv_3, -1.5264086564240316 AS sv_4, -2.594699659221376 AS sv_5, -0.23341381129125588 AS sv_6, 2.2202487716002484 AS sv_7, -1.117434817605979 AS sv_8, -0.8234440790714608 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 34 AS sv_idx, 0.26841250175077913 AS dual_coeff, -0.62021156059666 AS sv_0, 0.881017178904949 AS sv_1, -2.7159480239324174 AS sv_2, -1.0936327377464863 AS sv_3, 0.4953175346533387 AS sv_4, 1.662672460930335 AS sv_5, 0.5614743934752178 AS sv_6, 1.4498814917370577 AS sv_7, 0.11846602683614461 AS sv_8, 1.0793443975291446 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 35 AS sv_idx, 0.0067911034873274585 AS dual_coeff, 0.32341826959648295 AS sv_0, -3.085841957318085 AS sv_1, 0.1601563291591006 AS sv_2, -3.567935865688834 AS sv_3, -0.41912601395925453 AS sv_4, 0.4365104476539064 AS sv_5, 1.273152505631734 AS sv_6, -2.091028647908177 AS sv_7, 0.9380136904955607 AS sv_8, 1.7226040722993716 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 36 AS sv_idx, 0.10710300006435758 AS dual_coeff, 0.26152125787538144 AS sv_0, -2.2347824540402286 AS sv_1, -0.636827993972484 AS sv_2, -3.0578929674358024 AS sv_3, 1.2878625083487787 AS sv_4, 0.33291056374103883 AS sv_5, 1.1699543942540505 AS sv_6, -0.33367022715257466 AS sv_7, 0.46238060129166486 AS sv_8, -0.18440779099069243 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 37 AS sv_idx, 0.13312919988680097 AS dual_coeff, 0.7024601634400496 AS sv_0, 2.640972044465206 AS sv_1, 0.1027410075082742 AS sv_2, 4.723622290474969 AS sv_3, -1.0410581965660897 AS sv_4, -1.0080192103774277 AS sv_5, -2.024695828837066 AS sv_6, 3.6578641512239396 AS sv_7, -0.35992947582286433 AS sv_8, 1.173904485168846 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 38 AS sv_idx, 1.0 AS dual_coeff, -2.3121256842155526 AS sv_0, 0.1947097073987245 AS sv_1, -0.4271770163741134 AS sv_2, 0.21452098434669165 AS sv_3, -0.5137521642728706 AS sv_4, 0.3001204991813368 AS sv_5, -0.13051759138989738 AS sv_6, 0.5360475052618674 AS sv_7, -0.3792582630656641 AS sv_8, 0.3038362285511924 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 39 AS sv_idx, 1.0 AS dual_coeff, -0.23929647235393137 AS sv_0, -1.4123057644794093 AS sv_1, -0.629603334857446 AS sv_2, -2.1704959808451947 AS sv_3, -0.9661491492139072 AS sv_4, -0.50121130930097 AS sv_5, 0.7849292549421616 AS sv_6, -1.12648702476171 AS sv_7, -0.9541511016410574 AS sv_8, -0.34219217399760216 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 40 AS sv_idx, 0.0 AS dual_coeff, 0.877453233191471 AS sv_0, 0.8525193105074779 AS sv_1, -0.04551289005763226 AS sv_2, 1.9531712424427383 AS sv_3, -1.8900235307107218 AS sv_4, 2.1349324856704786 AS sv_5, -0.9484538356942613 AS sv_6, 1.3070285707327143 AS sv_7, 1.6687535011141577 AS sv_8, 0.4344720049661924 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 41 AS sv_idx, 0.06689790938002675 AS dual_coeff, 0.5223126891662067 AS sv_0, -0.5843921966466941 AS sv_1, -1.9523695782846908 AS sv_2, -1.9063488113635043 AS sv_3, -1.971790117746107 AS sv_4, 1.2677590217581047 AS sv_5, 0.6670384111794657 AS sv_6, -0.2275034822836477 AS sv_7, 0.5957530556545604 AS sv_8, -0.8100836790794957 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 42 AS sv_idx, 0.3622281113372518 AS dual_coeff, -1.0495224376120962 AS sv_0, 0.7644998516500521 AS sv_1, -2.012503187694194 AS sv_2, -1.397852313787251 AS sv_3, -0.7965208902169653 AS sv_4, -2.040113803171429 AS sv_5, 0.7171488802260655 AS sv_6, -0.6998926993071393 AS sv_7, -0.26852046676993463 AS sv_8, -0.08032563816377523 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 43 AS sv_idx, 0.12919562539583765 AS dual_coeff, 0.6594088240218963 AS sv_0, 2.1053465280655477 AS sv_1, 0.8276349141508204 AS sv_2, 4.619051035933396 AS sv_3, -0.4276787870229203 AS sv_4, 0.9959381235678008 AS sv_5, -1.9972343053097106 AS sv_6, 3.390607716535005 AS sv_7, 1.0503797085149378 AS sv_8, -2.7844237984466416 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 44 AS sv_idx, 0.3736268138928981 AS dual_coeff, 0.7359394469163053 AS sv_0, -1.174155399148166 AS sv_1, -1.275663903865864 AS sv_2, -1.3866074910092223 AS sv_3, -2.707463441114933 AS sv_4, 0.6433592121809218 AS sv_5, 0.29170510226664415 AS sv_6, 0.10916594596880769 AS sv_7, 0.22885481609230923 AS sv_8, 0.10715851196782991 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 45 AS sv_idx, 0.16275449012955884 AS dual_coeff, -1.4113130571285446 AS sv_0, -1.0778743852854968 AS sv_1, 0.08705338956130237 AS sv_2, -3.6359776100369197 AS sv_3, 0.5909495686464183 AS sv_4, -1.2710077669151731 AS sv_5, 1.770367863655151 AS sv_6, -4.638300055036927 AS sv_7, 0.999564916000194 AS sv_8, 0.6430072393302189 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 46 AS sv_idx, 0.9255731907660109 AS dual_coeff, -0.032340697730724274 AS sv_0, -0.2818439528912402 AS sv_1, -1.6288404200191777 AS sv_2, -2.8734125262164922 AS sv_3, 1.2114404534709755 AS sv_4, -0.14466184364459408 AS sv_5, 1.3988165181657142 AS sv_6, -1.3697485464371022 AS sv_7, -0.03277253020320722 AS sv_8, 0.45828793876616447 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 47 AS sv_idx, -0.7745574063284177 AS dual_coeff, -0.5583924823639528 AS sv_0, 1.3105809038966716 AS sv_1, -0.9010613373281338 AS sv_2, 0.16811173144963457 AS sv_3, -0.8601545422423352 AS sv_4, 0.9444309886480903 AS sv_5, 0.07996100917631371 AS sv_6, -0.6247704016426961 AS sv_7, -1.635627281588523 AS sv_8, 0.4913350109051379 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 48 AS sv_idx, -0.0 AS dual_coeff, -0.0030773090682687846 AS sv_0, 2.031845553628207 AS sv_1, -1.5233434071313563 AS sv_2, 0.41249531056248123 AS sv_3, -0.738633992984463 AS sv_4, 0.7554488928463763 AS sv_5, 0.05173478990443278 AS sv_6, -0.20186971626669759 AS sv_7, -2.0693302021355904 AS sv_8, 0.0942146697818402 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 49 AS sv_idx, -0.28871928642637773 AS dual_coeff, 0.5616515631128071 AS sv_0, 0.5493274399760499 AS sv_1, -1.7878413174418595 AS sv_2, -1.5923360797427266 AS sv_3, -0.9688017317645672 AS sv_4, 1.5547544560226256 AS sv_5, 0.7900975908946064 AS sv_6, -1.1712969041252344 AS sv_7, -1.6702920432003687 AS sv_8, 0.1206207624047862 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 50 AS sv_idx, -0.0 AS dual_coeff, 0.636305156382388 AS sv_0, 1.743788490051133 AS sv_1, 0.7657178011346493 AS sv_2, 2.546249335882604 AS sv_3, -2.097832522439988 AS sv_4, 1.7550829759782132 AS sv_5, -1.0152827920260847 AS sv_6, -0.43351762342622036 AS sv_7, 0.5407473106323089 AS sv_8, 0.8382817661390957 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 51 AS sv_idx, -0.0 AS dual_coeff, -2.063295162834261 AS sv_0, 2.733808388165165 AS sv_1, 2.988845446966221 AS sv_2, 5.185680756371328 AS sv_3, 0.519963941902523 AS sv_4, -0.14752596910266838 AS sv_5, -1.9462058561466646 AS sv_6, 0.34305762508309656 AS sv_7, -0.2227444485320821 AS sv_8, -0.5058003865138625 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 52 AS sv_idx, -1.0 AS dual_coeff, 0.32142977152454844 AS sv_0, 1.8222247993794864 AS sv_1, -0.7073418994129459 AS sv_2, 0.6944120719563062 AS sv_3, -0.43754698285221816 AS sv_4, 0.15853523281812312 AS sv_5, -0.063747299055815 AS sv_6, -0.5834418123310803 AS sv_7, -0.07117113335021549 AS sv_8, 0.008195345837626634 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 53 AS sv_idx, -0.10378672241715578 AS dual_coeff, -1.11848880136501 AS sv_0, -0.16886845845772447 AS sv_1, -0.22317353662117534 AS sv_2, -1.6455595291328824 AS sv_3, -1.357151578902304 AS sv_4, 1.1349097915558093 AS sv_5, 0.7884938954829066 AS sv_6, -2.9435946753046762 AS sv_7, -0.6120665005682058 AS sv_8, -0.8300214134281432 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 54 AS sv_idx, -0.33181233390625614 AS dual_coeff, -0.49432436559262044 AS sv_0, 1.1201943283614226 AS sv_1, 0.35732031563747113 AS sv_2, 0.9155571579456978 AS sv_3, -1.8276378039297505 AS sv_4, 0.48828125906256004 AS sv_5, -0.29046880198183805 AS sv_6, -1.5621703381255334 AS sv_7, 1.1330277779829447 AS sv_8, 0.4982022211777723 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 55 AS sv_idx, -1.0 AS dual_coeff, -0.2982856641323979 AS sv_0, 1.6562219161262264 AS sv_1, -1.520806340019603 AS sv_2, -0.3011692975758643 AS sv_3, -0.3687415194448771 AS sv_4, -0.09904085910169363 AS sv_5, 0.37183524572602944 AS sv_6, -0.7158002063509326 AS sv_7, -0.08798278697012904 AS sv_8, 1.4746098318690724 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 56 AS sv_idx, -0.0 AS dual_coeff, -0.7260115874357913 AS sv_0, 0.3091925787532015 AS sv_1, 0.6856143149432006 AS sv_2, 1.7628547984407819 AS sv_3, -3.346410143785196 AS sv_4, -0.5438633888600009 AS sv_5, -0.9495598916075549 AS sv_6, -0.1213231886342635 AS sv_7, -1.6415017006911274 AS sv_8, -1.085697803504388 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 57 AS sv_idx, -0.0 AS dual_coeff, -0.2900040524105142 AS sv_0, 2.0360084584890425 AS sv_1, 1.378378409904958 AS sv_2, 3.223910378373741 AS sv_3, -0.6916242881817921 AS sv_4, -1.7885360709318514 AS sv_5, -1.2162158976508866 AS sv_6, -0.002060551323300075 AS sv_7, 1.3419906953654295 AS sv_8, -0.3463541301131144 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 58 AS sv_idx, -0.0 AS dual_coeff, -0.01685310360797014 AS sv_0, 2.316746380081147 AS sv_1, -0.9145894888183488 AS sv_2, 0.678559483208915 AS sv_3, -1.1570157010481386 AS sv_4, 0.8644006299002615 AS sv_5, 0.0069849164343332715 AS sv_6, -1.3706117853921598 AS sv_7, -0.92259520661707 AS sv_8, -1.7654497366924988 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 59 AS sv_idx, -0.28844704962986056 AS dual_coeff, 0.01663158436200757 AS sv_0, 0.9134541210429848 AS sv_1, 0.6733974908050593 AS sv_2, -0.1309807615835813 AS sv_3, -0.6154093447799145 AS sv_4, -0.548574995285362 AS sv_5, 0.3041014092154993 AS sv_6, -3.024010503018774 AS sv_7, -0.08042811833495835 AS sv_8, 0.6392020587185764 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 60 AS sv_idx, -0.1384994547818478 AS dual_coeff, -1.2939361435540477 AS sv_0, 0.5334337099280959 AS sv_1, -0.17111036327254592 AS sv_2, -0.11445734021171539 AS sv_3, -2.4176616736141963 AS sv_4, -2.1277947525067775 AS sv_5, 0.07504669003754644 AS sv_6, -1.9092594687584343 AS sv_7, -1.6533000080360474 AS sv_8, 0.01559558553610639 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 61 AS sv_idx, -0.0 AS dual_coeff, -0.29157358796271793 AS sv_0, 0.8718283154141734 AS sv_1, 1.830615634433919 AS sv_2, 2.86104823525729 AS sv_3, -0.3208216917495872 AS sv_4, 0.5522043442253135 AS sv_5, -1.2160275125466646 AS sv_6, 0.5572789015962594 AS sv_7, 0.4715198809820012 AS sv_8, 0.22418695911281536 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 62 AS sv_idx, -0.6659106983054054 AS dual_coeff, -0.24873961548043694 AS sv_0, 1.1799894309571168 AS sv_1, 0.962583719288496 AS sv_2, 1.2681579598995851 AS sv_3, -0.6706564722197105 AS sv_4, 0.7379869754948905 AS sv_5, -0.37443842616850687 AS sv_6, -1.4618942488143614 AS sv_7, -0.21472348589688536 AS sv_8, -0.7706707136524124 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 63 AS sv_idx, -0.0 AS dual_coeff, -0.2662260018709619 AS sv_0, 3.476140303869601 AS sv_1, -0.7841689567750048 AS sv_2, 2.4671502296035337 AS sv_3, -0.9744959022134798 AS sv_4, 0.03698694704325669 AS sv_5, -0.696826922632134 AS sv_6, -0.09590682638869219 AS sv_7, 1.5454270693209808 AS sv_8, 0.4434717408763967 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 64 AS sv_idx, -1.0 AS dual_coeff, 0.4329310829188612 AS sv_0, 1.9918112811865791 AS sv_1, -1.1782163644120425 AS sv_2, 1.6050707449774766 AS sv_3, -0.8105369757192677 AS sv_4, -0.9630387748738439 AS sv_5, -0.5761579830428114 AS sv_6, 1.359790384484652 AS sv_7, 0.5485049111325756 AS sv_8, 0.7491792114879661 AS sv_9 FROM SYSIBM.SYSDUMMY1) AS "Values"), 
kernel_dp_2_3 AS 
(SELECT t_5."KEY" AS "KEY", t_5.dot_product AS dot_product 
FROM (SELECT full_join_data_sv_5."KEY" AS "KEY", sum(CAST(full_join_data_sv_5.dot_prod1 AS DOUBLE)) + -0.27429531881403435 AS dot_product 
FROM (SELECT kernel_input."KEY" AS "KEY", "SV_data_2_3".dual_coeff * power(0.1 * (kernel_input."Feature_0" * "SV_data_2_3".sv_0 + kernel_input."Feature_1" * "SV_data_2_3".sv_1 + kernel_input."Feature_2" * "SV_data_2_3".sv_2 + kernel_input."Feature_3" * "SV_data_2_3".sv_3 + kernel_input."Feature_4" * "SV_data_2_3".sv_4 + kernel_input."Feature_5" * "SV_data_2_3".sv_5 + kernel_input."Feature_6" * "SV_data_2_3".sv_6 + kernel_input."Feature_7" * "SV_data_2_3".sv_7 + kernel_input."Feature_8" * "SV_data_2_3".sv_8 + kernel_input."Feature_9" * "SV_data_2_3".sv_9) + 0.0, 3) AS dot_prod1 
FROM kernel_input, "SV_data_2_3") AS full_join_data_sv_5 GROUP BY full_join_data_sv_5."KEY") AS t_5), 
kernel_cte_2_3 AS 
(SELECT kernel_dp_2_3."KEY" AS "KEY", 2 AS "OVO_Class1", 3 AS "OVO_Class2", CASE WHEN (-kernel_dp_2_3.dot_product >= 0.0) THEN 1 ELSE 0 END AS "OVO_Decision", coalesce(-kernel_dp_2_3.dot_product, 1.0 / (1.0 + exp(least(greatest(-100.0, -(-((-kernel_dp_2_3.dot_product) * -0.22452999745039579 + -0.14099105417130656))), 100.0)))) AS "OVO_Conf" 
FROM kernel_dp_2_3)
 SELECT "KernAgg_B5"."KEY", "KernAgg_B5"."OVO_Class1", "KernAgg_B5"."OVO_Class2", "KernAgg_B5"."OVO_Decision", "KernAgg_B5"."OVO_Conf" 
FROM (SELECT "KernAgg_esu_5"."KEY" AS "KEY", "KernAgg_esu_5"."OVO_Class1" AS "OVO_Class1", "KernAgg_esu_5"."OVO_Class2" AS "OVO_Class2", "KernAgg_esu_5"."OVO_Decision" AS "OVO_Decision", "KernAgg_esu_5"."OVO_Conf" AS "OVO_Conf" 
FROM (SELECT kernel_cte_2_3."KEY" AS "KEY", kernel_cte_2_3."OVO_Class1" AS "OVO_Class1", kernel_cte_2_3."OVO_Class2" AS "OVO_Class2", kernel_cte_2_3."OVO_Decision" AS "OVO_Decision", kernel_cte_2_3."OVO_Conf" AS "OVO_Conf" 
FROM kernel_cte_2_3) AS "KernAgg_esu_5") AS "KernAgg_B5"

-- Code For temporary table tmp_20180602143451_p9l_kernagg_agg part 1. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180602143451_p9l_kernagg_agg (
	"KEY" BIGINT, 
	"OVO_Vote_0" BIGINT, 
	"OVO_SumConfidence_0" DOUBLE, 
	"OVO_Vote_1" BIGINT, 
	"OVO_SumConfidence_1" DOUBLE, 
	"OVO_Vote_2" BIGINT, 
	"OVO_SumConfidence_2" DOUBLE, 
	"OVO_Vote_3" BIGINT, 
	"OVO_SumConfidence_3" DOUBLE, 
	max_abs_confidence DOUBLE, 
	"OVO_Scale" DOUBLE, 
	"Score_0" DOUBLE, 
	"Score_1" DOUBLE, 
	"Score_2" DOUBLE, 
	"Score_3" DOUBLE
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180602143451_p9l_kernagg_agg part 2. Populate

INSERT INTO tmp_20180602143451_p9l_kernagg_agg WITH "KernAgg_Union" AS 
(SELECT "KernAgg_EnsembleUnion"."KEY" AS "KEY", "KernAgg_EnsembleUnion"."OVO_Class1" AS "OVO_Class1", "KernAgg_EnsembleUnion"."OVO_Class2" AS "OVO_Class2", "KernAgg_EnsembleUnion"."OVO_Decision" AS "OVO_Decision", "KernAgg_EnsembleUnion"."OVO_Conf" AS "OVO_Conf" 
FROM (SELECT "KernAgg_B0"."KEY" AS "KEY", "KernAgg_B0"."OVO_Class1" AS "OVO_Class1", "KernAgg_B0"."OVO_Class2" AS "OVO_Class2", "KernAgg_B0"."OVO_Decision" AS "OVO_Decision", "KernAgg_B0"."OVO_Conf" AS "OVO_Conf" 
FROM tmp_20180602143451_wth_kernagg_b0 AS "KernAgg_B0" UNION ALL SELECT "KernAgg_B1"."KEY" AS "KEY", "KernAgg_B1"."OVO_Class1" AS "OVO_Class1", "KernAgg_B1"."OVO_Class2" AS "OVO_Class2", "KernAgg_B1"."OVO_Decision" AS "OVO_Decision", "KernAgg_B1"."OVO_Conf" AS "OVO_Conf" 
FROM tmp_20180602143451_ze9_kernagg_b1 AS "KernAgg_B1" UNION ALL SELECT "KernAgg_B2"."KEY" AS "KEY", "KernAgg_B2"."OVO_Class1" AS "OVO_Class1", "KernAgg_B2"."OVO_Class2" AS "OVO_Class2", "KernAgg_B2"."OVO_Decision" AS "OVO_Decision", "KernAgg_B2"."OVO_Conf" AS "OVO_Conf" 
FROM tmp_20180602143451_vh4_kernagg_b2 AS "KernAgg_B2" UNION ALL SELECT "KernAgg_B3"."KEY" AS "KEY", "KernAgg_B3"."OVO_Class1" AS "OVO_Class1", "KernAgg_B3"."OVO_Class2" AS "OVO_Class2", "KernAgg_B3"."OVO_Decision" AS "OVO_Decision", "KernAgg_B3"."OVO_Conf" AS "OVO_Conf" 
FROM tmp_20180602143451_m4z_kernagg_b3 AS "KernAgg_B3" UNION ALL SELECT "KernAgg_B4"."KEY" AS "KEY", "KernAgg_B4"."OVO_Class1" AS "OVO_Class1", "KernAgg_B4"."OVO_Class2" AS "OVO_Class2", "KernAgg_B4"."OVO_Decision" AS "OVO_Decision", "KernAgg_B4"."OVO_Conf" AS "OVO_Conf" 
FROM tmp_20180602143451_fol_kernagg_b4 AS "KernAgg_B4" UNION ALL SELECT "KernAgg_B5"."KEY" AS "KEY", "KernAgg_B5"."OVO_Class1" AS "OVO_Class1", "KernAgg_B5"."OVO_Class2" AS "OVO_Class2", "KernAgg_B5"."OVO_Decision" AS "OVO_Decision", "KernAgg_B5"."OVO_Conf" AS "OVO_Conf" 
FROM tmp_20180602143451_m1d_kernagg_b5 AS "KernAgg_B5") AS "KernAgg_EnsembleUnion"), 
"OVO_Votes" AS 
(SELECT "Votes_Sel"."KEY" AS "KEY", "Votes_Sel"."OVO_Vote_0" AS "OVO_Vote_0", "Votes_Sel"."OVO_SumConfidence_0" AS "OVO_SumConfidence_0", "Votes_Sel"."OVO_Vote_1" AS "OVO_Vote_1", "Votes_Sel"."OVO_SumConfidence_1" AS "OVO_SumConfidence_1", "Votes_Sel"."OVO_Vote_2" AS "OVO_Vote_2", "Votes_Sel"."OVO_SumConfidence_2" AS "OVO_SumConfidence_2", "Votes_Sel"."OVO_Vote_3" AS "OVO_Vote_3", "Votes_Sel"."OVO_SumConfidence_3" AS "OVO_SumConfidence_3" 
FROM (SELECT "KernAgg_Union"."KEY" AS "KEY", sum(CASE WHEN ("KernAgg_Union"."OVO_Class1" = 0 OR "KernAgg_Union"."OVO_Class2" = 0) THEN 1 ELSE 0 END * (CASE WHEN ("KernAgg_Union"."OVO_Decision" = 0 AND "KernAgg_Union"."OVO_Class1" = 0) THEN 1 ELSE 0 END + CASE WHEN ("KernAgg_Union"."OVO_Decision" = 1 AND "KernAgg_Union"."OVO_Class2" = 0) THEN 1 ELSE 0 END)) AS "OVO_Vote_0", sum(CASE WHEN ("KernAgg_Union"."OVO_Class1" = 0 OR "KernAgg_Union"."OVO_Class2" = 0) THEN 1 ELSE 0 END * "KernAgg_Union"."OVO_Conf" * (-CASE WHEN ("KernAgg_Union"."OVO_Class1" = 0) THEN 1 ELSE 0 END + CASE WHEN ("KernAgg_Union"."OVO_Class2" = 0) THEN 1 ELSE 0 END)) AS "OVO_SumConfidence_0", sum(CASE WHEN ("KernAgg_Union"."OVO_Class1" = 1 OR "KernAgg_Union"."OVO_Class2" = 1) THEN 1 ELSE 0 END * (CASE WHEN ("KernAgg_Union"."OVO_Decision" = 0 AND "KernAgg_Union"."OVO_Class1" = 1) THEN 1 ELSE 0 END + CASE WHEN ("KernAgg_Union"."OVO_Decision" = 1 AND "KernAgg_Union"."OVO_Class2" = 1) THEN 1 ELSE 0 END)) AS "OVO_Vote_1", sum(CASE WHEN ("KernAgg_Union"."OVO_Class1" = 1 OR "KernAgg_Union"."OVO_Class2" = 1) THEN 1 ELSE 0 END * "KernAgg_Union"."OVO_Conf" * (-CASE WHEN ("KernAgg_Union"."OVO_Class1" = 1) THEN 1 ELSE 0 END + CASE WHEN ("KernAgg_Union"."OVO_Class2" = 1) THEN 1 ELSE 0 END)) AS "OVO_SumConfidence_1", sum(CASE WHEN ("KernAgg_Union"."OVO_Class1" = 2 OR "KernAgg_Union"."OVO_Class2" = 2) THEN 1 ELSE 0 END * (CASE WHEN ("KernAgg_Union"."OVO_Decision" = 0 AND "KernAgg_Union"."OVO_Class1" = 2) THEN 1 ELSE 0 END + CASE WHEN ("KernAgg_Union"."OVO_Decision" = 1 AND "KernAgg_Union"."OVO_Class2" = 2) THEN 1 ELSE 0 END)) AS "OVO_Vote_2", sum(CASE WHEN ("KernAgg_Union"."OVO_Class1" = 2 OR "KernAgg_Union"."OVO_Class2" = 2) THEN 1 ELSE 0 END * "KernAgg_Union"."OVO_Conf" * (-CASE WHEN ("KernAgg_Union"."OVO_Class1" = 2) THEN 1 ELSE 0 END + CASE WHEN ("KernAgg_Union"."OVO_Class2" = 2) THEN 1 ELSE 0 END)) AS "OVO_SumConfidence_2", sum(CASE WHEN ("KernAgg_Union"."OVO_Class1" = 3 OR "KernAgg_Union"."OVO_Class2" = 3) THEN 1 ELSE 0 END * (CASE WHEN ("KernAgg_Union"."OVO_Decision" = 0 AND "KernAgg_Union"."OVO_Class1" = 3) THEN 1 ELSE 0 END + CASE WHEN ("KernAgg_Union"."OVO_Decision" = 1 AND "KernAgg_Union"."OVO_Class2" = 3) THEN 1 ELSE 0 END)) AS "OVO_Vote_3", sum(CASE WHEN ("KernAgg_Union"."OVO_Class1" = 3 OR "KernAgg_Union"."OVO_Class2" = 3) THEN 1 ELSE 0 END * "KernAgg_Union"."OVO_Conf" * (-CASE WHEN ("KernAgg_Union"."OVO_Class1" = 3) THEN 1 ELSE 0 END + CASE WHEN ("KernAgg_Union"."OVO_Class2" = 3) THEN 1 ELSE 0 END)) AS "OVO_SumConfidence_3" 
FROM "KernAgg_Union" GROUP BY "KernAgg_Union"."KEY") AS "Votes_Sel"), 
"OVO_SumConf_CTE" AS 
(SELECT "Values"."KEY" AS "KEY", CAST("Values"."OVO_SumConfidence" AS DOUBLE) AS "OVO_SumConfidence" 
FROM (SELECT "OVO_Votes"."KEY" AS "KEY", "OVO_Votes"."OVO_SumConfidence_0" AS "OVO_SumConfidence" 
FROM "OVO_Votes" UNION ALL SELECT "OVO_Votes"."KEY" AS "KEY", "OVO_Votes"."OVO_SumConfidence_1" AS "OVO_SumConfidence" 
FROM "OVO_Votes" UNION ALL SELECT "OVO_Votes"."KEY" AS "KEY", "OVO_Votes"."OVO_SumConfidence_2" AS "OVO_SumConfidence" 
FROM "OVO_Votes" UNION ALL SELECT "OVO_Votes"."KEY" AS "KEY", "OVO_Votes"."OVO_SumConfidence_3" AS "OVO_SumConfidence" 
FROM "OVO_Votes") AS "Values"), 
"MinMaxConf" AS 
(SELECT min("OVO_SumConf_CTE"."OVO_SumConfidence") AS "OVO_min_conf", max("OVO_SumConf_CTE"."OVO_SumConfidence") AS "OVO_max_conf" 
FROM "OVO_SumConf_CTE"), 
"OVO_Votes_WithScale" AS 
(SELECT "OVO_Votes"."KEY" AS "KEY", "OVO_Votes"."OVO_Vote_0" AS "OVO_Vote_0", "OVO_Votes"."OVO_SumConfidence_0" AS "OVO_SumConfidence_0", "OVO_Votes"."OVO_Vote_1" AS "OVO_Vote_1", "OVO_Votes"."OVO_SumConfidence_1" AS "OVO_SumConfidence_1", "OVO_Votes"."OVO_Vote_2" AS "OVO_Vote_2", "OVO_Votes"."OVO_SumConfidence_2" AS "OVO_SumConfidence_2", "OVO_Votes"."OVO_Vote_3" AS "OVO_Vote_3", "OVO_Votes"."OVO_SumConfidence_3" AS "OVO_SumConfidence_3", CAST(CASE WHEN (abs("MinMaxConf"."OVO_min_conf") >= abs("MinMaxConf"."OVO_max_conf")) THEN abs("MinMaxConf"."OVO_min_conf") ELSE abs("MinMaxConf"."OVO_max_conf") END AS DOUBLE) AS max_abs_confidence, CASE WHEN ("MinMaxConf"."OVO_max_conf" - "MinMaxConf"."OVO_min_conf" <= 0.0) THEN 0.0 ELSE 0.4999999999999998 / CAST(CASE WHEN (abs("MinMaxConf"."OVO_min_conf") >= abs("MinMaxConf"."OVO_max_conf")) THEN abs("MinMaxConf"."OVO_min_conf") ELSE abs("MinMaxConf"."OVO_max_conf") END AS DOUBLE) END AS "OVO_Scale" 
FROM "OVO_Votes", "MinMaxConf")
 SELECT "KernAgg_agg"."KEY", "KernAgg_agg"."OVO_Vote_0", "KernAgg_agg"."OVO_SumConfidence_0", "KernAgg_agg"."OVO_Vote_1", "KernAgg_agg"."OVO_SumConfidence_1", "KernAgg_agg"."OVO_Vote_2", "KernAgg_agg"."OVO_SumConfidence_2", "KernAgg_agg"."OVO_Vote_3", "KernAgg_agg"."OVO_SumConfidence_3", "KernAgg_agg".max_abs_confidence, "KernAgg_agg"."OVO_Scale", "KernAgg_agg"."Score_0", "KernAgg_agg"."Score_1", "KernAgg_agg"."Score_2", "KernAgg_agg"."Score_3" 
FROM (SELECT "OVO_Votes_WithScale"."KEY" AS "KEY", "OVO_Votes_WithScale"."OVO_Vote_0" AS "OVO_Vote_0", "OVO_Votes_WithScale"."OVO_SumConfidence_0" AS "OVO_SumConfidence_0", "OVO_Votes_WithScale"."OVO_Vote_1" AS "OVO_Vote_1", "OVO_Votes_WithScale"."OVO_SumConfidence_1" AS "OVO_SumConfidence_1", "OVO_Votes_WithScale"."OVO_Vote_2" AS "OVO_Vote_2", "OVO_Votes_WithScale"."OVO_SumConfidence_2" AS "OVO_SumConfidence_2", "OVO_Votes_WithScale"."OVO_Vote_3" AS "OVO_Vote_3", "OVO_Votes_WithScale"."OVO_SumConfidence_3" AS "OVO_SumConfidence_3", "OVO_Votes_WithScale".max_abs_confidence AS max_abs_confidence, "OVO_Votes_WithScale"."OVO_Scale" AS "OVO_Scale", "OVO_Votes_WithScale"."OVO_Vote_0" + "OVO_Votes_WithScale"."OVO_Scale" * "OVO_Votes_WithScale"."OVO_SumConfidence_0" AS "Score_0", "OVO_Votes_WithScale"."OVO_Vote_1" + "OVO_Votes_WithScale"."OVO_Scale" * "OVO_Votes_WithScale"."OVO_SumConfidence_1" AS "Score_1", "OVO_Votes_WithScale"."OVO_Vote_2" + "OVO_Votes_WithScale"."OVO_Scale" * "OVO_Votes_WithScale"."OVO_SumConfidence_2" AS "Score_2", "OVO_Votes_WithScale"."OVO_Vote_3" + "OVO_Votes_WithScale"."OVO_Scale" * "OVO_Votes_WithScale"."OVO_SumConfidence_3" AS "Score_3" 
FROM "OVO_Votes_WithScale") AS "KernAgg_agg"

-- Model deployment code

WITH orig_cte AS 
(SELECT "KernAgg_agg"."KEY" AS "KEY", "KernAgg_agg"."Score_0" AS "Score_0", "KernAgg_agg"."Score_1" AS "Score_1", "KernAgg_agg"."Score_2" AS "Score_2", "KernAgg_agg"."Score_3" AS "Score_3", CAST(NULL AS DOUBLE) AS "Proba_0", CAST(NULL AS DOUBLE) AS "Proba_1", CAST(NULL AS DOUBLE) AS "Proba_2", CAST(NULL AS DOUBLE) AS "Proba_3", CAST(NULL AS DOUBLE) AS "LogProba_0", CAST(NULL AS DOUBLE) AS "LogProba_1", CAST(NULL AS DOUBLE) AS "LogProba_2", CAST(NULL AS DOUBLE) AS "LogProba_3", NULL AS "Decision", CAST(NULL AS DOUBLE) AS "DecisionProba" 
FROM tmp_20180602143451_p9l_kernagg_agg AS "KernAgg_agg"), 
score_class_union AS 
(SELECT scu."KEY_u" AS "KEY_u", scu.class AS class, scu."LogProba" AS "LogProba", scu."Proba" AS "Proba", scu."Score" AS "Score" 
FROM (SELECT orig_cte."KEY" AS "KEY_u", 0 AS class, orig_cte."LogProba_0" AS "LogProba", orig_cte."Proba_0" AS "Proba", orig_cte."Score_0" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY_u", 1 AS class, orig_cte."LogProba_1" AS "LogProba", orig_cte."Proba_1" AS "Proba", orig_cte."Score_1" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY_u", 2 AS class, orig_cte."LogProba_2" AS "LogProba", orig_cte."Proba_2" AS "Proba", orig_cte."Score_2" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY_u", 3 AS class, orig_cte."LogProba_3" AS "LogProba", orig_cte."Proba_3" AS "Proba", orig_cte."Score_3" AS "Score" 
FROM orig_cte) AS scu), 
score_max AS 
(SELECT orig_cte."KEY" AS "KEY", orig_cte."Score_0" AS "Score_0", orig_cte."Score_1" AS "Score_1", orig_cte."Score_2" AS "Score_2", orig_cte."Score_3" AS "Score_3", orig_cte."Proba_0" AS "Proba_0", orig_cte."Proba_1" AS "Proba_1", orig_cte."Proba_2" AS "Proba_2", orig_cte."Proba_3" AS "Proba_3", orig_cte."LogProba_0" AS "LogProba_0", orig_cte."LogProba_1" AS "LogProba_1", orig_cte."LogProba_2" AS "LogProba_2", orig_cte."LogProba_3" AS "LogProba_3", orig_cte."Decision" AS "Decision", orig_cte."DecisionProba" AS "DecisionProba", max_select."KEY_m" AS "KEY_m", max_select."max_Score" AS "max_Score" 
FROM orig_cte LEFT OUTER JOIN (SELECT score_class_union."KEY_u" AS "KEY_m", max(score_class_union."Score") AS "max_Score" 
FROM score_class_union GROUP BY score_class_union."KEY_u") AS max_select ON orig_cte."KEY" = max_select."KEY_m"), 
union_with_max AS 
(SELECT score_class_union."KEY_u" AS "KEY_u", score_class_union.class AS class, score_class_union."LogProba" AS "LogProba", score_class_union."Proba" AS "Proba", score_class_union."Score" AS "Score", score_max."KEY" AS "KEY", score_max."Score_0" AS "Score_0", score_max."Score_1" AS "Score_1", score_max."Score_2" AS "Score_2", score_max."Score_3" AS "Score_3", score_max."Proba_0" AS "Proba_0", score_max."Proba_1" AS "Proba_1", score_max."Proba_2" AS "Proba_2", score_max."Proba_3" AS "Proba_3", score_max."LogProba_0" AS "LogProba_0", score_max."LogProba_1" AS "LogProba_1", score_max."LogProba_2" AS "LogProba_2", score_max."LogProba_3" AS "LogProba_3", score_max."Decision" AS "Decision", score_max."DecisionProba" AS "DecisionProba", score_max."KEY_m" AS "KEY_m", score_max."max_Score" AS "max_Score" 
FROM score_class_union LEFT OUTER JOIN score_max ON score_class_union."KEY_u" = score_max."KEY"), 
arg_max_cte AS 
(SELECT score_max."KEY" AS "KEY", score_max."Score_0" AS "Score_0", score_max."Score_1" AS "Score_1", score_max."Score_2" AS "Score_2", score_max."Score_3" AS "Score_3", score_max."Proba_0" AS "Proba_0", score_max."Proba_1" AS "Proba_1", score_max."Proba_2" AS "Proba_2", score_max."Proba_3" AS "Proba_3", score_max."LogProba_0" AS "LogProba_0", score_max."LogProba_1" AS "LogProba_1", score_max."LogProba_2" AS "LogProba_2", score_max."LogProba_3" AS "LogProba_3", score_max."Decision" AS "Decision", score_max."DecisionProba" AS "DecisionProba", score_max."KEY_m" AS "KEY_m", score_max."max_Score" AS "max_Score", "arg_max_t_Score"."KEY_Score" AS "KEY_Score", "arg_max_t_Score"."arg_max_Score" AS "arg_max_Score" 
FROM score_max LEFT OUTER JOIN (SELECT union_with_max."KEY" AS "KEY_Score", min(union_with_max.class) AS "arg_max_Score" 
FROM union_with_max 
WHERE union_with_max."Score" >= union_with_max."max_Score" GROUP BY union_with_max."KEY") AS "arg_max_t_Score" ON score_max."KEY" = "arg_max_t_Score"."KEY_Score")
 SELECT arg_max_cte."KEY" AS "KEY", arg_max_cte."Score_0" AS "Score_0", arg_max_cte."Score_1" AS "Score_1", arg_max_cte."Score_2" AS "Score_2", arg_max_cte."Score_3" AS "Score_3", arg_max_cte."Proba_0" AS "Proba_0", arg_max_cte."Proba_1" AS "Proba_1", arg_max_cte."Proba_2" AS "Proba_2", arg_max_cte."Proba_3" AS "Proba_3", CASE WHEN (arg_max_cte."Proba_0" IS NULL OR arg_max_cte."Proba_0" > 0.0) THEN ln(arg_max_cte."Proba_0") ELSE -1.79769313486231e+308 END AS "LogProba_0", CASE WHEN (arg_max_cte."Proba_1" IS NULL OR arg_max_cte."Proba_1" > 0.0) THEN ln(arg_max_cte."Proba_1") ELSE -1.79769313486231e+308 END AS "LogProba_1", CASE WHEN (arg_max_cte."Proba_2" IS NULL OR arg_max_cte."Proba_2" > 0.0) THEN ln(arg_max_cte."Proba_2") ELSE -1.79769313486231e+308 END AS "LogProba_2", CASE WHEN (arg_max_cte."Proba_3" IS NULL OR arg_max_cte."Proba_3" > 0.0) THEN ln(arg_max_cte."Proba_3") ELSE -1.79769313486231e+308 END AS "LogProba_3", arg_max_cte."arg_max_Score" AS "Decision", CASE WHEN (arg_max_cte."arg_max_Score" = 0) THEN arg_max_cte."Proba_0" WHEN (arg_max_cte."arg_max_Score" = 1) THEN arg_max_cte."Proba_1" WHEN (arg_max_cte."arg_max_Score" = 2) THEN arg_max_cte."Proba_2" WHEN (arg_max_cte."arg_max_Score" = 3) THEN arg_max_cte."Proba_3" END AS "DecisionProba" 
FROM arg_max_cte