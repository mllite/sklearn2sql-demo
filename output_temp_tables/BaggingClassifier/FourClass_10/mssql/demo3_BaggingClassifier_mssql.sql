-- This SQL code was generated by sklearn2sql (development version).
-- Copyright 2018

-- Model : BaggingClassifier
-- Dataset : FourClass_10
-- Database : mssql


-- This SQL code can contain one or more statements, to be executed in the order they appear in this file.



-- Code For temporary table ##TMP_20180602142918_639_BAG_B0 part 1. Create 


CREATE TABLE ##TMP_20180602142918_639_BAG_B0 (
	[KEY] BIGINT NULL, 
	[Score_0] FLOAT(53) NULL, 
	[Proba_0] FLOAT(53) NULL, 
	[LogProba_0] FLOAT(53) NULL, 
	[Score_1] FLOAT(53) NULL, 
	[Proba_1] FLOAT(53) NULL, 
	[LogProba_1] FLOAT(53) NULL, 
	[Score_2] FLOAT(53) NULL, 
	[Proba_2] FLOAT(53) NULL, 
	[LogProba_2] FLOAT(53) NULL, 
	[Score_3] FLOAT(53) NULL, 
	[Proba_3] FLOAT(53) NULL, 
	[LogProba_3] FLOAT(53) NULL
)



-- Code For temporary table ##TMP_20180602142918_639_BAG_B0 part 2. Populate

WITH [DT_node_lookup] AS 
(SELECT [ADS].[KEY] AS [KEY], CASE WHEN ([ADS].[Feature_4] <= -0.7205710411071777) THEN CASE WHEN ([ADS].[Feature_1] <= -0.3766303062438965) THEN 2 ELSE CASE WHEN ([ADS].[Feature_7] <= -0.02593889832496643) THEN 4 ELSE CASE WHEN ([ADS].[Feature_7] <= 1.2799880504608154) THEN 6 ELSE CASE WHEN ([ADS].[Feature_4] <= -2.2154769897460938) THEN 8 ELSE 9 END END END END ELSE CASE WHEN ([ADS].[Feature_3] <= 0.6257461905479431) THEN CASE WHEN ([ADS].[Feature_6] <= 1.1597294807434082) THEN CASE WHEN ([ADS].[Feature_2] <= -2.5394277572631836) THEN 13 ELSE CASE WHEN ([ADS].[Feature_2] <= 0.6566844582557678) THEN 15 ELSE 16 END END ELSE 17 END ELSE CASE WHEN ([ADS].[Feature_6] <= -1.1888949871063232) THEN CASE WHEN ([ADS].[Feature_7] <= 1.0963629484176636) THEN 20 ELSE CASE WHEN ([ADS].[Feature_8] <= -0.1138073205947876) THEN 22 ELSE 23 END END ELSE CASE WHEN ([ADS].[Feature_0] <= 0.4317001700401306) THEN 25 ELSE 26 END END END END AS node_id_2 
FROM [FourClass_10] AS [ADS]), 
[DT_node_data] AS 
(SELECT [Values].nid AS nid, CAST([Values].[P_0] AS FLOAT(53)) AS [P_0], CAST([Values].[P_1] AS FLOAT(53)) AS [P_1], CAST([Values].[P_2] AS FLOAT(53)) AS [P_2], CAST([Values].[P_3] AS FLOAT(53)) AS [P_3], CAST([Values].[D] AS FLOAT(53)) AS [D], CAST([Values].[DP] AS FLOAT(53)) AS [DP] 
FROM (SELECT 2 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 4 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 6 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 8 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 9 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 13 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 15 AS nid, 0.9583333333333334 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.041666666666666664 AS [P_3], 0 AS [D], 0.9583333333333334 AS [DP] UNION ALL SELECT 16 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 17 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 20 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 22 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 23 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 25 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 26 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP]) AS [Values]), 
[DT_Output] AS 
(SELECT [DT_node_lookup].[KEY] AS [KEY], [DT_node_lookup].node_id_2 AS node_id_2, [DT_node_data].nid AS nid, [DT_node_data].[P_0] AS [P_0], [DT_node_data].[P_1] AS [P_1], [DT_node_data].[P_2] AS [P_2], [DT_node_data].[P_3] AS [P_3], [DT_node_data].[D] AS [D], [DT_node_data].[DP] AS [DP] 
FROM [DT_node_lookup] LEFT OUTER JOIN [DT_node_data] ON [DT_node_lookup].node_id_2 = [DT_node_data].nid), 
[BAG_Model_0] AS 
(SELECT [DT_Output].[KEY] AS [KEY], CAST(NULL AS FLOAT(53)) AS [Score_0], [DT_Output].[P_0] AS [Proba_0], CASE WHEN ([DT_Output].[P_0] IS NULL OR [DT_Output].[P_0] > 0.0) THEN log([DT_Output].[P_0]) ELSE -1.79769313486231e+308 END AS [LogProba_0], CAST(NULL AS FLOAT(53)) AS [Score_1], [DT_Output].[P_1] AS [Proba_1], CASE WHEN ([DT_Output].[P_1] IS NULL OR [DT_Output].[P_1] > 0.0) THEN log([DT_Output].[P_1]) ELSE -1.79769313486231e+308 END AS [LogProba_1], CAST(NULL AS FLOAT(53)) AS [Score_2], [DT_Output].[P_2] AS [Proba_2], CASE WHEN ([DT_Output].[P_2] IS NULL OR [DT_Output].[P_2] > 0.0) THEN log([DT_Output].[P_2]) ELSE -1.79769313486231e+308 END AS [LogProba_2], CAST(NULL AS FLOAT(53)) AS [Score_3], [DT_Output].[P_3] AS [Proba_3], CASE WHEN ([DT_Output].[P_3] IS NULL OR [DT_Output].[P_3] > 0.0) THEN log([DT_Output].[P_3]) ELSE -1.79769313486231e+308 END AS [LogProba_3] 
FROM [DT_Output]), 
[DT_node_lookup_1] AS 
(SELECT [ADS].[KEY] AS [KEY], CASE WHEN ([ADS].[Feature_3] <= 0.5939029455184937) THEN CASE WHEN ([ADS].[Feature_4] <= -0.35484129190444946) THEN CASE WHEN ([ADS].[Feature_1] <= 0.36407172679901123) THEN CASE WHEN ([ADS].[Feature_5] <= 0.07402315735816956) THEN 4 ELSE 5 END ELSE CASE WHEN ([ADS].[Feature_9] <= -0.03236502781510353) THEN 7 ELSE 8 END END ELSE CASE WHEN ([ADS].[Feature_3] <= -2.255753517150879) THEN 10 ELSE 11 END END ELSE CASE WHEN ([ADS].[Feature_8] <= 1.0354390144348145) THEN CASE WHEN ([ADS].[Feature_0] <= -1.47705078125) THEN 14 ELSE CASE WHEN ([ADS].[Feature_1] <= -0.1289312094449997) THEN CASE WHEN ([ADS].[Feature_0] <= -0.340914785861969) THEN 17 ELSE 18 END ELSE CASE WHEN ([ADS].[Feature_4] <= -1.7061595916748047) THEN 20 ELSE 21 END END END ELSE CASE WHEN ([ADS].[Feature_5] <= 0.7421096563339233) THEN 23 ELSE 24 END END END AS node_id_2 
FROM [FourClass_10] AS [ADS]), 
[DT_node_data_1] AS 
(SELECT [Values].nid AS nid, CAST([Values].[P_0] AS FLOAT(53)) AS [P_0], CAST([Values].[P_1] AS FLOAT(53)) AS [P_1], CAST([Values].[P_2] AS FLOAT(53)) AS [P_2], CAST([Values].[P_3] AS FLOAT(53)) AS [P_3], CAST([Values].[D] AS FLOAT(53)) AS [D], CAST([Values].[DP] AS FLOAT(53)) AS [DP] 
FROM (SELECT 4 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 5 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 7 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 8 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 10 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 11 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 14 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 17 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 18 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 20 AS nid, 0.0 AS [P_0], 0.3333333333333333 AS [P_1], 0.0 AS [P_2], 0.6666666666666666 AS [P_3], 3 AS [D], 0.6666666666666666 AS [DP] UNION ALL SELECT 21 AS nid, 0.0 AS [P_0], 0.96 AS [P_1], 0.0 AS [P_2], 0.04 AS [P_3], 1 AS [D], 0.96 AS [DP] UNION ALL SELECT 23 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 24 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP]) AS [Values]), 
[DT_Output_1] AS 
(SELECT [DT_node_lookup_1].[KEY] AS [KEY], [DT_node_lookup_1].node_id_2 AS node_id_2, [DT_node_data_1].nid AS nid, [DT_node_data_1].[P_0] AS [P_0], [DT_node_data_1].[P_1] AS [P_1], [DT_node_data_1].[P_2] AS [P_2], [DT_node_data_1].[P_3] AS [P_3], [DT_node_data_1].[D] AS [D], [DT_node_data_1].[DP] AS [DP] 
FROM [DT_node_lookup_1] LEFT OUTER JOIN [DT_node_data_1] ON [DT_node_lookup_1].node_id_2 = [DT_node_data_1].nid), 
[BAG_Model_1] AS 
(SELECT [DT_Output_1].[KEY] AS [KEY], CAST(NULL AS FLOAT(53)) AS [Score_0], [DT_Output_1].[P_0] AS [Proba_0], CASE WHEN ([DT_Output_1].[P_0] IS NULL OR [DT_Output_1].[P_0] > 0.0) THEN log([DT_Output_1].[P_0]) ELSE -1.79769313486231e+308 END AS [LogProba_0], CAST(NULL AS FLOAT(53)) AS [Score_1], [DT_Output_1].[P_1] AS [Proba_1], CASE WHEN ([DT_Output_1].[P_1] IS NULL OR [DT_Output_1].[P_1] > 0.0) THEN log([DT_Output_1].[P_1]) ELSE -1.79769313486231e+308 END AS [LogProba_1], CAST(NULL AS FLOAT(53)) AS [Score_2], [DT_Output_1].[P_2] AS [Proba_2], CASE WHEN ([DT_Output_1].[P_2] IS NULL OR [DT_Output_1].[P_2] > 0.0) THEN log([DT_Output_1].[P_2]) ELSE -1.79769313486231e+308 END AS [LogProba_2], CAST(NULL AS FLOAT(53)) AS [Score_3], [DT_Output_1].[P_3] AS [Proba_3], CASE WHEN ([DT_Output_1].[P_3] IS NULL OR [DT_Output_1].[P_3] > 0.0) THEN log([DT_Output_1].[P_3]) ELSE -1.79769313486231e+308 END AS [LogProba_3] 
FROM [DT_Output_1]), 
[DT_node_lookup_2] AS 
(SELECT [ADS].[KEY] AS [KEY], CASE WHEN ([ADS].[Feature_1] <= 0.2519511282444) THEN CASE WHEN ([ADS].[Feature_7] <= 0.5543844103813171) THEN CASE WHEN ([ADS].[Feature_5] <= 0.07402315735816956) THEN CASE WHEN ([ADS].[Feature_4] <= 0.4352496862411499) THEN 4 ELSE 5 END ELSE CASE WHEN ([ADS].[Feature_2] <= 1.9205784797668457) THEN 7 ELSE 8 END END ELSE CASE WHEN ([ADS].[Feature_1] <= -0.5793455839157104) THEN 10 ELSE 11 END END ELSE CASE WHEN ([ADS].[Feature_7] <= 0.44504228234291077) THEN CASE WHEN ([ADS].[Feature_4] <= 0.9742767810821533) THEN CASE WHEN ([ADS].[Feature_2] <= -1.900172233581543) THEN 15 ELSE 16 END ELSE CASE WHEN ([ADS].[Feature_5] <= -0.12828786671161652) THEN 18 ELSE 19 END END ELSE CASE WHEN ([ADS].[Feature_8] <= -1.1262891292572021) THEN 21 ELSE CASE WHEN ([ADS].[Feature_4] <= 0.5298123359680176) THEN CASE WHEN ([ADS].[Feature_7] <= 0.6106350421905518) THEN 24 ELSE 25 END ELSE 26 END END END END AS node_id_2 
FROM [FourClass_10] AS [ADS]), 
[DT_node_data_2] AS 
(SELECT [Values].nid AS nid, CAST([Values].[P_0] AS FLOAT(53)) AS [P_0], CAST([Values].[P_1] AS FLOAT(53)) AS [P_1], CAST([Values].[P_2] AS FLOAT(53)) AS [P_2], CAST([Values].[P_3] AS FLOAT(53)) AS [P_3], CAST([Values].[D] AS FLOAT(53)) AS [D], CAST([Values].[DP] AS FLOAT(53)) AS [DP] 
FROM (SELECT 4 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 5 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 7 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 8 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 10 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 11 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 15 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 16 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 18 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 19 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 21 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 24 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 25 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 26 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP]) AS [Values]), 
[DT_Output_2] AS 
(SELECT [DT_node_lookup_2].[KEY] AS [KEY], [DT_node_lookup_2].node_id_2 AS node_id_2, [DT_node_data_2].nid AS nid, [DT_node_data_2].[P_0] AS [P_0], [DT_node_data_2].[P_1] AS [P_1], [DT_node_data_2].[P_2] AS [P_2], [DT_node_data_2].[P_3] AS [P_3], [DT_node_data_2].[D] AS [D], [DT_node_data_2].[DP] AS [DP] 
FROM [DT_node_lookup_2] LEFT OUTER JOIN [DT_node_data_2] ON [DT_node_lookup_2].node_id_2 = [DT_node_data_2].nid), 
[BAG_Model_2] AS 
(SELECT [DT_Output_2].[KEY] AS [KEY], CAST(NULL AS FLOAT(53)) AS [Score_0], [DT_Output_2].[P_0] AS [Proba_0], CASE WHEN ([DT_Output_2].[P_0] IS NULL OR [DT_Output_2].[P_0] > 0.0) THEN log([DT_Output_2].[P_0]) ELSE -1.79769313486231e+308 END AS [LogProba_0], CAST(NULL AS FLOAT(53)) AS [Score_1], [DT_Output_2].[P_1] AS [Proba_1], CASE WHEN ([DT_Output_2].[P_1] IS NULL OR [DT_Output_2].[P_1] > 0.0) THEN log([DT_Output_2].[P_1]) ELSE -1.79769313486231e+308 END AS [LogProba_1], CAST(NULL AS FLOAT(53)) AS [Score_2], [DT_Output_2].[P_2] AS [Proba_2], CASE WHEN ([DT_Output_2].[P_2] IS NULL OR [DT_Output_2].[P_2] > 0.0) THEN log([DT_Output_2].[P_2]) ELSE -1.79769313486231e+308 END AS [LogProba_2], CAST(NULL AS FLOAT(53)) AS [Score_3], [DT_Output_2].[P_3] AS [Proba_3], CASE WHEN ([DT_Output_2].[P_3] IS NULL OR [DT_Output_2].[P_3] > 0.0) THEN log([DT_Output_2].[P_3]) ELSE -1.79769313486231e+308 END AS [LogProba_3] 
FROM [DT_Output_2]), 
[DT_node_lookup_3] AS 
(SELECT [ADS].[KEY] AS [KEY], CASE WHEN ([ADS].[Feature_3] <= 0.6734017729759216) THEN CASE WHEN ([ADS].[Feature_4] <= -0.38003355264663696) THEN CASE WHEN ([ADS].[Feature_1] <= -0.3766303062438965) THEN CASE WHEN ([ADS].[Feature_3] <= -0.7281683087348938) THEN 4 ELSE 5 END ELSE CASE WHEN ([ADS].[Feature_2] <= -1.900172233581543) THEN 7 ELSE 8 END END ELSE CASE WHEN ([ADS].[Feature_6] <= 1.2741605043411255) THEN CASE WHEN ([ADS].[Feature_5] <= 0.9470316767692566) THEN 11 ELSE 12 END ELSE 13 END END ELSE CASE WHEN ([ADS].[Feature_9] <= -2.2687716484069824) THEN 15 ELSE CASE WHEN ([ADS].[Feature_1] <= -0.1289312094449997) THEN CASE WHEN ([ADS].[Feature_6] <= -0.7937459945678711) THEN 18 ELSE 19 END ELSE CASE WHEN ([ADS].[Feature_7] <= -0.32661986351013184) THEN 21 ELSE CASE WHEN ([ADS].[Feature_1] <= 2.708956480026245) THEN 23 ELSE 24 END END END END END AS node_id_2 
FROM [FourClass_10] AS [ADS]), 
[DT_node_data_3] AS 
(SELECT [Values].nid AS nid, CAST([Values].[P_0] AS FLOAT(53)) AS [P_0], CAST([Values].[P_1] AS FLOAT(53)) AS [P_1], CAST([Values].[P_2] AS FLOAT(53)) AS [P_2], CAST([Values].[P_3] AS FLOAT(53)) AS [P_3], CAST([Values].[D] AS FLOAT(53)) AS [D], CAST([Values].[DP] AS FLOAT(53)) AS [DP] 
FROM (SELECT 4 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 5 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 7 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 8 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 11 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 12 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 13 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 15 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 18 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 19 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 21 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 23 AS nid, 0.0 AS [P_0], 0.9583333333333334 AS [P_1], 0.0 AS [P_2], 0.041666666666666664 AS [P_3], 1 AS [D], 0.9583333333333334 AS [DP] UNION ALL SELECT 24 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP]) AS [Values]), 
[DT_Output_3] AS 
(SELECT [DT_node_lookup_3].[KEY] AS [KEY], [DT_node_lookup_3].node_id_2 AS node_id_2, [DT_node_data_3].nid AS nid, [DT_node_data_3].[P_0] AS [P_0], [DT_node_data_3].[P_1] AS [P_1], [DT_node_data_3].[P_2] AS [P_2], [DT_node_data_3].[P_3] AS [P_3], [DT_node_data_3].[D] AS [D], [DT_node_data_3].[DP] AS [DP] 
FROM [DT_node_lookup_3] LEFT OUTER JOIN [DT_node_data_3] ON [DT_node_lookup_3].node_id_2 = [DT_node_data_3].nid), 
[BAG_Model_3] AS 
(SELECT [DT_Output_3].[KEY] AS [KEY], CAST(NULL AS FLOAT(53)) AS [Score_0], [DT_Output_3].[P_0] AS [Proba_0], CASE WHEN ([DT_Output_3].[P_0] IS NULL OR [DT_Output_3].[P_0] > 0.0) THEN log([DT_Output_3].[P_0]) ELSE -1.79769313486231e+308 END AS [LogProba_0], CAST(NULL AS FLOAT(53)) AS [Score_1], [DT_Output_3].[P_1] AS [Proba_1], CASE WHEN ([DT_Output_3].[P_1] IS NULL OR [DT_Output_3].[P_1] > 0.0) THEN log([DT_Output_3].[P_1]) ELSE -1.79769313486231e+308 END AS [LogProba_1], CAST(NULL AS FLOAT(53)) AS [Score_2], [DT_Output_3].[P_2] AS [Proba_2], CASE WHEN ([DT_Output_3].[P_2] IS NULL OR [DT_Output_3].[P_2] > 0.0) THEN log([DT_Output_3].[P_2]) ELSE -1.79769313486231e+308 END AS [LogProba_2], CAST(NULL AS FLOAT(53)) AS [Score_3], [DT_Output_3].[P_3] AS [Proba_3], CASE WHEN ([DT_Output_3].[P_3] IS NULL OR [DT_Output_3].[P_3] > 0.0) THEN log([DT_Output_3].[P_3]) ELSE -1.79769313486231e+308 END AS [LogProba_3] 
FROM [DT_Output_3]), 
[DT_node_lookup_4] AS 
(SELECT [ADS].[KEY] AS [KEY], CASE WHEN ([ADS].[Feature_2] <= 1.0767130851745605) THEN CASE WHEN ([ADS].[Feature_8] <= -1.5628834962844849) THEN 2 ELSE CASE WHEN ([ADS].[Feature_3] <= -1.775954246520996) THEN 4 ELSE CASE WHEN ([ADS].[Feature_1] <= -0.18501365184783936) THEN CASE WHEN ([ADS].[Feature_4] <= -1.9389472007751465) THEN 7 ELSE 8 END ELSE CASE WHEN ([ADS].[Feature_7] <= -0.46776115894317627) THEN 10 ELSE 11 END END END END ELSE CASE WHEN ([ADS].[Feature_1] <= 2.4217634201049805) THEN CASE WHEN ([ADS].[Feature_6] <= -0.7187981009483337) THEN 14 ELSE 15 END ELSE 16 END END AS node_id_2 
FROM [FourClass_10] AS [ADS]), 
[DT_node_data_4] AS 
(SELECT [Values].nid AS nid, CAST([Values].[P_0] AS FLOAT(53)) AS [P_0], CAST([Values].[P_1] AS FLOAT(53)) AS [P_1], CAST([Values].[P_2] AS FLOAT(53)) AS [P_2], CAST([Values].[P_3] AS FLOAT(53)) AS [P_3], CAST([Values].[D] AS FLOAT(53)) AS [D], CAST([Values].[DP] AS FLOAT(53)) AS [DP] 
FROM (SELECT 2 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 4 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 7 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 8 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 10 AS nid, 0.2727272727272727 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.7272727272727273 AS [P_3], 3 AS [D], 0.7272727272727273 AS [DP] UNION ALL SELECT 11 AS nid, 0.0 AS [P_0], 0.3333333333333333 AS [P_1], 0.6111111111111112 AS [P_2], 0.05555555555555555 AS [P_3], 2 AS [D], 0.6111111111111112 AS [DP] UNION ALL SELECT 14 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 15 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 16 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP]) AS [Values]), 
[DT_Output_4] AS 
(SELECT [DT_node_lookup_4].[KEY] AS [KEY], [DT_node_lookup_4].node_id_2 AS node_id_2, [DT_node_data_4].nid AS nid, [DT_node_data_4].[P_0] AS [P_0], [DT_node_data_4].[P_1] AS [P_1], [DT_node_data_4].[P_2] AS [P_2], [DT_node_data_4].[P_3] AS [P_3], [DT_node_data_4].[D] AS [D], [DT_node_data_4].[DP] AS [DP] 
FROM [DT_node_lookup_4] LEFT OUTER JOIN [DT_node_data_4] ON [DT_node_lookup_4].node_id_2 = [DT_node_data_4].nid), 
[BAG_Model_4] AS 
(SELECT [DT_Output_4].[KEY] AS [KEY], CAST(NULL AS FLOAT(53)) AS [Score_0], [DT_Output_4].[P_0] AS [Proba_0], CASE WHEN ([DT_Output_4].[P_0] IS NULL OR [DT_Output_4].[P_0] > 0.0) THEN log([DT_Output_4].[P_0]) ELSE -1.79769313486231e+308 END AS [LogProba_0], CAST(NULL AS FLOAT(53)) AS [Score_1], [DT_Output_4].[P_1] AS [Proba_1], CASE WHEN ([DT_Output_4].[P_1] IS NULL OR [DT_Output_4].[P_1] > 0.0) THEN log([DT_Output_4].[P_1]) ELSE -1.79769313486231e+308 END AS [LogProba_1], CAST(NULL AS FLOAT(53)) AS [Score_2], [DT_Output_4].[P_2] AS [Proba_2], CASE WHEN ([DT_Output_4].[P_2] IS NULL OR [DT_Output_4].[P_2] > 0.0) THEN log([DT_Output_4].[P_2]) ELSE -1.79769313486231e+308 END AS [LogProba_2], CAST(NULL AS FLOAT(53)) AS [Score_3], [DT_Output_4].[P_3] AS [Proba_3], CASE WHEN ([DT_Output_4].[P_3] IS NULL OR [DT_Output_4].[P_3] > 0.0) THEN log([DT_Output_4].[P_3]) ELSE -1.79769313486231e+308 END AS [LogProba_3] 
FROM [DT_Output_4]), 
[DT_node_lookup_5] AS 
(SELECT [ADS].[KEY] AS [KEY], CASE WHEN ([ADS].[Feature_7] <= 0.362348735332489) THEN CASE WHEN ([ADS].[Feature_3] <= -0.6974312663078308) THEN CASE WHEN ([ADS].[Feature_5] <= 0.07402315735816956) THEN CASE WHEN ([ADS].[Feature_9] <= 0.12583327293395996) THEN 4 ELSE 5 END ELSE CASE WHEN ([ADS].[Feature_1] <= -0.3766303062438965) THEN 7 ELSE 8 END END ELSE CASE WHEN ([ADS].[Feature_1] <= -0.5951647758483887) THEN 10 ELSE CASE WHEN ([ADS].[Feature_4] <= -0.10374534130096436) THEN 12 ELSE CASE WHEN ([ADS].[Feature_3] <= 3.2052979469299316) THEN 14 ELSE 15 END END END END ELSE CASE WHEN ([ADS].[Feature_1] <= 0.17078125476837158) THEN CASE WHEN ([ADS].[Feature_6] <= -0.8221747875213623) THEN 18 ELSE 19 END ELSE CASE WHEN ([ADS].[Feature_2] <= 0.2656080424785614) THEN CASE WHEN ([ADS].[Feature_7] <= 0.6106350421905518) THEN 22 ELSE CASE WHEN ([ADS].[Feature_4] <= 0.5298123359680176) THEN 24 ELSE 25 END END ELSE CASE WHEN ([ADS].[Feature_1] <= 2.0841925144195557) THEN 27 ELSE 28 END END END END AS node_id_2 
FROM [FourClass_10] AS [ADS]), 
[DT_node_data_5] AS 
(SELECT [Values].nid AS nid, CAST([Values].[P_0] AS FLOAT(53)) AS [P_0], CAST([Values].[P_1] AS FLOAT(53)) AS [P_1], CAST([Values].[P_2] AS FLOAT(53)) AS [P_2], CAST([Values].[P_3] AS FLOAT(53)) AS [P_3], CAST([Values].[D] AS FLOAT(53)) AS [D], CAST([Values].[DP] AS FLOAT(53)) AS [DP] 
FROM (SELECT 4 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 5 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 7 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 8 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 10 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 12 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 14 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 15 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 18 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 19 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 22 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 24 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 25 AS nid, 0.5 AS [P_0], 0.5 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 0.5 AS [DP] UNION ALL SELECT 27 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 28 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP]) AS [Values]), 
[DT_Output_5] AS 
(SELECT [DT_node_lookup_5].[KEY] AS [KEY], [DT_node_lookup_5].node_id_2 AS node_id_2, [DT_node_data_5].nid AS nid, [DT_node_data_5].[P_0] AS [P_0], [DT_node_data_5].[P_1] AS [P_1], [DT_node_data_5].[P_2] AS [P_2], [DT_node_data_5].[P_3] AS [P_3], [DT_node_data_5].[D] AS [D], [DT_node_data_5].[DP] AS [DP] 
FROM [DT_node_lookup_5] LEFT OUTER JOIN [DT_node_data_5] ON [DT_node_lookup_5].node_id_2 = [DT_node_data_5].nid), 
[BAG_Model_5] AS 
(SELECT [DT_Output_5].[KEY] AS [KEY], CAST(NULL AS FLOAT(53)) AS [Score_0], [DT_Output_5].[P_0] AS [Proba_0], CASE WHEN ([DT_Output_5].[P_0] IS NULL OR [DT_Output_5].[P_0] > 0.0) THEN log([DT_Output_5].[P_0]) ELSE -1.79769313486231e+308 END AS [LogProba_0], CAST(NULL AS FLOAT(53)) AS [Score_1], [DT_Output_5].[P_1] AS [Proba_1], CASE WHEN ([DT_Output_5].[P_1] IS NULL OR [DT_Output_5].[P_1] > 0.0) THEN log([DT_Output_5].[P_1]) ELSE -1.79769313486231e+308 END AS [LogProba_1], CAST(NULL AS FLOAT(53)) AS [Score_2], [DT_Output_5].[P_2] AS [Proba_2], CASE WHEN ([DT_Output_5].[P_2] IS NULL OR [DT_Output_5].[P_2] > 0.0) THEN log([DT_Output_5].[P_2]) ELSE -1.79769313486231e+308 END AS [LogProba_2], CAST(NULL AS FLOAT(53)) AS [Score_3], [DT_Output_5].[P_3] AS [Proba_3], CASE WHEN ([DT_Output_5].[P_3] IS NULL OR [DT_Output_5].[P_3] > 0.0) THEN log([DT_Output_5].[P_3]) ELSE -1.79769313486231e+308 END AS [LogProba_3] 
FROM [DT_Output_5]), 
[DT_node_lookup_6] AS 
(SELECT [ADS].[KEY] AS [KEY], CASE WHEN ([ADS].[Feature_3] <= 0.7143889665603638) THEN CASE WHEN ([ADS].[Feature_8] <= -0.059365637600421906) THEN CASE WHEN ([ADS].[Feature_7] <= 0.16708889603614807) THEN 3 ELSE CASE WHEN ([ADS].[Feature_1] <= -0.08559859544038773) THEN 5 ELSE 6 END END ELSE CASE WHEN ([ADS].[Feature_3] <= -1.1015613079071045) THEN CASE WHEN ([ADS].[Feature_1] <= 0.9861354827880859) THEN 9 ELSE 10 END ELSE 11 END END ELSE CASE WHEN ([ADS].[Feature_7] <= 0.4184545576572418) THEN CASE WHEN ([ADS].[Feature_2] <= 0.17803184688091278) THEN 14 ELSE CASE WHEN ([ADS].[Feature_9] <= 1.1536569595336914) THEN 16 ELSE 17 END END ELSE CASE WHEN ([ADS].[Feature_9] <= -1.5898537635803223) THEN 19 ELSE CASE WHEN ([ADS].[Feature_2] <= 0.23278450965881348) THEN CASE WHEN ([ADS].[Feature_3] <= 1.7188236713409424) THEN 22 ELSE 23 END ELSE CASE WHEN ([ADS].[Feature_7] <= 0.5804324746131897) THEN 25 ELSE 26 END END END END END AS node_id_2 
FROM [FourClass_10] AS [ADS]), 
[DT_node_data_6] AS 
(SELECT [Values].nid AS nid, CAST([Values].[P_0] AS FLOAT(53)) AS [P_0], CAST([Values].[P_1] AS FLOAT(53)) AS [P_1], CAST([Values].[P_2] AS FLOAT(53)) AS [P_2], CAST([Values].[P_3] AS FLOAT(53)) AS [P_3], CAST([Values].[D] AS FLOAT(53)) AS [D], CAST([Values].[DP] AS FLOAT(53)) AS [DP] 
FROM (SELECT 3 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 5 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 6 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 9 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 10 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 11 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 14 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 16 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 17 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 19 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 22 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 23 AS nid, 0.0 AS [P_0], 0.5 AS [P_1], 0.5 AS [P_2], 0.0 AS [P_3], 1 AS [D], 0.5 AS [DP] UNION ALL SELECT 25 AS nid, 0.0 AS [P_0], 0.6666666666666666 AS [P_1], 0.0 AS [P_2], 0.3333333333333333 AS [P_3], 1 AS [D], 0.6666666666666666 AS [DP] UNION ALL SELECT 26 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP]) AS [Values]), 
[DT_Output_6] AS 
(SELECT [DT_node_lookup_6].[KEY] AS [KEY], [DT_node_lookup_6].node_id_2 AS node_id_2, [DT_node_data_6].nid AS nid, [DT_node_data_6].[P_0] AS [P_0], [DT_node_data_6].[P_1] AS [P_1], [DT_node_data_6].[P_2] AS [P_2], [DT_node_data_6].[P_3] AS [P_3], [DT_node_data_6].[D] AS [D], [DT_node_data_6].[DP] AS [DP] 
FROM [DT_node_lookup_6] LEFT OUTER JOIN [DT_node_data_6] ON [DT_node_lookup_6].node_id_2 = [DT_node_data_6].nid), 
[BAG_Model_6] AS 
(SELECT [DT_Output_6].[KEY] AS [KEY], CAST(NULL AS FLOAT(53)) AS [Score_0], [DT_Output_6].[P_0] AS [Proba_0], CASE WHEN ([DT_Output_6].[P_0] IS NULL OR [DT_Output_6].[P_0] > 0.0) THEN log([DT_Output_6].[P_0]) ELSE -1.79769313486231e+308 END AS [LogProba_0], CAST(NULL AS FLOAT(53)) AS [Score_1], [DT_Output_6].[P_1] AS [Proba_1], CASE WHEN ([DT_Output_6].[P_1] IS NULL OR [DT_Output_6].[P_1] > 0.0) THEN log([DT_Output_6].[P_1]) ELSE -1.79769313486231e+308 END AS [LogProba_1], CAST(NULL AS FLOAT(53)) AS [Score_2], [DT_Output_6].[P_2] AS [Proba_2], CASE WHEN ([DT_Output_6].[P_2] IS NULL OR [DT_Output_6].[P_2] > 0.0) THEN log([DT_Output_6].[P_2]) ELSE -1.79769313486231e+308 END AS [LogProba_2], CAST(NULL AS FLOAT(53)) AS [Score_3], [DT_Output_6].[P_3] AS [Proba_3], CASE WHEN ([DT_Output_6].[P_3] IS NULL OR [DT_Output_6].[P_3] > 0.0) THEN log([DT_Output_6].[P_3]) ELSE -1.79769313486231e+308 END AS [LogProba_3] 
FROM [DT_Output_6]), 
[DT_node_lookup_7] AS 
(SELECT [ADS].[KEY] AS [KEY], CASE WHEN ([ADS].[Feature_4] <= -0.22726380825042725) THEN CASE WHEN ([ADS].[Feature_3] <= -1.1015613079071045) THEN CASE WHEN ([ADS].[Feature_8] <= -1.3122215270996094) THEN 3 ELSE 4 END ELSE CASE WHEN ([ADS].[Feature_7] <= 0.20736216008663177) THEN CASE WHEN ([ADS].[Feature_3] <= -0.6974312663078308) THEN 7 ELSE 8 END ELSE CASE WHEN ([ADS].[Feature_1] <= 1.8948585987091064) THEN CASE WHEN ([ADS].[Feature_1] <= -0.28247934579849243) THEN 11 ELSE 12 END ELSE CASE WHEN ([ADS].[Feature_7] <= 3.193324089050293) THEN 14 ELSE 15 END END END END ELSE CASE WHEN ([ADS].[Feature_3] <= 0.6257461905479431) THEN CASE WHEN ([ADS].[Feature_2] <= -1.4694247245788574) THEN CASE WHEN ([ADS].[Feature_8] <= 0.36681699752807617) THEN 19 ELSE 20 END ELSE CASE WHEN ([ADS].[Feature_5] <= -1.0711228847503662) THEN 22 ELSE 23 END END ELSE CASE WHEN ([ADS].[Feature_0] <= -0.27478232979774475) THEN CASE WHEN ([ADS].[Feature_3] <= 3.835151195526123) THEN 26 ELSE 27 END ELSE CASE WHEN ([ADS].[Feature_3] <= 2.1778652667999268) THEN 29 ELSE 30 END END END END AS node_id_2 
FROM [FourClass_10] AS [ADS]), 
[DT_node_data_7] AS 
(SELECT [Values].nid AS nid, CAST([Values].[P_0] AS FLOAT(53)) AS [P_0], CAST([Values].[P_1] AS FLOAT(53)) AS [P_1], CAST([Values].[P_2] AS FLOAT(53)) AS [P_2], CAST([Values].[P_3] AS FLOAT(53)) AS [P_3], CAST([Values].[D] AS FLOAT(53)) AS [D], CAST([Values].[DP] AS FLOAT(53)) AS [DP] 
FROM (SELECT 3 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 4 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 7 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 8 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 11 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 12 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 14 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 15 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 19 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 20 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 22 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 23 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 26 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 27 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 29 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 30 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP]) AS [Values]), 
[DT_Output_7] AS 
(SELECT [DT_node_lookup_7].[KEY] AS [KEY], [DT_node_lookup_7].node_id_2 AS node_id_2, [DT_node_data_7].nid AS nid, [DT_node_data_7].[P_0] AS [P_0], [DT_node_data_7].[P_1] AS [P_1], [DT_node_data_7].[P_2] AS [P_2], [DT_node_data_7].[P_3] AS [P_3], [DT_node_data_7].[D] AS [D], [DT_node_data_7].[DP] AS [DP] 
FROM [DT_node_lookup_7] LEFT OUTER JOIN [DT_node_data_7] ON [DT_node_lookup_7].node_id_2 = [DT_node_data_7].nid), 
[BAG_Model_7] AS 
(SELECT [DT_Output_7].[KEY] AS [KEY], CAST(NULL AS FLOAT(53)) AS [Score_0], [DT_Output_7].[P_0] AS [Proba_0], CASE WHEN ([DT_Output_7].[P_0] IS NULL OR [DT_Output_7].[P_0] > 0.0) THEN log([DT_Output_7].[P_0]) ELSE -1.79769313486231e+308 END AS [LogProba_0], CAST(NULL AS FLOAT(53)) AS [Score_1], [DT_Output_7].[P_1] AS [Proba_1], CASE WHEN ([DT_Output_7].[P_1] IS NULL OR [DT_Output_7].[P_1] > 0.0) THEN log([DT_Output_7].[P_1]) ELSE -1.79769313486231e+308 END AS [LogProba_1], CAST(NULL AS FLOAT(53)) AS [Score_2], [DT_Output_7].[P_2] AS [Proba_2], CASE WHEN ([DT_Output_7].[P_2] IS NULL OR [DT_Output_7].[P_2] > 0.0) THEN log([DT_Output_7].[P_2]) ELSE -1.79769313486231e+308 END AS [LogProba_2], CAST(NULL AS FLOAT(53)) AS [Score_3], [DT_Output_7].[P_3] AS [Proba_3], CASE WHEN ([DT_Output_7].[P_3] IS NULL OR [DT_Output_7].[P_3] > 0.0) THEN log([DT_Output_7].[P_3]) ELSE -1.79769313486231e+308 END AS [LogProba_3] 
FROM [DT_Output_7]), 
[DT_node_lookup_8] AS 
(SELECT [ADS].[KEY] AS [KEY], CASE WHEN ([ADS].[Feature_3] <= 0.9323714971542358) THEN CASE WHEN ([ADS].[Feature_3] <= -1.772221565246582) THEN 2 ELSE CASE WHEN ([ADS].[Feature_4] <= -0.35484129190444946) THEN CASE WHEN ([ADS].[Feature_1] <= 0.37201857566833496) THEN CASE WHEN ([ADS].[Feature_7] <= 0.6384981870651245) THEN 6 ELSE 7 END ELSE CASE WHEN ([ADS].[Feature_7] <= 0.7977391481399536) THEN 9 ELSE 10 END END ELSE CASE WHEN ([ADS].[Feature_5] <= 1.048132061958313) THEN 12 ELSE 13 END END END ELSE CASE WHEN ([ADS].[Feature_7] <= 0.5804324746131897) THEN CASE WHEN ([ADS].[Feature_3] <= 1.9839489459991455) THEN CASE WHEN ([ADS].[Feature_3] <= 1.4057672023773193) THEN 17 ELSE 18 END ELSE 19 END ELSE CASE WHEN ([ADS].[Feature_7] <= 3.1317644119262695) THEN 21 ELSE 22 END END END AS node_id_2 
FROM [FourClass_10] AS [ADS]), 
[DT_node_data_8] AS 
(SELECT [Values].nid AS nid, CAST([Values].[P_0] AS FLOAT(53)) AS [P_0], CAST([Values].[P_1] AS FLOAT(53)) AS [P_1], CAST([Values].[P_2] AS FLOAT(53)) AS [P_2], CAST([Values].[P_3] AS FLOAT(53)) AS [P_3], CAST([Values].[D] AS FLOAT(53)) AS [D], CAST([Values].[DP] AS FLOAT(53)) AS [DP] 
FROM (SELECT 2 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 6 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 7 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 9 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 10 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 12 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 13 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 17 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 18 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 19 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 21 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 22 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP]) AS [Values]), 
[DT_Output_8] AS 
(SELECT [DT_node_lookup_8].[KEY] AS [KEY], [DT_node_lookup_8].node_id_2 AS node_id_2, [DT_node_data_8].nid AS nid, [DT_node_data_8].[P_0] AS [P_0], [DT_node_data_8].[P_1] AS [P_1], [DT_node_data_8].[P_2] AS [P_2], [DT_node_data_8].[P_3] AS [P_3], [DT_node_data_8].[D] AS [D], [DT_node_data_8].[DP] AS [DP] 
FROM [DT_node_lookup_8] LEFT OUTER JOIN [DT_node_data_8] ON [DT_node_lookup_8].node_id_2 = [DT_node_data_8].nid), 
[BAG_Model_8] AS 
(SELECT [DT_Output_8].[KEY] AS [KEY], CAST(NULL AS FLOAT(53)) AS [Score_0], [DT_Output_8].[P_0] AS [Proba_0], CASE WHEN ([DT_Output_8].[P_0] IS NULL OR [DT_Output_8].[P_0] > 0.0) THEN log([DT_Output_8].[P_0]) ELSE -1.79769313486231e+308 END AS [LogProba_0], CAST(NULL AS FLOAT(53)) AS [Score_1], [DT_Output_8].[P_1] AS [Proba_1], CASE WHEN ([DT_Output_8].[P_1] IS NULL OR [DT_Output_8].[P_1] > 0.0) THEN log([DT_Output_8].[P_1]) ELSE -1.79769313486231e+308 END AS [LogProba_1], CAST(NULL AS FLOAT(53)) AS [Score_2], [DT_Output_8].[P_2] AS [Proba_2], CASE WHEN ([DT_Output_8].[P_2] IS NULL OR [DT_Output_8].[P_2] > 0.0) THEN log([DT_Output_8].[P_2]) ELSE -1.79769313486231e+308 END AS [LogProba_2], CAST(NULL AS FLOAT(53)) AS [Score_3], [DT_Output_8].[P_3] AS [Proba_3], CASE WHEN ([DT_Output_8].[P_3] IS NULL OR [DT_Output_8].[P_3] > 0.0) THEN log([DT_Output_8].[P_3]) ELSE -1.79769313486231e+308 END AS [LogProba_3] 
FROM [DT_Output_8]), 
[DT_node_lookup_9] AS 
(SELECT [ADS].[KEY] AS [KEY], CASE WHEN ([ADS].[Feature_3] <= -0.14788958430290222) THEN CASE WHEN ([ADS].[Feature_3] <= -1.9042950868606567) THEN 2 ELSE CASE WHEN ([ADS].[Feature_4] <= -0.7451081275939941) THEN CASE WHEN ([ADS].[Feature_8] <= -0.969406247138977) THEN 5 ELSE 6 END ELSE 7 END END ELSE CASE WHEN ([ADS].[Feature_7] <= 0.44504228234291077) THEN CASE WHEN ([ADS].[Feature_4] <= -0.13814806938171387) THEN 10 ELSE CASE WHEN ([ADS].[Feature_7] <= 0.07134207338094711) THEN 12 ELSE 13 END END ELSE CASE WHEN ([ADS].[Feature_3] <= 1.6230233907699585) THEN CASE WHEN ([ADS].[Feature_1] <= 0.7405263185501099) THEN 16 ELSE CASE WHEN ([ADS].[Feature_1] <= 1.9193854331970215) THEN 18 ELSE 19 END END ELSE CASE WHEN ([ADS].[Feature_8] <= 1.039745807647705) THEN 21 ELSE CASE WHEN ([ADS].[Feature_0] <= 1.407631516456604) THEN 23 ELSE 24 END END END END END AS node_id_2 
FROM [FourClass_10] AS [ADS]), 
[DT_node_data_9] AS 
(SELECT [Values].nid AS nid, CAST([Values].[P_0] AS FLOAT(53)) AS [P_0], CAST([Values].[P_1] AS FLOAT(53)) AS [P_1], CAST([Values].[P_2] AS FLOAT(53)) AS [P_2], CAST([Values].[P_3] AS FLOAT(53)) AS [P_3], CAST([Values].[D] AS FLOAT(53)) AS [D], CAST([Values].[DP] AS FLOAT(53)) AS [DP] 
FROM (SELECT 2 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 5 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 6 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 7 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 10 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 12 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 13 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 16 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 18 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 19 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 21 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 23 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 24 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP]) AS [Values]), 
[DT_Output_9] AS 
(SELECT [DT_node_lookup_9].[KEY] AS [KEY], [DT_node_lookup_9].node_id_2 AS node_id_2, [DT_node_data_9].nid AS nid, [DT_node_data_9].[P_0] AS [P_0], [DT_node_data_9].[P_1] AS [P_1], [DT_node_data_9].[P_2] AS [P_2], [DT_node_data_9].[P_3] AS [P_3], [DT_node_data_9].[D] AS [D], [DT_node_data_9].[DP] AS [DP] 
FROM [DT_node_lookup_9] LEFT OUTER JOIN [DT_node_data_9] ON [DT_node_lookup_9].node_id_2 = [DT_node_data_9].nid), 
[BAG_Model_9] AS 
(SELECT [DT_Output_9].[KEY] AS [KEY], CAST(NULL AS FLOAT(53)) AS [Score_0], [DT_Output_9].[P_0] AS [Proba_0], CASE WHEN ([DT_Output_9].[P_0] IS NULL OR [DT_Output_9].[P_0] > 0.0) THEN log([DT_Output_9].[P_0]) ELSE -1.79769313486231e+308 END AS [LogProba_0], CAST(NULL AS FLOAT(53)) AS [Score_1], [DT_Output_9].[P_1] AS [Proba_1], CASE WHEN ([DT_Output_9].[P_1] IS NULL OR [DT_Output_9].[P_1] > 0.0) THEN log([DT_Output_9].[P_1]) ELSE -1.79769313486231e+308 END AS [LogProba_1], CAST(NULL AS FLOAT(53)) AS [Score_2], [DT_Output_9].[P_2] AS [Proba_2], CASE WHEN ([DT_Output_9].[P_2] IS NULL OR [DT_Output_9].[P_2] > 0.0) THEN log([DT_Output_9].[P_2]) ELSE -1.79769313486231e+308 END AS [LogProba_2], CAST(NULL AS FLOAT(53)) AS [Score_3], [DT_Output_9].[P_3] AS [Proba_3], CASE WHEN ([DT_Output_9].[P_3] IS NULL OR [DT_Output_9].[P_3] > 0.0) THEN log([DT_Output_9].[P_3]) ELSE -1.79769313486231e+308 END AS [LogProba_3] 
FROM [DT_Output_9])
 INSERT INTO ##TMP_20180602142918_639_BAG_B0 ([KEY], [Score_0], [Proba_0], [LogProba_0], [Score_1], [Proba_1], [LogProba_1], [Score_2], [Proba_2], [LogProba_2], [Score_3], [Proba_3], [LogProba_3]) SELECT [BAG_B0].[KEY], [BAG_B0].[Score_0], [BAG_B0].[Proba_0], [BAG_B0].[LogProba_0], [BAG_B0].[Score_1], [BAG_B0].[Proba_1], [BAG_B0].[LogProba_1], [BAG_B0].[Score_2], [BAG_B0].[Proba_2], [BAG_B0].[LogProba_2], [BAG_B0].[Score_3], [BAG_B0].[Proba_3], [BAG_B0].[LogProba_3] 
FROM (SELECT [BAG_esu_0].[KEY] AS [KEY], [BAG_esu_0].[Score_0] AS [Score_0], [BAG_esu_0].[Proba_0] AS [Proba_0], [BAG_esu_0].[LogProba_0] AS [LogProba_0], [BAG_esu_0].[Score_1] AS [Score_1], [BAG_esu_0].[Proba_1] AS [Proba_1], [BAG_esu_0].[LogProba_1] AS [LogProba_1], [BAG_esu_0].[Score_2] AS [Score_2], [BAG_esu_0].[Proba_2] AS [Proba_2], [BAG_esu_0].[LogProba_2] AS [LogProba_2], [BAG_esu_0].[Score_3] AS [Score_3], [BAG_esu_0].[Proba_3] AS [Proba_3], [BAG_esu_0].[LogProba_3] AS [LogProba_3] 
FROM (SELECT [BAG_Model_0].[KEY] AS [KEY], [BAG_Model_0].[Score_0] AS [Score_0], [BAG_Model_0].[Proba_0] AS [Proba_0], [BAG_Model_0].[LogProba_0] AS [LogProba_0], [BAG_Model_0].[Score_1] AS [Score_1], [BAG_Model_0].[Proba_1] AS [Proba_1], [BAG_Model_0].[LogProba_1] AS [LogProba_1], [BAG_Model_0].[Score_2] AS [Score_2], [BAG_Model_0].[Proba_2] AS [Proba_2], [BAG_Model_0].[LogProba_2] AS [LogProba_2], [BAG_Model_0].[Score_3] AS [Score_3], [BAG_Model_0].[Proba_3] AS [Proba_3], [BAG_Model_0].[LogProba_3] AS [LogProba_3] 
FROM [BAG_Model_0] UNION ALL SELECT [BAG_Model_1].[KEY] AS [KEY], [BAG_Model_1].[Score_0] AS [Score_0], [BAG_Model_1].[Proba_0] AS [Proba_0], [BAG_Model_1].[LogProba_0] AS [LogProba_0], [BAG_Model_1].[Score_1] AS [Score_1], [BAG_Model_1].[Proba_1] AS [Proba_1], [BAG_Model_1].[LogProba_1] AS [LogProba_1], [BAG_Model_1].[Score_2] AS [Score_2], [BAG_Model_1].[Proba_2] AS [Proba_2], [BAG_Model_1].[LogProba_2] AS [LogProba_2], [BAG_Model_1].[Score_3] AS [Score_3], [BAG_Model_1].[Proba_3] AS [Proba_3], [BAG_Model_1].[LogProba_3] AS [LogProba_3] 
FROM [BAG_Model_1] UNION ALL SELECT [BAG_Model_2].[KEY] AS [KEY], [BAG_Model_2].[Score_0] AS [Score_0], [BAG_Model_2].[Proba_0] AS [Proba_0], [BAG_Model_2].[LogProba_0] AS [LogProba_0], [BAG_Model_2].[Score_1] AS [Score_1], [BAG_Model_2].[Proba_1] AS [Proba_1], [BAG_Model_2].[LogProba_1] AS [LogProba_1], [BAG_Model_2].[Score_2] AS [Score_2], [BAG_Model_2].[Proba_2] AS [Proba_2], [BAG_Model_2].[LogProba_2] AS [LogProba_2], [BAG_Model_2].[Score_3] AS [Score_3], [BAG_Model_2].[Proba_3] AS [Proba_3], [BAG_Model_2].[LogProba_3] AS [LogProba_3] 
FROM [BAG_Model_2] UNION ALL SELECT [BAG_Model_3].[KEY] AS [KEY], [BAG_Model_3].[Score_0] AS [Score_0], [BAG_Model_3].[Proba_0] AS [Proba_0], [BAG_Model_3].[LogProba_0] AS [LogProba_0], [BAG_Model_3].[Score_1] AS [Score_1], [BAG_Model_3].[Proba_1] AS [Proba_1], [BAG_Model_3].[LogProba_1] AS [LogProba_1], [BAG_Model_3].[Score_2] AS [Score_2], [BAG_Model_3].[Proba_2] AS [Proba_2], [BAG_Model_3].[LogProba_2] AS [LogProba_2], [BAG_Model_3].[Score_3] AS [Score_3], [BAG_Model_3].[Proba_3] AS [Proba_3], [BAG_Model_3].[LogProba_3] AS [LogProba_3] 
FROM [BAG_Model_3] UNION ALL SELECT [BAG_Model_4].[KEY] AS [KEY], [BAG_Model_4].[Score_0] AS [Score_0], [BAG_Model_4].[Proba_0] AS [Proba_0], [BAG_Model_4].[LogProba_0] AS [LogProba_0], [BAG_Model_4].[Score_1] AS [Score_1], [BAG_Model_4].[Proba_1] AS [Proba_1], [BAG_Model_4].[LogProba_1] AS [LogProba_1], [BAG_Model_4].[Score_2] AS [Score_2], [BAG_Model_4].[Proba_2] AS [Proba_2], [BAG_Model_4].[LogProba_2] AS [LogProba_2], [BAG_Model_4].[Score_3] AS [Score_3], [BAG_Model_4].[Proba_3] AS [Proba_3], [BAG_Model_4].[LogProba_3] AS [LogProba_3] 
FROM [BAG_Model_4] UNION ALL SELECT [BAG_Model_5].[KEY] AS [KEY], [BAG_Model_5].[Score_0] AS [Score_0], [BAG_Model_5].[Proba_0] AS [Proba_0], [BAG_Model_5].[LogProba_0] AS [LogProba_0], [BAG_Model_5].[Score_1] AS [Score_1], [BAG_Model_5].[Proba_1] AS [Proba_1], [BAG_Model_5].[LogProba_1] AS [LogProba_1], [BAG_Model_5].[Score_2] AS [Score_2], [BAG_Model_5].[Proba_2] AS [Proba_2], [BAG_Model_5].[LogProba_2] AS [LogProba_2], [BAG_Model_5].[Score_3] AS [Score_3], [BAG_Model_5].[Proba_3] AS [Proba_3], [BAG_Model_5].[LogProba_3] AS [LogProba_3] 
FROM [BAG_Model_5] UNION ALL SELECT [BAG_Model_6].[KEY] AS [KEY], [BAG_Model_6].[Score_0] AS [Score_0], [BAG_Model_6].[Proba_0] AS [Proba_0], [BAG_Model_6].[LogProba_0] AS [LogProba_0], [BAG_Model_6].[Score_1] AS [Score_1], [BAG_Model_6].[Proba_1] AS [Proba_1], [BAG_Model_6].[LogProba_1] AS [LogProba_1], [BAG_Model_6].[Score_2] AS [Score_2], [BAG_Model_6].[Proba_2] AS [Proba_2], [BAG_Model_6].[LogProba_2] AS [LogProba_2], [BAG_Model_6].[Score_3] AS [Score_3], [BAG_Model_6].[Proba_3] AS [Proba_3], [BAG_Model_6].[LogProba_3] AS [LogProba_3] 
FROM [BAG_Model_6] UNION ALL SELECT [BAG_Model_7].[KEY] AS [KEY], [BAG_Model_7].[Score_0] AS [Score_0], [BAG_Model_7].[Proba_0] AS [Proba_0], [BAG_Model_7].[LogProba_0] AS [LogProba_0], [BAG_Model_7].[Score_1] AS [Score_1], [BAG_Model_7].[Proba_1] AS [Proba_1], [BAG_Model_7].[LogProba_1] AS [LogProba_1], [BAG_Model_7].[Score_2] AS [Score_2], [BAG_Model_7].[Proba_2] AS [Proba_2], [BAG_Model_7].[LogProba_2] AS [LogProba_2], [BAG_Model_7].[Score_3] AS [Score_3], [BAG_Model_7].[Proba_3] AS [Proba_3], [BAG_Model_7].[LogProba_3] AS [LogProba_3] 
FROM [BAG_Model_7] UNION ALL SELECT [BAG_Model_8].[KEY] AS [KEY], [BAG_Model_8].[Score_0] AS [Score_0], [BAG_Model_8].[Proba_0] AS [Proba_0], [BAG_Model_8].[LogProba_0] AS [LogProba_0], [BAG_Model_8].[Score_1] AS [Score_1], [BAG_Model_8].[Proba_1] AS [Proba_1], [BAG_Model_8].[LogProba_1] AS [LogProba_1], [BAG_Model_8].[Score_2] AS [Score_2], [BAG_Model_8].[Proba_2] AS [Proba_2], [BAG_Model_8].[LogProba_2] AS [LogProba_2], [BAG_Model_8].[Score_3] AS [Score_3], [BAG_Model_8].[Proba_3] AS [Proba_3], [BAG_Model_8].[LogProba_3] AS [LogProba_3] 
FROM [BAG_Model_8] UNION ALL SELECT [BAG_Model_9].[KEY] AS [KEY], [BAG_Model_9].[Score_0] AS [Score_0], [BAG_Model_9].[Proba_0] AS [Proba_0], [BAG_Model_9].[LogProba_0] AS [LogProba_0], [BAG_Model_9].[Score_1] AS [Score_1], [BAG_Model_9].[Proba_1] AS [Proba_1], [BAG_Model_9].[LogProba_1] AS [LogProba_1], [BAG_Model_9].[Score_2] AS [Score_2], [BAG_Model_9].[Proba_2] AS [Proba_2], [BAG_Model_9].[LogProba_2] AS [LogProba_2], [BAG_Model_9].[Score_3] AS [Score_3], [BAG_Model_9].[Proba_3] AS [Proba_3], [BAG_Model_9].[LogProba_3] AS [LogProba_3] 
FROM [BAG_Model_9]) AS [BAG_esu_0]) AS [BAG_B0]

-- Code For temporary table ##TMP_20180602142918_BZ7_BAG_B1 part 1. Create 


CREATE TABLE ##TMP_20180602142918_BZ7_BAG_B1 (
	[KEY] BIGINT NULL, 
	[Score_0] FLOAT(53) NULL, 
	[Proba_0] FLOAT(53) NULL, 
	[LogProba_0] FLOAT(53) NULL, 
	[Score_1] FLOAT(53) NULL, 
	[Proba_1] FLOAT(53) NULL, 
	[LogProba_1] FLOAT(53) NULL, 
	[Score_2] FLOAT(53) NULL, 
	[Proba_2] FLOAT(53) NULL, 
	[LogProba_2] FLOAT(53) NULL, 
	[Score_3] FLOAT(53) NULL, 
	[Proba_3] FLOAT(53) NULL, 
	[LogProba_3] FLOAT(53) NULL
)



-- Code For temporary table ##TMP_20180602142918_BZ7_BAG_B1 part 2. Populate

WITH [DT_node_lookup_10] AS 
(SELECT [ADS].[KEY] AS [KEY], CASE WHEN ([ADS].[Feature_3] <= -0.6974009871482849) THEN CASE WHEN ([ADS].[Feature_5] <= 0.15964943170547485) THEN CASE WHEN ([ADS].[Feature_5] <= -0.3680424690246582) THEN 3 ELSE 4 END ELSE CASE WHEN ([ADS].[Feature_0] <= -1.019106149673462) THEN 6 ELSE 7 END END ELSE CASE WHEN ([ADS].[Feature_7] <= 0.362348735332489) THEN CASE WHEN ([ADS].[Feature_4] <= -0.17202873528003693) THEN 10 ELSE CASE WHEN ([ADS].[Feature_3] <= 3.3974950313568115) THEN 12 ELSE 13 END END ELSE CASE WHEN ([ADS].[Feature_1] <= 0.04064379632472992) THEN 15 ELSE CASE WHEN ([ADS].[Feature_8] <= -0.5801483988761902) THEN 17 ELSE CASE WHEN ([ADS].[Feature_7] <= 0.9321537017822266) THEN 19 ELSE 20 END END END END END AS node_id_2 
FROM [FourClass_10] AS [ADS]), 
[DT_node_data_10] AS 
(SELECT [Values].nid AS nid, CAST([Values].[P_0] AS FLOAT(53)) AS [P_0], CAST([Values].[P_1] AS FLOAT(53)) AS [P_1], CAST([Values].[P_2] AS FLOAT(53)) AS [P_2], CAST([Values].[P_3] AS FLOAT(53)) AS [P_3], CAST([Values].[D] AS FLOAT(53)) AS [D], CAST([Values].[DP] AS FLOAT(53)) AS [DP] 
FROM (SELECT 3 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 4 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 6 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 7 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 10 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 12 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 13 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 15 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 17 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 19 AS nid, 0.0 AS [P_0], 0.5 AS [P_1], 0.0 AS [P_2], 0.5 AS [P_3], 1 AS [D], 0.5 AS [DP] UNION ALL SELECT 20 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP]) AS [Values]), 
[DT_Output_10] AS 
(SELECT [DT_node_lookup_10].[KEY] AS [KEY], [DT_node_lookup_10].node_id_2 AS node_id_2, [DT_node_data_10].nid AS nid, [DT_node_data_10].[P_0] AS [P_0], [DT_node_data_10].[P_1] AS [P_1], [DT_node_data_10].[P_2] AS [P_2], [DT_node_data_10].[P_3] AS [P_3], [DT_node_data_10].[D] AS [D], [DT_node_data_10].[DP] AS [DP] 
FROM [DT_node_lookup_10] LEFT OUTER JOIN [DT_node_data_10] ON [DT_node_lookup_10].node_id_2 = [DT_node_data_10].nid), 
[BAG_Model_10] AS 
(SELECT [DT_Output_10].[KEY] AS [KEY], CAST(NULL AS FLOAT(53)) AS [Score_0], [DT_Output_10].[P_0] AS [Proba_0], CASE WHEN ([DT_Output_10].[P_0] IS NULL OR [DT_Output_10].[P_0] > 0.0) THEN log([DT_Output_10].[P_0]) ELSE -1.79769313486231e+308 END AS [LogProba_0], CAST(NULL AS FLOAT(53)) AS [Score_1], [DT_Output_10].[P_1] AS [Proba_1], CASE WHEN ([DT_Output_10].[P_1] IS NULL OR [DT_Output_10].[P_1] > 0.0) THEN log([DT_Output_10].[P_1]) ELSE -1.79769313486231e+308 END AS [LogProba_1], CAST(NULL AS FLOAT(53)) AS [Score_2], [DT_Output_10].[P_2] AS [Proba_2], CASE WHEN ([DT_Output_10].[P_2] IS NULL OR [DT_Output_10].[P_2] > 0.0) THEN log([DT_Output_10].[P_2]) ELSE -1.79769313486231e+308 END AS [LogProba_2], CAST(NULL AS FLOAT(53)) AS [Score_3], [DT_Output_10].[P_3] AS [Proba_3], CASE WHEN ([DT_Output_10].[P_3] IS NULL OR [DT_Output_10].[P_3] > 0.0) THEN log([DT_Output_10].[P_3]) ELSE -1.79769313486231e+308 END AS [LogProba_3] 
FROM [DT_Output_10]), 
[DT_node_lookup_11] AS 
(SELECT [ADS].[KEY] AS [KEY], CASE WHEN ([ADS].[Feature_3] <= -1.9042950868606567) THEN 1 ELSE CASE WHEN ([ADS].[Feature_3] <= 1.5620883703231812) THEN CASE WHEN ([ADS].[Feature_4] <= -0.35484129190444946) THEN CASE WHEN ([ADS].[Feature_7] <= -0.04635188356041908) THEN CASE WHEN ([ADS].[Feature_2] <= -1.900172233581543) THEN 6 ELSE 7 END ELSE CASE WHEN ([ADS].[Feature_2] <= -0.8729895353317261) THEN 9 ELSE 10 END END ELSE 11 END ELSE CASE WHEN ([ADS].[Feature_7] <= 0.4184545576572418) THEN 13 ELSE CASE WHEN ([ADS].[Feature_2] <= 0.2656080424785614) THEN CASE WHEN ([ADS].[Feature_1] <= 1.1558878421783447) THEN 16 ELSE 17 END ELSE 18 END END END END AS node_id_2 
FROM [FourClass_10] AS [ADS]), 
[DT_node_data_11] AS 
(SELECT [Values].nid AS nid, CAST([Values].[P_0] AS FLOAT(53)) AS [P_0], CAST([Values].[P_1] AS FLOAT(53)) AS [P_1], CAST([Values].[P_2] AS FLOAT(53)) AS [P_2], CAST([Values].[P_3] AS FLOAT(53)) AS [P_3], CAST([Values].[D] AS FLOAT(53)) AS [D], CAST([Values].[DP] AS FLOAT(53)) AS [DP] 
FROM (SELECT 1 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 6 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 7 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 9 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 10 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 11 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 13 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 16 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 17 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 18 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP]) AS [Values]), 
[DT_Output_11] AS 
(SELECT [DT_node_lookup_11].[KEY] AS [KEY], [DT_node_lookup_11].node_id_2 AS node_id_2, [DT_node_data_11].nid AS nid, [DT_node_data_11].[P_0] AS [P_0], [DT_node_data_11].[P_1] AS [P_1], [DT_node_data_11].[P_2] AS [P_2], [DT_node_data_11].[P_3] AS [P_3], [DT_node_data_11].[D] AS [D], [DT_node_data_11].[DP] AS [DP] 
FROM [DT_node_lookup_11] LEFT OUTER JOIN [DT_node_data_11] ON [DT_node_lookup_11].node_id_2 = [DT_node_data_11].nid), 
[BAG_Model_11] AS 
(SELECT [DT_Output_11].[KEY] AS [KEY], CAST(NULL AS FLOAT(53)) AS [Score_0], [DT_Output_11].[P_0] AS [Proba_0], CASE WHEN ([DT_Output_11].[P_0] IS NULL OR [DT_Output_11].[P_0] > 0.0) THEN log([DT_Output_11].[P_0]) ELSE -1.79769313486231e+308 END AS [LogProba_0], CAST(NULL AS FLOAT(53)) AS [Score_1], [DT_Output_11].[P_1] AS [Proba_1], CASE WHEN ([DT_Output_11].[P_1] IS NULL OR [DT_Output_11].[P_1] > 0.0) THEN log([DT_Output_11].[P_1]) ELSE -1.79769313486231e+308 END AS [LogProba_1], CAST(NULL AS FLOAT(53)) AS [Score_2], [DT_Output_11].[P_2] AS [Proba_2], CASE WHEN ([DT_Output_11].[P_2] IS NULL OR [DT_Output_11].[P_2] > 0.0) THEN log([DT_Output_11].[P_2]) ELSE -1.79769313486231e+308 END AS [LogProba_2], CAST(NULL AS FLOAT(53)) AS [Score_3], [DT_Output_11].[P_3] AS [Proba_3], CASE WHEN ([DT_Output_11].[P_3] IS NULL OR [DT_Output_11].[P_3] > 0.0) THEN log([DT_Output_11].[P_3]) ELSE -1.79769313486231e+308 END AS [LogProba_3] 
FROM [DT_Output_11]), 
[DT_node_lookup_12] AS 
(SELECT [ADS].[KEY] AS [KEY], CASE WHEN ([ADS].[Feature_1] <= -0.029132284224033356) THEN CASE WHEN ([ADS].[Feature_7] <= 0.3409436345100403) THEN CASE WHEN ([ADS].[Feature_0] <= 2.0923612117767334) THEN 3 ELSE 4 END ELSE CASE WHEN ([ADS].[Feature_3] <= 1.717782735824585) THEN 6 ELSE 7 END END ELSE CASE WHEN ([ADS].[Feature_7] <= 0.362348735332489) THEN CASE WHEN ([ADS].[Feature_4] <= 0.9742767810821533) THEN CASE WHEN ([ADS].[Feature_4] <= -0.2062663435935974) THEN 11 ELSE CASE WHEN ([ADS].[Feature_8] <= 0.3988768458366394) THEN 13 ELSE 14 END END ELSE CASE WHEN ([ADS].[Feature_3] <= -0.23729708790779114) THEN 16 ELSE 17 END END ELSE CASE WHEN ([ADS].[Feature_2] <= 0.21300426125526428) THEN CASE WHEN ([ADS].[Feature_9] <= 0.05315040051937103) THEN CASE WHEN ([ADS].[Feature_3] <= 0.32802700996398926) THEN 21 ELSE 22 END ELSE CASE WHEN ([ADS].[Feature_4] <= 0.02527746558189392) THEN 24 ELSE 25 END END ELSE 26 END END END AS node_id_2 
FROM [FourClass_10] AS [ADS]), 
[DT_node_data_12] AS 
(SELECT [Values].nid AS nid, CAST([Values].[P_0] AS FLOAT(53)) AS [P_0], CAST([Values].[P_1] AS FLOAT(53)) AS [P_1], CAST([Values].[P_2] AS FLOAT(53)) AS [P_2], CAST([Values].[P_3] AS FLOAT(53)) AS [P_3], CAST([Values].[D] AS FLOAT(53)) AS [D], CAST([Values].[DP] AS FLOAT(53)) AS [DP] 
FROM (SELECT 3 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 4 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 6 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 7 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 11 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 13 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 14 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 16 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 17 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 21 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 22 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 24 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.8333333333333334 AS [P_2], 0.16666666666666666 AS [P_3], 2 AS [D], 0.8333333333333334 AS [DP] UNION ALL SELECT 25 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 26 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP]) AS [Values]), 
[DT_Output_12] AS 
(SELECT [DT_node_lookup_12].[KEY] AS [KEY], [DT_node_lookup_12].node_id_2 AS node_id_2, [DT_node_data_12].nid AS nid, [DT_node_data_12].[P_0] AS [P_0], [DT_node_data_12].[P_1] AS [P_1], [DT_node_data_12].[P_2] AS [P_2], [DT_node_data_12].[P_3] AS [P_3], [DT_node_data_12].[D] AS [D], [DT_node_data_12].[DP] AS [DP] 
FROM [DT_node_lookup_12] LEFT OUTER JOIN [DT_node_data_12] ON [DT_node_lookup_12].node_id_2 = [DT_node_data_12].nid), 
[BAG_Model_12] AS 
(SELECT [DT_Output_12].[KEY] AS [KEY], CAST(NULL AS FLOAT(53)) AS [Score_0], [DT_Output_12].[P_0] AS [Proba_0], CASE WHEN ([DT_Output_12].[P_0] IS NULL OR [DT_Output_12].[P_0] > 0.0) THEN log([DT_Output_12].[P_0]) ELSE -1.79769313486231e+308 END AS [LogProba_0], CAST(NULL AS FLOAT(53)) AS [Score_1], [DT_Output_12].[P_1] AS [Proba_1], CASE WHEN ([DT_Output_12].[P_1] IS NULL OR [DT_Output_12].[P_1] > 0.0) THEN log([DT_Output_12].[P_1]) ELSE -1.79769313486231e+308 END AS [LogProba_1], CAST(NULL AS FLOAT(53)) AS [Score_2], [DT_Output_12].[P_2] AS [Proba_2], CASE WHEN ([DT_Output_12].[P_2] IS NULL OR [DT_Output_12].[P_2] > 0.0) THEN log([DT_Output_12].[P_2]) ELSE -1.79769313486231e+308 END AS [LogProba_2], CAST(NULL AS FLOAT(53)) AS [Score_3], [DT_Output_12].[P_3] AS [Proba_3], CASE WHEN ([DT_Output_12].[P_3] IS NULL OR [DT_Output_12].[P_3] > 0.0) THEN log([DT_Output_12].[P_3]) ELSE -1.79769313486231e+308 END AS [LogProba_3] 
FROM [DT_Output_12]), 
[DT_node_lookup_13] AS 
(SELECT [ADS].[KEY] AS [KEY], CASE WHEN ([ADS].[Feature_4] <= 0.5936837196350098) THEN CASE WHEN ([ADS].[Feature_7] <= 0.362348735332489) THEN CASE WHEN ([ADS].[Feature_1] <= -0.18501365184783936) THEN CASE WHEN ([ADS].[Feature_1] <= -0.7423888444900513) THEN 4 ELSE 5 END ELSE CASE WHEN ([ADS].[Feature_4] <= -0.22707927227020264) THEN 7 ELSE CASE WHEN ([ADS].[Feature_5] <= 0.1437649130821228) THEN 9 ELSE 10 END END END ELSE CASE WHEN ([ADS].[Feature_6] <= -0.42736783623695374) THEN CASE WHEN ([ADS].[Feature_7] <= 3.0718374252319336) THEN CASE WHEN ([ADS].[Feature_5] <= 1.7956550121307373) THEN 14 ELSE 15 END ELSE 16 END ELSE CASE WHEN ([ADS].[Feature_1] <= -0.28247934579849243) THEN 18 ELSE 19 END END END ELSE CASE WHEN ([ADS].[Feature_6] <= -0.843204140663147) THEN 21 ELSE CASE WHEN ([ADS].[Feature_5] <= 0.20823608338832855) THEN CASE WHEN ([ADS].[Feature_1] <= 1.870528221130371) THEN 24 ELSE CASE WHEN ([ADS].[Feature_8] <= 1.9057921171188354) THEN 26 ELSE 27 END END ELSE 28 END END END AS node_id_2 
FROM [FourClass_10] AS [ADS]), 
[DT_node_data_13] AS 
(SELECT [Values].nid AS nid, CAST([Values].[P_0] AS FLOAT(53)) AS [P_0], CAST([Values].[P_1] AS FLOAT(53)) AS [P_1], CAST([Values].[P_2] AS FLOAT(53)) AS [P_2], CAST([Values].[P_3] AS FLOAT(53)) AS [P_3], CAST([Values].[D] AS FLOAT(53)) AS [D], CAST([Values].[DP] AS FLOAT(53)) AS [DP] 
FROM (SELECT 4 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 5 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 7 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 9 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 10 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 14 AS nid, 0.0 AS [P_0], 0.8888888888888888 AS [P_1], 0.05555555555555555 AS [P_2], 0.05555555555555555 AS [P_3], 1 AS [D], 0.8888888888888888 AS [DP] UNION ALL SELECT 15 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 16 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 18 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 19 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 21 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 24 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 26 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 27 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 28 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP]) AS [Values]), 
[DT_Output_13] AS 
(SELECT [DT_node_lookup_13].[KEY] AS [KEY], [DT_node_lookup_13].node_id_2 AS node_id_2, [DT_node_data_13].nid AS nid, [DT_node_data_13].[P_0] AS [P_0], [DT_node_data_13].[P_1] AS [P_1], [DT_node_data_13].[P_2] AS [P_2], [DT_node_data_13].[P_3] AS [P_3], [DT_node_data_13].[D] AS [D], [DT_node_data_13].[DP] AS [DP] 
FROM [DT_node_lookup_13] LEFT OUTER JOIN [DT_node_data_13] ON [DT_node_lookup_13].node_id_2 = [DT_node_data_13].nid), 
[BAG_Model_13] AS 
(SELECT [DT_Output_13].[KEY] AS [KEY], CAST(NULL AS FLOAT(53)) AS [Score_0], [DT_Output_13].[P_0] AS [Proba_0], CASE WHEN ([DT_Output_13].[P_0] IS NULL OR [DT_Output_13].[P_0] > 0.0) THEN log([DT_Output_13].[P_0]) ELSE -1.79769313486231e+308 END AS [LogProba_0], CAST(NULL AS FLOAT(53)) AS [Score_1], [DT_Output_13].[P_1] AS [Proba_1], CASE WHEN ([DT_Output_13].[P_1] IS NULL OR [DT_Output_13].[P_1] > 0.0) THEN log([DT_Output_13].[P_1]) ELSE -1.79769313486231e+308 END AS [LogProba_1], CAST(NULL AS FLOAT(53)) AS [Score_2], [DT_Output_13].[P_2] AS [Proba_2], CASE WHEN ([DT_Output_13].[P_2] IS NULL OR [DT_Output_13].[P_2] > 0.0) THEN log([DT_Output_13].[P_2]) ELSE -1.79769313486231e+308 END AS [LogProba_2], CAST(NULL AS FLOAT(53)) AS [Score_3], [DT_Output_13].[P_3] AS [Proba_3], CASE WHEN ([DT_Output_13].[P_3] IS NULL OR [DT_Output_13].[P_3] > 0.0) THEN log([DT_Output_13].[P_3]) ELSE -1.79769313486231e+308 END AS [LogProba_3] 
FROM [DT_Output_13]), 
[DT_node_lookup_14] AS 
(SELECT [ADS].[KEY] AS [KEY], CASE WHEN ([ADS].[Feature_4] <= -0.20330390334129333) THEN CASE WHEN ([ADS].[Feature_7] <= 0.053552694618701935) THEN CASE WHEN ([ADS].[Feature_1] <= -0.18501365184783936) THEN CASE WHEN ([ADS].[Feature_5] <= 0.07402315735816956) THEN 4 ELSE 5 END ELSE CASE WHEN ([ADS].[Feature_5] <= -1.9143248796463013) THEN 7 ELSE 8 END END ELSE CASE WHEN ([ADS].[Feature_0] <= 0.5461699366569519) THEN CASE WHEN ([ADS].[Feature_9] <= 0.22027607262134552) THEN CASE WHEN ([ADS].[Feature_3] <= 0.5982345938682556) THEN 12 ELSE 13 END ELSE CASE WHEN ([ADS].[Feature_4] <= -1.0224858522415161) THEN 15 ELSE 16 END END ELSE 17 END END ELSE CASE WHEN ([ADS].[Feature_3] <= 1.5462548732757568) THEN CASE WHEN ([ADS].[Feature_3] <= -2.1362476348876953) THEN 20 ELSE CASE WHEN ([ADS].[Feature_5] <= 0.33322328329086304) THEN CASE WHEN ([ADS].[Feature_1] <= 1.870528221130371) THEN 23 ELSE 24 END ELSE CASE WHEN ([ADS].[Feature_5] <= 1.0488641262054443) THEN 26 ELSE 27 END END END ELSE 28 END END AS node_id_2 
FROM [FourClass_10] AS [ADS]), 
[DT_node_data_14] AS 
(SELECT [Values].nid AS nid, CAST([Values].[P_0] AS FLOAT(53)) AS [P_0], CAST([Values].[P_1] AS FLOAT(53)) AS [P_1], CAST([Values].[P_2] AS FLOAT(53)) AS [P_2], CAST([Values].[P_3] AS FLOAT(53)) AS [P_3], CAST([Values].[D] AS FLOAT(53)) AS [D], CAST([Values].[DP] AS FLOAT(53)) AS [DP] 
FROM (SELECT 4 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 5 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 7 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 8 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 12 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 13 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 15 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 16 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 17 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 20 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 23 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 24 AS nid, 0.75 AS [P_0], 0.25 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 0.75 AS [DP] UNION ALL SELECT 26 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 27 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 28 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP]) AS [Values]), 
[DT_Output_14] AS 
(SELECT [DT_node_lookup_14].[KEY] AS [KEY], [DT_node_lookup_14].node_id_2 AS node_id_2, [DT_node_data_14].nid AS nid, [DT_node_data_14].[P_0] AS [P_0], [DT_node_data_14].[P_1] AS [P_1], [DT_node_data_14].[P_2] AS [P_2], [DT_node_data_14].[P_3] AS [P_3], [DT_node_data_14].[D] AS [D], [DT_node_data_14].[DP] AS [DP] 
FROM [DT_node_lookup_14] LEFT OUTER JOIN [DT_node_data_14] ON [DT_node_lookup_14].node_id_2 = [DT_node_data_14].nid), 
[BAG_Model_14] AS 
(SELECT [DT_Output_14].[KEY] AS [KEY], CAST(NULL AS FLOAT(53)) AS [Score_0], [DT_Output_14].[P_0] AS [Proba_0], CASE WHEN ([DT_Output_14].[P_0] IS NULL OR [DT_Output_14].[P_0] > 0.0) THEN log([DT_Output_14].[P_0]) ELSE -1.79769313486231e+308 END AS [LogProba_0], CAST(NULL AS FLOAT(53)) AS [Score_1], [DT_Output_14].[P_1] AS [Proba_1], CASE WHEN ([DT_Output_14].[P_1] IS NULL OR [DT_Output_14].[P_1] > 0.0) THEN log([DT_Output_14].[P_1]) ELSE -1.79769313486231e+308 END AS [LogProba_1], CAST(NULL AS FLOAT(53)) AS [Score_2], [DT_Output_14].[P_2] AS [Proba_2], CASE WHEN ([DT_Output_14].[P_2] IS NULL OR [DT_Output_14].[P_2] > 0.0) THEN log([DT_Output_14].[P_2]) ELSE -1.79769313486231e+308 END AS [LogProba_2], CAST(NULL AS FLOAT(53)) AS [Score_3], [DT_Output_14].[P_3] AS [Proba_3], CASE WHEN ([DT_Output_14].[P_3] IS NULL OR [DT_Output_14].[P_3] > 0.0) THEN log([DT_Output_14].[P_3]) ELSE -1.79769313486231e+308 END AS [LogProba_3] 
FROM [DT_Output_14]), 
[DT_node_lookup_15] AS 
(SELECT [ADS].[KEY] AS [KEY], CASE WHEN ([ADS].[Feature_3] <= 1.0540543794631958) THEN CASE WHEN ([ADS].[Feature_4] <= -0.35484129190444946) THEN CASE WHEN ([ADS].[Feature_1] <= 0.8389769792556763) THEN CASE WHEN ([ADS].[Feature_8] <= -0.4956623911857605) THEN CASE WHEN ([ADS].[Feature_1] <= -0.46426844596862793) THEN 5 ELSE 6 END ELSE 7 END ELSE 8 END ELSE CASE WHEN ([ADS].[Feature_6] <= 1.1597294807434082) THEN CASE WHEN ([ADS].[Feature_2] <= -2.5394277572631836) THEN 11 ELSE 12 END ELSE 13 END END ELSE CASE WHEN ([ADS].[Feature_8] <= 1.0354390144348145) THEN CASE WHEN ([ADS].[Feature_7] <= -0.31694555282592773) THEN 16 ELSE CASE WHEN ([ADS].[Feature_9] <= -1.5898537635803223) THEN 18 ELSE CASE WHEN ([ADS].[Feature_8] <= 0.33265137672424316) THEN 20 ELSE 21 END END END ELSE CASE WHEN ([ADS].[Feature_7] <= 0.6524839997291565) THEN 23 ELSE 24 END END END AS node_id_2 
FROM [FourClass_10] AS [ADS]), 
[DT_node_data_15] AS 
(SELECT [Values].nid AS nid, CAST([Values].[P_0] AS FLOAT(53)) AS [P_0], CAST([Values].[P_1] AS FLOAT(53)) AS [P_1], CAST([Values].[P_2] AS FLOAT(53)) AS [P_2], CAST([Values].[P_3] AS FLOAT(53)) AS [P_3], CAST([Values].[D] AS FLOAT(53)) AS [D], CAST([Values].[DP] AS FLOAT(53)) AS [DP] 
FROM (SELECT 5 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 6 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 7 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 8 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 11 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 12 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 13 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP] UNION ALL SELECT 16 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 18 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 0 AS [D], 1.0 AS [DP] UNION ALL SELECT 20 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 0.0 AS [P_2], 0.0 AS [P_3], 1 AS [D], 1.0 AS [DP] UNION ALL SELECT 21 AS nid, 0.0 AS [P_0], 0.8 AS [P_1], 0.0 AS [P_2], 0.2 AS [P_3], 1 AS [D], 0.8 AS [DP] UNION ALL SELECT 23 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 0.0 AS [P_2], 1.0 AS [P_3], 3 AS [D], 1.0 AS [DP] UNION ALL SELECT 24 AS nid, 0.0 AS [P_0], 0.0 AS [P_1], 1.0 AS [P_2], 0.0 AS [P_3], 2 AS [D], 1.0 AS [DP]) AS [Values]), 
[DT_Output_15] AS 
(SELECT [DT_node_lookup_15].[KEY] AS [KEY], [DT_node_lookup_15].node_id_2 AS node_id_2, [DT_node_data_15].nid AS nid, [DT_node_data_15].[P_0] AS [P_0], [DT_node_data_15].[P_1] AS [P_1], [DT_node_data_15].[P_2] AS [P_2], [DT_node_data_15].[P_3] AS [P_3], [DT_node_data_15].[D] AS [D], [DT_node_data_15].[DP] AS [DP] 
FROM [DT_node_lookup_15] LEFT OUTER JOIN [DT_node_data_15] ON [DT_node_lookup_15].node_id_2 = [DT_node_data_15].nid), 
[BAG_Model_15] AS 
(SELECT [DT_Output_15].[KEY] AS [KEY], CAST(NULL AS FLOAT(53)) AS [Score_0], [DT_Output_15].[P_0] AS [Proba_0], CASE WHEN ([DT_Output_15].[P_0] IS NULL OR [DT_Output_15].[P_0] > 0.0) THEN log([DT_Output_15].[P_0]) ELSE -1.79769313486231e+308 END AS [LogProba_0], CAST(NULL AS FLOAT(53)) AS [Score_1], [DT_Output_15].[P_1] AS [Proba_1], CASE WHEN ([DT_Output_15].[P_1] IS NULL OR [DT_Output_15].[P_1] > 0.0) THEN log([DT_Output_15].[P_1]) ELSE -1.79769313486231e+308 END AS [LogProba_1], CAST(NULL AS FLOAT(53)) AS [Score_2], [DT_Output_15].[P_2] AS [Proba_2], CASE WHEN ([DT_Output_15].[P_2] IS NULL OR [DT_Output_15].[P_2] > 0.0) THEN log([DT_Output_15].[P_2]) ELSE -1.79769313486231e+308 END AS [LogProba_2], CAST(NULL AS FLOAT(53)) AS [Score_3], [DT_Output_15].[P_3] AS [Proba_3], CASE WHEN ([DT_Output_15].[P_3] IS NULL OR [DT_Output_15].[P_3] > 0.0) THEN log([DT_Output_15].[P_3]) ELSE -1.79769313486231e+308 END AS [LogProba_3] 
FROM [DT_Output_15])
 INSERT INTO ##TMP_20180602142918_BZ7_BAG_B1 ([KEY], [Score_0], [Proba_0], [LogProba_0], [Score_1], [Proba_1], [LogProba_1], [Score_2], [Proba_2], [LogProba_2], [Score_3], [Proba_3], [LogProba_3]) SELECT [BAG_B1].[KEY], [BAG_B1].[Score_0], [BAG_B1].[Proba_0], [BAG_B1].[LogProba_0], [BAG_B1].[Score_1], [BAG_B1].[Proba_1], [BAG_B1].[LogProba_1], [BAG_B1].[Score_2], [BAG_B1].[Proba_2], [BAG_B1].[LogProba_2], [BAG_B1].[Score_3], [BAG_B1].[Proba_3], [BAG_B1].[LogProba_3] 
FROM (SELECT [BAG_esu_1].[KEY] AS [KEY], [BAG_esu_1].[Score_0] AS [Score_0], [BAG_esu_1].[Proba_0] AS [Proba_0], [BAG_esu_1].[LogProba_0] AS [LogProba_0], [BAG_esu_1].[Score_1] AS [Score_1], [BAG_esu_1].[Proba_1] AS [Proba_1], [BAG_esu_1].[LogProba_1] AS [LogProba_1], [BAG_esu_1].[Score_2] AS [Score_2], [BAG_esu_1].[Proba_2] AS [Proba_2], [BAG_esu_1].[LogProba_2] AS [LogProba_2], [BAG_esu_1].[Score_3] AS [Score_3], [BAG_esu_1].[Proba_3] AS [Proba_3], [BAG_esu_1].[LogProba_3] AS [LogProba_3] 
FROM (SELECT [BAG_Model_10].[KEY] AS [KEY], [BAG_Model_10].[Score_0] AS [Score_0], [BAG_Model_10].[Proba_0] AS [Proba_0], [BAG_Model_10].[LogProba_0] AS [LogProba_0], [BAG_Model_10].[Score_1] AS [Score_1], [BAG_Model_10].[Proba_1] AS [Proba_1], [BAG_Model_10].[LogProba_1] AS [LogProba_1], [BAG_Model_10].[Score_2] AS [Score_2], [BAG_Model_10].[Proba_2] AS [Proba_2], [BAG_Model_10].[LogProba_2] AS [LogProba_2], [BAG_Model_10].[Score_3] AS [Score_3], [BAG_Model_10].[Proba_3] AS [Proba_3], [BAG_Model_10].[LogProba_3] AS [LogProba_3] 
FROM [BAG_Model_10] UNION ALL SELECT [BAG_Model_11].[KEY] AS [KEY], [BAG_Model_11].[Score_0] AS [Score_0], [BAG_Model_11].[Proba_0] AS [Proba_0], [BAG_Model_11].[LogProba_0] AS [LogProba_0], [BAG_Model_11].[Score_1] AS [Score_1], [BAG_Model_11].[Proba_1] AS [Proba_1], [BAG_Model_11].[LogProba_1] AS [LogProba_1], [BAG_Model_11].[Score_2] AS [Score_2], [BAG_Model_11].[Proba_2] AS [Proba_2], [BAG_Model_11].[LogProba_2] AS [LogProba_2], [BAG_Model_11].[Score_3] AS [Score_3], [BAG_Model_11].[Proba_3] AS [Proba_3], [BAG_Model_11].[LogProba_3] AS [LogProba_3] 
FROM [BAG_Model_11] UNION ALL SELECT [BAG_Model_12].[KEY] AS [KEY], [BAG_Model_12].[Score_0] AS [Score_0], [BAG_Model_12].[Proba_0] AS [Proba_0], [BAG_Model_12].[LogProba_0] AS [LogProba_0], [BAG_Model_12].[Score_1] AS [Score_1], [BAG_Model_12].[Proba_1] AS [Proba_1], [BAG_Model_12].[LogProba_1] AS [LogProba_1], [BAG_Model_12].[Score_2] AS [Score_2], [BAG_Model_12].[Proba_2] AS [Proba_2], [BAG_Model_12].[LogProba_2] AS [LogProba_2], [BAG_Model_12].[Score_3] AS [Score_3], [BAG_Model_12].[Proba_3] AS [Proba_3], [BAG_Model_12].[LogProba_3] AS [LogProba_3] 
FROM [BAG_Model_12] UNION ALL SELECT [BAG_Model_13].[KEY] AS [KEY], [BAG_Model_13].[Score_0] AS [Score_0], [BAG_Model_13].[Proba_0] AS [Proba_0], [BAG_Model_13].[LogProba_0] AS [LogProba_0], [BAG_Model_13].[Score_1] AS [Score_1], [BAG_Model_13].[Proba_1] AS [Proba_1], [BAG_Model_13].[LogProba_1] AS [LogProba_1], [BAG_Model_13].[Score_2] AS [Score_2], [BAG_Model_13].[Proba_2] AS [Proba_2], [BAG_Model_13].[LogProba_2] AS [LogProba_2], [BAG_Model_13].[Score_3] AS [Score_3], [BAG_Model_13].[Proba_3] AS [Proba_3], [BAG_Model_13].[LogProba_3] AS [LogProba_3] 
FROM [BAG_Model_13] UNION ALL SELECT [BAG_Model_14].[KEY] AS [KEY], [BAG_Model_14].[Score_0] AS [Score_0], [BAG_Model_14].[Proba_0] AS [Proba_0], [BAG_Model_14].[LogProba_0] AS [LogProba_0], [BAG_Model_14].[Score_1] AS [Score_1], [BAG_Model_14].[Proba_1] AS [Proba_1], [BAG_Model_14].[LogProba_1] AS [LogProba_1], [BAG_Model_14].[Score_2] AS [Score_2], [BAG_Model_14].[Proba_2] AS [Proba_2], [BAG_Model_14].[LogProba_2] AS [LogProba_2], [BAG_Model_14].[Score_3] AS [Score_3], [BAG_Model_14].[Proba_3] AS [Proba_3], [BAG_Model_14].[LogProba_3] AS [LogProba_3] 
FROM [BAG_Model_14] UNION ALL SELECT [BAG_Model_15].[KEY] AS [KEY], [BAG_Model_15].[Score_0] AS [Score_0], [BAG_Model_15].[Proba_0] AS [Proba_0], [BAG_Model_15].[LogProba_0] AS [LogProba_0], [BAG_Model_15].[Score_1] AS [Score_1], [BAG_Model_15].[Proba_1] AS [Proba_1], [BAG_Model_15].[LogProba_1] AS [LogProba_1], [BAG_Model_15].[Score_2] AS [Score_2], [BAG_Model_15].[Proba_2] AS [Proba_2], [BAG_Model_15].[LogProba_2] AS [LogProba_2], [BAG_Model_15].[Score_3] AS [Score_3], [BAG_Model_15].[Proba_3] AS [Proba_3], [BAG_Model_15].[LogProba_3] AS [LogProba_3] 
FROM [BAG_Model_15]) AS [BAG_esu_1]) AS [BAG_B1]

-- Code For temporary table ##TMP_20180602142918_JT4_BAG_avg part 1. Create 


CREATE TABLE ##TMP_20180602142918_JT4_BAG_avg (
	[KEY] BIGINT NULL, 
	[Score_0] FLOAT(53) NULL, 
	[Proba_0] FLOAT(53) NULL, 
	[LogProba_0] FLOAT(53) NULL, 
	[Score_1] FLOAT(53) NULL, 
	[Proba_1] FLOAT(53) NULL, 
	[LogProba_1] FLOAT(53) NULL, 
	[Score_2] FLOAT(53) NULL, 
	[Proba_2] FLOAT(53) NULL, 
	[LogProba_2] FLOAT(53) NULL, 
	[Score_3] FLOAT(53) NULL, 
	[Proba_3] FLOAT(53) NULL, 
	[LogProba_3] FLOAT(53) NULL
)



-- Code For temporary table ##TMP_20180602142918_JT4_BAG_avg part 2. Populate

WITH [BAG_Union] AS 
(SELECT [BAG_EnsembleUnion].[KEY] AS [KEY], [BAG_EnsembleUnion].[Score_0] AS [Score_0], [BAG_EnsembleUnion].[Proba_0] AS [Proba_0], [BAG_EnsembleUnion].[LogProba_0] AS [LogProba_0], [BAG_EnsembleUnion].[Score_1] AS [Score_1], [BAG_EnsembleUnion].[Proba_1] AS [Proba_1], [BAG_EnsembleUnion].[LogProba_1] AS [LogProba_1], [BAG_EnsembleUnion].[Score_2] AS [Score_2], [BAG_EnsembleUnion].[Proba_2] AS [Proba_2], [BAG_EnsembleUnion].[LogProba_2] AS [LogProba_2], [BAG_EnsembleUnion].[Score_3] AS [Score_3], [BAG_EnsembleUnion].[Proba_3] AS [Proba_3], [BAG_EnsembleUnion].[LogProba_3] AS [LogProba_3] 
FROM (SELECT [BAG_B0].[KEY] AS [KEY], [BAG_B0].[Score_0] AS [Score_0], [BAG_B0].[Proba_0] AS [Proba_0], [BAG_B0].[LogProba_0] AS [LogProba_0], [BAG_B0].[Score_1] AS [Score_1], [BAG_B0].[Proba_1] AS [Proba_1], [BAG_B0].[LogProba_1] AS [LogProba_1], [BAG_B0].[Score_2] AS [Score_2], [BAG_B0].[Proba_2] AS [Proba_2], [BAG_B0].[LogProba_2] AS [LogProba_2], [BAG_B0].[Score_3] AS [Score_3], [BAG_B0].[Proba_3] AS [Proba_3], [BAG_B0].[LogProba_3] AS [LogProba_3] 
FROM ##TMP_20180602142918_639_BAG_B0 AS [BAG_B0] UNION ALL SELECT [BAG_B1].[KEY] AS [KEY], [BAG_B1].[Score_0] AS [Score_0], [BAG_B1].[Proba_0] AS [Proba_0], [BAG_B1].[LogProba_0] AS [LogProba_0], [BAG_B1].[Score_1] AS [Score_1], [BAG_B1].[Proba_1] AS [Proba_1], [BAG_B1].[LogProba_1] AS [LogProba_1], [BAG_B1].[Score_2] AS [Score_2], [BAG_B1].[Proba_2] AS [Proba_2], [BAG_B1].[LogProba_2] AS [LogProba_2], [BAG_B1].[Score_3] AS [Score_3], [BAG_B1].[Proba_3] AS [Proba_3], [BAG_B1].[LogProba_3] AS [LogProba_3] 
FROM ##TMP_20180602142918_BZ7_BAG_B1 AS [BAG_B1]) AS [BAG_EnsembleUnion])
 INSERT INTO ##TMP_20180602142918_JT4_BAG_avg ([KEY], [Score_0], [Proba_0], [LogProba_0], [Score_1], [Proba_1], [LogProba_1], [Score_2], [Proba_2], [LogProba_2], [Score_3], [Proba_3], [LogProba_3]) SELECT [BAG_avg].[KEY], [BAG_avg].[Score_0], [BAG_avg].[Proba_0], [BAG_avg].[LogProba_0], [BAG_avg].[Score_1], [BAG_avg].[Proba_1], [BAG_avg].[LogProba_1], [BAG_avg].[Score_2], [BAG_avg].[Proba_2], [BAG_avg].[LogProba_2], [BAG_avg].[Score_3], [BAG_avg].[Proba_3], [BAG_avg].[LogProba_3] 
FROM (SELECT [T].[KEY] AS [KEY], CAST([T].[Score_0] AS FLOAT(53)) AS [Score_0], CAST([T].[Proba_0] AS FLOAT(53)) AS [Proba_0], CAST([T].[LogProba_0] AS FLOAT(53)) AS [LogProba_0], CAST([T].[Score_1] AS FLOAT(53)) AS [Score_1], CAST([T].[Proba_1] AS FLOAT(53)) AS [Proba_1], CAST([T].[LogProba_1] AS FLOAT(53)) AS [LogProba_1], CAST([T].[Score_2] AS FLOAT(53)) AS [Score_2], CAST([T].[Proba_2] AS FLOAT(53)) AS [Proba_2], CAST([T].[LogProba_2] AS FLOAT(53)) AS [LogProba_2], CAST([T].[Score_3] AS FLOAT(53)) AS [Score_3], CAST([T].[Proba_3] AS FLOAT(53)) AS [Proba_3], CAST([T].[LogProba_3] AS FLOAT(53)) AS [LogProba_3] 
FROM (SELECT [BAG_Union].[KEY] AS [KEY], avg(CAST([BAG_Union].[Score_0] AS FLOAT(53))) AS [Score_0], avg(CAST([BAG_Union].[Proba_0] AS FLOAT(53))) AS [Proba_0], CAST(NULL AS FLOAT(53)) AS [LogProba_0], avg(CAST([BAG_Union].[Score_1] AS FLOAT(53))) AS [Score_1], avg(CAST([BAG_Union].[Proba_1] AS FLOAT(53))) AS [Proba_1], CAST(NULL AS FLOAT(53)) AS [LogProba_1], avg(CAST([BAG_Union].[Score_2] AS FLOAT(53))) AS [Score_2], avg(CAST([BAG_Union].[Proba_2] AS FLOAT(53))) AS [Proba_2], CAST(NULL AS FLOAT(53)) AS [LogProba_2], avg(CAST([BAG_Union].[Score_3] AS FLOAT(53))) AS [Score_3], avg(CAST([BAG_Union].[Proba_3] AS FLOAT(53))) AS [Proba_3], CAST(NULL AS FLOAT(53)) AS [LogProba_3] 
FROM [BAG_Union] GROUP BY [BAG_Union].[KEY]) AS [T]) AS [BAG_avg]

-- Model deployment code

WITH orig_cte AS 
(SELECT [BAG_avg].[KEY] AS [KEY], [BAG_avg].[Score_0] AS [Score_0], [BAG_avg].[Score_1] AS [Score_1], [BAG_avg].[Score_2] AS [Score_2], [BAG_avg].[Score_3] AS [Score_3], [BAG_avg].[Proba_0] AS [Proba_0], [BAG_avg].[Proba_1] AS [Proba_1], [BAG_avg].[Proba_2] AS [Proba_2], [BAG_avg].[Proba_3] AS [Proba_3], [BAG_avg].[LogProba_0] AS [LogProba_0], [BAG_avg].[LogProba_1] AS [LogProba_1], [BAG_avg].[LogProba_2] AS [LogProba_2], [BAG_avg].[LogProba_3] AS [LogProba_3], CAST(NULL AS BIGINT) AS [Decision], CAST(NULL AS FLOAT(53)) AS [DecisionProba] 
FROM ##TMP_20180602142918_JT4_BAG_avg AS [BAG_avg]), 
score_class_union AS 
(SELECT scu.[KEY_u] AS [KEY_u], scu.class AS class, scu.[LogProba] AS [LogProba], scu.[Proba] AS [Proba], scu.[Score] AS [Score] 
FROM (SELECT orig_cte.[KEY] AS [KEY_u], 0 AS class, orig_cte.[LogProba_0] AS [LogProba], orig_cte.[Proba_0] AS [Proba], orig_cte.[Score_0] AS [Score] 
FROM orig_cte UNION ALL SELECT orig_cte.[KEY] AS [KEY_u], 1 AS class, orig_cte.[LogProba_1] AS [LogProba], orig_cte.[Proba_1] AS [Proba], orig_cte.[Score_1] AS [Score] 
FROM orig_cte UNION ALL SELECT orig_cte.[KEY] AS [KEY_u], 2 AS class, orig_cte.[LogProba_2] AS [LogProba], orig_cte.[Proba_2] AS [Proba], orig_cte.[Score_2] AS [Score] 
FROM orig_cte UNION ALL SELECT orig_cte.[KEY] AS [KEY_u], 3 AS class, orig_cte.[LogProba_3] AS [LogProba], orig_cte.[Proba_3] AS [Proba], orig_cte.[Score_3] AS [Score] 
FROM orig_cte) AS scu), 
score_max AS 
(SELECT orig_cte.[KEY] AS [KEY], orig_cte.[Score_0] AS [Score_0], orig_cte.[Score_1] AS [Score_1], orig_cte.[Score_2] AS [Score_2], orig_cte.[Score_3] AS [Score_3], orig_cte.[Proba_0] AS [Proba_0], orig_cte.[Proba_1] AS [Proba_1], orig_cte.[Proba_2] AS [Proba_2], orig_cte.[Proba_3] AS [Proba_3], orig_cte.[LogProba_0] AS [LogProba_0], orig_cte.[LogProba_1] AS [LogProba_1], orig_cte.[LogProba_2] AS [LogProba_2], orig_cte.[LogProba_3] AS [LogProba_3], orig_cte.[Decision] AS [Decision], orig_cte.[DecisionProba] AS [DecisionProba], max_select.[KEY_m] AS [KEY_m], max_select.[max_Proba] AS [max_Proba] 
FROM orig_cte LEFT OUTER JOIN (SELECT score_class_union.[KEY_u] AS [KEY_m], max(score_class_union.[Proba]) AS [max_Proba] 
FROM score_class_union GROUP BY score_class_union.[KEY_u]) AS max_select ON orig_cte.[KEY] = max_select.[KEY_m]), 
union_with_max AS 
(SELECT score_class_union.[KEY_u] AS [KEY_u], score_class_union.class AS class, score_class_union.[LogProba] AS [LogProba], score_class_union.[Proba] AS [Proba], score_class_union.[Score] AS [Score], score_max.[KEY] AS [KEY], score_max.[Score_0] AS [Score_0], score_max.[Score_1] AS [Score_1], score_max.[Score_2] AS [Score_2], score_max.[Score_3] AS [Score_3], score_max.[Proba_0] AS [Proba_0], score_max.[Proba_1] AS [Proba_1], score_max.[Proba_2] AS [Proba_2], score_max.[Proba_3] AS [Proba_3], score_max.[LogProba_0] AS [LogProba_0], score_max.[LogProba_1] AS [LogProba_1], score_max.[LogProba_2] AS [LogProba_2], score_max.[LogProba_3] AS [LogProba_3], score_max.[Decision] AS [Decision], score_max.[DecisionProba] AS [DecisionProba], score_max.[KEY_m] AS [KEY_m], score_max.[max_Proba] AS [max_Proba] 
FROM score_class_union LEFT OUTER JOIN score_max ON score_class_union.[KEY_u] = score_max.[KEY]), 
arg_max_cte AS 
(SELECT score_max.[KEY] AS [KEY], score_max.[Score_0] AS [Score_0], score_max.[Score_1] AS [Score_1], score_max.[Score_2] AS [Score_2], score_max.[Score_3] AS [Score_3], score_max.[Proba_0] AS [Proba_0], score_max.[Proba_1] AS [Proba_1], score_max.[Proba_2] AS [Proba_2], score_max.[Proba_3] AS [Proba_3], score_max.[LogProba_0] AS [LogProba_0], score_max.[LogProba_1] AS [LogProba_1], score_max.[LogProba_2] AS [LogProba_2], score_max.[LogProba_3] AS [LogProba_3], score_max.[Decision] AS [Decision], score_max.[DecisionProba] AS [DecisionProba], score_max.[KEY_m] AS [KEY_m], score_max.[max_Proba] AS [max_Proba], [arg_max_t_Proba].[KEY_Proba] AS [KEY_Proba], [arg_max_t_Proba].[arg_max_Proba] AS [arg_max_Proba] 
FROM score_max LEFT OUTER JOIN (SELECT union_with_max.[KEY] AS [KEY_Proba], min(union_with_max.class) AS [arg_max_Proba] 
FROM union_with_max 
WHERE union_with_max.[Proba] >= union_with_max.[max_Proba] GROUP BY union_with_max.[KEY]) AS [arg_max_t_Proba] ON score_max.[KEY] = [arg_max_t_Proba].[KEY_Proba])
 SELECT arg_max_cte.[KEY] AS [KEY], arg_max_cte.[Score_0] AS [Score_0], arg_max_cte.[Score_1] AS [Score_1], arg_max_cte.[Score_2] AS [Score_2], arg_max_cte.[Score_3] AS [Score_3], arg_max_cte.[Proba_0] AS [Proba_0], arg_max_cte.[Proba_1] AS [Proba_1], arg_max_cte.[Proba_2] AS [Proba_2], arg_max_cte.[Proba_3] AS [Proba_3], CASE WHEN (arg_max_cte.[Proba_0] IS NULL OR arg_max_cte.[Proba_0] > 0.0) THEN log(arg_max_cte.[Proba_0]) ELSE -1.79769313486231e+308 END AS [LogProba_0], CASE WHEN (arg_max_cte.[Proba_1] IS NULL OR arg_max_cte.[Proba_1] > 0.0) THEN log(arg_max_cte.[Proba_1]) ELSE -1.79769313486231e+308 END AS [LogProba_1], CASE WHEN (arg_max_cte.[Proba_2] IS NULL OR arg_max_cte.[Proba_2] > 0.0) THEN log(arg_max_cte.[Proba_2]) ELSE -1.79769313486231e+308 END AS [LogProba_2], CASE WHEN (arg_max_cte.[Proba_3] IS NULL OR arg_max_cte.[Proba_3] > 0.0) THEN log(arg_max_cte.[Proba_3]) ELSE -1.79769313486231e+308 END AS [LogProba_3], arg_max_cte.[arg_max_Proba] AS [Decision], arg_max_cte.[max_Proba] AS [DecisionProba] 
FROM arg_max_cte