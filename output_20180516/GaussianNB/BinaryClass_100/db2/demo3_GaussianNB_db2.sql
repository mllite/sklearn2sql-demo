-- This SQL code was generated by sklearn2sql (development version).
-- Copyright 2018

-- Model : GaussianNB
-- Dataset : BinaryClass_100
-- Database : db2


-- This SQL code can contain one or more statements, to be executed in the order they appear in this file.



-- Code For temporary table tmp_20180516110946_codegen_9cpdcj_naivebayes_scores part 1. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180516110946_codegen_9cpdcj_naivebayes_scores (
	"KEY" BIGINT, 
	"Score_0" DOUBLE, 
	"Score_1" DOUBLE
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180516110946_codegen_9cpdcj_naivebayes_scores part 2. Populate

INSERT INTO tmp_20180516110946_codegen_9cpdcj_naivebayes_scores WITH centered_data AS 
(SELECT "ADS"."KEY" AS "KEY", CAST("ADS"."Feature_0" AS DOUBLE) - 0.019794588624992563 AS "Feature_0_0", CAST("ADS"."Feature_1" AS DOUBLE) - 0.05387954877089766 AS "Feature_1_0", CAST("ADS"."Feature_2" AS DOUBLE) - 0.11488781572325525 AS "Feature_2_0", CAST("ADS"."Feature_3" AS DOUBLE) - -0.05949727299190275 AS "Feature_3_0", CAST("ADS"."Feature_4" AS DOUBLE) - 0.8930763647512598 AS "Feature_4_0", CAST("ADS"."Feature_5" AS DOUBLE) - 0.08949249059529617 AS "Feature_5_0", CAST("ADS"."Feature_6" AS DOUBLE) - -0.06522451547763095 AS "Feature_6_0", CAST("ADS"."Feature_7" AS DOUBLE) - -0.08791441649040836 AS "Feature_7_0", CAST("ADS"."Feature_8" AS DOUBLE) - 0.025350209804008636 AS "Feature_8_0", CAST("ADS"."Feature_9" AS DOUBLE) - 0.016900580854820914 AS "Feature_9_0", CAST("ADS"."Feature_10" AS DOUBLE) - 0.1875007620182646 AS "Feature_10_0", CAST("ADS"."Feature_11" AS DOUBLE) - -0.09483651079466747 AS "Feature_11_0", CAST("ADS"."Feature_12" AS DOUBLE) - -0.1785982020829447 AS "Feature_12_0", CAST("ADS"."Feature_13" AS DOUBLE) - -0.18191036873091165 AS "Feature_13_0", CAST("ADS"."Feature_14" AS DOUBLE) - -0.004347323688788593 AS "Feature_14_0", CAST("ADS"."Feature_15" AS DOUBLE) - 0.1283845183799563 AS "Feature_15_0", CAST("ADS"."Feature_16" AS DOUBLE) - -0.14735711589120865 AS "Feature_16_0", CAST("ADS"."Feature_17" AS DOUBLE) - -0.2276796172533036 AS "Feature_17_0", CAST("ADS"."Feature_18" AS DOUBLE) - 0.019408616103087622 AS "Feature_18_0", CAST("ADS"."Feature_19" AS DOUBLE) - -0.004980786663607562 AS "Feature_19_0", CAST("ADS"."Feature_20" AS DOUBLE) - -0.012853936651835691 AS "Feature_20_0", CAST("ADS"."Feature_21" AS DOUBLE) - 0.22277073351109422 AS "Feature_21_0", CAST("ADS"."Feature_22" AS DOUBLE) - 0.15328063742696757 AS "Feature_22_0", CAST("ADS"."Feature_23" AS DOUBLE) - 0.23265290530960525 AS "Feature_23_0", CAST("ADS"."Feature_24" AS DOUBLE) - 0.10114909320441352 AS "Feature_24_0", CAST("ADS"."Feature_25" AS DOUBLE) - 0.023392448730903966 AS "Feature_25_0", CAST("ADS"."Feature_26" AS DOUBLE) - 0.10891851470116136 AS "Feature_26_0", CAST("ADS"."Feature_27" AS DOUBLE) - -0.032262110915383495 AS "Feature_27_0", CAST("ADS"."Feature_28" AS DOUBLE) - -0.022204573180693993 AS "Feature_28_0", CAST("ADS"."Feature_29" AS DOUBLE) - 0.036693650734853304 AS "Feature_29_0", CAST("ADS"."Feature_30" AS DOUBLE) - 0.0316765321536491 AS "Feature_30_0", CAST("ADS"."Feature_31" AS DOUBLE) - 0.0015193616563879938 AS "Feature_31_0", CAST("ADS"."Feature_32" AS DOUBLE) - 0.10018871048433792 AS "Feature_32_0", CAST("ADS"."Feature_33" AS DOUBLE) - 0.39243511789808394 AS "Feature_33_0", CAST("ADS"."Feature_34" AS DOUBLE) - 0.32898340767368317 AS "Feature_34_0", CAST("ADS"."Feature_35" AS DOUBLE) - -0.021088501351309914 AS "Feature_35_0", CAST("ADS"."Feature_36" AS DOUBLE) - 0.07008004118550992 AS "Feature_36_0", CAST("ADS"."Feature_37" AS DOUBLE) - 0.282916623698697 AS "Feature_37_0", CAST("ADS"."Feature_38" AS DOUBLE) - 0.09888704165824835 AS "Feature_38_0", CAST("ADS"."Feature_39" AS DOUBLE) - 0.20870520227015488 AS "Feature_39_0", CAST("ADS"."Feature_40" AS DOUBLE) - -0.12590656007024434 AS "Feature_40_0", CAST("ADS"."Feature_41" AS DOUBLE) - 0.12909574543337726 AS "Feature_41_0", CAST("ADS"."Feature_42" AS DOUBLE) - -0.03923330293767345 AS "Feature_42_0", CAST("ADS"."Feature_43" AS DOUBLE) - 0.05987753646448564 AS "Feature_43_0", CAST("ADS"."Feature_44" AS DOUBLE) - 0.15335804412212967 AS "Feature_44_0", CAST("ADS"."Feature_45" AS DOUBLE) - -0.009250535507466956 AS "Feature_45_0", CAST("ADS"."Feature_46" AS DOUBLE) - -0.2990948797859349 AS "Feature_46_0", CAST("ADS"."Feature_47" AS DOUBLE) - 0.23739694973613715 AS "Feature_47_0", CAST("ADS"."Feature_48" AS DOUBLE) - 0.33709486949609224 AS "Feature_48_0", CAST("ADS"."Feature_49" AS DOUBLE) - 0.2271138706578479 AS "Feature_49_0", CAST("ADS"."Feature_50" AS DOUBLE) - -0.13205314511587624 AS "Feature_50_0", CAST("ADS"."Feature_51" AS DOUBLE) - -0.02533519451411991 AS "Feature_51_0", CAST("ADS"."Feature_52" AS DOUBLE) - 0.1856209425156102 AS "Feature_52_0", CAST("ADS"."Feature_53" AS DOUBLE) - -0.1671972903482089 AS "Feature_53_0", CAST("ADS"."Feature_54" AS DOUBLE) - 0.3113753089730967 AS "Feature_54_0", CAST("ADS"."Feature_55" AS DOUBLE) - 0.12226634355631164 AS "Feature_55_0", CAST("ADS"."Feature_56" AS DOUBLE) - -0.05067441188833494 AS "Feature_56_0", CAST("ADS"."Feature_57" AS DOUBLE) - -0.925345520617862 AS "Feature_57_0", CAST("ADS"."Feature_58" AS DOUBLE) - -0.10667841264574966 AS "Feature_58_0", CAST("ADS"."Feature_59" AS DOUBLE) - 0.06698266262837926 AS "Feature_59_0", CAST("ADS"."Feature_60" AS DOUBLE) - 0.18222738617493864 AS "Feature_60_0", CAST("ADS"."Feature_61" AS DOUBLE) - 0.05715696849665879 AS "Feature_61_0", CAST("ADS"."Feature_62" AS DOUBLE) - -0.08609982182153482 AS "Feature_62_0", CAST("ADS"."Feature_63" AS DOUBLE) - -0.1364691018600721 AS "Feature_63_0", CAST("ADS"."Feature_64" AS DOUBLE) - -0.12247573821464235 AS "Feature_64_0", CAST("ADS"."Feature_65" AS DOUBLE) - -0.10898598628278744 AS "Feature_65_0", CAST("ADS"."Feature_66" AS DOUBLE) - -0.05332547881563886 AS "Feature_66_0", CAST("ADS"."Feature_67" AS DOUBLE) - -0.4176360500803034 AS "Feature_67_0", CAST("ADS"."Feature_68" AS DOUBLE) - -0.14841543337174562 AS "Feature_68_0", CAST("ADS"."Feature_69" AS DOUBLE) - 0.24335263210713945 AS "Feature_69_0", CAST("ADS"."Feature_70" AS DOUBLE) - 0.08801496346012337 AS "Feature_70_0", CAST("ADS"."Feature_71" AS DOUBLE) - -0.0850578189049838 AS "Feature_71_0", CAST("ADS"."Feature_72" AS DOUBLE) - -0.26039944268284065 AS "Feature_72_0", CAST("ADS"."Feature_73" AS DOUBLE) - 0.21076983196756766 AS "Feature_73_0", CAST("ADS"."Feature_74" AS DOUBLE) - -0.1683610522305435 AS "Feature_74_0", CAST("ADS"."Feature_75" AS DOUBLE) - 0.23572070105917883 AS "Feature_75_0", CAST("ADS"."Feature_76" AS DOUBLE) - -0.225280368081331 AS "Feature_76_0", CAST("ADS"."Feature_77" AS DOUBLE) - 0.3555690513985725 AS "Feature_77_0", CAST("ADS"."Feature_78" AS DOUBLE) - 0.05993614873442727 AS "Feature_78_0", CAST("ADS"."Feature_79" AS DOUBLE) - 0.011891179985572629 AS "Feature_79_0", CAST("ADS"."Feature_80" AS DOUBLE) - -0.11975335939357816 AS "Feature_80_0", CAST("ADS"."Feature_81" AS DOUBLE) - -0.14552276964087024 AS "Feature_81_0", CAST("ADS"."Feature_82" AS DOUBLE) - -0.12203128386833016 AS "Feature_82_0", CAST("ADS"."Feature_83" AS DOUBLE) - 0.027295259208443383 AS "Feature_83_0", CAST("ADS"."Feature_84" AS DOUBLE) - 0.08450724374202644 AS "Feature_84_0", CAST("ADS"."Feature_85" AS DOUBLE) - 0.1287604240937586 AS "Feature_85_0", CAST("ADS"."Feature_86" AS DOUBLE) - 0.2644170368428714 AS "Feature_86_0", CAST("ADS"."Feature_87" AS DOUBLE) - -0.13581011579523133 AS "Feature_87_0", CAST("ADS"."Feature_88" AS DOUBLE) - -0.07088021173341379 AS "Feature_88_0", CAST("ADS"."Feature_89" AS DOUBLE) - 0.011337551441278565 AS "Feature_89_0", CAST("ADS"."Feature_90" AS DOUBLE) - 0.3297772655685176 AS "Feature_90_0", CAST("ADS"."Feature_91" AS DOUBLE) - 0.06124591095302724 AS "Feature_91_0", CAST("ADS"."Feature_92" AS DOUBLE) - -0.13281880506682206 AS "Feature_92_0", CAST("ADS"."Feature_93" AS DOUBLE) - 0.09816603559407577 AS "Feature_93_0", CAST("ADS"."Feature_94" AS DOUBLE) - -0.04432665508262422 AS "Feature_94_0", CAST("ADS"."Feature_95" AS DOUBLE) - 0.14573844053936702 AS "Feature_95_0", CAST("ADS"."Feature_96" AS DOUBLE) - 0.23318206686580054 AS "Feature_96_0", CAST("ADS"."Feature_97" AS DOUBLE) - 0.22297500914427748 AS "Feature_97_0", CAST("ADS"."Feature_98" AS DOUBLE) - -0.17572923813625282 AS "Feature_98_0", CAST("ADS"."Feature_99" AS DOUBLE) - 0.17277396476940649 AS "Feature_99_0", CAST("ADS"."Feature_0" AS DOUBLE) - 0.2918784198423757 AS "Feature_0_1", CAST("ADS"."Feature_1" AS DOUBLE) - -0.13044869060009245 AS "Feature_1_1", CAST("ADS"."Feature_2" AS DOUBLE) - 0.12424644273978813 AS "Feature_2_1", CAST("ADS"."Feature_3" AS DOUBLE) - -0.29990729048661824 AS "Feature_3_1", CAST("ADS"."Feature_4" AS DOUBLE) - -0.8495190243649432 AS "Feature_4_1", CAST("ADS"."Feature_5" AS DOUBLE) - 0.4139775617134418 AS "Feature_5_1", CAST("ADS"."Feature_6" AS DOUBLE) - -0.16722254418045204 AS "Feature_6_1", CAST("ADS"."Feature_7" AS DOUBLE) - -0.348651305493939 AS "Feature_7_1", CAST("ADS"."Feature_8" AS DOUBLE) - 0.21438092420793456 AS "Feature_8_1", CAST("ADS"."Feature_9" AS DOUBLE) - 0.04260867366275549 AS "Feature_9_1", CAST("ADS"."Feature_10" AS DOUBLE) - 0.025966300266437602 AS "Feature_10_1", CAST("ADS"."Feature_11" AS DOUBLE) - 0.1078888541255943 AS "Feature_11_1", CAST("ADS"."Feature_12" AS DOUBLE) - 0.03450553033015382 AS "Feature_12_1", CAST("ADS"."Feature_13" AS DOUBLE) - -0.03885125053631652 AS "Feature_13_1", CAST("ADS"."Feature_14" AS DOUBLE) - -0.2597767745554097 AS "Feature_14_1", CAST("ADS"."Feature_15" AS DOUBLE) - -0.2639954747143873 AS "Feature_15_1", CAST("ADS"."Feature_16" AS DOUBLE) - -0.13568453874079053 AS "Feature_16_1", CAST("ADS"."Feature_17" AS DOUBLE) - -0.014765536068403742 AS "Feature_17_1", CAST("ADS"."Feature_18" AS DOUBLE) - -0.18592002166169416 AS "Feature_18_1", CAST("ADS"."Feature_19" AS DOUBLE) - -0.15552097648806476 AS "Feature_19_1", CAST("ADS"."Feature_20" AS DOUBLE) - 0.1376651389913864 AS "Feature_20_1", CAST("ADS"."Feature_21" AS DOUBLE) - -0.01792476704799153 AS "Feature_21_1", CAST("ADS"."Feature_22" AS DOUBLE) - -0.04296076908571887 AS "Feature_22_1", CAST("ADS"."Feature_23" AS DOUBLE) - 0.06403144722485822 AS "Feature_23_1", CAST("ADS"."Feature_24" AS DOUBLE) - -0.2110032227585434 AS "Feature_24_1", CAST("ADS"."Feature_25" AS DOUBLE) - -0.14577685205182442 AS "Feature_25_1", CAST("ADS"."Feature_26" AS DOUBLE) - 0.08203078059226424 AS "Feature_26_1", CAST("ADS"."Feature_27" AS DOUBLE) - 0.2553177733223129 AS "Feature_27_1", CAST("ADS"."Feature_28" AS DOUBLE) - 0.09312539545152342 AS "Feature_28_1", CAST("ADS"."Feature_29" AS DOUBLE) - 0.08876819127972477 AS "Feature_29_1", CAST("ADS"."Feature_30" AS DOUBLE) - -0.06562232177125303 AS "Feature_30_1", CAST("ADS"."Feature_31" AS DOUBLE) - -0.23818036813429808 AS "Feature_31_1", CAST("ADS"."Feature_32" AS DOUBLE) - 0.13960794021186765 AS "Feature_32_1", CAST("ADS"."Feature_33" AS DOUBLE) - 0.04770117076065322 AS "Feature_33_1", CAST("ADS"."Feature_34" AS DOUBLE) - 0.13251689783270607 AS "Feature_34_1", CAST("ADS"."Feature_35" AS DOUBLE) - 0.1773498257033296 AS "Feature_35_1", CAST("ADS"."Feature_36" AS DOUBLE) - -0.14733919978334517 AS "Feature_36_1", CAST("ADS"."Feature_37" AS DOUBLE) - 0.2630792631072191 AS "Feature_37_1", CAST("ADS"."Feature_38" AS DOUBLE) - -0.1583268728690875 AS "Feature_38_1", CAST("ADS"."Feature_39" AS DOUBLE) - -0.1669091619603902 AS "Feature_39_1", CAST("ADS"."Feature_40" AS DOUBLE) - -0.08687856483048613 AS "Feature_40_1", CAST("ADS"."Feature_41" AS DOUBLE) - -0.08709961316765284 AS "Feature_41_1", CAST("ADS"."Feature_42" AS DOUBLE) - -0.1603662789617598 AS "Feature_42_1", CAST("ADS"."Feature_43" AS DOUBLE) - -0.05360307010712552 AS "Feature_43_1", CAST("ADS"."Feature_44" AS DOUBLE) - -0.09178043165694104 AS "Feature_44_1", CAST("ADS"."Feature_45" AS DOUBLE) - -0.29558030038383404 AS "Feature_45_1", CAST("ADS"."Feature_46" AS DOUBLE) - -0.0204797619456042 AS "Feature_46_1", CAST("ADS"."Feature_47" AS DOUBLE) - 0.2657079123053793 AS "Feature_47_1", CAST("ADS"."Feature_48" AS DOUBLE) - -0.06471752265867832 AS "Feature_48_1", CAST("ADS"."Feature_49" AS DOUBLE) - -0.036590464760650754 AS "Feature_49_1", CAST("ADS"."Feature_50" AS DOUBLE) - -0.13388991213688947 AS "Feature_50_1", CAST("ADS"."Feature_51" AS DOUBLE) - -0.06082276683268923 AS "Feature_51_1", CAST("ADS"."Feature_52" AS DOUBLE) - 0.11513534573920825 AS "Feature_52_1", CAST("ADS"."Feature_53" AS DOUBLE) - -0.14828451728456907 AS "Feature_53_1", CAST("ADS"."Feature_54" AS DOUBLE) - 0.03324330136186313 AS "Feature_54_1", CAST("ADS"."Feature_55" AS DOUBLE) - -0.028241048974077514 AS "Feature_55_1", CAST("ADS"."Feature_56" AS DOUBLE) - 0.030988452376955175 AS "Feature_56_1", CAST("ADS"."Feature_57" AS DOUBLE) - 0.9185662055430868 AS "Feature_57_1", CAST("ADS"."Feature_58" AS DOUBLE) - -0.1611814081806529 AS "Feature_58_1", CAST("ADS"."Feature_59" AS DOUBLE) - 0.17578207188470754 AS "Feature_59_1", CAST("ADS"."Feature_60" AS DOUBLE) - -0.3401635009350173 AS "Feature_60_1", CAST("ADS"."Feature_61" AS DOUBLE) - 0.2641648956340186 AS "Feature_61_1", CAST("ADS"."Feature_62" AS DOUBLE) - 0.08125074729541426 AS "Feature_62_1", CAST("ADS"."Feature_63" AS DOUBLE) - 0.1123588989296834 AS "Feature_63_1", CAST("ADS"."Feature_64" AS DOUBLE) - 0.07775462133477613 AS "Feature_64_1", CAST("ADS"."Feature_65" AS DOUBLE) - 0.15070293228453271 AS "Feature_65_1", CAST("ADS"."Feature_66" AS DOUBLE) - 0.17278142414267003 AS "Feature_66_1", CAST("ADS"."Feature_67" AS DOUBLE) - -0.02440801588858139 AS "Feature_67_1", CAST("ADS"."Feature_68" AS DOUBLE) - -0.34957302223912595 AS "Feature_68_1", CAST("ADS"."Feature_69" AS DOUBLE) - -0.13117783995716248 AS "Feature_69_1", CAST("ADS"."Feature_70" AS DOUBLE) - -0.007458258518597889 AS "Feature_70_1", CAST("ADS"."Feature_71" AS DOUBLE) - -0.2302943728627609 AS "Feature_71_1", CAST("ADS"."Feature_72" AS DOUBLE) - -0.18005378747106066 AS "Feature_72_1", CAST("ADS"."Feature_73" AS DOUBLE) - -0.088617946285696 AS "Feature_73_1", CAST("ADS"."Feature_74" AS DOUBLE) - -0.01685551249031646 AS "Feature_74_1", CAST("ADS"."Feature_75" AS DOUBLE) - 0.17625646572458276 AS "Feature_75_1", CAST("ADS"."Feature_76" AS DOUBLE) - -0.04459025353394924 AS "Feature_76_1", CAST("ADS"."Feature_77" AS DOUBLE) - -0.34677798570640783 AS "Feature_77_1", CAST("ADS"."Feature_78" AS DOUBLE) - 0.0818288258624968 AS "Feature_78_1", CAST("ADS"."Feature_79" AS DOUBLE) - 0.24080389982004605 AS "Feature_79_1", CAST("ADS"."Feature_80" AS DOUBLE) - 0.06127277102978808 AS "Feature_80_1", CAST("ADS"."Feature_81" AS DOUBLE) - -0.07207528225554026 AS "Feature_81_1", CAST("ADS"."Feature_82" AS DOUBLE) - 0.21964358835276468 AS "Feature_82_1", CAST("ADS"."Feature_83" AS DOUBLE) - 0.07008355273741211 AS "Feature_83_1", CAST("ADS"."Feature_84" AS DOUBLE) - 0.12332447579176042 AS "Feature_84_1", CAST("ADS"."Feature_85" AS DOUBLE) - -0.06772175112381663 AS "Feature_85_1", CAST("ADS"."Feature_86" AS DOUBLE) - 0.040648011813979056 AS "Feature_86_1", CAST("ADS"."Feature_87" AS DOUBLE) - -0.04717153943692447 AS "Feature_87_1", CAST("ADS"."Feature_88" AS DOUBLE) - -0.034336063518337935 AS "Feature_88_1", CAST("ADS"."Feature_89" AS DOUBLE) - -0.1319234439245708 AS "Feature_89_1", CAST("ADS"."Feature_90" AS DOUBLE) - -0.010069205119225254 AS "Feature_90_1", CAST("ADS"."Feature_91" AS DOUBLE) - -0.23642311812617484 AS "Feature_91_1", CAST("ADS"."Feature_92" AS DOUBLE) - 0.2885418734134063 AS "Feature_92_1", CAST("ADS"."Feature_93" AS DOUBLE) - -0.1272077589573801 AS "Feature_93_1", CAST("ADS"."Feature_94" AS DOUBLE) - 0.10393027249723849 AS "Feature_94_1", CAST("ADS"."Feature_95" AS DOUBLE) - -0.06770195636463489 AS "Feature_95_1", CAST("ADS"."Feature_96" AS DOUBLE) - -0.2011056358610035 AS "Feature_96_1", CAST("ADS"."Feature_97" AS DOUBLE) - 0.13740596966306318 AS "Feature_97_1", CAST("ADS"."Feature_98" AS DOUBLE) - -0.061194849702279876 AS "Feature_98_1", CAST("ADS"."Feature_99" AS DOUBLE) - -0.18165515574663463 AS "Feature_99_1" 
FROM "BINARYCLASS_100" AS "ADS"), 
"NaiveBayes_data" AS 
(SELECT "Values"."KEY" AS "KEY", CAST("Values"."Feature" AS DOUBLE) AS "Feature", CAST("Values".log_proba_0 AS DOUBLE) AS log_proba_0, CAST("Values".log_proba_1 AS DOUBLE) AS log_proba_1 
FROM (SELECT centered_data."KEY" AS "KEY", 0 AS "Feature", -0.5 * 1.6064753296731205 - (0.5 * centered_data."Feature_0_0" * centered_data."Feature_0_0") / 0.7934206557759292 AS log_proba_0, -0.5 * 1.414044163598418 - (0.5 * centered_data."Feature_0_1" * centered_data."Feature_0_1") / 0.654533243436735 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 1 AS "Feature", -0.5 * 1.7125257291396823 - (0.5 * centered_data."Feature_1_0" * centered_data."Feature_1_0") / 0.8821869029927489 AS log_proba_0, -0.5 * 1.7745405190116201 - (0.5 * centered_data."Feature_1_1" * centered_data."Feature_1_1") / 0.938627527874805 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 2 AS "Feature", -0.5 * 1.6857829248906053 - (0.5 * centered_data."Feature_2_0" * centered_data."Feature_2_0") / 0.8589074180861208 AS log_proba_0, -0.5 * 1.9418681102733855 - (0.5 * centered_data."Feature_2_1" * centered_data."Feature_2_1") / 1.1095905172275486 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 3 AS "Feature", -0.5 * 1.6463546443509645 - (0.5 * centered_data."Feature_3_0" * centered_data."Feature_3_0") / 0.8257011109804056 AS log_proba_0, -0.5 * 1.6876583016260747 - (0.5 * centered_data."Feature_3_1" * centered_data."Feature_3_1") / 0.8605197044255282 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 4 AS "Feature", -0.5 * 1.2478606324023125 - (0.5 * centered_data."Feature_4_0" * centered_data."Feature_4_0") / 0.5543181749908661 AS log_proba_0, -0.5 * 1.940836213733024 - (0.5 * centered_data."Feature_4_1" * centered_data."Feature_4_1") / 1.108446125160258 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 5 AS "Feature", -0.5 * 1.6373474462395425 - (0.5 * centered_data."Feature_5_0" * centered_data."Feature_5_0") / 0.8182972515632199 AS log_proba_0, -0.5 * 2.0764383448774684 - (0.5 * centered_data."Feature_5_1" * centered_data."Feature_5_1") / 1.269421491857508 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 6 AS "Feature", -0.5 * 1.6425410232950368 - (0.5 * centered_data."Feature_6_0" * centered_data."Feature_6_0") / 0.8225581965890518 AS log_proba_0, -0.5 * 1.5656158908094322 - (0.5 * centered_data."Feature_6_1" * centered_data."Feature_6_1") / 0.7616553093279548 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 7 AS "Feature", -0.5 * 1.7792459519694408 - (0.5 * centered_data."Feature_7_0" * centered_data."Feature_7_0") / 0.943054584219679 AS log_proba_0, -0.5 * 1.373268584716649 - (0.5 * centered_data."Feature_7_1" * centered_data."Feature_7_1") / 0.6283810797314088 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 8 AS "Feature", -0.5 * 2.0060300416699754 - (0.5 * centered_data."Feature_8_0" * centered_data."Feature_8_0") / 1.1831175845260433 AS log_proba_0, -0.5 * 1.7909018905908312 - (0.5 * centered_data."Feature_8_1" * centered_data."Feature_8_1") / 0.9541110823230581 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 9 AS "Feature", -0.5 * 1.2430270942119834 - (0.5 * centered_data."Feature_9_0" * centered_data."Feature_9_0") / 0.551645321795294 AS log_proba_0, -0.5 * 1.6181246335475434 - (0.5 * centered_data."Feature_9_1" * centered_data."Feature_9_1") / 0.8027174998396528 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 10 AS "Feature", -0.5 * 1.9154569897067082 - (0.5 * centered_data."Feature_10_0" * centered_data."Feature_10_0") / 1.0806685996049772 AS log_proba_0, -0.5 * 2.213923377838131 - (0.5 * centered_data."Feature_10_1" * centered_data."Feature_10_1") / 1.456514585480682 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 11 AS "Feature", -0.5 * 1.6761367913426353 - (0.5 * centered_data."Feature_11_0" * centered_data."Feature_11_0") / 0.8506621140119561 AS log_proba_0, -0.5 * 2.17116922025124 - (0.5 * centered_data."Feature_11_1" * centered_data."Feature_11_1") / 1.3955549556594677 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 12 AS "Feature", -0.5 * 1.6866336870574838 - (0.5 * centered_data."Feature_12_0" * centered_data."Feature_12_0") / 0.8596384549474384 AS log_proba_0, -0.5 * 1.725610774482394 - (0.5 * centered_data."Feature_12_1" * centered_data."Feature_12_1") / 0.8938062124283949 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 13 AS "Feature", -0.5 * 1.9936551532859998 - (0.5 * centered_data."Feature_13_0" * centered_data."Feature_13_0") / 1.1685668539940415 AS log_proba_0, -0.5 * 1.533948791924108 - (0.5 * centered_data."Feature_13_1" * centered_data."Feature_13_1") / 0.7379137917990867 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 14 AS "Feature", -0.5 * 1.9883031405068585 - (0.5 * centered_data."Feature_14_0" * centered_data."Feature_14_0") / 1.1623293756788855 AS log_proba_0, -0.5 * 1.9240672775731715 - (0.5 * centered_data."Feature_14_1" * centered_data."Feature_14_1") / 1.0900136413511834 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 15 AS "Feature", -0.5 * 1.3696453084050753 - (0.5 * centered_data."Feature_15_0" * centered_data."Feature_15_0") / 0.6261084012080401 AS log_proba_0, -0.5 * 1.9829847024175986 - (0.5 * centered_data."Feature_15_1" * centered_data."Feature_15_1") / 1.1561640084496423 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 16 AS "Feature", -0.5 * 1.8591734958429065 - (0.5 * centered_data."Feature_16_0" * centered_data."Feature_16_0") / 1.021524816783869 AS log_proba_0, -0.5 * 1.5261572272736654 - (0.5 * centered_data."Feature_16_1" * centered_data."Feature_16_1") / 0.7321866295352656 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 17 AS "Feature", -0.5 * 1.7915319770706803 - (0.5 * centered_data."Feature_17_0" * centered_data."Feature_17_0") / 0.9547124442514188 AS log_proba_0, -0.5 * 2.016400739425058 - (0.5 * centered_data."Feature_17_1" * centered_data."Feature_17_1") / 1.1954511828731447 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 18 AS "Feature", -0.5 * 2.4315248968223777 - (0.5 * centered_data."Feature_18_0" * centered_data."Feature_18_0") / 1.8105810763483352 AS log_proba_0, -0.5 * 2.34356488760136 - (0.5 * centered_data."Feature_18_1" * centered_data."Feature_18_1") / 1.6581256222648277 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 19 AS "Feature", -0.5 * 1.5351296998892046 - (0.5 * centered_data."Feature_19_0" * centered_data."Feature_19_0") / 0.7387857148024587 AS log_proba_0, -0.5 * 1.9028517058743104 - (0.5 * centered_data."Feature_19_1" * centered_data."Feature_19_1") / 1.0671319610035392 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 20 AS "Feature", -0.5 * 1.7764010527509912 - (0.5 * centered_data."Feature_20_0" * centered_data."Feature_20_0") / 0.9403755016369684 AS log_proba_0, -0.5 * 1.6919342489417084 - (0.5 * centered_data."Feature_20_1" * centered_data."Feature_20_1") / 0.8642071193233284 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 21 AS "Feature", -0.5 * 2.106030568703799 - (0.5 * centered_data."Feature_21_0" * centered_data."Feature_21_0") / 1.307547836203844 AS log_proba_0, -0.5 * 2.315015289815111 - (0.5 * centered_data."Feature_21_1" * centered_data."Feature_21_1") / 1.6114561696209497 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 22 AS "Feature", -0.5 * 1.924432491534165 - (0.5 * centered_data."Feature_22_0" * centered_data."Feature_22_0") / 1.0904118022532128 AS log_proba_0, -0.5 * 1.2458311929660435 - (0.5 * centered_data."Feature_22_1" * centered_data."Feature_22_1") / 0.5531943605686669 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 23 AS "Feature", -0.5 * 1.774636389414633 - (0.5 * centered_data."Feature_23_0" * centered_data."Feature_23_0") / 0.9387175187878449 AS log_proba_0, -0.5 * 1.574196410586886 - (0.5 * centered_data."Feature_23_1" * centered_data."Feature_23_1") / 0.7682188266985105 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 24 AS "Feature", -0.5 * 1.3255587162120526 - (0.5 * centered_data."Feature_24_0" * centered_data."Feature_24_0") / 0.5991050322783882 AS log_proba_0, -0.5 * 1.2253547978858106 - (0.5 * centered_data."Feature_24_1" * centered_data."Feature_24_1") / 0.5419821191832286 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 25 AS "Feature", -0.5 * 1.6422548768220113 - (0.5 * centered_data."Feature_25_0" * centered_data."Feature_25_0") / 0.8223228581344799 AS log_proba_0, -0.5 * 1.4119364419455058 - (0.5 * centered_data."Feature_25_1" * centered_data."Feature_25_1") / 0.6531551224049529 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 26 AS "Feature", -0.5 * 1.7072868885589323 - (0.5 * centered_data."Feature_26_0" * centered_data."Feature_26_0") / 0.8775773513412668 AS log_proba_0, -0.5 * 1.8458185334751955 - (0.5 * centered_data."Feature_26_1" * centered_data."Feature_26_1") / 1.0079730841553693 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 27 AS "Feature", -0.5 * 1.940207243070877 - (0.5 * centered_data."Feature_27_0" * centered_data."Feature_27_0") / 1.1077491642739135 AS log_proba_0, -0.5 * 2.0752434531310624 - (0.5 * centered_data."Feature_27_1" * centered_data."Feature_27_1") / 1.2679055764519447 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 28 AS "Feature", -0.5 * 1.8514673726622903 - (0.5 * centered_data."Feature_28_0" * centered_data."Feature_28_0") / 1.0136830742370346 AS log_proba_0, -0.5 * 1.5458452568419625 - (0.5 * centered_data."Feature_28_1" * centered_data."Feature_28_1") / 0.7467447819670968 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 29 AS "Feature", -0.5 * 1.8063027379560272 - (0.5 * centered_data."Feature_29_0" * centered_data."Feature_29_0") / 0.9689189355313023 AS log_proba_0, -0.5 * 2.2791752586682423 - (0.5 * centered_data."Feature_29_1" * centered_data."Feature_29_1") / 1.5547242399602823 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 30 AS "Feature", -0.5 * 1.9677772693314057 - (0.5 * centered_data."Feature_30_0" * centered_data."Feature_30_0") / 1.1387147372505586 AS log_proba_0, -0.5 * 1.924021487647832 - (0.5 * centered_data."Feature_30_1" * centered_data."Feature_30_1") / 1.0899637308506347 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 31 AS "Feature", -0.5 * 1.6602227381344976 - (0.5 * centered_data."Feature_31_0" * centered_data."Feature_31_0") / 0.8372317808285927 AS log_proba_0, -0.5 * 1.8967671911703456 - (0.5 * centered_data."Feature_31_1" * centered_data."Feature_31_1") / 1.0606586942099638 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 32 AS "Feature", -0.5 * 1.8723405353429783 - (0.5 * centered_data."Feature_32_0" * centered_data."Feature_32_0") / 1.035064215685892 AS log_proba_0, -0.5 * 1.8250730734620055 - (0.5 * centered_data."Feature_32_1" * centered_data."Feature_32_1") / 0.987277629434836 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 33 AS "Feature", -0.5 * 2.1200782248300287 - (0.5 * centered_data."Feature_33_0" * centered_data."Feature_33_0") / 1.3260454383657048 AS log_proba_0, -0.5 * 1.2792430635682037 - (0.5 * centered_data."Feature_33_1" * centered_data."Feature_33_1") / 0.5719898669731597 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 34 AS "Feature", -0.5 * 1.8121961066145151 - (0.5 * centered_data."Feature_34_0" * centered_data."Feature_34_0") / 0.9746459912680695 AS log_proba_0, -0.5 * 1.2707008048314015 - (0.5 * centered_data."Feature_34_1" * centered_data."Feature_34_1") / 0.5671245913412516 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 35 AS "Feature", -0.5 * 0.7484729054781968 - (0.5 * centered_data."Feature_35_0" * centered_data."Feature_35_0") / 0.33641688432362665 AS log_proba_0, -0.5 * 1.9520075957815144 - (0.5 * centered_data."Feature_35_1" * centered_data."Feature_35_1") / 1.1208984255034273 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 36 AS "Feature", -0.5 * 1.7294345641212958 - (0.5 * centered_data."Feature_36_0" * centered_data."Feature_36_0") / 0.8972304820336925 AS log_proba_0, -0.5 * 1.676244667766513 - (0.5 * centered_data."Feature_36_1" * centered_data."Feature_36_1") / 0.8507538853486368 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 37 AS "Feature", -0.5 * 1.5873140197657747 - (0.5 * centered_data."Feature_37_0" * centered_data."Feature_37_0") / 0.7783624053296255 AS log_proba_0, -0.5 * 1.596668619205151 - (0.5 * centered_data."Feature_37_1" * centered_data."Feature_37_1") / 0.7856778369697014 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 38 AS "Feature", -0.5 * 1.988239452786206 - (0.5 * centered_data."Feature_38_0" * centered_data."Feature_38_0") / 1.162255351927528 AS log_proba_0, -0.5 * 1.5686182084639182 - (0.5 * centered_data."Feature_38_1" * centered_data."Feature_38_1") / 0.763945476694461 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 39 AS "Feature", -0.5 * 1.9272806063688106 - (0.5 * centered_data."Feature_39_0" * centered_data."Feature_39_0") / 1.0935218470631352 AS log_proba_0, -0.5 * 1.825765624511555 - (0.5 * centered_data."Feature_39_1" * centered_data."Feature_39_1") / 0.9879616064104461 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 40 AS "Feature", -0.5 * 1.9525697492138667 - (0.5 * centered_data."Feature_40_0" * centered_data."Feature_40_0") / 1.1215287195450232 AS log_proba_0, -0.5 * 1.607151606003442 - (0.5 * centered_data."Feature_40_1" * centered_data."Feature_40_1") / 0.7939574088616652 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 41 AS "Feature", -0.5 * 1.6400802293548014 - (0.5 * centered_data."Feature_41_0" * centered_data."Feature_41_0") / 0.820536538825162 AS log_proba_0, -0.5 * 2.1341634797803843 - (0.5 * centered_data."Feature_41_1" * centered_data."Feature_41_1") / 1.3448552862124012 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 42 AS "Feature", -0.5 * 2.110474659493097 - (0.5 * centered_data."Feature_42_0" * centered_data."Feature_42_0") / 1.313371628645498 AS log_proba_0, -0.5 * 1.4107093048845962 - (0.5 * centered_data."Feature_42_1" * centered_data."Feature_42_1") / 0.6523541031284661 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 43 AS "Feature", -0.5 * 1.5848958983841959 - (0.5 * centered_data."Feature_43_0" * centered_data."Feature_43_0") / 0.776482504385046 AS log_proba_0, -0.5 * 1.747859235128209 - (0.5 * centered_data."Feature_43_1" * centered_data."Feature_43_1") / 0.9139148888526177 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 44 AS "Feature", -0.5 * 1.976760850067344 - (0.5 * centered_data."Feature_44_0" * centered_data."Feature_44_0") / 1.1489905607640682 AS log_proba_0, -0.5 * 1.9401864776434739 - (0.5 * centered_data."Feature_44_1" * centered_data."Feature_44_1") / 1.1077261616278926 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 45 AS "Feature", -0.5 * 2.0948839029028514 - (0.5 * centered_data."Feature_45_0" * centered_data."Feature_45_0") / 1.2930539666841827 AS log_proba_0, -0.5 * 1.395317330481836 - (0.5 * centered_data."Feature_45_1" * centered_data."Feature_45_1") / 0.6423899660615046 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 46 AS "Feature", -0.5 * 1.81891240553783 - (0.5 * centered_data."Feature_46_0" * centered_data."Feature_46_0") / 0.9812140368790367 AS log_proba_0, -0.5 * 1.9268551090780797 - (0.5 * centered_data."Feature_46_1" * centered_data."Feature_46_1") / 1.0930566554557575 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 47 AS "Feature", -0.5 * 1.9306080231128349 - (0.5 * centered_data."Feature_47_0" * centered_data."Feature_47_0") / 1.0971665102609667 AS log_proba_0, -0.5 * 1.8044159927858137 - (0.5 * centered_data."Feature_47_1" * centered_data."Feature_47_1") / 0.9670925559076236 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 48 AS "Feature", -0.5 * 1.8261970395063323 - (0.5 * centered_data."Feature_48_0" * centered_data."Feature_48_0") / 0.9883879198141011 AS log_proba_0, -0.5 * 1.5127183621533895 - (0.5 * centered_data."Feature_48_1" * centered_data."Feature_48_1") / 0.7224126945746864 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 49 AS "Feature", -0.5 * 2.2396593039814876 - (0.5 * centered_data."Feature_49_0" * centered_data."Feature_49_0") / 1.4944858543708086 AS log_proba_0, -0.5 * 1.5934743927533543 - (0.5 * centered_data."Feature_49_1" * centered_data."Feature_49_1") / 0.7831722079439467 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 50 AS "Feature", -0.5 * 2.261192981795136 - (0.5 * centered_data."Feature_50_0" * centered_data."Feature_50_0") / 1.5270166278215054 AS log_proba_0, -0.5 * 2.144785627788439 - (0.5 * centered_data."Feature_50_1" * centered_data."Feature_50_1") / 1.3592166774910852 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 51 AS "Feature", -0.5 * 2.128859963930122 - (0.5 * centered_data."Feature_51_0" * centered_data."Feature_51_0") / 1.3377417050546758 AS log_proba_0, -0.5 * 1.8555081783000464 - (0.5 * centered_data."Feature_51_1" * centered_data."Feature_51_1") / 1.0177874574409709 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 52 AS "Feature", -0.5 * 1.7972903483148517 - (0.5 * centered_data."Feature_52_0" * centered_data."Feature_52_0") / 0.9602258919412131 AS log_proba_0, -0.5 * 2.0150889945535537 - (0.5 * centered_data."Feature_52_1" * centered_data."Feature_52_1") / 1.1938840839565663 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 53 AS "Feature", -0.5 * 1.3842637172275094 - (0.5 * centered_data."Feature_53_0" * centered_data."Feature_53_0") / 0.6353283359825292 AS log_proba_0, -0.5 * 1.4659599650801864 - (0.5 * centered_data."Feature_53_1" * centered_data."Feature_53_1") / 0.6894113914434182 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 54 AS "Feature", -0.5 * 2.1929590478716836 - (0.5 * centered_data."Feature_54_0" * centered_data."Feature_54_0") / 1.426297579449859 AS log_proba_0, -0.5 * 1.6089343081687273 - (0.5 * centered_data."Feature_54_1" * centered_data."Feature_54_1") / 0.7953740608126575 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 55 AS "Feature", -0.5 * 1.8672938123964677 - (0.5 * centered_data."Feature_55_0" * centered_data."Feature_55_0") / 1.0298536924501425 AS log_proba_0, -0.5 * 1.8149175468531193 - (0.5 * centered_data."Feature_55_1" * centered_data."Feature_55_1") / 0.9773020445930182 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 56 AS "Feature", -0.5 * 1.7127836277525608 - (0.5 * centered_data."Feature_56_0" * centered_data."Feature_56_0") / 0.8824144471117256 AS log_proba_0, -0.5 * 1.836411271635068 - (0.5 * centered_data."Feature_56_1" * centered_data."Feature_56_1") / 0.9985352789781851 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 57 AS "Feature", -0.5 * 0.7742792892363299 - (0.5 * centered_data."Feature_57_0" * centered_data."Feature_57_0") / 0.3452115790996632 AS log_proba_0, -0.5 * 2.004192030057853 - (0.5 * centered_data."Feature_57_1" * centered_data."Feature_57_1") / 1.1809449978985382 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 58 AS "Feature", -0.5 * 1.6249673249372794 - (0.5 * centered_data."Feature_58_0" * centered_data."Feature_58_0") / 0.8082290834917365 AS log_proba_0, -0.5 * 1.4719823480371192 - (0.5 * centered_data."Feature_58_1" * centered_data."Feature_58_1") / 0.6935758181571369 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 59 AS "Feature", -0.5 * 2.239013442071603 - (0.5 * centered_data."Feature_59_0" * centered_data."Feature_59_0") / 1.4935209345186402 AS log_proba_0, -0.5 * 1.5130808245262783 - (0.5 * centered_data."Feature_59_1" * centered_data."Feature_59_1") / 0.7226745894548193 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 60 AS "Feature", -0.5 * 1.6081650991899892 - (0.5 * centered_data."Feature_60_0" * centered_data."Feature_60_0") / 0.7947624871877417 AS log_proba_0, -0.5 * 2.0718187077918597 - (0.5 * centered_data."Feature_60_1" * centered_data."Feature_60_1") / 1.263570749813992 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 61 AS "Feature", -0.5 * 1.5510614739424824 - (0.5 * centered_data."Feature_61_0" * centered_data."Feature_61_0") / 0.7506501416153605 AS log_proba_0, -0.5 * 1.6550279275742619 - (0.5 * centered_data."Feature_61_1" * centered_data."Feature_61_1") / 0.8328937975881704 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 62 AS "Feature", -0.5 * 1.6413513566718088 - (0.5 * centered_data."Feature_62_0" * centered_data."Feature_62_0") / 0.8215802084121995 AS log_proba_0, -0.5 * 1.67069085873404 - (0.5 * centered_data."Feature_62_1" * centered_data."Feature_62_1") / 0.8460420571440721 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 63 AS "Feature", -0.5 * 1.6178994921917618 - (0.5 * centered_data."Feature_63_0" * centered_data."Feature_63_0") / 0.8025367952762278 AS log_proba_0, -0.5 * 2.134749742102307 - (0.5 * centered_data."Feature_63_1" * centered_data."Feature_63_1") / 1.3456439553560589 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 64 AS "Feature", -0.5 * 1.6767857431036326 - (0.5 * centered_data."Feature_64_0" * centered_data."Feature_64_0") / 0.8512143318508475 AS log_proba_0, -0.5 * 1.4768893541557802 - (0.5 * centered_data."Feature_64_1" * centered_data."Feature_64_1") / 0.6969875628206943 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 65 AS "Feature", -0.5 * 1.7759744422183603 - (0.5 * centered_data."Feature_65_0" * centered_data."Feature_65_0") / 0.9399744131037215 AS log_proba_0, -0.5 * 1.4837071329509548 - (0.5 * centered_data."Feature_65_1" * centered_data."Feature_65_1") / 0.7017557054484146 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 66 AS "Feature", -0.5 * 1.6430998014906433 - (0.5 * centered_data."Feature_66_0" * centered_data."Feature_66_0") / 0.8230179526127814 AS log_proba_0, -0.5 * 1.71315179280007 - (0.5 * centered_data."Feature_66_1" * centered_data."Feature_66_1") / 0.8827393810795638 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 67 AS "Feature", -0.5 * 1.4670429430850296 - (0.5 * centered_data."Feature_67_0" * centered_data."Feature_67_0") / 0.6901584132477199 AS log_proba_0, -0.5 * 1.869804053383361 - (0.5 * centered_data."Feature_67_1" * centered_data."Feature_67_1") / 1.032442120829732 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 68 AS "Feature", -0.5 * 1.9391682684893647 - (0.5 * centered_data."Feature_68_0" * centered_data."Feature_68_0") / 1.1065988387325187 AS log_proba_0, -0.5 * 1.8949563829026836 - (0.5 * centered_data."Feature_68_1" * centered_data."Feature_68_1") / 1.058739782592179 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 69 AS "Feature", -0.5 * 1.6446311366376236 - (0.5 * centered_data."Feature_69_0" * centered_data."Feature_69_0") / 0.8242792344063093 AS log_proba_0, -0.5 * 1.4930698657389354 - (0.5 * centered_data."Feature_69_1" * centered_data."Feature_69_1") / 0.7083569110408316 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 70 AS "Feature", -0.5 * 1.6575081037015602 - (0.5 * centered_data."Feature_70_0" * centered_data."Feature_70_0") / 0.8349620846994658 AS log_proba_0, -0.5 * 1.5035470475803994 - (0.5 * centered_data."Feature_70_1" * centered_data."Feature_70_1") / 0.7158175099858239 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 71 AS "Feature", -0.5 * 1.6434248639150524 - (0.5 * centered_data."Feature_71_0" * centered_data."Feature_71_0") / 0.8232855283108365 AS log_proba_0, -0.5 * 1.9598948158129526 - (0.5 * centered_data."Feature_71_1" * centered_data."Feature_71_1") / 1.1297741544198086 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 72 AS "Feature", -0.5 * 1.861765893446783 - (0.5 * centered_data."Feature_72_0" * centered_data."Feature_72_0") / 1.024176450831044 AS log_proba_0, -0.5 * 1.589194729342999 - (0.5 * centered_data."Feature_72_1" * centered_data."Feature_72_1") / 0.7798276563838347 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 73 AS "Feature", -0.5 * 1.8058146759301592 - (0.5 * centered_data."Feature_73_0" * centered_data."Feature_73_0") / 0.9684461583743982 AS log_proba_0, -0.5 * 1.6115468979799206 - (0.5 * centered_data."Feature_73_1" * centered_data."Feature_73_1") / 0.7974547638082391 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 74 AS "Feature", -0.5 * 1.8927709802147954 - (0.5 * centered_data."Feature_74_0" * centered_data."Feature_74_0") / 1.0564285362473878 AS log_proba_0, -0.5 * 1.9142397719304987 - (0.5 * centered_data."Feature_74_1" * centered_data."Feature_74_1") / 1.0793539908202496 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 75 AS "Feature", -0.5 * 2.0532127615744207 - (0.5 * centered_data."Feature_75_0" * centered_data."Feature_75_0") / 1.2402781824788423 AS log_proba_0, -0.5 * 1.8356040705186558 - (0.5 * centered_data."Feature_75_1" * centered_data."Feature_75_1") / 0.9977295854083389 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 76 AS "Feature", -0.5 * 1.924258708590989 - (0.5 * centered_data."Feature_76_0" * centered_data."Feature_76_0") / 1.0902223237454864 AS log_proba_0, -0.5 * 1.8160231230949424 - (0.5 * centered_data."Feature_76_1" * centered_data."Feature_76_1") / 0.9783831240123493 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 77 AS "Feature", -0.5 * -0.9269885286486925 - (0.5 * centered_data."Feature_77_0" * centered_data."Feature_77_0") / 0.06298456421584024 AS log_proba_0, -0.5 * 0.07637542799729208 - (0.5 * centered_data."Feature_77_1" * centered_data."Feature_77_1") / 0.17178670852340439 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 78 AS "Feature", -0.5 * 1.8694143951843423 - (0.5 * centered_data."Feature_78_0" * centered_data."Feature_78_0") / 1.0320398996618156 AS log_proba_0, -0.5 * 1.7946789080767689 - (0.5 * centered_data."Feature_78_1" * centered_data."Feature_78_1") / 0.9577215907489983 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 79 AS "Feature", -0.5 * 2.098751037306087 - (0.5 * centered_data."Feature_79_0" * centered_data."Feature_79_0") / 1.2980640612748493 AS log_proba_0, -0.5 * 1.676877227463313 - (0.5 * centered_data."Feature_79_1" * centered_data."Feature_79_1") / 0.8512922082111278 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 80 AS "Feature", -0.5 * 1.670685726060565 - (0.5 * centered_data."Feature_80_0" * centered_data."Feature_80_0") / 0.8460377146975909 AS log_proba_0, -0.5 * 2.0234949837340195 - (0.5 * centered_data."Feature_80_1" * centered_data."Feature_80_1") / 1.2039621594020657 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 81 AS "Feature", -0.5 * 1.574787725974009 - (0.5 * centered_data."Feature_81_0" * centered_data."Feature_81_0") / 0.7686732206432407 AS log_proba_0, -0.5 * 1.4289011037991581 - (0.5 * centered_data."Feature_81_1" * centered_data."Feature_81_1") / 0.664330200894298 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 82 AS "Feature", -0.5 * 1.4822726888067308 - (0.5 * centered_data."Feature_82_0" * centered_data."Feature_82_0") / 0.7007497977177675 AS log_proba_0, -0.5 * 1.8143764356642489 - (0.5 * centered_data."Feature_82_1" * centered_data."Feature_82_1") / 0.976773358573643 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 83 AS "Feature", -0.5 * 1.977943828534967 - (0.5 * centered_data."Feature_83_0" * centered_data."Feature_83_0") / 1.1503505961446323 AS log_proba_0, -0.5 * 1.7398518323042 - (0.5 * centered_data."Feature_83_1" * centered_data."Feature_83_1") / 0.9066260255688101 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 84 AS "Feature", -0.5 * 1.6896143099270264 - (0.5 * centered_data."Feature_84_0" * centered_data."Feature_84_0") / 0.8622045353449733 AS log_proba_0, -0.5 * 1.7237418421863744 - (0.5 * centered_data."Feature_84_1" * centered_data."Feature_84_1") / 0.8921373091509984 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 85 AS "Feature", -0.5 * 1.6052281293598958 - (0.5 * centered_data."Feature_85_0" * centered_data."Feature_85_0") / 0.7924317181153981 AS log_proba_0, -0.5 * 1.9440483078590083 - (0.5 * centered_data."Feature_85_1" * centered_data."Feature_85_1") / 1.11201228279869 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 86 AS "Feature", -0.5 * 2.1464179358729587 - (0.5 * centered_data."Feature_86_0" * centered_data."Feature_86_0") / 1.361437149616644 AS log_proba_0, -0.5 * 1.3303365240942655 - (0.5 * centered_data."Feature_86_1" * centered_data."Feature_86_1") / 0.6019742899466828 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 87 AS "Feature", -0.5 * 1.7397115949520021 - (0.5 * centered_data."Feature_87_0" * centered_data."Feature_87_0") / 0.906498891650221 AS log_proba_0, -0.5 * 1.7353366594106285 - (0.5 * centered_data."Feature_87_1" * centered_data."Feature_87_1") / 0.902541680015608 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 88 AS "Feature", -0.5 * 1.5550499725329656 - (0.5 * centered_data."Feature_88_0" * centered_data."Feature_88_0") / 0.7536500873097689 AS log_proba_0, -0.5 * 2.1855200318137125 - (0.5 * centered_data."Feature_88_1" * centered_data."Feature_88_1") / 1.4157266960868575 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 89 AS "Feature", -0.5 * 1.7071260669436843 - (0.5 * centered_data."Feature_89_0" * centered_data."Feature_89_0") / 0.877436229282162 AS log_proba_0, -0.5 * 2.242209305533025 - (0.5 * centered_data."Feature_89_1" * centered_data."Feature_89_1") / 1.4983016587039992 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 90 AS "Feature", -0.5 * 1.4263987843660473 - (0.5 * centered_data."Feature_90_0" * centered_data."Feature_90_0") / 0.6626699126746745 AS log_proba_0, -0.5 * 1.4110208850171906 - (0.5 * centered_data."Feature_90_1" * centered_data."Feature_90_1") / 0.6525573953756854 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 91 AS "Feature", -0.5 * 2.0434963425126287 - (0.5 * centered_data."Feature_91_0" * centered_data."Feature_91_0") / 1.2282854773303926 AS log_proba_0, -0.5 * 1.845957374995078 - (0.5 * centered_data."Feature_91_1" * centered_data."Feature_91_1") / 1.0081130423861562 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 92 AS "Feature", -0.5 * 1.9866585233945537 - (0.5 * centered_data."Feature_92_0" * centered_data."Feature_92_0") / 1.1604193599502974 AS log_proba_0, -0.5 * 2.2635998277147507 - (0.5 * centered_data."Feature_92_1" * centered_data."Feature_92_1") / 1.5306963480448068 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 93 AS "Feature", -0.5 * 1.912510605060215 - (0.5 * centered_data."Feature_93_0" * centered_data."Feature_93_0") / 1.0774892203722959 AS log_proba_0, -0.5 * 2.032911066462909 - (0.5 * centered_data."Feature_93_1" * centered_data."Feature_93_1") / 1.2153523078308275 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 94 AS "Feature", -0.5 * 1.8699905669315955 - (0.5 * centered_data."Feature_94_0" * centered_data."Feature_94_0") / 1.03263470323209 AS log_proba_0, -0.5 * 2.1961359131272435 - (0.5 * centered_data."Feature_94_1" * centered_data."Feature_94_1") / 1.4308359397367199 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 95 AS "Feature", -0.5 * 1.4775584172811733 - (0.5 * centered_data."Feature_95_0" * centered_data."Feature_95_0") / 0.6974540475342939 AS log_proba_0, -0.5 * 1.6851322350143976 - (0.5 * centered_data."Feature_95_1" * centered_data."Feature_95_1") / 0.858348717514688 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 96 AS "Feature", -0.5 * 1.8287853336071527 - (0.5 * centered_data."Feature_96_0" * centered_data."Feature_96_0") / 0.9909494720314814 AS log_proba_0, -0.5 * 1.7879490883357045 - (0.5 * centered_data."Feature_96_1" * centered_data."Feature_96_1") / 0.9512979363434239 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 97 AS "Feature", -0.5 * 1.8698998466200145 - (0.5 * centered_data."Feature_97_0" * centered_data."Feature_97_0") / 1.0325410265393171 AS log_proba_0, -0.5 * 1.5836746048090067 - (0.5 * centered_data."Feature_97_1" * centered_data."Feature_97_1") / 0.775534770139866 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 98 AS "Feature", -0.5 * 1.6837241410520722 - (0.5 * centered_data."Feature_98_0" * centered_data."Feature_98_0") / 0.8571409324050053 AS log_proba_0, -0.5 * 1.675962566257813 - (0.5 * centered_data."Feature_98_1" * centered_data."Feature_98_1") / 0.8505139202428982 AS log_proba_1 
FROM centered_data UNION ALL SELECT centered_data."KEY" AS "KEY", 99 AS "Feature", -0.5 * 1.7429112070598596 - (0.5 * centered_data."Feature_99_0" * centered_data."Feature_99_0") / 0.9094039815817555 AS log_proba_0, -0.5 * 1.5869129483175304 - (0.5 * centered_data."Feature_99_1" * centered_data."Feature_99_1") / 0.7780502889871217 AS log_proba_1 
FROM centered_data) AS "Values")
 SELECT "NaiveBayes_Scores"."KEY", "NaiveBayes_Scores"."Score_0", "NaiveBayes_Scores"."Score_1" 
FROM (SELECT nb_sums."KEY" AS "KEY", nb_sums."Score_0" AS "Score_0", nb_sums."Score_1" AS "Score_1" 
FROM (SELECT "NaiveBayes_data"."KEY" AS "KEY", -0.6443570163905132 + sum("NaiveBayes_data".log_proba_0) AS "Score_0", -0.7444404749474959 + sum("NaiveBayes_data".log_proba_1) AS "Score_1" 
FROM "NaiveBayes_data" GROUP BY "NaiveBayes_data"."KEY") AS nb_sums) AS "NaiveBayes_Scores"

-- Model deployment code

WITH orig_cte AS 
(SELECT "NaiveBayes_Scores"."KEY" AS "KEY", "NaiveBayes_Scores"."Score_0" AS "Score_0", "NaiveBayes_Scores"."Score_1" AS "Score_1", CAST(NULL AS DOUBLE) AS "Proba_0", CAST(NULL AS DOUBLE) AS "Proba_1", CAST(NULL AS DOUBLE) AS "LogProba_0", CAST(NULL AS DOUBLE) AS "LogProba_1", NULL AS "Decision", CAST(NULL AS DOUBLE) AS "DecisionProba" 
FROM tmp_20180516110946_codegen_9cpdcj_naivebayes_scores AS "NaiveBayes_Scores"), 
score_class_union AS 
(SELECT scu."KEY_u" AS "KEY_u", scu.class AS class, scu."LogProba" AS "LogProba", scu."Proba" AS "Proba", scu."Score" AS "Score" 
FROM (SELECT orig_cte."KEY" AS "KEY_u", 0 AS class, orig_cte."LogProba_0" AS "LogProba", orig_cte."Proba_0" AS "Proba", orig_cte."Score_0" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY_u", 1 AS class, orig_cte."LogProba_1" AS "LogProba", orig_cte."Proba_1" AS "Proba", orig_cte."Score_1" AS "Score" 
FROM orig_cte) AS scu), 
score_max AS 
(SELECT orig_cte."KEY" AS "KEY", orig_cte."Score_0" AS "Score_0", orig_cte."Score_1" AS "Score_1", orig_cte."Proba_0" AS "Proba_0", orig_cte."Proba_1" AS "Proba_1", orig_cte."LogProba_0" AS "LogProba_0", orig_cte."LogProba_1" AS "LogProba_1", orig_cte."Decision" AS "Decision", orig_cte."DecisionProba" AS "DecisionProba", max_select."KEY_m" AS "KEY_m", max_select."max_Score" AS "max_Score" 
FROM orig_cte LEFT OUTER JOIN (SELECT score_class_union."KEY_u" AS "KEY_m", max(score_class_union."Score") AS "max_Score" 
FROM score_class_union GROUP BY score_class_union."KEY_u") AS max_select ON orig_cte."KEY" = max_select."KEY_m"), 
score_soft_max_deltas AS 
(SELECT score_max."KEY" AS "KEY", score_max."Score_0" AS "Score_0", score_max."Score_1" AS "Score_1", score_max."Proba_0" AS "Proba_0", score_max."Proba_1" AS "Proba_1", score_max."LogProba_0" AS "LogProba_0", score_max."LogProba_1" AS "LogProba_1", score_max."Decision" AS "Decision", score_max."DecisionProba" AS "DecisionProba", score_max."KEY_m" AS "KEY_m", score_max."max_Score" AS "max_Score", exp(greatest(-100.0, score_max."Score_0" - score_max."max_Score")) AS "exp_delta_Score_0", exp(greatest(-100.0, score_max."Score_1" - score_max."max_Score")) AS "exp_delta_Score_1" 
FROM score_max), 
score_class_union_soft AS 
(SELECT soft_scu."KEY" AS "KEY", soft_scu.class AS class, soft_scu."exp_delta_Score" AS "exp_delta_Score" 
FROM (SELECT score_soft_max_deltas."KEY" AS "KEY", 0 AS class, score_soft_max_deltas."exp_delta_Score_0" AS "exp_delta_Score" 
FROM score_soft_max_deltas UNION ALL SELECT score_soft_max_deltas."KEY" AS "KEY", 1 AS class, score_soft_max_deltas."exp_delta_Score_1" AS "exp_delta_Score" 
FROM score_soft_max_deltas) AS soft_scu), 
score_soft_max AS 
(SELECT score_soft_max_deltas."KEY" AS "KEY", score_soft_max_deltas."Score_0" AS "Score_0", score_soft_max_deltas."Score_1" AS "Score_1", score_soft_max_deltas."Proba_0" AS "Proba_0", score_soft_max_deltas."Proba_1" AS "Proba_1", score_soft_max_deltas."LogProba_0" AS "LogProba_0", score_soft_max_deltas."LogProba_1" AS "LogProba_1", score_soft_max_deltas."Decision" AS "Decision", score_soft_max_deltas."DecisionProba" AS "DecisionProba", score_soft_max_deltas."KEY_m" AS "KEY_m", score_soft_max_deltas."max_Score" AS "max_Score", score_soft_max_deltas."exp_delta_Score_0" AS "exp_delta_Score_0", score_soft_max_deltas."exp_delta_Score_1" AS "exp_delta_Score_1", sum_exp_t."KEY_sum" AS "KEY_sum", sum_exp_t."sum_ExpDeltaScore" AS "sum_ExpDeltaScore" 
FROM score_soft_max_deltas LEFT OUTER JOIN (SELECT score_class_union_soft."KEY" AS "KEY_sum", sum(score_class_union_soft."exp_delta_Score") AS "sum_ExpDeltaScore" 
FROM score_class_union_soft GROUP BY score_class_union_soft."KEY") AS sum_exp_t ON score_soft_max_deltas."KEY" = sum_exp_t."KEY_sum"), 
union_with_max AS 
(SELECT score_class_union."KEY_u" AS "KEY_u", score_class_union.class AS class, score_class_union."LogProba" AS "LogProba", score_class_union."Proba" AS "Proba", score_class_union."Score" AS "Score", score_soft_max."KEY" AS "KEY", score_soft_max."Score_0" AS "Score_0", score_soft_max."Score_1" AS "Score_1", score_soft_max."Proba_0" AS "Proba_0", score_soft_max."Proba_1" AS "Proba_1", score_soft_max."LogProba_0" AS "LogProba_0", score_soft_max."LogProba_1" AS "LogProba_1", score_soft_max."Decision" AS "Decision", score_soft_max."DecisionProba" AS "DecisionProba", score_soft_max."KEY_m" AS "KEY_m", score_soft_max."max_Score" AS "max_Score", score_soft_max."exp_delta_Score_0" AS "exp_delta_Score_0", score_soft_max."exp_delta_Score_1" AS "exp_delta_Score_1", score_soft_max."KEY_sum" AS "KEY_sum", score_soft_max."sum_ExpDeltaScore" AS "sum_ExpDeltaScore" 
FROM score_class_union LEFT OUTER JOIN score_soft_max ON score_class_union."KEY_u" = score_soft_max."KEY"), 
arg_max_cte AS 
(SELECT score_soft_max."KEY" AS "KEY", score_soft_max."Score_0" AS "Score_0", score_soft_max."Score_1" AS "Score_1", score_soft_max."Proba_0" AS "Proba_0", score_soft_max."Proba_1" AS "Proba_1", score_soft_max."LogProba_0" AS "LogProba_0", score_soft_max."LogProba_1" AS "LogProba_1", score_soft_max."Decision" AS "Decision", score_soft_max."DecisionProba" AS "DecisionProba", score_soft_max."KEY_m" AS "KEY_m", score_soft_max."max_Score" AS "max_Score", score_soft_max."exp_delta_Score_0" AS "exp_delta_Score_0", score_soft_max."exp_delta_Score_1" AS "exp_delta_Score_1", score_soft_max."KEY_sum" AS "KEY_sum", score_soft_max."sum_ExpDeltaScore" AS "sum_ExpDeltaScore", "arg_max_t_Score"."KEY_Score" AS "KEY_Score", "arg_max_t_Score"."arg_max_Score" AS "arg_max_Score", soft_max_comp."KEY_softmax" AS "KEY_softmax", soft_max_comp."SoftProba_0" AS "SoftProba_0", soft_max_comp."SoftProba_1" AS "SoftProba_1" 
FROM score_soft_max LEFT OUTER JOIN (SELECT union_with_max."KEY" AS "KEY_Score", min(union_with_max.class) AS "arg_max_Score" 
FROM union_with_max 
WHERE union_with_max."Score" >= union_with_max."max_Score" GROUP BY union_with_max."KEY") AS "arg_max_t_Score" ON score_soft_max."KEY" = "arg_max_t_Score"."KEY_Score" LEFT OUTER JOIN (SELECT score_soft_max."KEY" AS "KEY_softmax", score_soft_max."exp_delta_Score_0" / score_soft_max."sum_ExpDeltaScore" AS "SoftProba_0", score_soft_max."exp_delta_Score_1" / score_soft_max."sum_ExpDeltaScore" AS "SoftProba_1" 
FROM score_soft_max) AS soft_max_comp ON soft_max_comp."KEY_softmax" = "arg_max_t_Score"."KEY_Score")
 SELECT arg_max_cte."KEY" AS "KEY", CAST(NULL AS DOUBLE) AS "Score_0", CAST(NULL AS DOUBLE) AS "Score_1", arg_max_cte."SoftProba_0" AS "Proba_0", arg_max_cte."SoftProba_1" AS "Proba_1", CASE WHEN (arg_max_cte."SoftProba_0" IS NULL OR arg_max_cte."SoftProba_0" > 0.0) THEN ln(arg_max_cte."SoftProba_0") ELSE -1.79769313486231e+308 END AS "LogProba_0", CASE WHEN (arg_max_cte."SoftProba_1" IS NULL OR arg_max_cte."SoftProba_1" > 0.0) THEN ln(arg_max_cte."SoftProba_1") ELSE -1.79769313486231e+308 END AS "LogProba_1", arg_max_cte."arg_max_Score" AS "Decision", greatest(arg_max_cte."SoftProba_0", arg_max_cte."SoftProba_1") AS "DecisionProba" 
FROM arg_max_cte