-- This SQL code was generated by sklearn2sql (development version).
-- Copyright 2018

-- Model : AdaBoostClassifier_Pipeline
-- Dataset : BinaryClass_10
-- Database : mssql


-- This SQL code can contain one or more statements, to be executed in the order they appear in this file.



-- Code For temporary table ##TMP_20180516110109_CODEGEN_TVM4CK_ADS_imp_1_OUT part 1. Create 


CREATE TABLE ##TMP_20180516110109_CODEGEN_TVM4CK_ADS_imp_1_OUT (
	[KEY] BIGINT NULL, 
	impter_2 FLOAT(53) NULL, 
	impter_3 FLOAT(53) NULL, 
	impter_4 FLOAT(53) NULL, 
	impter_5 FLOAT(53) NULL, 
	impter_6 FLOAT(53) NULL, 
	impter_7 FLOAT(53) NULL, 
	impter_8 FLOAT(53) NULL, 
	impter_9 FLOAT(53) NULL, 
	impter_10 FLOAT(53) NULL, 
	impter_11 FLOAT(53) NULL
)



-- Code For temporary table ##TMP_20180516110109_CODEGEN_TVM4CK_ADS_imp_1_OUT part 2. Populate

INSERT INTO ##TMP_20180516110109_CODEGEN_TVM4CK_ADS_imp_1_OUT ([KEY], impter_2, impter_3, impter_4, impter_5, impter_6, impter_7, impter_8, impter_9, impter_10, impter_11) SELECT [ADS_imp_1_OUT].[KEY], [ADS_imp_1_OUT].impter_2, [ADS_imp_1_OUT].impter_3, [ADS_imp_1_OUT].impter_4, [ADS_imp_1_OUT].impter_5, [ADS_imp_1_OUT].impter_6, [ADS_imp_1_OUT].impter_7, [ADS_imp_1_OUT].impter_8, [ADS_imp_1_OUT].impter_9, [ADS_imp_1_OUT].impter_10, [ADS_imp_1_OUT].impter_11 
FROM (SELECT [ADS].[KEY] AS [KEY], CASE WHEN ([ADS].[Feature_0] IS NULL) THEN 0.061829205238134496 ELSE [ADS].[Feature_0] END AS impter_2, CASE WHEN ([ADS].[Feature_1] IS NULL) THEN 0.17702463767183324 ELSE [ADS].[Feature_1] END AS impter_3, CASE WHEN ([ADS].[Feature_2] IS NULL) THEN 0.04138385004903454 ELSE [ADS].[Feature_2] END AS impter_4, CASE WHEN ([ADS].[Feature_3] IS NULL) THEN 0.13060646805847148 ELSE [ADS].[Feature_3] END AS impter_5, CASE WHEN ([ADS].[Feature_4] IS NULL) THEN -0.05955810471983082 ELSE [ADS].[Feature_4] END AS impter_6, CASE WHEN ([ADS].[Feature_5] IS NULL) THEN -0.04892908987010584 ELSE [ADS].[Feature_5] END AS impter_7, CASE WHEN ([ADS].[Feature_6] IS NULL) THEN 0.19101797861713127 ELSE [ADS].[Feature_6] END AS impter_8, CASE WHEN ([ADS].[Feature_7] IS NULL) THEN 0.02204959673267471 ELSE [ADS].[Feature_7] END AS impter_9, CASE WHEN ([ADS].[Feature_8] IS NULL) THEN -0.057729814034140035 ELSE [ADS].[Feature_8] END AS impter_10, CASE WHEN ([ADS].[Feature_9] IS NULL) THEN -0.05254959205203237 ELSE [ADS].[Feature_9] END AS impter_11 
FROM [BinaryClass_10] AS [ADS]) AS [ADS_imp_1_OUT]

-- Code For temporary table ##TMP_20180516110109_CODEGEN_JK3O7J_ADS_sca_2_OUT part 1. Create 


CREATE TABLE ##TMP_20180516110109_CODEGEN_JK3O7J_ADS_sca_2_OUT (
	[KEY] BIGINT NULL, 
	scaler_2 FLOAT NULL, 
	scaler_3 FLOAT NULL, 
	scaler_4 FLOAT NULL, 
	scaler_5 FLOAT NULL, 
	scaler_6 FLOAT NULL, 
	scaler_7 FLOAT NULL, 
	scaler_8 FLOAT NULL, 
	scaler_9 FLOAT NULL, 
	scaler_10 FLOAT NULL, 
	scaler_11 FLOAT NULL
)



-- Code For temporary table ##TMP_20180516110109_CODEGEN_JK3O7J_ADS_sca_2_OUT part 2. Populate

INSERT INTO ##TMP_20180516110109_CODEGEN_JK3O7J_ADS_sca_2_OUT ([KEY], scaler_2, scaler_3, scaler_4, scaler_5, scaler_6, scaler_7, scaler_8, scaler_9, scaler_10, scaler_11) SELECT [ADS_sca_2_OUT].[KEY], [ADS_sca_2_OUT].scaler_2, [ADS_sca_2_OUT].scaler_3, [ADS_sca_2_OUT].scaler_4, [ADS_sca_2_OUT].scaler_5, [ADS_sca_2_OUT].scaler_6, [ADS_sca_2_OUT].scaler_7, [ADS_sca_2_OUT].scaler_8, [ADS_sca_2_OUT].scaler_9, [ADS_sca_2_OUT].scaler_10, [ADS_sca_2_OUT].scaler_11 
FROM (SELECT [ADS_imp_1_OUT].[KEY] AS [KEY], (CAST([ADS_imp_1_OUT].impter_2 AS FLOAT(53)) - 0.061829205238134496) / 1.2283839562090673 AS scaler_2, (CAST([ADS_imp_1_OUT].impter_3 AS FLOAT(53)) - 0.17702463767183324) / 0.940821656314017 AS scaler_3, (CAST([ADS_imp_1_OUT].impter_4 AS FLOAT(53)) - 0.04138385004903454) / 1.0741824888811282 AS scaler_4, (CAST([ADS_imp_1_OUT].impter_5 AS FLOAT(53)) - 0.13060646805847148) / 1.0792244559733761 AS scaler_5, (CAST([ADS_imp_1_OUT].impter_6 AS FLOAT(53)) - -0.05955810471983082) / 1.1095891190508123 AS scaler_6, (CAST([ADS_imp_1_OUT].impter_7 AS FLOAT(53)) - -0.04892908987010584) / 1.3781871812029047 AS scaler_7, (CAST([ADS_imp_1_OUT].impter_8 AS FLOAT(53)) - 0.19101797861713127) / 0.9735285246303208 AS scaler_8, (CAST([ADS_imp_1_OUT].impter_9 AS FLOAT(53)) - 0.02204959673267471) / 0.47460301203797095 AS scaler_9, (CAST([ADS_imp_1_OUT].impter_10 AS FLOAT(53)) - -0.057729814034140035) / 1.064607524840552 AS scaler_10, (CAST([ADS_imp_1_OUT].impter_11 AS FLOAT(53)) - -0.05254959205203237) / 1.2245328896554564 AS scaler_11 
FROM ##TMP_20180516110109_CODEGEN_TVM4CK_ADS_imp_1_OUT AS [ADS_imp_1_OUT]) AS [ADS_sca_2_OUT]

-- Code For temporary table ##TMP_20180516110109_CODEGEN_MUU3DZ_ADB_B0 part 1. Create 


CREATE TABLE ##TMP_20180516110109_CODEGEN_MUU3DZ_ADB_B0 (
	[KEY] BIGINT NULL, 
	[Score_0] FLOAT NULL, 
	[Proba_0] FLOAT NULL, 
	[Score_1] FLOAT NULL, 
	[Proba_1] FLOAT NULL
)



-- Code For temporary table ##TMP_20180516110109_CODEGEN_MUU3DZ_ADB_B0 part 2. Populate

WITH [DT_node_lookup] AS 
(SELECT [ADS_sca_2_OUT].[KEY] AS [KEY], CASE WHEN ([ADS_sca_2_OUT].scaler_11 <= 0.07101128250360489) THEN 1 ELSE 2 END AS node_id_2 
FROM ##TMP_20180516110109_CODEGEN_JK3O7J_ADS_sca_2_OUT AS [ADS_sca_2_OUT]), 
[DT_node_data] AS 
(SELECT [Values].nid AS nid, CAST([Values].[P_0] AS FLOAT(53)) AS [P_0], CAST([Values].[P_1] AS FLOAT(53)) AS [P_1], CAST([Values].[D] AS FLOAT(53)) AS [D], CAST([Values].[DP] AS FLOAT(53)) AS [DP] 
FROM (SELECT 1 AS nid, 0.8085106382978724 AS [P_0], 0.19148936170212755 AS [P_1], 0 AS [D], 0.8085106382978724 AS [DP] UNION ALL SELECT 2 AS nid, 0.06060606060606058 AS [P_0], 0.9393939393939393 AS [P_1], 1 AS [D], 0.9393939393939393 AS [DP]) AS [Values]), 
[DT_Output] AS 
(SELECT [DT_node_lookup].[KEY] AS [KEY], [DT_node_lookup].node_id_2 AS node_id_2, [DT_node_data].nid AS nid, [DT_node_data].[P_0] AS [P_0], [DT_node_data].[P_1] AS [P_1], [DT_node_data].[D] AS [D], [DT_node_data].[DP] AS [DP] 
FROM [DT_node_lookup] LEFT OUTER JOIN [DT_node_data] ON [DT_node_lookup].node_id_2 = [DT_node_data].nid), 
[ADB_Model_0] AS 
(SELECT [DT_Output].[KEY] AS [KEY], (1.0 * (CASE WHEN ([DT_Output].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output].[P_0] IS NULL OR [DT_Output].[P_0] > 0.0) THEN log([DT_Output].[P_0]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output].[P_0] IS NULL OR [DT_Output].[P_0] > 0.0) THEN log([DT_Output].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output].[P_1] IS NULL OR [DT_Output].[P_1] > 0.0) THEN log([DT_Output].[P_1]) ELSE -1.79769313486231e+308 END END) / 2)) / 16.0 AS [Score_0], 1.0 * (CASE WHEN ([DT_Output].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output].[P_0] IS NULL OR [DT_Output].[P_0] > 0.0) THEN log([DT_Output].[P_0]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output].[P_0] IS NULL OR [DT_Output].[P_0] > 0.0) THEN log([DT_Output].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output].[P_1] IS NULL OR [DT_Output].[P_1] > 0.0) THEN log([DT_Output].[P_1]) ELSE -1.79769313486231e+308 END END) / 2) AS [Proba_0], (1.0 * (CASE WHEN ([DT_Output].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output].[P_1] IS NULL OR [DT_Output].[P_1] > 0.0) THEN log([DT_Output].[P_1]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output].[P_0] IS NULL OR [DT_Output].[P_0] > 0.0) THEN log([DT_Output].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output].[P_1] IS NULL OR [DT_Output].[P_1] > 0.0) THEN log([DT_Output].[P_1]) ELSE -1.79769313486231e+308 END END) / 2)) / 16.0 AS [Score_1], 1.0 * (CASE WHEN ([DT_Output].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output].[P_1] IS NULL OR [DT_Output].[P_1] > 0.0) THEN log([DT_Output].[P_1]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output].[P_0] IS NULL OR [DT_Output].[P_0] > 0.0) THEN log([DT_Output].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output].[P_1] IS NULL OR [DT_Output].[P_1] > 0.0) THEN log([DT_Output].[P_1]) ELSE -1.79769313486231e+308 END END) / 2) AS [Proba_1] 
FROM [DT_Output]), 
[DT_node_lookup_1] AS 
(SELECT [ADS_sca_2_OUT].[KEY] AS [KEY], CASE WHEN ([ADS_sca_2_OUT].scaler_9 <= 0.6601690649986267) THEN 1 ELSE 2 END AS node_id_2 
FROM ##TMP_20180516110109_CODEGEN_JK3O7J_ADS_sca_2_OUT AS [ADS_sca_2_OUT]), 
[DT_node_data_1] AS 
(SELECT [Values].nid AS nid, CAST([Values].[P_0] AS FLOAT(53)) AS [P_0], CAST([Values].[P_1] AS FLOAT(53)) AS [P_1], CAST([Values].[D] AS FLOAT(53)) AS [D], CAST([Values].[DP] AS FLOAT(53)) AS [DP] 
FROM (SELECT 1 AS nid, 0.36527504972347863 AS [P_0], 0.6347249502765214 AS [P_1], 1 AS [D], 0.6347249502765214 AS [DP] UNION ALL SELECT 2 AS nid, 1.0 AS [P_0], 0.0 AS [P_1], 0 AS [D], 1.0 AS [DP]) AS [Values]), 
[DT_Output_1] AS 
(SELECT [DT_node_lookup_1].[KEY] AS [KEY], [DT_node_lookup_1].node_id_2 AS node_id_2, [DT_node_data_1].nid AS nid, [DT_node_data_1].[P_0] AS [P_0], [DT_node_data_1].[P_1] AS [P_1], [DT_node_data_1].[D] AS [D], [DT_node_data_1].[DP] AS [DP] 
FROM [DT_node_lookup_1] LEFT OUTER JOIN [DT_node_data_1] ON [DT_node_lookup_1].node_id_2 = [DT_node_data_1].nid), 
[ADB_Model_1] AS 
(SELECT [DT_Output_1].[KEY] AS [KEY], (1.0 * (CASE WHEN ([DT_Output_1].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_1].[P_0] IS NULL OR [DT_Output_1].[P_0] > 0.0) THEN log([DT_Output_1].[P_0]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_1].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_1].[P_0] IS NULL OR [DT_Output_1].[P_0] > 0.0) THEN log([DT_Output_1].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_1].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_1].[P_1] IS NULL OR [DT_Output_1].[P_1] > 0.0) THEN log([DT_Output_1].[P_1]) ELSE -1.79769313486231e+308 END END) / 2)) / 16.0 AS [Score_0], 1.0 * (CASE WHEN ([DT_Output_1].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_1].[P_0] IS NULL OR [DT_Output_1].[P_0] > 0.0) THEN log([DT_Output_1].[P_0]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_1].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_1].[P_0] IS NULL OR [DT_Output_1].[P_0] > 0.0) THEN log([DT_Output_1].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_1].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_1].[P_1] IS NULL OR [DT_Output_1].[P_1] > 0.0) THEN log([DT_Output_1].[P_1]) ELSE -1.79769313486231e+308 END END) / 2) AS [Proba_0], (1.0 * (CASE WHEN ([DT_Output_1].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_1].[P_1] IS NULL OR [DT_Output_1].[P_1] > 0.0) THEN log([DT_Output_1].[P_1]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_1].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_1].[P_0] IS NULL OR [DT_Output_1].[P_0] > 0.0) THEN log([DT_Output_1].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_1].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_1].[P_1] IS NULL OR [DT_Output_1].[P_1] > 0.0) THEN log([DT_Output_1].[P_1]) ELSE -1.79769313486231e+308 END END) / 2)) / 16.0 AS [Score_1], 1.0 * (CASE WHEN ([DT_Output_1].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_1].[P_1] IS NULL OR [DT_Output_1].[P_1] > 0.0) THEN log([DT_Output_1].[P_1]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_1].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_1].[P_0] IS NULL OR [DT_Output_1].[P_0] > 0.0) THEN log([DT_Output_1].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_1].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_1].[P_1] IS NULL OR [DT_Output_1].[P_1] > 0.0) THEN log([DT_Output_1].[P_1]) ELSE -1.79769313486231e+308 END END) / 2) AS [Proba_1] 
FROM [DT_Output_1]), 
[DT_node_lookup_2] AS 
(SELECT [ADS_sca_2_OUT].[KEY] AS [KEY], CASE WHEN ([ADS_sca_2_OUT].scaler_7 <= -0.6792029142379761) THEN 1 ELSE 2 END AS node_id_2 
FROM ##TMP_20180516110109_CODEGEN_JK3O7J_ADS_sca_2_OUT AS [ADS_sca_2_OUT]), 
[DT_node_data_2] AS 
(SELECT [Values].nid AS nid, CAST([Values].[P_0] AS FLOAT(53)) AS [P_0], CAST([Values].[P_1] AS FLOAT(53)) AS [P_1], CAST([Values].[D] AS FLOAT(53)) AS [D], CAST([Values].[DP] AS FLOAT(53)) AS [DP] 
FROM (SELECT 1 AS nid, 5.786261339882229e-09 AS [P_0], 0.9999999942137386 AS [P_1], 1 AS [D], 0.9999999942137386 AS [DP] UNION ALL SELECT 2 AS nid, 0.6963365620302985 AS [P_0], 0.3036634379697016 AS [P_1], 0 AS [D], 0.6963365620302985 AS [DP]) AS [Values]), 
[DT_Output_2] AS 
(SELECT [DT_node_lookup_2].[KEY] AS [KEY], [DT_node_lookup_2].node_id_2 AS node_id_2, [DT_node_data_2].nid AS nid, [DT_node_data_2].[P_0] AS [P_0], [DT_node_data_2].[P_1] AS [P_1], [DT_node_data_2].[D] AS [D], [DT_node_data_2].[DP] AS [DP] 
FROM [DT_node_lookup_2] LEFT OUTER JOIN [DT_node_data_2] ON [DT_node_lookup_2].node_id_2 = [DT_node_data_2].nid), 
[ADB_Model_2] AS 
(SELECT [DT_Output_2].[KEY] AS [KEY], (1.0 * (CASE WHEN ([DT_Output_2].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_2].[P_0] IS NULL OR [DT_Output_2].[P_0] > 0.0) THEN log([DT_Output_2].[P_0]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_2].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_2].[P_0] IS NULL OR [DT_Output_2].[P_0] > 0.0) THEN log([DT_Output_2].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_2].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_2].[P_1] IS NULL OR [DT_Output_2].[P_1] > 0.0) THEN log([DT_Output_2].[P_1]) ELSE -1.79769313486231e+308 END END) / 2)) / 16.0 AS [Score_0], 1.0 * (CASE WHEN ([DT_Output_2].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_2].[P_0] IS NULL OR [DT_Output_2].[P_0] > 0.0) THEN log([DT_Output_2].[P_0]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_2].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_2].[P_0] IS NULL OR [DT_Output_2].[P_0] > 0.0) THEN log([DT_Output_2].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_2].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_2].[P_1] IS NULL OR [DT_Output_2].[P_1] > 0.0) THEN log([DT_Output_2].[P_1]) ELSE -1.79769313486231e+308 END END) / 2) AS [Proba_0], (1.0 * (CASE WHEN ([DT_Output_2].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_2].[P_1] IS NULL OR [DT_Output_2].[P_1] > 0.0) THEN log([DT_Output_2].[P_1]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_2].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_2].[P_0] IS NULL OR [DT_Output_2].[P_0] > 0.0) THEN log([DT_Output_2].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_2].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_2].[P_1] IS NULL OR [DT_Output_2].[P_1] > 0.0) THEN log([DT_Output_2].[P_1]) ELSE -1.79769313486231e+308 END END) / 2)) / 16.0 AS [Score_1], 1.0 * (CASE WHEN ([DT_Output_2].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_2].[P_1] IS NULL OR [DT_Output_2].[P_1] > 0.0) THEN log([DT_Output_2].[P_1]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_2].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_2].[P_0] IS NULL OR [DT_Output_2].[P_0] > 0.0) THEN log([DT_Output_2].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_2].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_2].[P_1] IS NULL OR [DT_Output_2].[P_1] > 0.0) THEN log([DT_Output_2].[P_1]) ELSE -1.79769313486231e+308 END END) / 2) AS [Proba_1] 
FROM [DT_Output_2]), 
[DT_node_lookup_3] AS 
(SELECT [ADS_sca_2_OUT].[KEY] AS [KEY], CASE WHEN ([ADS_sca_2_OUT].scaler_6 <= 1.1815500259399414) THEN 1 ELSE 2 END AS node_id_2 
FROM ##TMP_20180516110109_CODEGEN_JK3O7J_ADS_sca_2_OUT AS [ADS_sca_2_OUT]), 
[DT_node_data_3] AS 
(SELECT [Values].nid AS nid, CAST([Values].[P_0] AS FLOAT(53)) AS [P_0], CAST([Values].[P_1] AS FLOAT(53)) AS [P_1], CAST([Values].[D] AS FLOAT(53)) AS [D], CAST([Values].[DP] AS FLOAT(53)) AS [DP] 
FROM (SELECT 1 AS nid, 0.29426593755197866 AS [P_0], 0.7057340624480213 AS [P_1], 1 AS [D], 0.7057340624480213 AS [DP] UNION ALL SELECT 2 AS nid, 0.9999961938490312 AS [P_0], 3.806150968968417e-06 AS [P_1], 0 AS [D], 0.9999961938490312 AS [DP]) AS [Values]), 
[DT_Output_3] AS 
(SELECT [DT_node_lookup_3].[KEY] AS [KEY], [DT_node_lookup_3].node_id_2 AS node_id_2, [DT_node_data_3].nid AS nid, [DT_node_data_3].[P_0] AS [P_0], [DT_node_data_3].[P_1] AS [P_1], [DT_node_data_3].[D] AS [D], [DT_node_data_3].[DP] AS [DP] 
FROM [DT_node_lookup_3] LEFT OUTER JOIN [DT_node_data_3] ON [DT_node_lookup_3].node_id_2 = [DT_node_data_3].nid), 
[ADB_Model_3] AS 
(SELECT [DT_Output_3].[KEY] AS [KEY], (1.0 * (CASE WHEN ([DT_Output_3].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_3].[P_0] IS NULL OR [DT_Output_3].[P_0] > 0.0) THEN log([DT_Output_3].[P_0]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_3].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_3].[P_0] IS NULL OR [DT_Output_3].[P_0] > 0.0) THEN log([DT_Output_3].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_3].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_3].[P_1] IS NULL OR [DT_Output_3].[P_1] > 0.0) THEN log([DT_Output_3].[P_1]) ELSE -1.79769313486231e+308 END END) / 2)) / 16.0 AS [Score_0], 1.0 * (CASE WHEN ([DT_Output_3].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_3].[P_0] IS NULL OR [DT_Output_3].[P_0] > 0.0) THEN log([DT_Output_3].[P_0]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_3].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_3].[P_0] IS NULL OR [DT_Output_3].[P_0] > 0.0) THEN log([DT_Output_3].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_3].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_3].[P_1] IS NULL OR [DT_Output_3].[P_1] > 0.0) THEN log([DT_Output_3].[P_1]) ELSE -1.79769313486231e+308 END END) / 2) AS [Proba_0], (1.0 * (CASE WHEN ([DT_Output_3].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_3].[P_1] IS NULL OR [DT_Output_3].[P_1] > 0.0) THEN log([DT_Output_3].[P_1]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_3].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_3].[P_0] IS NULL OR [DT_Output_3].[P_0] > 0.0) THEN log([DT_Output_3].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_3].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_3].[P_1] IS NULL OR [DT_Output_3].[P_1] > 0.0) THEN log([DT_Output_3].[P_1]) ELSE -1.79769313486231e+308 END END) / 2)) / 16.0 AS [Score_1], 1.0 * (CASE WHEN ([DT_Output_3].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_3].[P_1] IS NULL OR [DT_Output_3].[P_1] > 0.0) THEN log([DT_Output_3].[P_1]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_3].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_3].[P_0] IS NULL OR [DT_Output_3].[P_0] > 0.0) THEN log([DT_Output_3].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_3].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_3].[P_1] IS NULL OR [DT_Output_3].[P_1] > 0.0) THEN log([DT_Output_3].[P_1]) ELSE -1.79769313486231e+308 END END) / 2) AS [Proba_1] 
FROM [DT_Output_3]), 
[DT_node_lookup_4] AS 
(SELECT [ADS_sca_2_OUT].[KEY] AS [KEY], CASE WHEN ([ADS_sca_2_OUT].scaler_2 <= 0.2812865674495697) THEN 1 ELSE 2 END AS node_id_2 
FROM ##TMP_20180516110109_CODEGEN_JK3O7J_ADS_sca_2_OUT AS [ADS_sca_2_OUT]), 
[DT_node_data_4] AS 
(SELECT [Values].nid AS nid, CAST([Values].[P_0] AS FLOAT(53)) AS [P_0], CAST([Values].[P_1] AS FLOAT(53)) AS [P_1], CAST([Values].[D] AS FLOAT(53)) AS [D], CAST([Values].[DP] AS FLOAT(53)) AS [DP] 
FROM (SELECT 1 AS nid, 0.3161274870060781 AS [P_0], 0.6838725129939218 AS [P_1], 1 AS [D], 0.6838725129939218 AS [DP] UNION ALL SELECT 2 AS nid, 0.9999000362396798 AS [P_0], 9.996376032020769e-05 AS [P_1], 0 AS [D], 0.9999000362396798 AS [DP]) AS [Values]), 
[DT_Output_4] AS 
(SELECT [DT_node_lookup_4].[KEY] AS [KEY], [DT_node_lookup_4].node_id_2 AS node_id_2, [DT_node_data_4].nid AS nid, [DT_node_data_4].[P_0] AS [P_0], [DT_node_data_4].[P_1] AS [P_1], [DT_node_data_4].[D] AS [D], [DT_node_data_4].[DP] AS [DP] 
FROM [DT_node_lookup_4] LEFT OUTER JOIN [DT_node_data_4] ON [DT_node_lookup_4].node_id_2 = [DT_node_data_4].nid), 
[ADB_Model_4] AS 
(SELECT [DT_Output_4].[KEY] AS [KEY], (1.0 * (CASE WHEN ([DT_Output_4].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_4].[P_0] IS NULL OR [DT_Output_4].[P_0] > 0.0) THEN log([DT_Output_4].[P_0]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_4].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_4].[P_0] IS NULL OR [DT_Output_4].[P_0] > 0.0) THEN log([DT_Output_4].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_4].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_4].[P_1] IS NULL OR [DT_Output_4].[P_1] > 0.0) THEN log([DT_Output_4].[P_1]) ELSE -1.79769313486231e+308 END END) / 2)) / 16.0 AS [Score_0], 1.0 * (CASE WHEN ([DT_Output_4].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_4].[P_0] IS NULL OR [DT_Output_4].[P_0] > 0.0) THEN log([DT_Output_4].[P_0]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_4].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_4].[P_0] IS NULL OR [DT_Output_4].[P_0] > 0.0) THEN log([DT_Output_4].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_4].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_4].[P_1] IS NULL OR [DT_Output_4].[P_1] > 0.0) THEN log([DT_Output_4].[P_1]) ELSE -1.79769313486231e+308 END END) / 2) AS [Proba_0], (1.0 * (CASE WHEN ([DT_Output_4].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_4].[P_1] IS NULL OR [DT_Output_4].[P_1] > 0.0) THEN log([DT_Output_4].[P_1]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_4].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_4].[P_0] IS NULL OR [DT_Output_4].[P_0] > 0.0) THEN log([DT_Output_4].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_4].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_4].[P_1] IS NULL OR [DT_Output_4].[P_1] > 0.0) THEN log([DT_Output_4].[P_1]) ELSE -1.79769313486231e+308 END END) / 2)) / 16.0 AS [Score_1], 1.0 * (CASE WHEN ([DT_Output_4].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_4].[P_1] IS NULL OR [DT_Output_4].[P_1] > 0.0) THEN log([DT_Output_4].[P_1]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_4].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_4].[P_0] IS NULL OR [DT_Output_4].[P_0] > 0.0) THEN log([DT_Output_4].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_4].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_4].[P_1] IS NULL OR [DT_Output_4].[P_1] > 0.0) THEN log([DT_Output_4].[P_1]) ELSE -1.79769313486231e+308 END END) / 2) AS [Proba_1] 
FROM [DT_Output_4]), 
[DT_node_lookup_5] AS 
(SELECT [ADS_sca_2_OUT].[KEY] AS [KEY], CASE WHEN ([ADS_sca_2_OUT].scaler_7 <= 1.2402734756469727) THEN 1 ELSE 2 END AS node_id_2 
FROM ##TMP_20180516110109_CODEGEN_JK3O7J_ADS_sca_2_OUT AS [ADS_sca_2_OUT]), 
[DT_node_data_5] AS 
(SELECT [Values].nid AS nid, CAST([Values].[P_0] AS FLOAT(53)) AS [P_0], CAST([Values].[P_1] AS FLOAT(53)) AS [P_1], CAST([Values].[D] AS FLOAT(53)) AS [D], CAST([Values].[DP] AS FLOAT(53)) AS [DP] 
FROM (SELECT 1 AS nid, 0.7010286028315516 AS [P_0], 0.29897139716844834 AS [P_1], 0 AS [D], 0.7010286028315516 AS [DP] UNION ALL SELECT 2 AS nid, 0.004848042135582704 AS [P_0], 0.9951519578644173 AS [P_1], 1 AS [D], 0.9951519578644173 AS [DP]) AS [Values]), 
[DT_Output_5] AS 
(SELECT [DT_node_lookup_5].[KEY] AS [KEY], [DT_node_lookup_5].node_id_2 AS node_id_2, [DT_node_data_5].nid AS nid, [DT_node_data_5].[P_0] AS [P_0], [DT_node_data_5].[P_1] AS [P_1], [DT_node_data_5].[D] AS [D], [DT_node_data_5].[DP] AS [DP] 
FROM [DT_node_lookup_5] LEFT OUTER JOIN [DT_node_data_5] ON [DT_node_lookup_5].node_id_2 = [DT_node_data_5].nid), 
[ADB_Model_5] AS 
(SELECT [DT_Output_5].[KEY] AS [KEY], (1.0 * (CASE WHEN ([DT_Output_5].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_5].[P_0] IS NULL OR [DT_Output_5].[P_0] > 0.0) THEN log([DT_Output_5].[P_0]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_5].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_5].[P_0] IS NULL OR [DT_Output_5].[P_0] > 0.0) THEN log([DT_Output_5].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_5].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_5].[P_1] IS NULL OR [DT_Output_5].[P_1] > 0.0) THEN log([DT_Output_5].[P_1]) ELSE -1.79769313486231e+308 END END) / 2)) / 16.0 AS [Score_0], 1.0 * (CASE WHEN ([DT_Output_5].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_5].[P_0] IS NULL OR [DT_Output_5].[P_0] > 0.0) THEN log([DT_Output_5].[P_0]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_5].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_5].[P_0] IS NULL OR [DT_Output_5].[P_0] > 0.0) THEN log([DT_Output_5].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_5].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_5].[P_1] IS NULL OR [DT_Output_5].[P_1] > 0.0) THEN log([DT_Output_5].[P_1]) ELSE -1.79769313486231e+308 END END) / 2) AS [Proba_0], (1.0 * (CASE WHEN ([DT_Output_5].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_5].[P_1] IS NULL OR [DT_Output_5].[P_1] > 0.0) THEN log([DT_Output_5].[P_1]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_5].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_5].[P_0] IS NULL OR [DT_Output_5].[P_0] > 0.0) THEN log([DT_Output_5].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_5].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_5].[P_1] IS NULL OR [DT_Output_5].[P_1] > 0.0) THEN log([DT_Output_5].[P_1]) ELSE -1.79769313486231e+308 END END) / 2)) / 16.0 AS [Score_1], 1.0 * (CASE WHEN ([DT_Output_5].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_5].[P_1] IS NULL OR [DT_Output_5].[P_1] > 0.0) THEN log([DT_Output_5].[P_1]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_5].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_5].[P_0] IS NULL OR [DT_Output_5].[P_0] > 0.0) THEN log([DT_Output_5].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_5].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_5].[P_1] IS NULL OR [DT_Output_5].[P_1] > 0.0) THEN log([DT_Output_5].[P_1]) ELSE -1.79769313486231e+308 END END) / 2) AS [Proba_1] 
FROM [DT_Output_5]), 
[DT_node_lookup_6] AS 
(SELECT [ADS_sca_2_OUT].[KEY] AS [KEY], CASE WHEN ([ADS_sca_2_OUT].scaler_11 <= 0.35896432399749756) THEN 1 ELSE 2 END AS node_id_2 
FROM ##TMP_20180516110109_CODEGEN_JK3O7J_ADS_sca_2_OUT AS [ADS_sca_2_OUT]), 
[DT_node_data_6] AS 
(SELECT [Values].nid AS nid, CAST([Values].[P_0] AS FLOAT(53)) AS [P_0], CAST([Values].[P_1] AS FLOAT(53)) AS [P_1], CAST([Values].[D] AS FLOAT(53)) AS [D], CAST([Values].[DP] AS FLOAT(53)) AS [DP] 
FROM (SELECT 1 AS nid, 0.9316897155687578 AS [P_0], 0.06831028443124218 AS [P_1], 0 AS [D], 0.9316897155687578 AS [DP] UNION ALL SELECT 2 AS nid, 0.0017088907657951782 AS [P_0], 0.9982911092342048 AS [P_1], 1 AS [D], 0.9982911092342048 AS [DP]) AS [Values]), 
[DT_Output_6] AS 
(SELECT [DT_node_lookup_6].[KEY] AS [KEY], [DT_node_lookup_6].node_id_2 AS node_id_2, [DT_node_data_6].nid AS nid, [DT_node_data_6].[P_0] AS [P_0], [DT_node_data_6].[P_1] AS [P_1], [DT_node_data_6].[D] AS [D], [DT_node_data_6].[DP] AS [DP] 
FROM [DT_node_lookup_6] LEFT OUTER JOIN [DT_node_data_6] ON [DT_node_lookup_6].node_id_2 = [DT_node_data_6].nid), 
[ADB_Model_6] AS 
(SELECT [DT_Output_6].[KEY] AS [KEY], (1.0 * (CASE WHEN ([DT_Output_6].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_6].[P_0] IS NULL OR [DT_Output_6].[P_0] > 0.0) THEN log([DT_Output_6].[P_0]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_6].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_6].[P_0] IS NULL OR [DT_Output_6].[P_0] > 0.0) THEN log([DT_Output_6].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_6].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_6].[P_1] IS NULL OR [DT_Output_6].[P_1] > 0.0) THEN log([DT_Output_6].[P_1]) ELSE -1.79769313486231e+308 END END) / 2)) / 16.0 AS [Score_0], 1.0 * (CASE WHEN ([DT_Output_6].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_6].[P_0] IS NULL OR [DT_Output_6].[P_0] > 0.0) THEN log([DT_Output_6].[P_0]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_6].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_6].[P_0] IS NULL OR [DT_Output_6].[P_0] > 0.0) THEN log([DT_Output_6].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_6].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_6].[P_1] IS NULL OR [DT_Output_6].[P_1] > 0.0) THEN log([DT_Output_6].[P_1]) ELSE -1.79769313486231e+308 END END) / 2) AS [Proba_0], (1.0 * (CASE WHEN ([DT_Output_6].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_6].[P_1] IS NULL OR [DT_Output_6].[P_1] > 0.0) THEN log([DT_Output_6].[P_1]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_6].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_6].[P_0] IS NULL OR [DT_Output_6].[P_0] > 0.0) THEN log([DT_Output_6].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_6].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_6].[P_1] IS NULL OR [DT_Output_6].[P_1] > 0.0) THEN log([DT_Output_6].[P_1]) ELSE -1.79769313486231e+308 END END) / 2)) / 16.0 AS [Score_1], 1.0 * (CASE WHEN ([DT_Output_6].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_6].[P_1] IS NULL OR [DT_Output_6].[P_1] > 0.0) THEN log([DT_Output_6].[P_1]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_6].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_6].[P_0] IS NULL OR [DT_Output_6].[P_0] > 0.0) THEN log([DT_Output_6].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_6].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_6].[P_1] IS NULL OR [DT_Output_6].[P_1] > 0.0) THEN log([DT_Output_6].[P_1]) ELSE -1.79769313486231e+308 END END) / 2) AS [Proba_1] 
FROM [DT_Output_6]), 
[DT_node_lookup_7] AS 
(SELECT [ADS_sca_2_OUT].[KEY] AS [KEY], CASE WHEN ([ADS_sca_2_OUT].scaler_9 <= 0.2683620750904083) THEN 1 ELSE 2 END AS node_id_2 
FROM ##TMP_20180516110109_CODEGEN_JK3O7J_ADS_sca_2_OUT AS [ADS_sca_2_OUT]), 
[DT_node_data_7] AS 
(SELECT [Values].nid AS nid, CAST([Values].[P_0] AS FLOAT(53)) AS [P_0], CAST([Values].[P_1] AS FLOAT(53)) AS [P_1], CAST([Values].[D] AS FLOAT(53)) AS [D], CAST([Values].[DP] AS FLOAT(53)) AS [DP] 
FROM (SELECT 1 AS nid, 0.8659907105959614 AS [P_0], 0.1340092894040386 AS [P_1], 0 AS [D], 0.8659907105959614 AS [DP] UNION ALL SELECT 2 AS nid, 0.02963779071654291 AS [P_0], 0.9703622092834571 AS [P_1], 1 AS [D], 0.9703622092834571 AS [DP]) AS [Values]), 
[DT_Output_7] AS 
(SELECT [DT_node_lookup_7].[KEY] AS [KEY], [DT_node_lookup_7].node_id_2 AS node_id_2, [DT_node_data_7].nid AS nid, [DT_node_data_7].[P_0] AS [P_0], [DT_node_data_7].[P_1] AS [P_1], [DT_node_data_7].[D] AS [D], [DT_node_data_7].[DP] AS [DP] 
FROM [DT_node_lookup_7] LEFT OUTER JOIN [DT_node_data_7] ON [DT_node_lookup_7].node_id_2 = [DT_node_data_7].nid), 
[ADB_Model_7] AS 
(SELECT [DT_Output_7].[KEY] AS [KEY], (1.0 * (CASE WHEN ([DT_Output_7].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_7].[P_0] IS NULL OR [DT_Output_7].[P_0] > 0.0) THEN log([DT_Output_7].[P_0]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_7].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_7].[P_0] IS NULL OR [DT_Output_7].[P_0] > 0.0) THEN log([DT_Output_7].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_7].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_7].[P_1] IS NULL OR [DT_Output_7].[P_1] > 0.0) THEN log([DT_Output_7].[P_1]) ELSE -1.79769313486231e+308 END END) / 2)) / 16.0 AS [Score_0], 1.0 * (CASE WHEN ([DT_Output_7].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_7].[P_0] IS NULL OR [DT_Output_7].[P_0] > 0.0) THEN log([DT_Output_7].[P_0]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_7].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_7].[P_0] IS NULL OR [DT_Output_7].[P_0] > 0.0) THEN log([DT_Output_7].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_7].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_7].[P_1] IS NULL OR [DT_Output_7].[P_1] > 0.0) THEN log([DT_Output_7].[P_1]) ELSE -1.79769313486231e+308 END END) / 2) AS [Proba_0], (1.0 * (CASE WHEN ([DT_Output_7].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_7].[P_1] IS NULL OR [DT_Output_7].[P_1] > 0.0) THEN log([DT_Output_7].[P_1]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_7].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_7].[P_0] IS NULL OR [DT_Output_7].[P_0] > 0.0) THEN log([DT_Output_7].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_7].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_7].[P_1] IS NULL OR [DT_Output_7].[P_1] > 0.0) THEN log([DT_Output_7].[P_1]) ELSE -1.79769313486231e+308 END END) / 2)) / 16.0 AS [Score_1], 1.0 * (CASE WHEN ([DT_Output_7].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_7].[P_1] IS NULL OR [DT_Output_7].[P_1] > 0.0) THEN log([DT_Output_7].[P_1]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_7].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_7].[P_0] IS NULL OR [DT_Output_7].[P_0] > 0.0) THEN log([DT_Output_7].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_7].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_7].[P_1] IS NULL OR [DT_Output_7].[P_1] > 0.0) THEN log([DT_Output_7].[P_1]) ELSE -1.79769313486231e+308 END END) / 2) AS [Proba_1] 
FROM [DT_Output_7]), 
[DT_node_lookup_8] AS 
(SELECT [ADS_sca_2_OUT].[KEY] AS [KEY], CASE WHEN ([ADS_sca_2_OUT].scaler_11 <= 0.07101128250360489) THEN 1 ELSE 2 END AS node_id_2 
FROM ##TMP_20180516110109_CODEGEN_JK3O7J_ADS_sca_2_OUT AS [ADS_sca_2_OUT]), 
[DT_node_data_8] AS 
(SELECT [Values].nid AS nid, CAST([Values].[P_0] AS FLOAT(53)) AS [P_0], CAST([Values].[P_1] AS FLOAT(53)) AS [P_1], CAST([Values].[D] AS FLOAT(53)) AS [D], CAST([Values].[DP] AS FLOAT(53)) AS [DP] 
FROM (SELECT 1 AS nid, 0.7602777720453834 AS [P_0], 0.2397222279546167 AS [P_1], 0 AS [D], 0.7602777720453834 AS [DP] UNION ALL SELECT 2 AS nid, 0.1370917815918646 AS [P_0], 0.8629082184081354 AS [P_1], 1 AS [D], 0.8629082184081354 AS [DP]) AS [Values]), 
[DT_Output_8] AS 
(SELECT [DT_node_lookup_8].[KEY] AS [KEY], [DT_node_lookup_8].node_id_2 AS node_id_2, [DT_node_data_8].nid AS nid, [DT_node_data_8].[P_0] AS [P_0], [DT_node_data_8].[P_1] AS [P_1], [DT_node_data_8].[D] AS [D], [DT_node_data_8].[DP] AS [DP] 
FROM [DT_node_lookup_8] LEFT OUTER JOIN [DT_node_data_8] ON [DT_node_lookup_8].node_id_2 = [DT_node_data_8].nid), 
[ADB_Model_8] AS 
(SELECT [DT_Output_8].[KEY] AS [KEY], (1.0 * (CASE WHEN ([DT_Output_8].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_8].[P_0] IS NULL OR [DT_Output_8].[P_0] > 0.0) THEN log([DT_Output_8].[P_0]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_8].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_8].[P_0] IS NULL OR [DT_Output_8].[P_0] > 0.0) THEN log([DT_Output_8].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_8].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_8].[P_1] IS NULL OR [DT_Output_8].[P_1] > 0.0) THEN log([DT_Output_8].[P_1]) ELSE -1.79769313486231e+308 END END) / 2)) / 16.0 AS [Score_0], 1.0 * (CASE WHEN ([DT_Output_8].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_8].[P_0] IS NULL OR [DT_Output_8].[P_0] > 0.0) THEN log([DT_Output_8].[P_0]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_8].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_8].[P_0] IS NULL OR [DT_Output_8].[P_0] > 0.0) THEN log([DT_Output_8].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_8].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_8].[P_1] IS NULL OR [DT_Output_8].[P_1] > 0.0) THEN log([DT_Output_8].[P_1]) ELSE -1.79769313486231e+308 END END) / 2) AS [Proba_0], (1.0 * (CASE WHEN ([DT_Output_8].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_8].[P_1] IS NULL OR [DT_Output_8].[P_1] > 0.0) THEN log([DT_Output_8].[P_1]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_8].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_8].[P_0] IS NULL OR [DT_Output_8].[P_0] > 0.0) THEN log([DT_Output_8].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_8].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_8].[P_1] IS NULL OR [DT_Output_8].[P_1] > 0.0) THEN log([DT_Output_8].[P_1]) ELSE -1.79769313486231e+308 END END) / 2)) / 16.0 AS [Score_1], 1.0 * (CASE WHEN ([DT_Output_8].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_8].[P_1] IS NULL OR [DT_Output_8].[P_1] > 0.0) THEN log([DT_Output_8].[P_1]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_8].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_8].[P_0] IS NULL OR [DT_Output_8].[P_0] > 0.0) THEN log([DT_Output_8].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_8].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_8].[P_1] IS NULL OR [DT_Output_8].[P_1] > 0.0) THEN log([DT_Output_8].[P_1]) ELSE -1.79769313486231e+308 END END) / 2) AS [Proba_1] 
FROM [DT_Output_8]), 
[DT_node_lookup_9] AS 
(SELECT [ADS_sca_2_OUT].[KEY] AS [KEY], CASE WHEN ([ADS_sca_2_OUT].scaler_7 <= 1.8312153816223145) THEN 1 ELSE 2 END AS node_id_2 
FROM ##TMP_20180516110109_CODEGEN_JK3O7J_ADS_sca_2_OUT AS [ADS_sca_2_OUT]), 
[DT_node_data_9] AS 
(SELECT [Values].nid AS nid, CAST([Values].[P_0] AS FLOAT(53)) AS [P_0], CAST([Values].[P_1] AS FLOAT(53)) AS [P_1], CAST([Values].[D] AS FLOAT(53)) AS [D], CAST([Values].[DP] AS FLOAT(53)) AS [DP] 
FROM (SELECT 1 AS nid, 0.6572943070672909 AS [P_0], 0.3427056929327092 AS [P_1], 0 AS [D], 0.6572943070672909 AS [DP] UNION ALL SELECT 2 AS nid, 0.0 AS [P_0], 1.0 AS [P_1], 1 AS [D], 1.0 AS [DP]) AS [Values]), 
[DT_Output_9] AS 
(SELECT [DT_node_lookup_9].[KEY] AS [KEY], [DT_node_lookup_9].node_id_2 AS node_id_2, [DT_node_data_9].nid AS nid, [DT_node_data_9].[P_0] AS [P_0], [DT_node_data_9].[P_1] AS [P_1], [DT_node_data_9].[D] AS [D], [DT_node_data_9].[DP] AS [DP] 
FROM [DT_node_lookup_9] LEFT OUTER JOIN [DT_node_data_9] ON [DT_node_lookup_9].node_id_2 = [DT_node_data_9].nid), 
[ADB_Model_9] AS 
(SELECT [DT_Output_9].[KEY] AS [KEY], (1.0 * (CASE WHEN ([DT_Output_9].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_9].[P_0] IS NULL OR [DT_Output_9].[P_0] > 0.0) THEN log([DT_Output_9].[P_0]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_9].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_9].[P_0] IS NULL OR [DT_Output_9].[P_0] > 0.0) THEN log([DT_Output_9].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_9].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_9].[P_1] IS NULL OR [DT_Output_9].[P_1] > 0.0) THEN log([DT_Output_9].[P_1]) ELSE -1.79769313486231e+308 END END) / 2)) / 16.0 AS [Score_0], 1.0 * (CASE WHEN ([DT_Output_9].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_9].[P_0] IS NULL OR [DT_Output_9].[P_0] > 0.0) THEN log([DT_Output_9].[P_0]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_9].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_9].[P_0] IS NULL OR [DT_Output_9].[P_0] > 0.0) THEN log([DT_Output_9].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_9].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_9].[P_1] IS NULL OR [DT_Output_9].[P_1] > 0.0) THEN log([DT_Output_9].[P_1]) ELSE -1.79769313486231e+308 END END) / 2) AS [Proba_0], (1.0 * (CASE WHEN ([DT_Output_9].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_9].[P_1] IS NULL OR [DT_Output_9].[P_1] > 0.0) THEN log([DT_Output_9].[P_1]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_9].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_9].[P_0] IS NULL OR [DT_Output_9].[P_0] > 0.0) THEN log([DT_Output_9].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_9].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_9].[P_1] IS NULL OR [DT_Output_9].[P_1] > 0.0) THEN log([DT_Output_9].[P_1]) ELSE -1.79769313486231e+308 END END) / 2)) / 16.0 AS [Score_1], 1.0 * (CASE WHEN ([DT_Output_9].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_9].[P_1] IS NULL OR [DT_Output_9].[P_1] > 0.0) THEN log([DT_Output_9].[P_1]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_9].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_9].[P_0] IS NULL OR [DT_Output_9].[P_0] > 0.0) THEN log([DT_Output_9].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_9].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_9].[P_1] IS NULL OR [DT_Output_9].[P_1] > 0.0) THEN log([DT_Output_9].[P_1]) ELSE -1.79769313486231e+308 END END) / 2) AS [Proba_1] 
FROM [DT_Output_9])
 INSERT INTO ##TMP_20180516110109_CODEGEN_MUU3DZ_ADB_B0 ([KEY], [Score_0], [Proba_0], [Score_1], [Proba_1]) SELECT [ADB_B0].[KEY], [ADB_B0].[Score_0], [ADB_B0].[Proba_0], [ADB_B0].[Score_1], [ADB_B0].[Proba_1] 
FROM (SELECT [ADB_esu_0].[KEY] AS [KEY], [ADB_esu_0].[Score_0] AS [Score_0], [ADB_esu_0].[Proba_0] AS [Proba_0], [ADB_esu_0].[Score_1] AS [Score_1], [ADB_esu_0].[Proba_1] AS [Proba_1] 
FROM (SELECT [ADB_Model_0].[KEY] AS [KEY], [ADB_Model_0].[Score_0] AS [Score_0], [ADB_Model_0].[Proba_0] AS [Proba_0], [ADB_Model_0].[Score_1] AS [Score_1], [ADB_Model_0].[Proba_1] AS [Proba_1] 
FROM [ADB_Model_0] UNION ALL SELECT [ADB_Model_1].[KEY] AS [KEY], [ADB_Model_1].[Score_0] AS [Score_0], [ADB_Model_1].[Proba_0] AS [Proba_0], [ADB_Model_1].[Score_1] AS [Score_1], [ADB_Model_1].[Proba_1] AS [Proba_1] 
FROM [ADB_Model_1] UNION ALL SELECT [ADB_Model_2].[KEY] AS [KEY], [ADB_Model_2].[Score_0] AS [Score_0], [ADB_Model_2].[Proba_0] AS [Proba_0], [ADB_Model_2].[Score_1] AS [Score_1], [ADB_Model_2].[Proba_1] AS [Proba_1] 
FROM [ADB_Model_2] UNION ALL SELECT [ADB_Model_3].[KEY] AS [KEY], [ADB_Model_3].[Score_0] AS [Score_0], [ADB_Model_3].[Proba_0] AS [Proba_0], [ADB_Model_3].[Score_1] AS [Score_1], [ADB_Model_3].[Proba_1] AS [Proba_1] 
FROM [ADB_Model_3] UNION ALL SELECT [ADB_Model_4].[KEY] AS [KEY], [ADB_Model_4].[Score_0] AS [Score_0], [ADB_Model_4].[Proba_0] AS [Proba_0], [ADB_Model_4].[Score_1] AS [Score_1], [ADB_Model_4].[Proba_1] AS [Proba_1] 
FROM [ADB_Model_4] UNION ALL SELECT [ADB_Model_5].[KEY] AS [KEY], [ADB_Model_5].[Score_0] AS [Score_0], [ADB_Model_5].[Proba_0] AS [Proba_0], [ADB_Model_5].[Score_1] AS [Score_1], [ADB_Model_5].[Proba_1] AS [Proba_1] 
FROM [ADB_Model_5] UNION ALL SELECT [ADB_Model_6].[KEY] AS [KEY], [ADB_Model_6].[Score_0] AS [Score_0], [ADB_Model_6].[Proba_0] AS [Proba_0], [ADB_Model_6].[Score_1] AS [Score_1], [ADB_Model_6].[Proba_1] AS [Proba_1] 
FROM [ADB_Model_6] UNION ALL SELECT [ADB_Model_7].[KEY] AS [KEY], [ADB_Model_7].[Score_0] AS [Score_0], [ADB_Model_7].[Proba_0] AS [Proba_0], [ADB_Model_7].[Score_1] AS [Score_1], [ADB_Model_7].[Proba_1] AS [Proba_1] 
FROM [ADB_Model_7] UNION ALL SELECT [ADB_Model_8].[KEY] AS [KEY], [ADB_Model_8].[Score_0] AS [Score_0], [ADB_Model_8].[Proba_0] AS [Proba_0], [ADB_Model_8].[Score_1] AS [Score_1], [ADB_Model_8].[Proba_1] AS [Proba_1] 
FROM [ADB_Model_8] UNION ALL SELECT [ADB_Model_9].[KEY] AS [KEY], [ADB_Model_9].[Score_0] AS [Score_0], [ADB_Model_9].[Proba_0] AS [Proba_0], [ADB_Model_9].[Score_1] AS [Score_1], [ADB_Model_9].[Proba_1] AS [Proba_1] 
FROM [ADB_Model_9]) AS [ADB_esu_0]) AS [ADB_B0]

-- Code For temporary table ##TMP_20180516110109_CODEGEN_X20H5Y_ADB_B1 part 1. Create 


CREATE TABLE ##TMP_20180516110109_CODEGEN_X20H5Y_ADB_B1 (
	[KEY] BIGINT NULL, 
	[Score_0] FLOAT NULL, 
	[Proba_0] FLOAT NULL, 
	[Score_1] FLOAT NULL, 
	[Proba_1] FLOAT NULL
)



-- Code For temporary table ##TMP_20180516110109_CODEGEN_X20H5Y_ADB_B1 part 2. Populate

WITH [DT_node_lookup_10] AS 
(SELECT [ADS_sca_2_OUT].[KEY] AS [KEY], CASE WHEN ([ADS_sca_2_OUT].scaler_7 <= 0.9573294520378113) THEN 1 ELSE 2 END AS node_id_2 
FROM ##TMP_20180516110109_CODEGEN_JK3O7J_ADS_sca_2_OUT AS [ADS_sca_2_OUT]), 
[DT_node_data_10] AS 
(SELECT [Values].nid AS nid, CAST([Values].[P_0] AS FLOAT(53)) AS [P_0], CAST([Values].[P_1] AS FLOAT(53)) AS [P_1], CAST([Values].[D] AS FLOAT(53)) AS [D], CAST([Values].[DP] AS FLOAT(53)) AS [DP] 
FROM (SELECT 1 AS nid, 0.13253509846403605 AS [P_0], 0.8674649015359639 AS [P_1], 1 AS [D], 0.8674649015359639 AS [DP] UNION ALL SELECT 2 AS nid, 0.7827359807304209 AS [P_0], 0.21726401926957906 AS [P_1], 0 AS [D], 0.7827359807304209 AS [DP]) AS [Values]), 
[DT_Output_10] AS 
(SELECT [DT_node_lookup_10].[KEY] AS [KEY], [DT_node_lookup_10].node_id_2 AS node_id_2, [DT_node_data_10].nid AS nid, [DT_node_data_10].[P_0] AS [P_0], [DT_node_data_10].[P_1] AS [P_1], [DT_node_data_10].[D] AS [D], [DT_node_data_10].[DP] AS [DP] 
FROM [DT_node_lookup_10] LEFT OUTER JOIN [DT_node_data_10] ON [DT_node_lookup_10].node_id_2 = [DT_node_data_10].nid), 
[ADB_Model_10] AS 
(SELECT [DT_Output_10].[KEY] AS [KEY], (1.0 * (CASE WHEN ([DT_Output_10].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_10].[P_0] IS NULL OR [DT_Output_10].[P_0] > 0.0) THEN log([DT_Output_10].[P_0]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_10].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_10].[P_0] IS NULL OR [DT_Output_10].[P_0] > 0.0) THEN log([DT_Output_10].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_10].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_10].[P_1] IS NULL OR [DT_Output_10].[P_1] > 0.0) THEN log([DT_Output_10].[P_1]) ELSE -1.79769313486231e+308 END END) / 2)) / 16.0 AS [Score_0], 1.0 * (CASE WHEN ([DT_Output_10].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_10].[P_0] IS NULL OR [DT_Output_10].[P_0] > 0.0) THEN log([DT_Output_10].[P_0]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_10].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_10].[P_0] IS NULL OR [DT_Output_10].[P_0] > 0.0) THEN log([DT_Output_10].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_10].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_10].[P_1] IS NULL OR [DT_Output_10].[P_1] > 0.0) THEN log([DT_Output_10].[P_1]) ELSE -1.79769313486231e+308 END END) / 2) AS [Proba_0], (1.0 * (CASE WHEN ([DT_Output_10].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_10].[P_1] IS NULL OR [DT_Output_10].[P_1] > 0.0) THEN log([DT_Output_10].[P_1]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_10].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_10].[P_0] IS NULL OR [DT_Output_10].[P_0] > 0.0) THEN log([DT_Output_10].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_10].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_10].[P_1] IS NULL OR [DT_Output_10].[P_1] > 0.0) THEN log([DT_Output_10].[P_1]) ELSE -1.79769313486231e+308 END END) / 2)) / 16.0 AS [Score_1], 1.0 * (CASE WHEN ([DT_Output_10].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_10].[P_1] IS NULL OR [DT_Output_10].[P_1] > 0.0) THEN log([DT_Output_10].[P_1]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_10].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_10].[P_0] IS NULL OR [DT_Output_10].[P_0] > 0.0) THEN log([DT_Output_10].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_10].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_10].[P_1] IS NULL OR [DT_Output_10].[P_1] > 0.0) THEN log([DT_Output_10].[P_1]) ELSE -1.79769313486231e+308 END END) / 2) AS [Proba_1] 
FROM [DT_Output_10]), 
[DT_node_lookup_11] AS 
(SELECT [ADS_sca_2_OUT].[KEY] AS [KEY], CASE WHEN ([ADS_sca_2_OUT].scaler_11 <= 0.07101128250360489) THEN 1 ELSE 2 END AS node_id_2 
FROM ##TMP_20180516110109_CODEGEN_JK3O7J_ADS_sca_2_OUT AS [ADS_sca_2_OUT]), 
[DT_node_data_11] AS 
(SELECT [Values].nid AS nid, CAST([Values].[P_0] AS FLOAT(53)) AS [P_0], CAST([Values].[P_1] AS FLOAT(53)) AS [P_1], CAST([Values].[D] AS FLOAT(53)) AS [D], CAST([Values].[DP] AS FLOAT(53)) AS [DP] 
FROM (SELECT 1 AS nid, 0.830022138012806 AS [P_0], 0.16997786198719406 AS [P_1], 0 AS [D], 0.830022138012806 AS [DP] UNION ALL SELECT 2 AS nid, 0.23034286101009635 AS [P_0], 0.7696571389899036 AS [P_1], 1 AS [D], 0.7696571389899036 AS [DP]) AS [Values]), 
[DT_Output_11] AS 
(SELECT [DT_node_lookup_11].[KEY] AS [KEY], [DT_node_lookup_11].node_id_2 AS node_id_2, [DT_node_data_11].nid AS nid, [DT_node_data_11].[P_0] AS [P_0], [DT_node_data_11].[P_1] AS [P_1], [DT_node_data_11].[D] AS [D], [DT_node_data_11].[DP] AS [DP] 
FROM [DT_node_lookup_11] LEFT OUTER JOIN [DT_node_data_11] ON [DT_node_lookup_11].node_id_2 = [DT_node_data_11].nid), 
[ADB_Model_11] AS 
(SELECT [DT_Output_11].[KEY] AS [KEY], (1.0 * (CASE WHEN ([DT_Output_11].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_11].[P_0] IS NULL OR [DT_Output_11].[P_0] > 0.0) THEN log([DT_Output_11].[P_0]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_11].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_11].[P_0] IS NULL OR [DT_Output_11].[P_0] > 0.0) THEN log([DT_Output_11].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_11].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_11].[P_1] IS NULL OR [DT_Output_11].[P_1] > 0.0) THEN log([DT_Output_11].[P_1]) ELSE -1.79769313486231e+308 END END) / 2)) / 16.0 AS [Score_0], 1.0 * (CASE WHEN ([DT_Output_11].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_11].[P_0] IS NULL OR [DT_Output_11].[P_0] > 0.0) THEN log([DT_Output_11].[P_0]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_11].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_11].[P_0] IS NULL OR [DT_Output_11].[P_0] > 0.0) THEN log([DT_Output_11].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_11].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_11].[P_1] IS NULL OR [DT_Output_11].[P_1] > 0.0) THEN log([DT_Output_11].[P_1]) ELSE -1.79769313486231e+308 END END) / 2) AS [Proba_0], (1.0 * (CASE WHEN ([DT_Output_11].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_11].[P_1] IS NULL OR [DT_Output_11].[P_1] > 0.0) THEN log([DT_Output_11].[P_1]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_11].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_11].[P_0] IS NULL OR [DT_Output_11].[P_0] > 0.0) THEN log([DT_Output_11].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_11].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_11].[P_1] IS NULL OR [DT_Output_11].[P_1] > 0.0) THEN log([DT_Output_11].[P_1]) ELSE -1.79769313486231e+308 END END) / 2)) / 16.0 AS [Score_1], 1.0 * (CASE WHEN ([DT_Output_11].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_11].[P_1] IS NULL OR [DT_Output_11].[P_1] > 0.0) THEN log([DT_Output_11].[P_1]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_11].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_11].[P_0] IS NULL OR [DT_Output_11].[P_0] > 0.0) THEN log([DT_Output_11].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_11].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_11].[P_1] IS NULL OR [DT_Output_11].[P_1] > 0.0) THEN log([DT_Output_11].[P_1]) ELSE -1.79769313486231e+308 END END) / 2) AS [Proba_1] 
FROM [DT_Output_11]), 
[DT_node_lookup_12] AS 
(SELECT [ADS_sca_2_OUT].[KEY] AS [KEY], CASE WHEN ([ADS_sca_2_OUT].scaler_8 <= 2.0757689476013184) THEN 1 ELSE 2 END AS node_id_2 
FROM ##TMP_20180516110109_CODEGEN_JK3O7J_ADS_sca_2_OUT AS [ADS_sca_2_OUT]), 
[DT_node_data_12] AS 
(SELECT [Values].nid AS nid, CAST([Values].[P_0] AS FLOAT(53)) AS [P_0], CAST([Values].[P_1] AS FLOAT(53)) AS [P_1], CAST([Values].[D] AS FLOAT(53)) AS [D], CAST([Values].[DP] AS FLOAT(53)) AS [DP] 
FROM (SELECT 1 AS nid, 0.2213514925087552 AS [P_0], 0.7786485074912447 AS [P_1], 1 AS [D], 0.7786485074912447 AS [DP] UNION ALL SELECT 2 AS nid, 0.9999999683578278 AS [P_0], 3.164217215806375e-08 AS [P_1], 0 AS [D], 0.9999999683578278 AS [DP]) AS [Values]), 
[DT_Output_12] AS 
(SELECT [DT_node_lookup_12].[KEY] AS [KEY], [DT_node_lookup_12].node_id_2 AS node_id_2, [DT_node_data_12].nid AS nid, [DT_node_data_12].[P_0] AS [P_0], [DT_node_data_12].[P_1] AS [P_1], [DT_node_data_12].[D] AS [D], [DT_node_data_12].[DP] AS [DP] 
FROM [DT_node_lookup_12] LEFT OUTER JOIN [DT_node_data_12] ON [DT_node_lookup_12].node_id_2 = [DT_node_data_12].nid), 
[ADB_Model_12] AS 
(SELECT [DT_Output_12].[KEY] AS [KEY], (1.0 * (CASE WHEN ([DT_Output_12].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_12].[P_0] IS NULL OR [DT_Output_12].[P_0] > 0.0) THEN log([DT_Output_12].[P_0]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_12].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_12].[P_0] IS NULL OR [DT_Output_12].[P_0] > 0.0) THEN log([DT_Output_12].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_12].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_12].[P_1] IS NULL OR [DT_Output_12].[P_1] > 0.0) THEN log([DT_Output_12].[P_1]) ELSE -1.79769313486231e+308 END END) / 2)) / 16.0 AS [Score_0], 1.0 * (CASE WHEN ([DT_Output_12].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_12].[P_0] IS NULL OR [DT_Output_12].[P_0] > 0.0) THEN log([DT_Output_12].[P_0]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_12].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_12].[P_0] IS NULL OR [DT_Output_12].[P_0] > 0.0) THEN log([DT_Output_12].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_12].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_12].[P_1] IS NULL OR [DT_Output_12].[P_1] > 0.0) THEN log([DT_Output_12].[P_1]) ELSE -1.79769313486231e+308 END END) / 2) AS [Proba_0], (1.0 * (CASE WHEN ([DT_Output_12].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_12].[P_1] IS NULL OR [DT_Output_12].[P_1] > 0.0) THEN log([DT_Output_12].[P_1]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_12].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_12].[P_0] IS NULL OR [DT_Output_12].[P_0] > 0.0) THEN log([DT_Output_12].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_12].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_12].[P_1] IS NULL OR [DT_Output_12].[P_1] > 0.0) THEN log([DT_Output_12].[P_1]) ELSE -1.79769313486231e+308 END END) / 2)) / 16.0 AS [Score_1], 1.0 * (CASE WHEN ([DT_Output_12].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_12].[P_1] IS NULL OR [DT_Output_12].[P_1] > 0.0) THEN log([DT_Output_12].[P_1]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_12].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_12].[P_0] IS NULL OR [DT_Output_12].[P_0] > 0.0) THEN log([DT_Output_12].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_12].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_12].[P_1] IS NULL OR [DT_Output_12].[P_1] > 0.0) THEN log([DT_Output_12].[P_1]) ELSE -1.79769313486231e+308 END END) / 2) AS [Proba_1] 
FROM [DT_Output_12]), 
[DT_node_lookup_13] AS 
(SELECT [ADS_sca_2_OUT].[KEY] AS [KEY], CASE WHEN ([ADS_sca_2_OUT].scaler_11 <= 0.07101128250360489) THEN 1 ELSE 2 END AS node_id_2 
FROM ##TMP_20180516110109_CODEGEN_JK3O7J_ADS_sca_2_OUT AS [ADS_sca_2_OUT]), 
[DT_node_data_13] AS 
(SELECT [Values].nid AS nid, CAST([Values].[P_0] AS FLOAT(53)) AS [P_0], CAST([Values].[P_1] AS FLOAT(53)) AS [P_1], CAST([Values].[D] AS FLOAT(53)) AS [D], CAST([Values].[DP] AS FLOAT(53)) AS [DP] 
FROM (SELECT 1 AS nid, 0.7033237601770923 AS [P_0], 0.29667623982290775 AS [P_1], 0 AS [D], 0.7033237601770923 AS [DP] UNION ALL SELECT 2 AS nid, 0.0003335168521824454 AS [P_0], 0.9996664831478175 AS [P_1], 1 AS [D], 0.9996664831478175 AS [DP]) AS [Values]), 
[DT_Output_13] AS 
(SELECT [DT_node_lookup_13].[KEY] AS [KEY], [DT_node_lookup_13].node_id_2 AS node_id_2, [DT_node_data_13].nid AS nid, [DT_node_data_13].[P_0] AS [P_0], [DT_node_data_13].[P_1] AS [P_1], [DT_node_data_13].[D] AS [D], [DT_node_data_13].[DP] AS [DP] 
FROM [DT_node_lookup_13] LEFT OUTER JOIN [DT_node_data_13] ON [DT_node_lookup_13].node_id_2 = [DT_node_data_13].nid), 
[ADB_Model_13] AS 
(SELECT [DT_Output_13].[KEY] AS [KEY], (1.0 * (CASE WHEN ([DT_Output_13].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_13].[P_0] IS NULL OR [DT_Output_13].[P_0] > 0.0) THEN log([DT_Output_13].[P_0]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_13].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_13].[P_0] IS NULL OR [DT_Output_13].[P_0] > 0.0) THEN log([DT_Output_13].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_13].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_13].[P_1] IS NULL OR [DT_Output_13].[P_1] > 0.0) THEN log([DT_Output_13].[P_1]) ELSE -1.79769313486231e+308 END END) / 2)) / 16.0 AS [Score_0], 1.0 * (CASE WHEN ([DT_Output_13].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_13].[P_0] IS NULL OR [DT_Output_13].[P_0] > 0.0) THEN log([DT_Output_13].[P_0]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_13].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_13].[P_0] IS NULL OR [DT_Output_13].[P_0] > 0.0) THEN log([DT_Output_13].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_13].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_13].[P_1] IS NULL OR [DT_Output_13].[P_1] > 0.0) THEN log([DT_Output_13].[P_1]) ELSE -1.79769313486231e+308 END END) / 2) AS [Proba_0], (1.0 * (CASE WHEN ([DT_Output_13].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_13].[P_1] IS NULL OR [DT_Output_13].[P_1] > 0.0) THEN log([DT_Output_13].[P_1]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_13].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_13].[P_0] IS NULL OR [DT_Output_13].[P_0] > 0.0) THEN log([DT_Output_13].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_13].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_13].[P_1] IS NULL OR [DT_Output_13].[P_1] > 0.0) THEN log([DT_Output_13].[P_1]) ELSE -1.79769313486231e+308 END END) / 2)) / 16.0 AS [Score_1], 1.0 * (CASE WHEN ([DT_Output_13].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_13].[P_1] IS NULL OR [DT_Output_13].[P_1] > 0.0) THEN log([DT_Output_13].[P_1]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_13].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_13].[P_0] IS NULL OR [DT_Output_13].[P_0] > 0.0) THEN log([DT_Output_13].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_13].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_13].[P_1] IS NULL OR [DT_Output_13].[P_1] > 0.0) THEN log([DT_Output_13].[P_1]) ELSE -1.79769313486231e+308 END END) / 2) AS [Proba_1] 
FROM [DT_Output_13]), 
[DT_node_lookup_14] AS 
(SELECT [ADS_sca_2_OUT].[KEY] AS [KEY], CASE WHEN ([ADS_sca_2_OUT].scaler_7 <= -0.8025482296943665) THEN 1 ELSE 2 END AS node_id_2 
FROM ##TMP_20180516110109_CODEGEN_JK3O7J_ADS_sca_2_OUT AS [ADS_sca_2_OUT]), 
[DT_node_data_14] AS 
(SELECT [Values].nid AS nid, CAST([Values].[P_0] AS FLOAT(53)) AS [P_0], CAST([Values].[P_1] AS FLOAT(53)) AS [P_1], CAST([Values].[D] AS FLOAT(53)) AS [D], CAST([Values].[DP] AS FLOAT(53)) AS [DP] 
FROM (SELECT 1 AS nid, 6.453671167401752e-05 AS [P_0], 0.9999354632883259 AS [P_1], 1 AS [D], 0.9999354632883259 AS [DP] UNION ALL SELECT 2 AS nid, 0.9837315462867782 AS [P_0], 0.016268453713221828 AS [P_1], 0 AS [D], 0.9837315462867782 AS [DP]) AS [Values]), 
[DT_Output_14] AS 
(SELECT [DT_node_lookup_14].[KEY] AS [KEY], [DT_node_lookup_14].node_id_2 AS node_id_2, [DT_node_data_14].nid AS nid, [DT_node_data_14].[P_0] AS [P_0], [DT_node_data_14].[P_1] AS [P_1], [DT_node_data_14].[D] AS [D], [DT_node_data_14].[DP] AS [DP] 
FROM [DT_node_lookup_14] LEFT OUTER JOIN [DT_node_data_14] ON [DT_node_lookup_14].node_id_2 = [DT_node_data_14].nid), 
[ADB_Model_14] AS 
(SELECT [DT_Output_14].[KEY] AS [KEY], (1.0 * (CASE WHEN ([DT_Output_14].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_14].[P_0] IS NULL OR [DT_Output_14].[P_0] > 0.0) THEN log([DT_Output_14].[P_0]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_14].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_14].[P_0] IS NULL OR [DT_Output_14].[P_0] > 0.0) THEN log([DT_Output_14].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_14].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_14].[P_1] IS NULL OR [DT_Output_14].[P_1] > 0.0) THEN log([DT_Output_14].[P_1]) ELSE -1.79769313486231e+308 END END) / 2)) / 16.0 AS [Score_0], 1.0 * (CASE WHEN ([DT_Output_14].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_14].[P_0] IS NULL OR [DT_Output_14].[P_0] > 0.0) THEN log([DT_Output_14].[P_0]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_14].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_14].[P_0] IS NULL OR [DT_Output_14].[P_0] > 0.0) THEN log([DT_Output_14].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_14].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_14].[P_1] IS NULL OR [DT_Output_14].[P_1] > 0.0) THEN log([DT_Output_14].[P_1]) ELSE -1.79769313486231e+308 END END) / 2) AS [Proba_0], (1.0 * (CASE WHEN ([DT_Output_14].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_14].[P_1] IS NULL OR [DT_Output_14].[P_1] > 0.0) THEN log([DT_Output_14].[P_1]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_14].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_14].[P_0] IS NULL OR [DT_Output_14].[P_0] > 0.0) THEN log([DT_Output_14].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_14].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_14].[P_1] IS NULL OR [DT_Output_14].[P_1] > 0.0) THEN log([DT_Output_14].[P_1]) ELSE -1.79769313486231e+308 END END) / 2)) / 16.0 AS [Score_1], 1.0 * (CASE WHEN ([DT_Output_14].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_14].[P_1] IS NULL OR [DT_Output_14].[P_1] > 0.0) THEN log([DT_Output_14].[P_1]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_14].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_14].[P_0] IS NULL OR [DT_Output_14].[P_0] > 0.0) THEN log([DT_Output_14].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_14].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_14].[P_1] IS NULL OR [DT_Output_14].[P_1] > 0.0) THEN log([DT_Output_14].[P_1]) ELSE -1.79769313486231e+308 END END) / 2) AS [Proba_1] 
FROM [DT_Output_14]), 
[DT_node_lookup_15] AS 
(SELECT [ADS_sca_2_OUT].[KEY] AS [KEY], CASE WHEN ([ADS_sca_2_OUT].scaler_11 <= 0.07101128250360489) THEN 1 ELSE 2 END AS node_id_2 
FROM ##TMP_20180516110109_CODEGEN_JK3O7J_ADS_sca_2_OUT AS [ADS_sca_2_OUT]), 
[DT_node_data_15] AS 
(SELECT [Values].nid AS nid, CAST([Values].[P_0] AS FLOAT(53)) AS [P_0], CAST([Values].[P_1] AS FLOAT(53)) AS [P_1], CAST([Values].[D] AS FLOAT(53)) AS [D], CAST([Values].[DP] AS FLOAT(53)) AS [DP] 
FROM (SELECT 1 AS nid, 0.9165938602543394 AS [P_0], 0.08340613974566062 AS [P_1], 0 AS [D], 0.9165938602543394 AS [DP] UNION ALL SELECT 2 AS nid, 0.016294580962179877 AS [P_0], 0.9837054190378202 AS [P_1], 1 AS [D], 0.9837054190378202 AS [DP]) AS [Values]), 
[DT_Output_15] AS 
(SELECT [DT_node_lookup_15].[KEY] AS [KEY], [DT_node_lookup_15].node_id_2 AS node_id_2, [DT_node_data_15].nid AS nid, [DT_node_data_15].[P_0] AS [P_0], [DT_node_data_15].[P_1] AS [P_1], [DT_node_data_15].[D] AS [D], [DT_node_data_15].[DP] AS [DP] 
FROM [DT_node_lookup_15] LEFT OUTER JOIN [DT_node_data_15] ON [DT_node_lookup_15].node_id_2 = [DT_node_data_15].nid), 
[ADB_Model_15] AS 
(SELECT [DT_Output_15].[KEY] AS [KEY], (1.0 * (CASE WHEN ([DT_Output_15].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_15].[P_0] IS NULL OR [DT_Output_15].[P_0] > 0.0) THEN log([DT_Output_15].[P_0]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_15].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_15].[P_0] IS NULL OR [DT_Output_15].[P_0] > 0.0) THEN log([DT_Output_15].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_15].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_15].[P_1] IS NULL OR [DT_Output_15].[P_1] > 0.0) THEN log([DT_Output_15].[P_1]) ELSE -1.79769313486231e+308 END END) / 2)) / 16.0 AS [Score_0], 1.0 * (CASE WHEN ([DT_Output_15].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_15].[P_0] IS NULL OR [DT_Output_15].[P_0] > 0.0) THEN log([DT_Output_15].[P_0]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_15].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_15].[P_0] IS NULL OR [DT_Output_15].[P_0] > 0.0) THEN log([DT_Output_15].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_15].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_15].[P_1] IS NULL OR [DT_Output_15].[P_1] > 0.0) THEN log([DT_Output_15].[P_1]) ELSE -1.79769313486231e+308 END END) / 2) AS [Proba_0], (1.0 * (CASE WHEN ([DT_Output_15].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_15].[P_1] IS NULL OR [DT_Output_15].[P_1] > 0.0) THEN log([DT_Output_15].[P_1]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_15].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_15].[P_0] IS NULL OR [DT_Output_15].[P_0] > 0.0) THEN log([DT_Output_15].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_15].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_15].[P_1] IS NULL OR [DT_Output_15].[P_1] > 0.0) THEN log([DT_Output_15].[P_1]) ELSE -1.79769313486231e+308 END END) / 2)) / 16.0 AS [Score_1], 1.0 * (CASE WHEN ([DT_Output_15].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_15].[P_1] IS NULL OR [DT_Output_15].[P_1] > 0.0) THEN log([DT_Output_15].[P_1]) ELSE -1.79769313486231e+308 END END - (CASE WHEN ([DT_Output_15].[P_0] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_15].[P_0] IS NULL OR [DT_Output_15].[P_0] > 0.0) THEN log([DT_Output_15].[P_0]) ELSE -1.79769313486231e+308 END END + CASE WHEN ([DT_Output_15].[P_1] <= 2.22044604925e-16) THEN -36.043653389117296 ELSE CASE WHEN ([DT_Output_15].[P_1] IS NULL OR [DT_Output_15].[P_1] > 0.0) THEN log([DT_Output_15].[P_1]) ELSE -1.79769313486231e+308 END END) / 2) AS [Proba_1] 
FROM [DT_Output_15])
 INSERT INTO ##TMP_20180516110109_CODEGEN_X20H5Y_ADB_B1 ([KEY], [Score_0], [Proba_0], [Score_1], [Proba_1]) SELECT [ADB_B1].[KEY], [ADB_B1].[Score_0], [ADB_B1].[Proba_0], [ADB_B1].[Score_1], [ADB_B1].[Proba_1] 
FROM (SELECT [ADB_esu_1].[KEY] AS [KEY], [ADB_esu_1].[Score_0] AS [Score_0], [ADB_esu_1].[Proba_0] AS [Proba_0], [ADB_esu_1].[Score_1] AS [Score_1], [ADB_esu_1].[Proba_1] AS [Proba_1] 
FROM (SELECT [ADB_Model_10].[KEY] AS [KEY], [ADB_Model_10].[Score_0] AS [Score_0], [ADB_Model_10].[Proba_0] AS [Proba_0], [ADB_Model_10].[Score_1] AS [Score_1], [ADB_Model_10].[Proba_1] AS [Proba_1] 
FROM [ADB_Model_10] UNION ALL SELECT [ADB_Model_11].[KEY] AS [KEY], [ADB_Model_11].[Score_0] AS [Score_0], [ADB_Model_11].[Proba_0] AS [Proba_0], [ADB_Model_11].[Score_1] AS [Score_1], [ADB_Model_11].[Proba_1] AS [Proba_1] 
FROM [ADB_Model_11] UNION ALL SELECT [ADB_Model_12].[KEY] AS [KEY], [ADB_Model_12].[Score_0] AS [Score_0], [ADB_Model_12].[Proba_0] AS [Proba_0], [ADB_Model_12].[Score_1] AS [Score_1], [ADB_Model_12].[Proba_1] AS [Proba_1] 
FROM [ADB_Model_12] UNION ALL SELECT [ADB_Model_13].[KEY] AS [KEY], [ADB_Model_13].[Score_0] AS [Score_0], [ADB_Model_13].[Proba_0] AS [Proba_0], [ADB_Model_13].[Score_1] AS [Score_1], [ADB_Model_13].[Proba_1] AS [Proba_1] 
FROM [ADB_Model_13] UNION ALL SELECT [ADB_Model_14].[KEY] AS [KEY], [ADB_Model_14].[Score_0] AS [Score_0], [ADB_Model_14].[Proba_0] AS [Proba_0], [ADB_Model_14].[Score_1] AS [Score_1], [ADB_Model_14].[Proba_1] AS [Proba_1] 
FROM [ADB_Model_14] UNION ALL SELECT [ADB_Model_15].[KEY] AS [KEY], [ADB_Model_15].[Score_0] AS [Score_0], [ADB_Model_15].[Proba_0] AS [Proba_0], [ADB_Model_15].[Score_1] AS [Score_1], [ADB_Model_15].[Proba_1] AS [Proba_1] 
FROM [ADB_Model_15]) AS [ADB_esu_1]) AS [ADB_B1]

-- Code For temporary table ##TMP_20180516110109_CODEGEN_2OHH4Z_ADB_sum part 1. Create 


CREATE TABLE ##TMP_20180516110109_CODEGEN_2OHH4Z_ADB_sum (
	[KEY] BIGINT NULL, 
	[Score_0] FLOAT(53) NULL, 
	[Proba_0] FLOAT(53) NULL, 
	[Score_1] FLOAT(53) NULL, 
	[Proba_1] FLOAT(53) NULL
)



-- Code For temporary table ##TMP_20180516110109_CODEGEN_2OHH4Z_ADB_sum part 2. Populate

WITH [ADB_Union] AS 
(SELECT [ADB_EnsembleUnion].[KEY] AS [KEY], [ADB_EnsembleUnion].[Score_0] AS [Score_0], [ADB_EnsembleUnion].[Proba_0] AS [Proba_0], [ADB_EnsembleUnion].[Score_1] AS [Score_1], [ADB_EnsembleUnion].[Proba_1] AS [Proba_1] 
FROM (SELECT [ADB_B0].[KEY] AS [KEY], [ADB_B0].[Score_0] AS [Score_0], [ADB_B0].[Proba_0] AS [Proba_0], [ADB_B0].[Score_1] AS [Score_1], [ADB_B0].[Proba_1] AS [Proba_1] 
FROM ##TMP_20180516110109_CODEGEN_MUU3DZ_ADB_B0 AS [ADB_B0] UNION ALL SELECT [ADB_B1].[KEY] AS [KEY], [ADB_B1].[Score_0] AS [Score_0], [ADB_B1].[Proba_0] AS [Proba_0], [ADB_B1].[Score_1] AS [Score_1], [ADB_B1].[Proba_1] AS [Proba_1] 
FROM ##TMP_20180516110109_CODEGEN_X20H5Y_ADB_B1 AS [ADB_B1]) AS [ADB_EnsembleUnion])
 INSERT INTO ##TMP_20180516110109_CODEGEN_2OHH4Z_ADB_sum ([KEY], [Score_0], [Proba_0], [Score_1], [Proba_1]) SELECT [ADB_sum].[KEY], [ADB_sum].[Score_0], [ADB_sum].[Proba_0], [ADB_sum].[Score_1], [ADB_sum].[Proba_1] 
FROM (SELECT [T].[KEY] AS [KEY], CAST([T].[Score_0] AS FLOAT(53)) AS [Score_0], CAST([T].[Proba_0] AS FLOAT(53)) AS [Proba_0], CAST([T].[Score_1] AS FLOAT(53)) AS [Score_1], CAST([T].[Proba_1] AS FLOAT(53)) AS [Proba_1] 
FROM (SELECT [ADB_Union].[KEY] AS [KEY], sum([ADB_Union].[Score_0]) AS [Score_0], sum([ADB_Union].[Proba_0]) AS [Proba_0], sum([ADB_Union].[Score_1]) AS [Score_1], sum([ADB_Union].[Proba_1]) AS [Proba_1] 
FROM [ADB_Union] GROUP BY [ADB_Union].[KEY]) AS [T]) AS [ADB_sum]

-- Model deployment code

WITH [AdaBoost_AVG_Scores_BN] AS 
(SELECT [ADB_sum].[KEY] AS [KEY], [ADB_sum].[Score_0] AS [Score_0], [ADB_sum].[Proba_0] AS [Proba_0], [ADB_sum].[Score_1] AS [Score_1], [ADB_sum].[Proba_1] AS [Proba_1] 
FROM ##TMP_20180516110109_CODEGEN_2OHH4Z_ADB_sum AS [ADB_sum]), 
[AdaBoost_AVG_Scores] AS 
(SELECT [AdaBoost_AVG_Scores_BN].[KEY] AS [KEY], -([AdaBoost_AVG_Scores_BN].[Score_1] - [AdaBoost_AVG_Scores_BN].[Score_0]) AS [Score_0], exp(([AdaBoost_AVG_Scores_BN].[Proba_0] / 16.0) / 1) / (exp(([AdaBoost_AVG_Scores_BN].[Proba_0] / 16.0) / 1) + exp(([AdaBoost_AVG_Scores_BN].[Proba_1] / 16.0) / 1)) AS [Proba_0], CAST(NULL AS FLOAT(53)) AS [LogProba_0], [AdaBoost_AVG_Scores_BN].[Score_1] - [AdaBoost_AVG_Scores_BN].[Score_0] AS [Score_1], exp(([AdaBoost_AVG_Scores_BN].[Proba_1] / 16.0) / 1) / (exp(([AdaBoost_AVG_Scores_BN].[Proba_0] / 16.0) / 1) + exp(([AdaBoost_AVG_Scores_BN].[Proba_1] / 16.0) / 1)) AS [Proba_1], CAST(NULL AS FLOAT(53)) AS [LogProba_1] 
FROM [AdaBoost_AVG_Scores_BN]), 
orig_cte AS 
(SELECT [AdaBoost_AVG_Scores].[KEY] AS [KEY], [AdaBoost_AVG_Scores].[Score_0] AS [Score_0], [AdaBoost_AVG_Scores].[Score_1] AS [Score_1], [AdaBoost_AVG_Scores].[Proba_0] AS [Proba_0], [AdaBoost_AVG_Scores].[Proba_1] AS [Proba_1], [AdaBoost_AVG_Scores].[LogProba_0] AS [LogProba_0], [AdaBoost_AVG_Scores].[LogProba_1] AS [LogProba_1], CAST(NULL AS BIGINT) AS [Decision], CAST(NULL AS FLOAT(53)) AS [DecisionProba] 
FROM [AdaBoost_AVG_Scores]), 
score_class_union AS 
(SELECT scu.[KEY_u] AS [KEY_u], scu.class AS class, scu.[LogProba] AS [LogProba], scu.[Proba] AS [Proba], scu.[Score] AS [Score] 
FROM (SELECT orig_cte.[KEY] AS [KEY_u], 0 AS class, orig_cte.[LogProba_0] AS [LogProba], orig_cte.[Proba_0] AS [Proba], orig_cte.[Score_0] AS [Score] 
FROM orig_cte UNION ALL SELECT orig_cte.[KEY] AS [KEY_u], 1 AS class, orig_cte.[LogProba_1] AS [LogProba], orig_cte.[Proba_1] AS [Proba], orig_cte.[Score_1] AS [Score] 
FROM orig_cte) AS scu), 
score_max AS 
(SELECT orig_cte.[KEY] AS [KEY], orig_cte.[Score_0] AS [Score_0], orig_cte.[Score_1] AS [Score_1], orig_cte.[Proba_0] AS [Proba_0], orig_cte.[Proba_1] AS [Proba_1], orig_cte.[LogProba_0] AS [LogProba_0], orig_cte.[LogProba_1] AS [LogProba_1], orig_cte.[Decision] AS [Decision], orig_cte.[DecisionProba] AS [DecisionProba], max_select.[KEY_m] AS [KEY_m], max_select.[max_Score] AS [max_Score] 
FROM orig_cte LEFT OUTER JOIN (SELECT score_class_union.[KEY_u] AS [KEY_m], max(score_class_union.[Score]) AS [max_Score] 
FROM score_class_union GROUP BY score_class_union.[KEY_u]) AS max_select ON orig_cte.[KEY] = max_select.[KEY_m]), 
union_with_max AS 
(SELECT score_class_union.[KEY_u] AS [KEY_u], score_class_union.class AS class, score_class_union.[LogProba] AS [LogProba], score_class_union.[Proba] AS [Proba], score_class_union.[Score] AS [Score], score_max.[KEY] AS [KEY], score_max.[Score_0] AS [Score_0], score_max.[Score_1] AS [Score_1], score_max.[Proba_0] AS [Proba_0], score_max.[Proba_1] AS [Proba_1], score_max.[LogProba_0] AS [LogProba_0], score_max.[LogProba_1] AS [LogProba_1], score_max.[Decision] AS [Decision], score_max.[DecisionProba] AS [DecisionProba], score_max.[KEY_m] AS [KEY_m], score_max.[max_Score] AS [max_Score] 
FROM score_class_union LEFT OUTER JOIN score_max ON score_class_union.[KEY_u] = score_max.[KEY]), 
arg_max_cte AS 
(SELECT score_max.[KEY] AS [KEY], score_max.[Score_0] AS [Score_0], score_max.[Score_1] AS [Score_1], score_max.[Proba_0] AS [Proba_0], score_max.[Proba_1] AS [Proba_1], score_max.[LogProba_0] AS [LogProba_0], score_max.[LogProba_1] AS [LogProba_1], score_max.[Decision] AS [Decision], score_max.[DecisionProba] AS [DecisionProba], score_max.[KEY_m] AS [KEY_m], score_max.[max_Score] AS [max_Score], [arg_max_t_Score].[KEY_Score] AS [KEY_Score], [arg_max_t_Score].[arg_max_Score] AS [arg_max_Score] 
FROM score_max LEFT OUTER JOIN (SELECT union_with_max.[KEY] AS [KEY_Score], min(union_with_max.class) AS [arg_max_Score] 
FROM union_with_max 
WHERE union_with_max.[max_Score] <= union_with_max.[Score] GROUP BY union_with_max.[KEY]) AS [arg_max_t_Score] ON score_max.[KEY] = [arg_max_t_Score].[KEY_Score])
 SELECT arg_max_cte.[KEY] AS [KEY], arg_max_cte.[Score_0] AS [Score_0], arg_max_cte.[Score_1] AS [Score_1], arg_max_cte.[Proba_0] AS [Proba_0], arg_max_cte.[Proba_1] AS [Proba_1], CASE WHEN (arg_max_cte.[Proba_0] IS NULL OR arg_max_cte.[Proba_0] > 0.0) THEN log(arg_max_cte.[Proba_0]) ELSE -1.79769313486231e+308 END AS [LogProba_0], CASE WHEN (arg_max_cte.[Proba_1] IS NULL OR arg_max_cte.[Proba_1] > 0.0) THEN log(arg_max_cte.[Proba_1]) ELSE -1.79769313486231e+308 END AS [LogProba_1], arg_max_cte.[arg_max_Score] AS [Decision], CASE WHEN (arg_max_cte.[arg_max_Score] = 0) THEN arg_max_cte.[Proba_0] WHEN (arg_max_cte.[arg_max_Score] = 1) THEN arg_max_cte.[Proba_1] END AS [DecisionProba] 
FROM arg_max_cte