-- This SQL code was generated by sklearn2sql (development version).
-- Copyright 2018

-- Model : SVC_linear_Pipeline
-- Dataset : FourClass_10
-- Database : db2


-- This SQL code can contain one or more statements, to be executed in the order they appear in this file.



-- Code For temporary table tmp_20180602143441_vxr_ads_imp_1_out part 1. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180602143441_vxr_ads_imp_1_out (
	"KEY" BIGINT, 
	impter_2 DOUBLE, 
	impter_3 DOUBLE, 
	impter_4 DOUBLE, 
	impter_5 DOUBLE, 
	impter_6 DOUBLE, 
	impter_7 DOUBLE, 
	impter_8 DOUBLE, 
	impter_9 DOUBLE, 
	impter_10 DOUBLE, 
	impter_11 DOUBLE
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180602143441_vxr_ads_imp_1_out part 2. Populate

INSERT INTO tmp_20180602143441_vxr_ads_imp_1_out SELECT "ADS_imp_1_OUT"."KEY", "ADS_imp_1_OUT".impter_2, "ADS_imp_1_OUT".impter_3, "ADS_imp_1_OUT".impter_4, "ADS_imp_1_OUT".impter_5, "ADS_imp_1_OUT".impter_6, "ADS_imp_1_OUT".impter_7, "ADS_imp_1_OUT".impter_8, "ADS_imp_1_OUT".impter_9, "ADS_imp_1_OUT".impter_10, "ADS_imp_1_OUT".impter_11 
FROM (SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_0" IS NULL) THEN -0.003903374463034205 ELSE "ADS"."Feature_0" END AS impter_2, CASE WHEN ("ADS"."Feature_1" IS NULL) THEN 0.6152232215702322 ELSE "ADS"."Feature_1" END AS impter_3, CASE WHEN ("ADS"."Feature_2" IS NULL) THEN 0.042796236914291665 ELSE "ADS"."Feature_2" END AS impter_4, CASE WHEN ("ADS"."Feature_3" IS NULL) THEN 0.7709819558904074 ELSE "ADS"."Feature_3" END AS impter_5, CASE WHEN ("ADS"."Feature_4" IS NULL) THEN -0.43300733624893334 ELSE "ADS"."Feature_4" END AS impter_6, CASE WHEN ("ADS"."Feature_5" IS NULL) THEN -0.0424956965794036 ELSE "ADS"."Feature_5" END AS impter_7, CASE WHEN ("ADS"."Feature_6" IS NULL) THEN -0.29809080119845455 ELSE "ADS"."Feature_6" END AS impter_8, CASE WHEN ("ADS"."Feature_7" IS NULL) THEN 0.14672241507251663 ELSE "ADS"."Feature_7" END AS impter_9, CASE WHEN ("ADS"."Feature_8" IS NULL) THEN 0.01746942384662034 ELSE "ADS"."Feature_8" END AS impter_10, CASE WHEN ("ADS"."Feature_9" IS NULL) THEN 0.11507331415602866 ELSE "ADS"."Feature_9" END AS impter_11 
FROM "FOURCLASS_10" AS "ADS") AS "ADS_imp_1_OUT"

-- Code For temporary table tmp_20180602143441_2qt_ads_sca_2_out part 1. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180602143441_2qt_ads_sca_2_out (
	"KEY" BIGINT, 
	scaler_2 DOUBLE, 
	scaler_3 DOUBLE, 
	scaler_4 DOUBLE, 
	scaler_5 DOUBLE, 
	scaler_6 DOUBLE, 
	scaler_7 DOUBLE, 
	scaler_8 DOUBLE, 
	scaler_9 DOUBLE, 
	scaler_10 DOUBLE, 
	scaler_11 DOUBLE
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180602143441_2qt_ads_sca_2_out part 2. Populate

INSERT INTO tmp_20180602143441_2qt_ads_sca_2_out SELECT "ADS_sca_2_OUT"."KEY", "ADS_sca_2_OUT".scaler_2, "ADS_sca_2_OUT".scaler_3, "ADS_sca_2_OUT".scaler_4, "ADS_sca_2_OUT".scaler_5, "ADS_sca_2_OUT".scaler_6, "ADS_sca_2_OUT".scaler_7, "ADS_sca_2_OUT".scaler_8, "ADS_sca_2_OUT".scaler_9, "ADS_sca_2_OUT".scaler_10, "ADS_sca_2_OUT".scaler_11 
FROM (SELECT "ADS_imp_1_OUT"."KEY" AS "KEY", (CAST("ADS_imp_1_OUT".impter_2 AS DOUBLE) - -0.003903374463034205) / 0.9795060640183997 AS scaler_2, (CAST("ADS_imp_1_OUT".impter_3 AS DOUBLE) - 0.6152232215702322) / 1.3900807236205235 AS scaler_3, (CAST("ADS_imp_1_OUT".impter_4 AS DOUBLE) - 0.042796236914291665) / 1.4962685135870766 AS scaler_4, (CAST("ADS_imp_1_OUT".impter_5 AS DOUBLE) - 0.7709819558904074) / 2.3333561060111743 AS scaler_5, (CAST("ADS_imp_1_OUT".impter_6 AS DOUBLE) - -0.43300733624893334) / 1.4029757772648748 AS scaler_6, (CAST("ADS_imp_1_OUT".impter_7 AS DOUBLE) - -0.0424956965794036) / 0.9558091076873229 AS scaler_7, (CAST("ADS_imp_1_OUT".impter_8 AS DOUBLE) - -0.29809080119845455) / 1.017013180721433 AS scaler_8, (CAST("ADS_imp_1_OUT".impter_9 AS DOUBLE) - 0.14672241507251663) / 1.600798539929603 AS scaler_9, (CAST("ADS_imp_1_OUT".impter_10 AS DOUBLE) - 0.01746942384662034) / 1.1487296361671415 AS scaler_10, (CAST("ADS_imp_1_OUT".impter_11 AS DOUBLE) - 0.11507331415602866) / 0.9690911857336224 AS scaler_11 
FROM tmp_20180602143441_vxr_ads_imp_1_out AS "ADS_imp_1_OUT") AS "ADS_sca_2_OUT"

-- Code For temporary table tmp_20180602143441_ndz_kernagg_b0 part 1. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180602143441_ndz_kernagg_b0 (
	"KEY" BIGINT, 
	"OVO_Class1" BIGINT, 
	"OVO_Class2" BIGINT, 
	"OVO_Decision" BIGINT, 
	"OVO_Conf" DOUBLE
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180602143441_ndz_kernagg_b0 part 2. Populate

INSERT INTO tmp_20180602143441_ndz_kernagg_b0 WITH kernel_input AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CAST("ADS_sca_2_OUT".scaler_2 AS DOUBLE) AS scaler_2, CAST("ADS_sca_2_OUT".scaler_3 AS DOUBLE) AS scaler_3, CAST("ADS_sca_2_OUT".scaler_4 AS DOUBLE) AS scaler_4, CAST("ADS_sca_2_OUT".scaler_5 AS DOUBLE) AS scaler_5, CAST("ADS_sca_2_OUT".scaler_6 AS DOUBLE) AS scaler_6, CAST("ADS_sca_2_OUT".scaler_7 AS DOUBLE) AS scaler_7, CAST("ADS_sca_2_OUT".scaler_8 AS DOUBLE) AS scaler_8, CAST("ADS_sca_2_OUT".scaler_9 AS DOUBLE) AS scaler_9, CAST("ADS_sca_2_OUT".scaler_10 AS DOUBLE) AS scaler_10, CAST("ADS_sca_2_OUT".scaler_11 AS DOUBLE) AS scaler_11 
FROM tmp_20180602143441_2qt_ads_sca_2_out AS "ADS_sca_2_OUT"), 
"SV_data_0_1" AS 
(SELECT "Values".sv_idx AS sv_idx, CAST("Values".dual_coeff AS DOUBLE) AS dual_coeff, CAST("Values".sv_0 AS DOUBLE) AS sv_0, CAST("Values".sv_1 AS DOUBLE) AS sv_1, CAST("Values".sv_2 AS DOUBLE) AS sv_2, CAST("Values".sv_3 AS DOUBLE) AS sv_3, CAST("Values".sv_4 AS DOUBLE) AS sv_4, CAST("Values".sv_5 AS DOUBLE) AS sv_5, CAST("Values".sv_6 AS DOUBLE) AS sv_6, CAST("Values".sv_7 AS DOUBLE) AS sv_7, CAST("Values".sv_8 AS DOUBLE) AS sv_8, CAST("Values".sv_9 AS DOUBLE) AS sv_9 
FROM (SELECT 0 AS sv_idx, 0.7624191345462945 AS dual_coeff, 0.9714093888112304 AS sv_0, -1.1362862709591603 AS sv_1, 1.4121646810839101 AS sv_2, 0.16748694582255716 AS sv_3, 1.919129112546945 AS sv_4, -1.3816843324216765 AS sv_5, -0.264450213574542 AS sv_6, 0.5734893436019516 AS sv_7, -0.8001824570648544 AS sv_8, 0.5312588986282071 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 1 AS sv_idx, 0.0 AS dual_coeff, 0.5155181451371881 AS sv_0, -0.8714698092700448 AS sv_1, -0.24389322910487762 AS sv_2, -0.7991387414972061 AS sv_3, -0.18581083474468457 AS sv_4, -0.023588682037116185 AS sv_5, 0.6986600728081974 AS sv_6, -0.6135893124459777 AS sv_7, 0.2006481214834177 AS sv_8, 2.5794740486698324 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 2 AS sv_idx, 0.05493970289107962 AS dual_coeff, 0.7512981458283388 AS sv_0, -0.9149828300753567 AS sv_1, 0.2852823045034491 AS sv_2, -0.11558803226776675 AS sv_3, 0.24748912034828158 AS sv_4, 0.28654936422754373 AS sv_5, -0.07524606808095237 AS sv_6, 0.5729190266147256 AS sv_7, 0.6858859078443724 AS sv_8, -0.620232456039194 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 3 AS sv_idx, 0.0 AS dual_coeff, -0.7724118389110615 AS sv_0, -1.523108404513254 AS sv_1, -0.06934453307085123 AS sv_2, -0.8222931132740179 AS sv_3, 0.6337346825309558 AS sv_4, 0.18651831067623925 AS sv_5, 0.5994429231757117 AS sv_6, 0.26611650190454433 AS sv_7, -0.4332155471305799 AS sv_8, -0.0021916563910858184 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 4 AS sv_idx, 0.20587919811406885 AS dual_coeff, -1.6525901403740733 AS sv_0, -0.9890732087979381 AS sv_1, -0.342927413635955 AS sv_2, -0.4790906384194392 AS sv_3, -0.5256139818544308 AS sv_4, 0.9495403665210237 AS sv_5, 0.2362342026029566 AS sv_6, 0.3712062131271089 AS sv_7, -0.8665466719556469 AS sv_8, -0.2548238481870406 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 5 AS sv_idx, 0.0 AS dual_coeff, 0.781312822280884 AS sv_0, 0.6347829483833167 AS sv_1, -0.9041192391704674 AS sv_2, -0.9300186648244536 AS sv_3, 1.326891768298379 AS sv_4, 0.13188542176567378 AS sv_5, 1.2923759777877002 AS sv_6, -1.2673209344092986 AS sv_7, 0.5635183958191062 AS sv_8, 1.1924250826103184 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 6 AS sv_idx, 0.0 AS dual_coeff, 0.3750056424765156 AS sv_0, 0.08839156664387353 AS sv_1, -1.1500997262003088 AS sv_2, -0.7106948912048624 AS sv_3, 0.8214637945754517 AS sv_4, 0.02765690710297472 AS sv_5, 0.802492887609131 AS sv_6, 0.17755366813131324 AS sv_7, 0.5203126451539958 AS sv_8, -0.3473398360786861 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 7 AS sv_idx, 0.40858778201178964 AS dual_coeff, -2.04390942155231 AS sv_0, 1.6045476968164614 AS sv_1, -1.6078018561905978 AS sv_2, -0.8553322073826393 AS sv_3, 1.9483185006626593 AS sv_4, -1.193969085208424 AS sv_5, 1.4233791815648011 AS sv_6, -1.001496133180198 AS sv_7, 2.6578500028699037 AS sv_8, 0.22383740962764367 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 8 AS sv_idx, 0.0 AS dual_coeff, -0.9008243879031689 AS sv_0, -0.7058080155207507 AS sv_1, -0.1954871267874386 AS sv_2, -0.14288199830722706 AS sv_3, 0.7337440799607109 AS sv_4, -0.37261544979685357 AS sv_5, -0.018101107213572498 AS sv_6, 1.1757591626798987 AS sv_7, -0.7275765325824345 AS sv_8, -1.4838347842326305 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 9 AS sv_idx, 0.11548560314166775 AS dual_coeff, 1.6205372377548237 AS sv_0, 0.24588358170973168 AS sv_1, 0.17361682358299016 AS sv_2, -0.8594167963741567 AS sv_3, 1.0360197969314284 AS sv_4, -0.22808201831799044 AS sv_5, 1.2154111271626897 AS sv_6, -2.3575145129167856 AS sv_7, -0.23125451691989812 AS sv_8, 1.1072978105948121 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 10 AS sv_idx, 0.4484873110118266 AS dual_coeff, -2.0463565761467315 AS sv_0, 0.021854712922967697 AS sv_1, -0.45913908750371657 AS sv_2, -0.2644863625352091 AS sv_3, 1.4146860438861666 AS sv_4, -0.25484644833947895 AS sv_5, 0.346076492554258 AS sv_6, 0.6033426931850794 AS sv_7, 0.6694726458182755 AS sv_8, 1.293706733667843 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 11 AS sv_idx, 0.0 AS dual_coeff, 2.873564244275373 AS sv_0, -0.5872911114054795 AS sv_1, -1.036220513213831 AS sv_2, -1.032451104156314 AS sv_3, 0.06562210871181286 AS sv_4, -0.2012723442633616 AS sv_5, 0.982408087540338 AS sv_6, -0.26033619760585114 AS sv_7, 1.722492539259153 AS sv_8, 0.7782941095903136 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 12 AS sv_idx, 1.0 AS dual_coeff, -0.1677974436428522 AS sv_0, -0.609335392494558 AS sv_1, 0.785396575978586 AS sv_2, 0.3052336023473161 AS sv_3, 0.9175267395284237 AS sv_4, -0.3604428274466762 AS sv_5, -0.4118383859489017 AS sv_6, 0.7705520894457417 AS sv_7, -0.671830837083766 AS sv_8, -1.9277782785654813 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 13 AS sv_idx, 0.0 AS dual_coeff, -0.6129536127403589 AS sv_0, -1.2003117703069377 AS sv_1, 0.169188933661664 AS sv_2, -0.24184135719251648 AS sv_3, 0.3752467217535285 AS sv_4, 0.4980986824546179 AS sv_5, -0.010420009873701903 AS sv_6, 0.8568014759721623 AS sv_7, 1.0375391875324445 AS sv_8, 0.41331227685244276 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 14 AS sv_idx, -0.0 AS dual_coeff, -0.6384379162711309 AS sv_0, 0.717712741267091 AS sv_1, -0.029441812995214225 AS sv_2, 0.19454074631293933 AS sv_3, 0.42356979543552 AS sv_4, 0.4996306149226033 AS sv_5, -0.014709875293858664 AS sv_6, -0.21682672177070866 AS sv_7, 0.8731634819745784 AS sv_8, 0.3996037942181906 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 15 AS sv_idx, -1.0 AS dual_coeff, -0.5091996214221497 AS sv_0, 1.1713064754998441 AS sv_1, -0.48494740604431213 AS sv_2, -0.008898553173031508 AS sv_3, 1.3733454370146492 AS sv_4, -0.3114028163844563 AS sv_5, 0.35946894921283384 AS sv_6, -0.22891358225263628 AS sv_7, 0.6298212594245098 AS sv_8, -1.259802912006969 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 16 AS sv_idx, -0.2542247808230787 AS dual_coeff, -0.08197430824290891 AS sv_0, -0.00021955504887942811 AS sv_1, 1.1805552767545813 AS sv_2, 0.9006545480532682 AS sv_3, 2.4222684678755795 AS sv_4, 1.2870622577404576 AS sv_5, -0.849223596083783 AS sv_6, 1.5371118397176036 AS sv_7, -0.128922343722663 AS sv_8, 1.3531654464868126 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 17 AS sv_idx, -0.0 AS dual_coeff, 1.498564845881099 AS sv_0, 1.48831742779472 AS sv_1, -0.9195950368877045 AS sv_2, 0.45496476868785374 AS sv_3, -0.8831439969763527 AS sv_4, 0.1605753080607123 AS sv_5, -0.29246802189369364 AS sv_6, 0.2500655154498075 AS sv_7, 0.8724808729913642 AS sv_8, -1.5908321123459748 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 18 AS sv_idx, -1.0 AS dual_coeff, -0.6167692842155993 AS sv_0, -0.2173495764149621 AS sv_1, 0.4539181821969074 AS sv_2, 0.18067095507803288 AS sv_3, 0.6122834345039813 AS sv_4, -2.0679664960978896 AS sv_5, -0.19976608756975378 AS sv_6, 0.31411294150482844 AS sv_7, -0.7119488376066533 AS sv_8, -0.32601200274560516 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 19 AS sv_idx, -0.0 AS dual_coeff, -0.46515313120920093 AS sv_0, 1.2103577416175606 AS sv_1, 0.14357328513380316 AS sv_2, 1.0670224926771352 AS sv_3, -0.004180412672813376 AS sv_4, -0.5165474025968144 AS sv_5, -0.9551233938552457 AS sv_6, 0.9299887560835304 AS sv_7, -1.1277360622292962 AS sv_8, 1.3633593105363355 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 20 AS sv_idx, -0.0 AS dual_coeff, 0.009674343495163067 AS sv_0, 1.2178845494390973 AS sv_1, 2.412039780702482 AS sv_2, 2.7994399099133482 AS sv_3, -2.364480222710695 AS sv_4, -1.200108875400591 AS sv_5, -2.9327320914381376 AS sv_6, 0.8741712868555673 AS sv_7, 0.15348555651244278 AS sv_8, 0.10452254551846794 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 21 AS sv_idx, -0.0 AS dual_coeff, -0.7181604123131647 AS sv_0, 0.47635997350587705 AS sv_1, 0.21388659584479253 AS sv_2, 1.1163530548266316 AS sv_3, -0.4968220838205612 AS sv_4, -0.5072223495412532 AS sv_5, -1.24688692572275 AS sv_6, 1.7030243556175357 AS sv_7, -1.003380404809525 AS sv_8, 0.6423375532130973 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 22 AS sv_idx, -0.3819048507009721 AS dual_coeff, -0.38529554644994124 AS sv_0, -0.33978526464340053 AS sv_1, 1.1521852950916334 AS sv_2, 0.6277675404581664 AS sv_3, 1.4605869711557362 AS sv_4, -0.5811596496045133 AS sv_5, -0.6601503419469803 AS sv_6, 0.9136756412886499 AS sv_7, 0.10977779808551855 AS sv_8, -0.36931239107023645 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 23 AS sv_idx, -0.0 AS dual_coeff, -1.292731963918506 AS sv_0, 0.5628285196619536 AS sv_1, 0.007127339857400062 AS sv_2, 0.3728509698863072 AS sv_3, 0.7108565052671136 AS sv_4, 1.5681721671032636 AS sv_5, -0.26318102458574727 AS sv_6, 0.512232870741319 AS sv_7, 0.5221201360240043 AS sv_8, 0.4516931545431869 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 24 AS sv_idx, -0.0 AS dual_coeff, 0.3737039642758539 AS sv_0, 0.3836668075977489 AS sv_1, 0.2262882357990665 AS sv_2, 0.4555038841016273 AS sv_3, -0.23804811339629262 AS sv_4, -0.3942471767707451 AS sv_5, -0.4370578804876122 AS sv_6, 0.2168474346275738 AS sv_7, 0.46104028509524775 AS sv_8, -1.4332412094725877 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 25 AS sv_idx, -0.0 AS dual_coeff, 0.12894791123724086 AS sv_0, 0.6506067209702775 AS sv_1, -0.22887773821383223 AS sv_2, 0.33102294500659235 AS sv_3, -0.4701513824550577 AS sv_4, 0.9428923579731946 AS sv_5, -0.274116093353173 AS sv_6, 0.14675015500968058 AS sv_7, -1.3124142189597725 AS sv_8, -0.32257928780172823 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 26 AS sv_idx, -0.3596691001926758 AS dual_coeff, -0.520327735882063 AS sv_0, -1.5213111907033747 AS sv_1, 2.4315184437785144 AS sv_2, 0.3592795244718508 AS sv_3, 0.32622900008176564 AS sv_4, 1.1916928182803614 AS sv_5, -0.5628887017025386 AS sv_6, -0.6777260177602357 AS sv_7, -0.2942834435409094 AS sv_8, 1.3971427897210167 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 27 AS sv_idx, -0.0 AS dual_coeff, 1.9823391269812736 AS sv_0, 1.041533370242338 AS sv_1, 1.1741916871533693 AS sv_2, 2.144983578407978 AS sv_3, -1.6631709351723898 AS sv_4, -0.7478608271844139 AS sv_5, -2.2951102991250854 AS sv_6, 1.6281529749851422 AS sv_7, 1.6396331333077083 AS sv_8, -1.525977817768459 AS sv_9 FROM SYSIBM.SYSDUMMY1) AS "Values"), 
kernel_dp_0_1 AS 
(SELECT t."KEY" AS "KEY", t.dot_product AS dot_product 
FROM (SELECT full_join_data_sv."KEY" AS "KEY", sum(CAST(full_join_data_sv.dot_prod1 AS DOUBLE)) + -0.594801821723198 AS dot_product 
FROM (SELECT kernel_input."KEY" AS "KEY", "SV_data_0_1".dual_coeff * (kernel_input.scaler_2 * "SV_data_0_1".sv_0 + kernel_input.scaler_3 * "SV_data_0_1".sv_1 + kernel_input.scaler_4 * "SV_data_0_1".sv_2 + kernel_input.scaler_5 * "SV_data_0_1".sv_3 + kernel_input.scaler_6 * "SV_data_0_1".sv_4 + kernel_input.scaler_7 * "SV_data_0_1".sv_5 + kernel_input.scaler_8 * "SV_data_0_1".sv_6 + kernel_input.scaler_9 * "SV_data_0_1".sv_7 + kernel_input.scaler_10 * "SV_data_0_1".sv_8 + kernel_input.scaler_11 * "SV_data_0_1".sv_9) AS dot_prod1 
FROM kernel_input, "SV_data_0_1") AS full_join_data_sv GROUP BY full_join_data_sv."KEY") AS t), 
kernel_cte_0_1 AS 
(SELECT kernel_dp_0_1."KEY" AS "KEY", 0 AS "OVO_Class1", 1 AS "OVO_Class2", CASE WHEN (-kernel_dp_0_1.dot_product >= 0.0) THEN 1 ELSE 0 END AS "OVO_Decision", coalesce(-kernel_dp_0_1.dot_product, 1.0 / (1.0 + exp(least(greatest(-100.0, -(-((-kernel_dp_0_1.dot_product) * -1.307872692060811 + 0.15402438259203052))), 100.0)))) AS "OVO_Conf" 
FROM kernel_dp_0_1)
 SELECT "KernAgg_B0"."KEY", "KernAgg_B0"."OVO_Class1", "KernAgg_B0"."OVO_Class2", "KernAgg_B0"."OVO_Decision", "KernAgg_B0"."OVO_Conf" 
FROM (SELECT "KernAgg_esu_0"."KEY" AS "KEY", "KernAgg_esu_0"."OVO_Class1" AS "OVO_Class1", "KernAgg_esu_0"."OVO_Class2" AS "OVO_Class2", "KernAgg_esu_0"."OVO_Decision" AS "OVO_Decision", "KernAgg_esu_0"."OVO_Conf" AS "OVO_Conf" 
FROM (SELECT kernel_cte_0_1."KEY" AS "KEY", kernel_cte_0_1."OVO_Class1" AS "OVO_Class1", kernel_cte_0_1."OVO_Class2" AS "OVO_Class2", kernel_cte_0_1."OVO_Decision" AS "OVO_Decision", kernel_cte_0_1."OVO_Conf" AS "OVO_Conf" 
FROM kernel_cte_0_1) AS "KernAgg_esu_0") AS "KernAgg_B0"

-- Code For temporary table tmp_20180602143441_4bu_kernagg_b1 part 1. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180602143441_4bu_kernagg_b1 (
	"KEY" BIGINT, 
	"OVO_Class1" BIGINT, 
	"OVO_Class2" BIGINT, 
	"OVO_Decision" BIGINT, 
	"OVO_Conf" DOUBLE
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180602143441_4bu_kernagg_b1 part 2. Populate

INSERT INTO tmp_20180602143441_4bu_kernagg_b1 WITH kernel_input AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CAST("ADS_sca_2_OUT".scaler_2 AS DOUBLE) AS scaler_2, CAST("ADS_sca_2_OUT".scaler_3 AS DOUBLE) AS scaler_3, CAST("ADS_sca_2_OUT".scaler_4 AS DOUBLE) AS scaler_4, CAST("ADS_sca_2_OUT".scaler_5 AS DOUBLE) AS scaler_5, CAST("ADS_sca_2_OUT".scaler_6 AS DOUBLE) AS scaler_6, CAST("ADS_sca_2_OUT".scaler_7 AS DOUBLE) AS scaler_7, CAST("ADS_sca_2_OUT".scaler_8 AS DOUBLE) AS scaler_8, CAST("ADS_sca_2_OUT".scaler_9 AS DOUBLE) AS scaler_9, CAST("ADS_sca_2_OUT".scaler_10 AS DOUBLE) AS scaler_10, CAST("ADS_sca_2_OUT".scaler_11 AS DOUBLE) AS scaler_11 
FROM tmp_20180602143441_2qt_ads_sca_2_out AS "ADS_sca_2_OUT"), 
"SV_data_0_2" AS 
(SELECT "Values".sv_idx AS sv_idx, CAST("Values".dual_coeff AS DOUBLE) AS dual_coeff, CAST("Values".sv_0 AS DOUBLE) AS sv_0, CAST("Values".sv_1 AS DOUBLE) AS sv_1, CAST("Values".sv_2 AS DOUBLE) AS sv_2, CAST("Values".sv_3 AS DOUBLE) AS sv_3, CAST("Values".sv_4 AS DOUBLE) AS sv_4, CAST("Values".sv_5 AS DOUBLE) AS sv_5, CAST("Values".sv_6 AS DOUBLE) AS sv_6, CAST("Values".sv_7 AS DOUBLE) AS sv_7, CAST("Values".sv_8 AS DOUBLE) AS sv_8, CAST("Values".sv_9 AS DOUBLE) AS sv_9 
FROM (SELECT 0 AS sv_idx, 0.0 AS dual_coeff, 0.9714093888112304 AS sv_0, -1.1362862709591603 AS sv_1, 1.4121646810839101 AS sv_2, 0.16748694582255716 AS sv_3, 1.919129112546945 AS sv_4, -1.3816843324216765 AS sv_5, -0.264450213574542 AS sv_6, 0.5734893436019516 AS sv_7, -0.8001824570648544 AS sv_8, 0.5312588986282071 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 1 AS sv_idx, 1.0 AS dual_coeff, 0.5155181451371881 AS sv_0, -0.8714698092700448 AS sv_1, -0.24389322910487762 AS sv_2, -0.7991387414972061 AS sv_3, -0.18581083474468457 AS sv_4, -0.023588682037116185 AS sv_5, 0.6986600728081974 AS sv_6, -0.6135893124459777 AS sv_7, 0.2006481214834177 AS sv_8, 2.5794740486698324 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 2 AS sv_idx, 1.0 AS dual_coeff, 0.7512981458283388 AS sv_0, -0.9149828300753567 AS sv_1, 0.2852823045034491 AS sv_2, -0.11558803226776675 AS sv_3, 0.24748912034828158 AS sv_4, 0.28654936422754373 AS sv_5, -0.07524606808095237 AS sv_6, 0.5729190266147256 AS sv_7, 0.6858859078443724 AS sv_8, -0.620232456039194 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 3 AS sv_idx, 1.0 AS dual_coeff, -0.7724118389110615 AS sv_0, -1.523108404513254 AS sv_1, -0.06934453307085123 AS sv_2, -0.8222931132740179 AS sv_3, 0.6337346825309558 AS sv_4, 0.18651831067623925 AS sv_5, 0.5994429231757117 AS sv_6, 0.26611650190454433 AS sv_7, -0.4332155471305799 AS sv_8, -0.0021916563910858184 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 4 AS sv_idx, 1.0 AS dual_coeff, -1.6525901403740733 AS sv_0, -0.9890732087979381 AS sv_1, -0.342927413635955 AS sv_2, -0.4790906384194392 AS sv_3, -0.5256139818544308 AS sv_4, 0.9495403665210237 AS sv_5, 0.2362342026029566 AS sv_6, 0.3712062131271089 AS sv_7, -0.8665466719556469 AS sv_8, -0.2548238481870406 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 5 AS sv_idx, 0.31400532745696036 AS dual_coeff, 0.781312822280884 AS sv_0, 0.6347829483833167 AS sv_1, -0.9041192391704674 AS sv_2, -0.9300186648244536 AS sv_3, 1.326891768298379 AS sv_4, 0.13188542176567378 AS sv_5, 1.2923759777877002 AS sv_6, -1.2673209344092986 AS sv_7, 0.5635183958191062 AS sv_8, 1.1924250826103184 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 6 AS sv_idx, 1.0 AS dual_coeff, 0.3750056424765156 AS sv_0, 0.08839156664387353 AS sv_1, -1.1500997262003088 AS sv_2, -0.7106948912048624 AS sv_3, 0.8214637945754517 AS sv_4, 0.02765690710297472 AS sv_5, 0.802492887609131 AS sv_6, 0.17755366813131324 AS sv_7, 0.5203126451539958 AS sv_8, -0.3473398360786861 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 7 AS sv_idx, 0.3026393437970364 AS dual_coeff, -2.04390942155231 AS sv_0, 1.6045476968164614 AS sv_1, -1.6078018561905978 AS sv_2, -0.8553322073826393 AS sv_3, 1.9483185006626593 AS sv_4, -1.193969085208424 AS sv_5, 1.4233791815648011 AS sv_6, -1.001496133180198 AS sv_7, 2.6578500028699037 AS sv_8, 0.22383740962764367 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 8 AS sv_idx, 1.0 AS dual_coeff, -0.9008243879031689 AS sv_0, -0.7058080155207507 AS sv_1, -0.1954871267874386 AS sv_2, -0.14288199830722706 AS sv_3, 0.7337440799607109 AS sv_4, -0.37261544979685357 AS sv_5, -0.018101107213572498 AS sv_6, 1.1757591626798987 AS sv_7, -0.7275765325824345 AS sv_8, -1.4838347842326305 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 9 AS sv_idx, 0.5636502578748177 AS dual_coeff, 1.6205372377548237 AS sv_0, 0.24588358170973168 AS sv_1, 0.17361682358299016 AS sv_2, -0.8594167963741567 AS sv_3, 1.0360197969314284 AS sv_4, -0.22808201831799044 AS sv_5, 1.2154111271626897 AS sv_6, -2.3575145129167856 AS sv_7, -0.23125451691989812 AS sv_8, 1.1072978105948121 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 10 AS sv_idx, 0.0 AS dual_coeff, -2.0463565761467315 AS sv_0, 0.021854712922967697 AS sv_1, -0.45913908750371657 AS sv_2, -0.2644863625352091 AS sv_3, 1.4146860438861666 AS sv_4, -0.25484644833947895 AS sv_5, 0.346076492554258 AS sv_6, 0.6033426931850794 AS sv_7, 0.6694726458182755 AS sv_8, 1.293706733667843 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 11 AS sv_idx, 1.0 AS dual_coeff, 2.873564244275373 AS sv_0, -0.5872911114054795 AS sv_1, -1.036220513213831 AS sv_2, -1.032451104156314 AS sv_3, 0.06562210871181286 AS sv_4, -0.2012723442633616 AS sv_5, 0.982408087540338 AS sv_6, -0.26033619760585114 AS sv_7, 1.722492539259153 AS sv_8, 0.7782941095903136 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 12 AS sv_idx, 0.0 AS dual_coeff, -0.1677974436428522 AS sv_0, -0.609335392494558 AS sv_1, 0.785396575978586 AS sv_2, 0.3052336023473161 AS sv_3, 0.9175267395284237 AS sv_4, -0.3604428274466762 AS sv_5, -0.4118383859489017 AS sv_6, 0.7705520894457417 AS sv_7, -0.671830837083766 AS sv_8, -1.9277782785654813 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 13 AS sv_idx, 0.7088739959292281 AS dual_coeff, -0.6129536127403589 AS sv_0, -1.2003117703069377 AS sv_1, 0.169188933661664 AS sv_2, -0.24184135719251648 AS sv_3, 0.3752467217535285 AS sv_4, 0.4980986824546179 AS sv_5, -0.010420009873701903 AS sv_6, 0.8568014759721623 AS sv_7, 1.0375391875324445 AS sv_8, 0.41331227685244276 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 28 AS sv_idx, -0.8107859733569943 AS dual_coeff, 0.3728477956732985 AS sv_0, 0.2150610679834529 AS sv_1, 0.08393670362034505 AS sv_2, 0.7029479107610479 AS sv_3, -0.8778134194688425 AS sv_4, 0.6056477433901051 AS sv_5, -0.844443589473496 AS sv_6, 1.0202010595638178 AS sv_7, 0.9073571060114952 AS sv_8, 0.5949187633081499 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 29 AS sv_idx, -0.2817082797340208 AS dual_coeff, 1.4122845978733751 AS sv_0, 0.8860898474486589 AS sv_1, -1.9405186231398404 AS sv_2, -0.07474079289882218 AS sv_3, -0.7793444034413073 AS sv_4, -2.6702025981079935 AS sv_5, 0.06359503606562808 AS sv_6, 1.295307501104366 AS sv_7, -0.9879646225889391 AS sv_8, -0.9684510673956982 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 30 AS sv_idx, -0.7718686249645761 AS dual_coeff, 1.4066838727702853 AS sv_0, -1.9182044206192992 AS sv_1, -0.5196200501051259 AS sv_2, -1.4705199852923474 AS sv_3, -0.3458523910961328 AS sv_4, 0.33616488091266306 AS sv_5, 1.1840694698786476 AS sv_6, -0.6080444045275858 AS sv_7, -0.29994497023595584 AS sv_8, -0.7844124282150763 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 31 AS sv_idx, -1.0 AS dual_coeff, -0.6292030328074096 AS sv_0, 0.1912075700484827 AS sv_1, -1.843749457931878 AS sv_2, -0.7991127838709606 AS sv_3, 0.6616827502981251 AS sv_4, 1.7840049271298177 AS sv_5, 0.8451858943105607 AS sv_6, 0.8140681317224646 AS sv_7, 0.08792025539317516 AS sv_8, 0.9950261622110849 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 32 AS sv_idx, -1.0 AS dual_coeff, 0.3341701047941328 AS sv_0, -2.662482196896262 AS sv_1, 0.07843518137226316 AS sv_2, -1.8595180608743578 AS sv_3, 0.009894199539738802 AS sv_4, 0.5011525213358909 AS sv_5, 1.5449586461756617 AS sv_6, -1.3978967416343981 AS sv_7, 0.8013585074033905 AS sv_8, 1.6588023725821097 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 33 AS sv_idx, -1.0 AS dual_coeff, 0.27097803892047134 AS sv_0, -2.050244728369085 AS sv_1, -0.4542127463856603 AS sv_2, -1.6409303806916962 AS sv_3, 1.2265855708161812 AS sv_4, 0.39276279886971993 AS sv_5, 1.4434868920883854 AS sv_6, -0.300095627427432 AS sv_7, 0.38730712905565656 AS sv_8, -0.3090329471111716 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 34 AS sv_idx, -1.0 AS dual_coeff, 0.7211425879338048 AS sv_0, 1.457288622504473 AS sv_1, 0.04006284303228038 AS sv_2, 1.693972182129337 AS sv_3, -0.43340082570959415 AS sv_4, -1.0101635421053963 AS sv_5, -1.6977213868691645 AS sv_6, 2.1933689021891722 AS sv_7, -0.32853587805805745 AS sv_8, 1.092602209782003 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 35 AS sv_idx, -0.21453836141464103 AS dual_coeff, -2.3565166103036597 AS sv_0, -0.30251013989767633 AS sv_1, -0.3140968676549342 AS sv_2, -0.2384809460116976 AS sv_3, -0.057552546047053434 AS sv_4, 0.3584567179839237 AS sv_5, 0.16476994889061974 AS sv_6, 0.24320679990529717 AS sv_7, -0.34536210647094345 AS sv_8, 0.194783439550393 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 36 AS sv_idx, -0.0 AS dual_coeff, -1.0674962632282596 AS sv_0, 0.10738702259752413 AS sv_1, -1.3736167044518084 AS sv_2, -0.9294913297161647 AS sv_3, -0.2591018033659197 AS sv_4, -2.089976011450095 AS sv_5, 0.9982561688181318 AS sv_6, -0.5288704938579509 AS sv_7, -0.2489618806830741 AS sv_8, -0.20163113151409254 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 37 AS sv_idx, -0.8102676855878099 AS dual_coeff, 0.6771904971815166 AS sv_0, 1.0719689016435152 AS sv_1, 0.5245306374555708 AS sv_2, 1.6491563675727086 AS sv_3, 0.00379803365985488 AS sv_4, 1.0864447846283871 AS sv_5, -1.6707192554829466 AS sv_6, 2.0264169541316184 AS sv_7, 0.8991761439312493 AS sv_8, -2.991975528502707 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 38 AS sv_idx, -1.0 AS dual_coeff, -1.4368565283727257 AS sv_0, -1.2179850983373004 AS sv_1, 0.02957834923686986 AS sv_2, -1.8886785238541821 AS sv_3, 0.7298464602800008 AS sv_4, -1.2853111154258396 AS sv_5, 2.0338563000592718 AS sv_6, -2.9891471979477635 AS sv_7, 0.8549405023016902 AS sv_8, 0.544772187536236 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 39 AS sv_idx, -1.0 AS dual_coeff, -0.029032309561236043 AS sv_0, -0.6453345904438006 AS sv_1, -1.117203658136182 AS sv_2, -1.5618681060804385 AS sv_3, 1.1721141707277283 AS sv_4, -0.10688969820803637 AS sv_5, 1.6685204789189094 AS sv_6, -0.9473215546387913 AS sv_7, -0.043736970360985186 AS sv_8, 0.35416133142343575 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 40 AS sv_idx, -0.0 AS dual_coeff, -0.934981534951002 AS sv_0, -0.9646927105624221 AS sv_1, -1.086082141474592 AS sv_2, -1.8089677945974325 AS sv_3, -0.5573323681766859 AS sv_4, 1.5320749070354607 AS sv_5, 1.8012437726323827 AS sv_6, -1.9513058268134067 AS sv_7, 0.5571671919157734 AS sv_8, 1.2547979832590759 AS sv_9 FROM SYSIBM.SYSDUMMY1) AS "Values"), 
kernel_dp_0_2 AS 
(SELECT t_1."KEY" AS "KEY", t_1.dot_product AS dot_product 
FROM (SELECT full_join_data_sv_1."KEY" AS "KEY", sum(CAST(full_join_data_sv_1.dot_prod1 AS DOUBLE)) + -0.3160086078465727 AS dot_product 
FROM (SELECT kernel_input."KEY" AS "KEY", "SV_data_0_2".dual_coeff * (kernel_input.scaler_2 * "SV_data_0_2".sv_0 + kernel_input.scaler_3 * "SV_data_0_2".sv_1 + kernel_input.scaler_4 * "SV_data_0_2".sv_2 + kernel_input.scaler_5 * "SV_data_0_2".sv_3 + kernel_input.scaler_6 * "SV_data_0_2".sv_4 + kernel_input.scaler_7 * "SV_data_0_2".sv_5 + kernel_input.scaler_8 * "SV_data_0_2".sv_6 + kernel_input.scaler_9 * "SV_data_0_2".sv_7 + kernel_input.scaler_10 * "SV_data_0_2".sv_8 + kernel_input.scaler_11 * "SV_data_0_2".sv_9) AS dot_prod1 
FROM kernel_input, "SV_data_0_2") AS full_join_data_sv_1 GROUP BY full_join_data_sv_1."KEY") AS t_1), 
kernel_cte_0_2 AS 
(SELECT kernel_dp_0_2."KEY" AS "KEY", 0 AS "OVO_Class1", 2 AS "OVO_Class2", CASE WHEN (-kernel_dp_0_2.dot_product >= 0.0) THEN 1 ELSE 0 END AS "OVO_Decision", coalesce(-kernel_dp_0_2.dot_product, 1.0 / (1.0 + exp(least(greatest(-100.0, -(-((-kernel_dp_0_2.dot_product) * -0.40942670720631436 + 0.18688952048099036))), 100.0)))) AS "OVO_Conf" 
FROM kernel_dp_0_2)
 SELECT "KernAgg_B1"."KEY", "KernAgg_B1"."OVO_Class1", "KernAgg_B1"."OVO_Class2", "KernAgg_B1"."OVO_Decision", "KernAgg_B1"."OVO_Conf" 
FROM (SELECT "KernAgg_esu_1"."KEY" AS "KEY", "KernAgg_esu_1"."OVO_Class1" AS "OVO_Class1", "KernAgg_esu_1"."OVO_Class2" AS "OVO_Class2", "KernAgg_esu_1"."OVO_Decision" AS "OVO_Decision", "KernAgg_esu_1"."OVO_Conf" AS "OVO_Conf" 
FROM (SELECT kernel_cte_0_2."KEY" AS "KEY", kernel_cte_0_2."OVO_Class1" AS "OVO_Class1", kernel_cte_0_2."OVO_Class2" AS "OVO_Class2", kernel_cte_0_2."OVO_Decision" AS "OVO_Decision", kernel_cte_0_2."OVO_Conf" AS "OVO_Conf" 
FROM kernel_cte_0_2) AS "KernAgg_esu_1") AS "KernAgg_B1"

-- Code For temporary table tmp_20180602143441_k1m_kernagg_b2 part 1. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180602143441_k1m_kernagg_b2 (
	"KEY" BIGINT, 
	"OVO_Class1" BIGINT, 
	"OVO_Class2" BIGINT, 
	"OVO_Decision" BIGINT, 
	"OVO_Conf" DOUBLE
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180602143441_k1m_kernagg_b2 part 2. Populate

INSERT INTO tmp_20180602143441_k1m_kernagg_b2 WITH kernel_input AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CAST("ADS_sca_2_OUT".scaler_2 AS DOUBLE) AS scaler_2, CAST("ADS_sca_2_OUT".scaler_3 AS DOUBLE) AS scaler_3, CAST("ADS_sca_2_OUT".scaler_4 AS DOUBLE) AS scaler_4, CAST("ADS_sca_2_OUT".scaler_5 AS DOUBLE) AS scaler_5, CAST("ADS_sca_2_OUT".scaler_6 AS DOUBLE) AS scaler_6, CAST("ADS_sca_2_OUT".scaler_7 AS DOUBLE) AS scaler_7, CAST("ADS_sca_2_OUT".scaler_8 AS DOUBLE) AS scaler_8, CAST("ADS_sca_2_OUT".scaler_9 AS DOUBLE) AS scaler_9, CAST("ADS_sca_2_OUT".scaler_10 AS DOUBLE) AS scaler_10, CAST("ADS_sca_2_OUT".scaler_11 AS DOUBLE) AS scaler_11 
FROM tmp_20180602143441_2qt_ads_sca_2_out AS "ADS_sca_2_OUT"), 
"SV_data_0_3" AS 
(SELECT "Values".sv_idx AS sv_idx, CAST("Values".dual_coeff AS DOUBLE) AS dual_coeff, CAST("Values".sv_0 AS DOUBLE) AS sv_0, CAST("Values".sv_1 AS DOUBLE) AS sv_1, CAST("Values".sv_2 AS DOUBLE) AS sv_2, CAST("Values".sv_3 AS DOUBLE) AS sv_3, CAST("Values".sv_4 AS DOUBLE) AS sv_4, CAST("Values".sv_5 AS DOUBLE) AS sv_5, CAST("Values".sv_6 AS DOUBLE) AS sv_6, CAST("Values".sv_7 AS DOUBLE) AS sv_7, CAST("Values".sv_8 AS DOUBLE) AS sv_8, CAST("Values".sv_9 AS DOUBLE) AS sv_9 
FROM (SELECT 0 AS sv_idx, 0.0 AS dual_coeff, 0.9714093888112304 AS sv_0, -1.1362862709591603 AS sv_1, 1.4121646810839101 AS sv_2, 0.16748694582255716 AS sv_3, 1.919129112546945 AS sv_4, -1.3816843324216765 AS sv_5, -0.264450213574542 AS sv_6, 0.5734893436019516 AS sv_7, -0.8001824570648544 AS sv_8, 0.5312588986282071 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 1 AS sv_idx, 0.12697727737620465 AS dual_coeff, 0.5155181451371881 AS sv_0, -0.8714698092700448 AS sv_1, -0.24389322910487762 AS sv_2, -0.7991387414972061 AS sv_3, -0.18581083474468457 AS sv_4, -0.023588682037116185 AS sv_5, 0.6986600728081974 AS sv_6, -0.6135893124459777 AS sv_7, 0.2006481214834177 AS sv_8, 2.5794740486698324 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 2 AS sv_idx, 0.0 AS dual_coeff, 0.7512981458283388 AS sv_0, -0.9149828300753567 AS sv_1, 0.2852823045034491 AS sv_2, -0.11558803226776675 AS sv_3, 0.24748912034828158 AS sv_4, 0.28654936422754373 AS sv_5, -0.07524606808095237 AS sv_6, 0.5729190266147256 AS sv_7, 0.6858859078443724 AS sv_8, -0.620232456039194 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 3 AS sv_idx, 0.0 AS dual_coeff, -0.7724118389110615 AS sv_0, -1.523108404513254 AS sv_1, -0.06934453307085123 AS sv_2, -0.8222931132740179 AS sv_3, 0.6337346825309558 AS sv_4, 0.18651831067623925 AS sv_5, 0.5994429231757117 AS sv_6, 0.26611650190454433 AS sv_7, -0.4332155471305799 AS sv_8, -0.0021916563910858184 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 4 AS sv_idx, 1.0 AS dual_coeff, -1.6525901403740733 AS sv_0, -0.9890732087979381 AS sv_1, -0.342927413635955 AS sv_2, -0.4790906384194392 AS sv_3, -0.5256139818544308 AS sv_4, 0.9495403665210237 AS sv_5, 0.2362342026029566 AS sv_6, 0.3712062131271089 AS sv_7, -0.8665466719556469 AS sv_8, -0.2548238481870406 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 5 AS sv_idx, 0.0 AS dual_coeff, 0.781312822280884 AS sv_0, 0.6347829483833167 AS sv_1, -0.9041192391704674 AS sv_2, -0.9300186648244536 AS sv_3, 1.326891768298379 AS sv_4, 0.13188542176567378 AS sv_5, 1.2923759777877002 AS sv_6, -1.2673209344092986 AS sv_7, 0.5635183958191062 AS sv_8, 1.1924250826103184 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 6 AS sv_idx, 0.0 AS dual_coeff, 0.3750056424765156 AS sv_0, 0.08839156664387353 AS sv_1, -1.1500997262003088 AS sv_2, -0.7106948912048624 AS sv_3, 0.8214637945754517 AS sv_4, 0.02765690710297472 AS sv_5, 0.802492887609131 AS sv_6, 0.17755366813131324 AS sv_7, 0.5203126451539958 AS sv_8, -0.3473398360786861 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 7 AS sv_idx, 0.1838408727074767 AS dual_coeff, -2.04390942155231 AS sv_0, 1.6045476968164614 AS sv_1, -1.6078018561905978 AS sv_2, -0.8553322073826393 AS sv_3, 1.9483185006626593 AS sv_4, -1.193969085208424 AS sv_5, 1.4233791815648011 AS sv_6, -1.001496133180198 AS sv_7, 2.6578500028699037 AS sv_8, 0.22383740962764367 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 8 AS sv_idx, 0.0 AS dual_coeff, -0.9008243879031689 AS sv_0, -0.7058080155207507 AS sv_1, -0.1954871267874386 AS sv_2, -0.14288199830722706 AS sv_3, 0.7337440799607109 AS sv_4, -0.37261544979685357 AS sv_5, -0.018101107213572498 AS sv_6, 1.1757591626798987 AS sv_7, -0.7275765325824345 AS sv_8, -1.4838347842326305 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 9 AS sv_idx, 1.0 AS dual_coeff, 1.6205372377548237 AS sv_0, 0.24588358170973168 AS sv_1, 0.17361682358299016 AS sv_2, -0.8594167963741567 AS sv_3, 1.0360197969314284 AS sv_4, -0.22808201831799044 AS sv_5, 1.2154111271626897 AS sv_6, -2.3575145129167856 AS sv_7, -0.23125451691989812 AS sv_8, 1.1072978105948121 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 10 AS sv_idx, 0.0 AS dual_coeff, -2.0463565761467315 AS sv_0, 0.021854712922967697 AS sv_1, -0.45913908750371657 AS sv_2, -0.2644863625352091 AS sv_3, 1.4146860438861666 AS sv_4, -0.25484644833947895 AS sv_5, 0.346076492554258 AS sv_6, 0.6033426931850794 AS sv_7, 0.6694726458182755 AS sv_8, 1.293706733667843 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 11 AS sv_idx, 0.0 AS dual_coeff, 2.873564244275373 AS sv_0, -0.5872911114054795 AS sv_1, -1.036220513213831 AS sv_2, -1.032451104156314 AS sv_3, 0.06562210871181286 AS sv_4, -0.2012723442633616 AS sv_5, 0.982408087540338 AS sv_6, -0.26033619760585114 AS sv_7, 1.722492539259153 AS sv_8, 0.7782941095903136 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 12 AS sv_idx, 0.0 AS dual_coeff, -0.1677974436428522 AS sv_0, -0.609335392494558 AS sv_1, 0.785396575978586 AS sv_2, 0.3052336023473161 AS sv_3, 0.9175267395284237 AS sv_4, -0.3604428274466762 AS sv_5, -0.4118383859489017 AS sv_6, 0.7705520894457417 AS sv_7, -0.671830837083766 AS sv_8, -1.9277782785654813 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 13 AS sv_idx, 0.0 AS dual_coeff, -0.6129536127403589 AS sv_0, -1.2003117703069377 AS sv_1, 0.169188933661664 AS sv_2, -0.24184135719251648 AS sv_3, 0.3752467217535285 AS sv_4, 0.4980986824546179 AS sv_5, -0.010420009873701903 AS sv_6, 0.8568014759721623 AS sv_7, 1.0375391875324445 AS sv_8, 0.41331227685244276 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 41 AS sv_idx, -0.0 AS dual_coeff, 0.0008433489338253888 AS sv_0, 1.0190935734784685 AS sv_1, -1.0466969195863554 AS sv_2, -0.153635634271338 AS sv_3, -0.21784172021227197 AS sv_4, 0.8348367712842659 AS sv_5, 0.3439735076537882 AS sv_6, -0.21776140010381564 AS sv_7, -1.8166151201121956 AS sv_8, -0.02152392332244568 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 42 AS sv_idx, -0.35933131186544076 AS dual_coeff, 0.5773878879888359 AS sv_0, -0.04740428413578312 AS sv_1, -1.2234686072271048 AS sv_2, -1.0128407016591991 AS sv_3, -0.3818985360960217 AS sv_4, 1.671097439599355 AS sv_5, 1.0699845515484259 AS sv_6, -0.8233511502676111 AS sv_7, -1.4692416856923658 AS sv_8, 0.005724382112255003 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 43 AS sv_idx, -0.0 AS dual_coeff, 0.653603437858243 AS sv_0, 0.8118703103381688 AS sv_1, 0.4831496203093006 AS sv_2, 0.7608214517358779 AS sv_3, -1.1866385814847495 AS sv_4, 1.8806879512866757 AS sv_5, -0.7051943912062965 AS sv_6, -0.3624691202705955 AS sv_7, 0.4555274542508199 AS sv_8, 0.7462749250325531 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 44 AS sv_idx, -0.0 AS dual_coeff, -2.1024798763599506 AS sv_0, 1.5240734804788811 AS sv_1, 1.9689308324675117 AS sv_2, 1.891995306292 AS sv_3, 0.679249986774034 AS sv_4, -0.1098862436845744 AS sv_5, -1.6205444395313497 AS sv_6, 0.12264829403156129 AS sv_7, -0.20911262738915795 AS sv_8, -0.6406762436910173 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 45 AS sv_idx, -0.0 AS dual_coeff, 0.33214000192394044 AS sv_0, 0.8682960329566819 AS sv_1, -0.5013392512877888 AS sv_2, -0.03281534427464479 AS sv_3, -0.0032357270003156705 AS sv_4, 0.2103253963377075 AS sv_5, 0.2304232694176142 AS sv_6, -0.4561249958634437 AS sv_7, -0.0771639856812561 AS sv_8, -0.11028680261650832 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 46 AS sv_idx, -0.3063451555730026 AS dual_coeff, -1.1379055912419944 AS sv_0, -0.5640619761892367 AS sv_1, -0.1777553768727278 AS sv_2, -1.0356505287803321 AS sv_3, -0.6587029210547068 AS sv_4, 1.2318416707537607 AS sv_5, 1.0684076836748335 AS sv_6, -1.9304847007875792 AS sv_7, -0.5480279298054324 AS sv_8, -0.9752381834622871 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 47 AS sv_idx, -0.710927005302442 AS dual_coeff, -0.30054156935146226 AS sv_0, 0.7488764334812653 AS sv_1, -1.0450013234492215 AS sv_2, -0.45948890986000973 AS sv_3, 0.04580678999985555 AS sv_4, -0.05915947239622647 AS sv_5, 0.6587191391651996 AS sv_6, -0.5388077262123063 AS sv_7, -0.09179898167213818 AS sv_8, 1.4028984451900115 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 48 AS sv_idx, -0.0 AS dual_coeff, -0.7372166845096658 AS sv_0, -0.22015314479000983 AS sv_1, 0.42961411818247125 AS sv_2, 0.4250842123905216 AS sv_3, -2.0765881027653883 AS sv_4, -0.5245479335237841 AS sv_5, -0.6405709412212055 AS sv_6, -0.16744493265128024 AS sv_7, -1.444178919308708 AS sv_8, -1.239069279895893 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 49 AS sv_idx, -0.0 AS dual_coeff, -0.2920866837452327 AS sv_0, 1.022088295144699 AS sv_1, 0.8926086199520507 AS sv_2, 1.0512447783534276 AS sv_3, -0.18433458091274885 AS sv_4, -1.8267668306458908 AS sv_5, -0.9027661724119904 AS sv_6, -0.0929429673282683 AS sv_7, 1.1530313398531398 AS sv_8, -0.476144506380824 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 50 AS sv_idx, -0.7308493190846571 AS dual_coeff, 0.0209646061207601 AS sv_0, 0.21454214449934803 AS sv_1, 0.4214492573789425 AS sv_2, -0.38655167771021287 AS sv_3, -0.13001080381200664 AS sv_4, -0.529477376429765 AS sv_5, 0.5921183931822596 AS sv_6, -1.980719521539998 AS sv_7, -0.08522243972761444 AS sv_8, 0.5408456420597524 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 51 AS sv_idx, -0.20336535825813878 AS dual_coeff, -0.2936890582581222 AS sv_0, 0.1845972607803685 AS sv_1, 1.194851980968043 AS sv_2, 0.8957339490455271 AS sv_3, 0.07996263821322273 AS sv_4, 0.6221954112193534 AS sv_5, -0.9025809387220117 AS sv_6, 0.256469803215711 AS sv_7, 0.3952631174819938 AS sv_8, 0.11259378535590062 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 52 AS sv_idx, -0.0 AS dual_coeff, -0.11191263631327658 AS sv_0, 1.3813029664097791 AS sv_1, 1.656277470117092 AS sv_2, 1.7619728083931392 AS sv_3, -0.9651613323940517 AS sv_4, 0.08470566089931222 AS sv_5, -1.6220269594798407 AS sv_6, -0.24693306041128285 AS sv_7, 0.9092784839684264 AS sv_8, -0.7129384781069622 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 53 AS sv_idx, -0.0 AS dual_coeff, 0.44597422459008845 AS sv_0, 0.9902936111731451 AS sv_1, -0.8160384250812989 AS sv_2, 0.35746313515467953 AS sv_3, -0.269092058172476 AS sv_4, -0.9631034804865878 AS sv_5, -0.27341551428773603 AS sv_6, 0.757789277759762 AS sv_7, 0.4622806538341011 AS sv_8, 0.6543304764988714 AS sv_9 FROM SYSIBM.SYSDUMMY1) AS "Values"), 
kernel_dp_0_3 AS 
(SELECT t_2."KEY" AS "KEY", t_2.dot_product AS dot_product 
FROM (SELECT full_join_data_sv_2."KEY" AS "KEY", sum(CAST(full_join_data_sv_2.dot_prod1 AS DOUBLE)) + -0.40430928801279015 AS dot_product 
FROM (SELECT kernel_input."KEY" AS "KEY", "SV_data_0_3".dual_coeff * (kernel_input.scaler_2 * "SV_data_0_3".sv_0 + kernel_input.scaler_3 * "SV_data_0_3".sv_1 + kernel_input.scaler_4 * "SV_data_0_3".sv_2 + kernel_input.scaler_5 * "SV_data_0_3".sv_3 + kernel_input.scaler_6 * "SV_data_0_3".sv_4 + kernel_input.scaler_7 * "SV_data_0_3".sv_5 + kernel_input.scaler_8 * "SV_data_0_3".sv_6 + kernel_input.scaler_9 * "SV_data_0_3".sv_7 + kernel_input.scaler_10 * "SV_data_0_3".sv_8 + kernel_input.scaler_11 * "SV_data_0_3".sv_9) AS dot_prod1 
FROM kernel_input, "SV_data_0_3") AS full_join_data_sv_2 GROUP BY full_join_data_sv_2."KEY") AS t_2), 
kernel_cte_0_3 AS 
(SELECT kernel_dp_0_3."KEY" AS "KEY", 0 AS "OVO_Class1", 3 AS "OVO_Class2", CASE WHEN (-kernel_dp_0_3.dot_product >= 0.0) THEN 1 ELSE 0 END AS "OVO_Decision", coalesce(-kernel_dp_0_3.dot_product, 1.0 / (1.0 + exp(least(greatest(-100.0, -(-((-kernel_dp_0_3.dot_product) * -1.4890874205158384 + 0.0052142689532324645))), 100.0)))) AS "OVO_Conf" 
FROM kernel_dp_0_3)
 SELECT "KernAgg_B2"."KEY", "KernAgg_B2"."OVO_Class1", "KernAgg_B2"."OVO_Class2", "KernAgg_B2"."OVO_Decision", "KernAgg_B2"."OVO_Conf" 
FROM (SELECT "KernAgg_esu_2"."KEY" AS "KEY", "KernAgg_esu_2"."OVO_Class1" AS "OVO_Class1", "KernAgg_esu_2"."OVO_Class2" AS "OVO_Class2", "KernAgg_esu_2"."OVO_Decision" AS "OVO_Decision", "KernAgg_esu_2"."OVO_Conf" AS "OVO_Conf" 
FROM (SELECT kernel_cte_0_3."KEY" AS "KEY", kernel_cte_0_3."OVO_Class1" AS "OVO_Class1", kernel_cte_0_3."OVO_Class2" AS "OVO_Class2", kernel_cte_0_3."OVO_Decision" AS "OVO_Decision", kernel_cte_0_3."OVO_Conf" AS "OVO_Conf" 
FROM kernel_cte_0_3) AS "KernAgg_esu_2") AS "KernAgg_B2"

-- Code For temporary table tmp_20180602143441_gss_kernagg_b3 part 1. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180602143441_gss_kernagg_b3 (
	"KEY" BIGINT, 
	"OVO_Class1" BIGINT, 
	"OVO_Class2" BIGINT, 
	"OVO_Decision" BIGINT, 
	"OVO_Conf" DOUBLE
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180602143441_gss_kernagg_b3 part 2. Populate

INSERT INTO tmp_20180602143441_gss_kernagg_b3 WITH kernel_input AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CAST("ADS_sca_2_OUT".scaler_2 AS DOUBLE) AS scaler_2, CAST("ADS_sca_2_OUT".scaler_3 AS DOUBLE) AS scaler_3, CAST("ADS_sca_2_OUT".scaler_4 AS DOUBLE) AS scaler_4, CAST("ADS_sca_2_OUT".scaler_5 AS DOUBLE) AS scaler_5, CAST("ADS_sca_2_OUT".scaler_6 AS DOUBLE) AS scaler_6, CAST("ADS_sca_2_OUT".scaler_7 AS DOUBLE) AS scaler_7, CAST("ADS_sca_2_OUT".scaler_8 AS DOUBLE) AS scaler_8, CAST("ADS_sca_2_OUT".scaler_9 AS DOUBLE) AS scaler_9, CAST("ADS_sca_2_OUT".scaler_10 AS DOUBLE) AS scaler_10, CAST("ADS_sca_2_OUT".scaler_11 AS DOUBLE) AS scaler_11 
FROM tmp_20180602143441_2qt_ads_sca_2_out AS "ADS_sca_2_OUT"), 
"SV_data_1_2" AS 
(SELECT "Values".sv_idx AS sv_idx, CAST("Values".dual_coeff AS DOUBLE) AS dual_coeff, CAST("Values".sv_0 AS DOUBLE) AS sv_0, CAST("Values".sv_1 AS DOUBLE) AS sv_1, CAST("Values".sv_2 AS DOUBLE) AS sv_2, CAST("Values".sv_3 AS DOUBLE) AS sv_3, CAST("Values".sv_4 AS DOUBLE) AS sv_4, CAST("Values".sv_5 AS DOUBLE) AS sv_5, CAST("Values".sv_6 AS DOUBLE) AS sv_6, CAST("Values".sv_7 AS DOUBLE) AS sv_7, CAST("Values".sv_8 AS DOUBLE) AS sv_8, CAST("Values".sv_9 AS DOUBLE) AS sv_9 
FROM (SELECT 14 AS sv_idx, 0.5746240341825217 AS dual_coeff, -0.6384379162711309 AS sv_0, 0.717712741267091 AS sv_1, -0.029441812995214225 AS sv_2, 0.19454074631293933 AS sv_3, 0.42356979543552 AS sv_4, 0.4996306149226033 AS sv_5, -0.014709875293858664 AS sv_6, -0.21682672177070866 AS sv_7, 0.8731634819745784 AS sv_8, 0.3996037942181906 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 15 AS sv_idx, 0.0 AS dual_coeff, -0.5091996214221497 AS sv_0, 1.1713064754998441 AS sv_1, -0.48494740604431213 AS sv_2, -0.008898553173031508 AS sv_3, 1.3733454370146492 AS sv_4, -0.3114028163844563 AS sv_5, 0.35946894921283384 AS sv_6, -0.22891358225263628 AS sv_7, 0.6298212594245098 AS sv_8, -1.259802912006969 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 16 AS sv_idx, 0.0 AS dual_coeff, -0.08197430824290891 AS sv_0, -0.00021955504887942811 AS sv_1, 1.1805552767545813 AS sv_2, 0.9006545480532682 AS sv_3, 2.4222684678755795 AS sv_4, 1.2870622577404576 AS sv_5, -0.849223596083783 AS sv_6, 1.5371118397176036 AS sv_7, -0.128922343722663 AS sv_8, 1.3531654464868126 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 17 AS sv_idx, 1.0 AS dual_coeff, 1.498564845881099 AS sv_0, 1.48831742779472 AS sv_1, -0.9195950368877045 AS sv_2, 0.45496476868785374 AS sv_3, -0.8831439969763527 AS sv_4, 0.1605753080607123 AS sv_5, -0.29246802189369364 AS sv_6, 0.2500655154498075 AS sv_7, 0.8724808729913642 AS sv_8, -1.5908321123459748 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 18 AS sv_idx, 1.0 AS dual_coeff, -0.6167692842155993 AS sv_0, -0.2173495764149621 AS sv_1, 0.4539181821969074 AS sv_2, 0.18067095507803288 AS sv_3, 0.6122834345039813 AS sv_4, -2.0679664960978896 AS sv_5, -0.19976608756975378 AS sv_6, 0.31411294150482844 AS sv_7, -0.7119488376066533 AS sv_8, -0.32601200274560516 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 19 AS sv_idx, 0.0 AS dual_coeff, -0.46515313120920093 AS sv_0, 1.2103577416175606 AS sv_1, 0.14357328513380316 AS sv_2, 1.0670224926771352 AS sv_3, -0.004180412672813376 AS sv_4, -0.5165474025968144 AS sv_5, -0.9551233938552457 AS sv_6, 0.9299887560835304 AS sv_7, -1.1277360622292962 AS sv_8, 1.3633593105363355 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 20 AS sv_idx, 0.0 AS dual_coeff, 0.009674343495163067 AS sv_0, 1.2178845494390973 AS sv_1, 2.412039780702482 AS sv_2, 2.7994399099133482 AS sv_3, -2.364480222710695 AS sv_4, -1.200108875400591 AS sv_5, -2.9327320914381376 AS sv_6, 0.8741712868555673 AS sv_7, 0.15348555651244278 AS sv_8, 0.10452254551846794 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 21 AS sv_idx, 1.0 AS dual_coeff, -0.7181604123131647 AS sv_0, 0.47635997350587705 AS sv_1, 0.21388659584479253 AS sv_2, 1.1163530548266316 AS sv_3, -0.4968220838205612 AS sv_4, -0.5072223495412532 AS sv_5, -1.24688692572275 AS sv_6, 1.7030243556175357 AS sv_7, -1.003380404809525 AS sv_8, 0.6423375532130973 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 22 AS sv_idx, 0.0 AS dual_coeff, -0.38529554644994124 AS sv_0, -0.33978526464340053 AS sv_1, 1.1521852950916334 AS sv_2, 0.6277675404581664 AS sv_3, 1.4605869711557362 AS sv_4, -0.5811596496045133 AS sv_5, -0.6601503419469803 AS sv_6, 0.9136756412886499 AS sv_7, 0.10977779808551855 AS sv_8, -0.36931239107023645 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 23 AS sv_idx, 1.0 AS dual_coeff, -1.292731963918506 AS sv_0, 0.5628285196619536 AS sv_1, 0.007127339857400062 AS sv_2, 0.3728509698863072 AS sv_3, 0.7108565052671136 AS sv_4, 1.5681721671032636 AS sv_5, -0.26318102458574727 AS sv_6, 0.512232870741319 AS sv_7, 0.5221201360240043 AS sv_8, 0.4516931545431869 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 24 AS sv_idx, 0.36274118538956296 AS dual_coeff, 0.3737039642758539 AS sv_0, 0.3836668075977489 AS sv_1, 0.2262882357990665 AS sv_2, 0.4555038841016273 AS sv_3, -0.23804811339629262 AS sv_4, -0.3942471767707451 AS sv_5, -0.4370578804876122 AS sv_6, 0.2168474346275738 AS sv_7, 0.46104028509524775 AS sv_8, -1.4332412094725877 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 25 AS sv_idx, 0.0 AS dual_coeff, 0.12894791123724086 AS sv_0, 0.6506067209702775 AS sv_1, -0.22887773821383223 AS sv_2, 0.33102294500659235 AS sv_3, -0.4701513824550577 AS sv_4, 0.9428923579731946 AS sv_5, -0.274116093353173 AS sv_6, 0.14675015500968058 AS sv_7, -1.3124142189597725 AS sv_8, -0.32257928780172823 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 26 AS sv_idx, 0.02255956406954066 AS dual_coeff, -0.520327735882063 AS sv_0, -1.5213111907033747 AS sv_1, 2.4315184437785144 AS sv_2, 0.3592795244718508 AS sv_3, 0.32622900008176564 AS sv_4, 1.1916928182803614 AS sv_5, -0.5628887017025386 AS sv_6, -0.6777260177602357 AS sv_7, -0.2942834435409094 AS sv_8, 1.3971427897210167 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 27 AS sv_idx, 0.22944324120745443 AS dual_coeff, 1.9823391269812736 AS sv_0, 1.041533370242338 AS sv_1, 1.1741916871533693 AS sv_2, 2.144983578407978 AS sv_3, -1.6631709351723898 AS sv_4, -0.7478608271844139 AS sv_5, -2.2951102991250854 AS sv_6, 1.6281529749851422 AS sv_7, 1.6396331333077083 AS sv_8, -1.525977817768459 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 28 AS sv_idx, -1.0 AS dual_coeff, 0.3728477956732985 AS sv_0, 0.2150610679834529 AS sv_1, 0.08393670362034505 AS sv_2, 0.7029479107610479 AS sv_3, -0.8778134194688425 AS sv_4, 0.6056477433901051 AS sv_5, -0.844443589473496 AS sv_6, 1.0202010595638178 AS sv_7, 0.9073571060114952 AS sv_8, 0.5949187633081499 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 29 AS sv_idx, -0.4161447064050657 AS dual_coeff, 1.4122845978733751 AS sv_0, 0.8860898474486589 AS sv_1, -1.9405186231398404 AS sv_2, -0.07474079289882218 AS sv_3, -0.7793444034413073 AS sv_4, -2.6702025981079935 AS sv_5, 0.06359503606562808 AS sv_6, 1.295307501104366 AS sv_7, -0.9879646225889391 AS sv_8, -0.9684510673956982 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 30 AS sv_idx, -0.0 AS dual_coeff, 1.4066838727702853 AS sv_0, -1.9182044206192992 AS sv_1, -0.5196200501051259 AS sv_2, -1.4705199852923474 AS sv_3, -0.3458523910961328 AS sv_4, 0.33616488091266306 AS sv_5, 1.1840694698786476 AS sv_6, -0.6080444045275858 AS sv_7, -0.29994497023595584 AS sv_8, -0.7844124282150763 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 31 AS sv_idx, -0.0 AS dual_coeff, -0.6292030328074096 AS sv_0, 0.1912075700484827 AS sv_1, -1.843749457931878 AS sv_2, -0.7991127838709606 AS sv_3, 0.6616827502981251 AS sv_4, 1.7840049271298177 AS sv_5, 0.8451858943105607 AS sv_6, 0.8140681317224646 AS sv_7, 0.08792025539317516 AS sv_8, 0.9950261622110849 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 32 AS sv_idx, -0.0 AS dual_coeff, 0.3341701047941328 AS sv_0, -2.662482196896262 AS sv_1, 0.07843518137226316 AS sv_2, -1.8595180608743578 AS sv_3, 0.009894199539738802 AS sv_4, 0.5011525213358909 AS sv_5, 1.5449586461756617 AS sv_6, -1.3978967416343981 AS sv_7, 0.8013585074033905 AS sv_8, 1.6588023725821097 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 33 AS sv_idx, -0.0 AS dual_coeff, 0.27097803892047134 AS sv_0, -2.050244728369085 AS sv_1, -0.4542127463856603 AS sv_2, -1.6409303806916962 AS sv_3, 1.2265855708161812 AS sv_4, 0.39276279886971993 AS sv_5, 1.4434868920883854 AS sv_6, -0.300095627427432 AS sv_7, 0.38730712905565656 AS sv_8, -0.3090329471111716 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 34 AS sv_idx, -1.0 AS dual_coeff, 0.7211425879338048 AS sv_0, 1.457288622504473 AS sv_1, 0.04006284303228038 AS sv_2, 1.693972182129337 AS sv_3, -0.43340082570959415 AS sv_4, -1.0101635421053963 AS sv_5, -1.6977213868691645 AS sv_6, 2.1933689021891722 AS sv_7, -0.32853587805805745 AS sv_8, 1.092602209782003 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 35 AS sv_idx, -1.0 AS dual_coeff, -2.3565166103036597 AS sv_0, -0.30251013989767633 AS sv_1, -0.3140968676549342 AS sv_2, -0.2384809460116976 AS sv_3, -0.057552546047053434 AS sv_4, 0.3584567179839237 AS sv_5, 0.16476994889061974 AS sv_6, 0.24320679990529717 AS sv_7, -0.34536210647094345 AS sv_8, 0.194783439550393 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 36 AS sv_idx, -0.0 AS dual_coeff, -1.0674962632282596 AS sv_0, 0.10738702259752413 AS sv_1, -1.3736167044518084 AS sv_2, -0.9294913297161647 AS sv_3, -0.2591018033659197 AS sv_4, -2.089976011450095 AS sv_5, 0.9982561688181318 AS sv_6, -0.5288704938579509 AS sv_7, -0.2489618806830741 AS sv_8, -0.20163113151409254 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 37 AS sv_idx, -1.0 AS dual_coeff, 0.6771904971815166 AS sv_0, 1.0719689016435152 AS sv_1, 0.5245306374555708 AS sv_2, 1.6491563675727086 AS sv_3, 0.00379803365985488 AS sv_4, 1.0864447846283871 AS sv_5, -1.6707192554829466 AS sv_6, 2.0264169541316184 AS sv_7, 0.8991761439312493 AS sv_8, -2.991975528502707 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 38 AS sv_idx, -0.7170113462529873 AS dual_coeff, -1.4368565283727257 AS sv_0, -1.2179850983373004 AS sv_1, 0.02957834923686986 AS sv_2, -1.8886785238541821 AS sv_3, 0.7298464602800008 AS sv_4, -1.2853111154258396 AS sv_5, 2.0338563000592718 AS sv_6, -2.9891471979477635 AS sv_7, 0.8549405023016902 AS sv_8, 0.544772187536236 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 39 AS sv_idx, -0.056211972191026964 AS dual_coeff, -0.029032309561236043 AS sv_0, -0.6453345904438006 AS sv_1, -1.117203658136182 AS sv_2, -1.5618681060804385 AS sv_3, 1.1721141707277283 AS sv_4, -0.10688969820803637 AS sv_5, 1.6685204789189094 AS sv_6, -0.9473215546387913 AS sv_7, -0.043736970360985186 AS sv_8, 0.35416133142343575 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 40 AS sv_idx, -0.0 AS dual_coeff, -0.934981534951002 AS sv_0, -0.9646927105624221 AS sv_1, -1.086082141474592 AS sv_2, -1.8089677945974325 AS sv_3, -0.5573323681766859 AS sv_4, 1.5320749070354607 AS sv_5, 1.8012437726323827 AS sv_6, -1.9513058268134067 AS sv_7, 0.5571671919157734 AS sv_8, 1.2547979832590759 AS sv_9 FROM SYSIBM.SYSDUMMY1) AS "Values"), 
kernel_dp_1_2 AS 
(SELECT t_3."KEY" AS "KEY", t_3.dot_product AS dot_product 
FROM (SELECT full_join_data_sv_3."KEY" AS "KEY", sum(CAST(full_join_data_sv_3.dot_prod1 AS DOUBLE)) + 0.2201386675176707 AS dot_product 
FROM (SELECT kernel_input."KEY" AS "KEY", "SV_data_1_2".dual_coeff * (kernel_input.scaler_2 * "SV_data_1_2".sv_0 + kernel_input.scaler_3 * "SV_data_1_2".sv_1 + kernel_input.scaler_4 * "SV_data_1_2".sv_2 + kernel_input.scaler_5 * "SV_data_1_2".sv_3 + kernel_input.scaler_6 * "SV_data_1_2".sv_4 + kernel_input.scaler_7 * "SV_data_1_2".sv_5 + kernel_input.scaler_8 * "SV_data_1_2".sv_6 + kernel_input.scaler_9 * "SV_data_1_2".sv_7 + kernel_input.scaler_10 * "SV_data_1_2".sv_8 + kernel_input.scaler_11 * "SV_data_1_2".sv_9) AS dot_prod1 
FROM kernel_input, "SV_data_1_2") AS full_join_data_sv_3 GROUP BY full_join_data_sv_3."KEY") AS t_3), 
kernel_cte_1_2 AS 
(SELECT kernel_dp_1_2."KEY" AS "KEY", 1 AS "OVO_Class1", 2 AS "OVO_Class2", CASE WHEN (-kernel_dp_1_2.dot_product >= 0.0) THEN 1 ELSE 0 END AS "OVO_Decision", coalesce(-kernel_dp_1_2.dot_product, 1.0 / (1.0 + exp(least(greatest(-100.0, -(-((-kernel_dp_1_2.dot_product) * -0.8646692088597091 + 0.10257223574712543))), 100.0)))) AS "OVO_Conf" 
FROM kernel_dp_1_2)
 SELECT "KernAgg_B3"."KEY", "KernAgg_B3"."OVO_Class1", "KernAgg_B3"."OVO_Class2", "KernAgg_B3"."OVO_Decision", "KernAgg_B3"."OVO_Conf" 
FROM (SELECT "KernAgg_esu_3"."KEY" AS "KEY", "KernAgg_esu_3"."OVO_Class1" AS "OVO_Class1", "KernAgg_esu_3"."OVO_Class2" AS "OVO_Class2", "KernAgg_esu_3"."OVO_Decision" AS "OVO_Decision", "KernAgg_esu_3"."OVO_Conf" AS "OVO_Conf" 
FROM (SELECT kernel_cte_1_2."KEY" AS "KEY", kernel_cte_1_2."OVO_Class1" AS "OVO_Class1", kernel_cte_1_2."OVO_Class2" AS "OVO_Class2", kernel_cte_1_2."OVO_Decision" AS "OVO_Decision", kernel_cte_1_2."OVO_Conf" AS "OVO_Conf" 
FROM kernel_cte_1_2) AS "KernAgg_esu_3") AS "KernAgg_B3"

-- Code For temporary table tmp_20180602143441_2gc_kernagg_b4 part 1. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180602143441_2gc_kernagg_b4 (
	"KEY" BIGINT, 
	"OVO_Class1" BIGINT, 
	"OVO_Class2" BIGINT, 
	"OVO_Decision" BIGINT, 
	"OVO_Conf" DOUBLE
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180602143441_2gc_kernagg_b4 part 2. Populate

INSERT INTO tmp_20180602143441_2gc_kernagg_b4 WITH kernel_input AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CAST("ADS_sca_2_OUT".scaler_2 AS DOUBLE) AS scaler_2, CAST("ADS_sca_2_OUT".scaler_3 AS DOUBLE) AS scaler_3, CAST("ADS_sca_2_OUT".scaler_4 AS DOUBLE) AS scaler_4, CAST("ADS_sca_2_OUT".scaler_5 AS DOUBLE) AS scaler_5, CAST("ADS_sca_2_OUT".scaler_6 AS DOUBLE) AS scaler_6, CAST("ADS_sca_2_OUT".scaler_7 AS DOUBLE) AS scaler_7, CAST("ADS_sca_2_OUT".scaler_8 AS DOUBLE) AS scaler_8, CAST("ADS_sca_2_OUT".scaler_9 AS DOUBLE) AS scaler_9, CAST("ADS_sca_2_OUT".scaler_10 AS DOUBLE) AS scaler_10, CAST("ADS_sca_2_OUT".scaler_11 AS DOUBLE) AS scaler_11 
FROM tmp_20180602143441_2qt_ads_sca_2_out AS "ADS_sca_2_OUT"), 
"SV_data_1_3" AS 
(SELECT "Values".sv_idx AS sv_idx, CAST("Values".dual_coeff AS DOUBLE) AS dual_coeff, CAST("Values".sv_0 AS DOUBLE) AS sv_0, CAST("Values".sv_1 AS DOUBLE) AS sv_1, CAST("Values".sv_2 AS DOUBLE) AS sv_2, CAST("Values".sv_3 AS DOUBLE) AS sv_3, CAST("Values".sv_4 AS DOUBLE) AS sv_4, CAST("Values".sv_5 AS DOUBLE) AS sv_5, CAST("Values".sv_6 AS DOUBLE) AS sv_6, CAST("Values".sv_7 AS DOUBLE) AS sv_7, CAST("Values".sv_8 AS DOUBLE) AS sv_8, CAST("Values".sv_9 AS DOUBLE) AS sv_9 
FROM (SELECT 14 AS sv_idx, 1.0 AS dual_coeff, -0.6384379162711309 AS sv_0, 0.717712741267091 AS sv_1, -0.029441812995214225 AS sv_2, 0.19454074631293933 AS sv_3, 0.42356979543552 AS sv_4, 0.4996306149226033 AS sv_5, -0.014709875293858664 AS sv_6, -0.21682672177070866 AS sv_7, 0.8731634819745784 AS sv_8, 0.3996037942181906 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 15 AS sv_idx, 1.0 AS dual_coeff, -0.5091996214221497 AS sv_0, 1.1713064754998441 AS sv_1, -0.48494740604431213 AS sv_2, -0.008898553173031508 AS sv_3, 1.3733454370146492 AS sv_4, -0.3114028163844563 AS sv_5, 0.35946894921283384 AS sv_6, -0.22891358225263628 AS sv_7, 0.6298212594245098 AS sv_8, -1.259802912006969 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 16 AS sv_idx, 0.0 AS dual_coeff, -0.08197430824290891 AS sv_0, -0.00021955504887942811 AS sv_1, 1.1805552767545813 AS sv_2, 0.9006545480532682 AS sv_3, 2.4222684678755795 AS sv_4, 1.2870622577404576 AS sv_5, -0.849223596083783 AS sv_6, 1.5371118397176036 AS sv_7, -0.128922343722663 AS sv_8, 1.3531654464868126 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 17 AS sv_idx, 1.0 AS dual_coeff, 1.498564845881099 AS sv_0, 1.48831742779472 AS sv_1, -0.9195950368877045 AS sv_2, 0.45496476868785374 AS sv_3, -0.8831439969763527 AS sv_4, 0.1605753080607123 AS sv_5, -0.29246802189369364 AS sv_6, 0.2500655154498075 AS sv_7, 0.8724808729913642 AS sv_8, -1.5908321123459748 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 18 AS sv_idx, 0.03886257408995834 AS dual_coeff, -0.6167692842155993 AS sv_0, -0.2173495764149621 AS sv_1, 0.4539181821969074 AS sv_2, 0.18067095507803288 AS sv_3, 0.6122834345039813 AS sv_4, -2.0679664960978896 AS sv_5, -0.19976608756975378 AS sv_6, 0.31411294150482844 AS sv_7, -0.7119488376066533 AS sv_8, -0.32601200274560516 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 19 AS sv_idx, 1.0 AS dual_coeff, -0.46515313120920093 AS sv_0, 1.2103577416175606 AS sv_1, 0.14357328513380316 AS sv_2, 1.0670224926771352 AS sv_3, -0.004180412672813376 AS sv_4, -0.5165474025968144 AS sv_5, -0.9551233938552457 AS sv_6, 0.9299887560835304 AS sv_7, -1.1277360622292962 AS sv_8, 1.3633593105363355 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 20 AS sv_idx, 1.0 AS dual_coeff, 0.009674343495163067 AS sv_0, 1.2178845494390973 AS sv_1, 2.412039780702482 AS sv_2, 2.7994399099133482 AS sv_3, -2.364480222710695 AS sv_4, -1.200108875400591 AS sv_5, -2.9327320914381376 AS sv_6, 0.8741712868555673 AS sv_7, 0.15348555651244278 AS sv_8, 0.10452254551846794 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 21 AS sv_idx, 0.0 AS dual_coeff, -0.7181604123131647 AS sv_0, 0.47635997350587705 AS sv_1, 0.21388659584479253 AS sv_2, 1.1163530548266316 AS sv_3, -0.4968220838205612 AS sv_4, -0.5072223495412532 AS sv_5, -1.24688692572275 AS sv_6, 1.7030243556175357 AS sv_7, -1.003380404809525 AS sv_8, 0.6423375532130973 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 22 AS sv_idx, 0.0 AS dual_coeff, -0.38529554644994124 AS sv_0, -0.33978526464340053 AS sv_1, 1.1521852950916334 AS sv_2, 0.6277675404581664 AS sv_3, 1.4605869711557362 AS sv_4, -0.5811596496045133 AS sv_5, -0.6601503419469803 AS sv_6, 0.9136756412886499 AS sv_7, 0.10977779808551855 AS sv_8, -0.36931239107023645 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 23 AS sv_idx, 0.4436066374670497 AS dual_coeff, -1.292731963918506 AS sv_0, 0.5628285196619536 AS sv_1, 0.007127339857400062 AS sv_2, 0.3728509698863072 AS sv_3, 0.7108565052671136 AS sv_4, 1.5681721671032636 AS sv_5, -0.26318102458574727 AS sv_6, 0.512232870741319 AS sv_7, 0.5221201360240043 AS sv_8, 0.4516931545431869 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 24 AS sv_idx, 0.37488733188581075 AS dual_coeff, 0.3737039642758539 AS sv_0, 0.3836668075977489 AS sv_1, 0.2262882357990665 AS sv_2, 0.4555038841016273 AS sv_3, -0.23804811339629262 AS sv_4, -0.3942471767707451 AS sv_5, -0.4370578804876122 AS sv_6, 0.2168474346275738 AS sv_7, 0.46104028509524775 AS sv_8, -1.4332412094725877 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 25 AS sv_idx, 1.0 AS dual_coeff, 0.12894791123724086 AS sv_0, 0.6506067209702775 AS sv_1, -0.22887773821383223 AS sv_2, 0.33102294500659235 AS sv_3, -0.4701513824550577 AS sv_4, 0.9428923579731946 AS sv_5, -0.274116093353173 AS sv_6, 0.14675015500968058 AS sv_7, -1.3124142189597725 AS sv_8, -0.32257928780172823 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 26 AS sv_idx, 0.77719567388073 AS dual_coeff, -0.520327735882063 AS sv_0, -1.5213111907033747 AS sv_1, 2.4315184437785144 AS sv_2, 0.3592795244718508 AS sv_3, 0.32622900008176564 AS sv_4, 1.1916928182803614 AS sv_5, -0.5628887017025386 AS sv_6, -0.6777260177602357 AS sv_7, -0.2942834435409094 AS sv_8, 1.3971427897210167 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 27 AS sv_idx, 0.0 AS dual_coeff, 1.9823391269812736 AS sv_0, 1.041533370242338 AS sv_1, 1.1741916871533693 AS sv_2, 2.144983578407978 AS sv_3, -1.6631709351723898 AS sv_4, -0.7478608271844139 AS sv_5, -2.2951102991250854 AS sv_6, 1.6281529749851422 AS sv_7, 1.6396331333077083 AS sv_8, -1.525977817768459 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 41 AS sv_idx, -0.8529562477201913 AS dual_coeff, 0.0008433489338253888 AS sv_0, 1.0190935734784685 AS sv_1, -1.0466969195863554 AS sv_2, -0.153635634271338 AS sv_3, -0.21784172021227197 AS sv_4, 0.8348367712842659 AS sv_5, 0.3439735076537882 AS sv_6, -0.21776140010381564 AS sv_7, -1.8166151201121956 AS sv_8, -0.02152392332244568 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 42 AS sv_idx, -0.20566872768790795 AS dual_coeff, 0.5773878879888359 AS sv_0, -0.04740428413578312 AS sv_1, -1.2234686072271048 AS sv_2, -1.0128407016591991 AS sv_3, -0.3818985360960217 AS sv_4, 1.671097439599355 AS sv_5, 1.0699845515484259 AS sv_6, -0.8233511502676111 AS sv_7, -1.4692416856923658 AS sv_8, 0.005724382112255003 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 43 AS sv_idx, -1.0 AS dual_coeff, 0.653603437858243 AS sv_0, 0.8118703103381688 AS sv_1, 0.4831496203093006 AS sv_2, 0.7608214517358779 AS sv_3, -1.1866385814847495 AS sv_4, 1.8806879512866757 AS sv_5, -0.7051943912062965 AS sv_6, -0.3624691202705955 AS sv_7, 0.4555274542508199 AS sv_8, 0.7462749250325531 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 44 AS sv_idx, -1.0 AS dual_coeff, -2.1024798763599506 AS sv_0, 1.5240734804788811 AS sv_1, 1.9689308324675117 AS sv_2, 1.891995306292 AS sv_3, 0.679249986774034 AS sv_4, -0.1098862436845744 AS sv_5, -1.6205444395313497 AS sv_6, 0.12264829403156129 AS sv_7, -0.20911262738915795 AS sv_8, -0.6406762436910173 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 45 AS sv_idx, -0.9167383945931493 AS dual_coeff, 0.33214000192394044 AS sv_0, 0.8682960329566819 AS sv_1, -0.5013392512877888 AS sv_2, -0.03281534427464479 AS sv_3, -0.0032357270003156705 AS sv_4, 0.2103253963377075 AS sv_5, 0.2304232694176142 AS sv_6, -0.4561249958634437 AS sv_7, -0.0771639856812561 AS sv_8, -0.11028680261650832 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 46 AS sv_idx, -0.0 AS dual_coeff, -1.1379055912419944 AS sv_0, -0.5640619761892367 AS sv_1, -0.1777553768727278 AS sv_2, -1.0356505287803321 AS sv_3, -0.6587029210547068 AS sv_4, 1.2318416707537607 AS sv_5, 1.0684076836748335 AS sv_6, -1.9304847007875792 AS sv_7, -0.5480279298054324 AS sv_8, -0.9752381834622871 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 47 AS sv_idx, -0.0 AS dual_coeff, -0.30054156935146226 AS sv_0, 0.7488764334812653 AS sv_1, -1.0450013234492215 AS sv_2, -0.45948890986000973 AS sv_3, 0.04580678999985555 AS sv_4, -0.05915947239622647 AS sv_5, 0.6587191391651996 AS sv_6, -0.5388077262123063 AS sv_7, -0.09179898167213818 AS sv_8, 1.4028984451900115 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 48 AS sv_idx, -0.2938394210244224 AS dual_coeff, -0.7372166845096658 AS sv_0, -0.22015314479000983 AS sv_1, 0.42961411818247125 AS sv_2, 0.4250842123905216 AS sv_3, -2.0765881027653883 AS sv_4, -0.5245479335237841 AS sv_5, -0.6405709412212055 AS sv_6, -0.16744493265128024 AS sv_7, -1.444178919308708 AS sv_8, -1.239069279895893 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 49 AS sv_idx, -1.0 AS dual_coeff, -0.2920866837452327 AS sv_0, 1.022088295144699 AS sv_1, 0.8926086199520507 AS sv_2, 1.0512447783534276 AS sv_3, -0.18433458091274885 AS sv_4, -1.8267668306458908 AS sv_5, -0.9027661724119904 AS sv_6, -0.0929429673282683 AS sv_7, 1.1530313398531398 AS sv_8, -0.476144506380824 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 50 AS sv_idx, -0.0 AS dual_coeff, 0.0209646061207601 AS sv_0, 0.21454214449934803 AS sv_1, 0.4214492573789425 AS sv_2, -0.38655167771021287 AS sv_3, -0.13001080381200664 AS sv_4, -0.529477376429765 AS sv_5, 0.5921183931822596 AS sv_6, -1.980719521539998 AS sv_7, -0.08522243972761444 AS sv_8, 0.5408456420597524 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 51 AS sv_idx, -1.0 AS dual_coeff, -0.2936890582581222 AS sv_0, 0.1845972607803685 AS sv_1, 1.194851980968043 AS sv_2, 0.8957339490455271 AS sv_3, 0.07996263821322273 AS sv_4, 0.6221954112193534 AS sv_5, -0.9025809387220117 AS sv_6, 0.256469803215711 AS sv_7, 0.3952631174819938 AS sv_8, 0.11259378535590062 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 52 AS sv_idx, -0.36534942629787653 AS dual_coeff, -0.11191263631327658 AS sv_0, 1.3813029664097791 AS sv_1, 1.656277470117092 AS sv_2, 1.7619728083931392 AS sv_3, -0.9651613323940517 AS sv_4, 0.08470566089931222 AS sv_5, -1.6220269594798407 AS sv_6, -0.24693306041128285 AS sv_7, 0.9092784839684264 AS sv_8, -0.7129384781069622 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 53 AS sv_idx, -1.0 AS dual_coeff, 0.44597422459008845 AS sv_0, 0.9902936111731451 AS sv_1, -0.8160384250812989 AS sv_2, 0.35746313515467953 AS sv_3, -0.269092058172476 AS sv_4, -0.9631034804865878 AS sv_5, -0.27341551428773603 AS sv_6, 0.757789277759762 AS sv_7, 0.4622806538341011 AS sv_8, 0.6543304764988714 AS sv_9 FROM SYSIBM.SYSDUMMY1) AS "Values"), 
kernel_dp_1_3 AS 
(SELECT t_4."KEY" AS "KEY", t_4.dot_product AS dot_product 
FROM (SELECT full_join_data_sv_4."KEY" AS "KEY", sum(CAST(full_join_data_sv_4.dot_prod1 AS DOUBLE)) + 0.4890271240082854 AS dot_product 
FROM (SELECT kernel_input."KEY" AS "KEY", "SV_data_1_3".dual_coeff * (kernel_input.scaler_2 * "SV_data_1_3".sv_0 + kernel_input.scaler_3 * "SV_data_1_3".sv_1 + kernel_input.scaler_4 * "SV_data_1_3".sv_2 + kernel_input.scaler_5 * "SV_data_1_3".sv_3 + kernel_input.scaler_6 * "SV_data_1_3".sv_4 + kernel_input.scaler_7 * "SV_data_1_3".sv_5 + kernel_input.scaler_8 * "SV_data_1_3".sv_6 + kernel_input.scaler_9 * "SV_data_1_3".sv_7 + kernel_input.scaler_10 * "SV_data_1_3".sv_8 + kernel_input.scaler_11 * "SV_data_1_3".sv_9) AS dot_prod1 
FROM kernel_input, "SV_data_1_3") AS full_join_data_sv_4 GROUP BY full_join_data_sv_4."KEY") AS t_4), 
kernel_cte_1_3 AS 
(SELECT kernel_dp_1_3."KEY" AS "KEY", 1 AS "OVO_Class1", 3 AS "OVO_Class2", CASE WHEN (-kernel_dp_1_3.dot_product >= 0.0) THEN 1 ELSE 0 END AS "OVO_Decision", coalesce(-kernel_dp_1_3.dot_product, 1.0 / (1.0 + exp(least(greatest(-100.0, -(-((-kernel_dp_1_3.dot_product) * -0.672571803255304 + 0.16116363098265973))), 100.0)))) AS "OVO_Conf" 
FROM kernel_dp_1_3)
 SELECT "KernAgg_B4"."KEY", "KernAgg_B4"."OVO_Class1", "KernAgg_B4"."OVO_Class2", "KernAgg_B4"."OVO_Decision", "KernAgg_B4"."OVO_Conf" 
FROM (SELECT "KernAgg_esu_4"."KEY" AS "KEY", "KernAgg_esu_4"."OVO_Class1" AS "OVO_Class1", "KernAgg_esu_4"."OVO_Class2" AS "OVO_Class2", "KernAgg_esu_4"."OVO_Decision" AS "OVO_Decision", "KernAgg_esu_4"."OVO_Conf" AS "OVO_Conf" 
FROM (SELECT kernel_cte_1_3."KEY" AS "KEY", kernel_cte_1_3."OVO_Class1" AS "OVO_Class1", kernel_cte_1_3."OVO_Class2" AS "OVO_Class2", kernel_cte_1_3."OVO_Decision" AS "OVO_Decision", kernel_cte_1_3."OVO_Conf" AS "OVO_Conf" 
FROM kernel_cte_1_3) AS "KernAgg_esu_4") AS "KernAgg_B4"

-- Code For temporary table tmp_20180602143441_arj_kernagg_b5 part 1. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180602143441_arj_kernagg_b5 (
	"KEY" BIGINT, 
	"OVO_Class1" BIGINT, 
	"OVO_Class2" BIGINT, 
	"OVO_Decision" BIGINT, 
	"OVO_Conf" DOUBLE
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180602143441_arj_kernagg_b5 part 2. Populate

INSERT INTO tmp_20180602143441_arj_kernagg_b5 WITH kernel_input AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CAST("ADS_sca_2_OUT".scaler_2 AS DOUBLE) AS scaler_2, CAST("ADS_sca_2_OUT".scaler_3 AS DOUBLE) AS scaler_3, CAST("ADS_sca_2_OUT".scaler_4 AS DOUBLE) AS scaler_4, CAST("ADS_sca_2_OUT".scaler_5 AS DOUBLE) AS scaler_5, CAST("ADS_sca_2_OUT".scaler_6 AS DOUBLE) AS scaler_6, CAST("ADS_sca_2_OUT".scaler_7 AS DOUBLE) AS scaler_7, CAST("ADS_sca_2_OUT".scaler_8 AS DOUBLE) AS scaler_8, CAST("ADS_sca_2_OUT".scaler_9 AS DOUBLE) AS scaler_9, CAST("ADS_sca_2_OUT".scaler_10 AS DOUBLE) AS scaler_10, CAST("ADS_sca_2_OUT".scaler_11 AS DOUBLE) AS scaler_11 
FROM tmp_20180602143441_2qt_ads_sca_2_out AS "ADS_sca_2_OUT"), 
"SV_data_2_3" AS 
(SELECT "Values".sv_idx AS sv_idx, CAST("Values".dual_coeff AS DOUBLE) AS dual_coeff, CAST("Values".sv_0 AS DOUBLE) AS sv_0, CAST("Values".sv_1 AS DOUBLE) AS sv_1, CAST("Values".sv_2 AS DOUBLE) AS sv_2, CAST("Values".sv_3 AS DOUBLE) AS sv_3, CAST("Values".sv_4 AS DOUBLE) AS sv_4, CAST("Values".sv_5 AS DOUBLE) AS sv_5, CAST("Values".sv_6 AS DOUBLE) AS sv_6, CAST("Values".sv_7 AS DOUBLE) AS sv_7, CAST("Values".sv_8 AS DOUBLE) AS sv_8, CAST("Values".sv_9 AS DOUBLE) AS sv_9 
FROM (SELECT 28 AS sv_idx, 0.42428826136321884 AS dual_coeff, 0.3728477956732985 AS sv_0, 0.2150610679834529 AS sv_1, 0.08393670362034505 AS sv_2, 0.7029479107610479 AS sv_3, -0.8778134194688425 AS sv_4, 0.6056477433901051 AS sv_5, -0.844443589473496 AS sv_6, 1.0202010595638178 AS sv_7, 0.9073571060114952 AS sv_8, 0.5949187633081499 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 29 AS sv_idx, 0.11807122382967716 AS dual_coeff, 1.4122845978733751 AS sv_0, 0.8860898474486589 AS sv_1, -1.9405186231398404 AS sv_2, -0.07474079289882218 AS sv_3, -0.7793444034413073 AS sv_4, -2.6702025981079935 AS sv_5, 0.06359503606562808 AS sv_6, 1.295307501104366 AS sv_7, -0.9879646225889391 AS sv_8, -0.9684510673956982 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 30 AS sv_idx, 0.0 AS dual_coeff, 1.4066838727702853 AS sv_0, -1.9182044206192992 AS sv_1, -0.5196200501051259 AS sv_2, -1.4705199852923474 AS sv_3, -0.3458523910961328 AS sv_4, 0.33616488091266306 AS sv_5, 1.1840694698786476 AS sv_6, -0.6080444045275858 AS sv_7, -0.29994497023595584 AS sv_8, -0.7844124282150763 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 31 AS sv_idx, 0.0 AS dual_coeff, -0.6292030328074096 AS sv_0, 0.1912075700484827 AS sv_1, -1.843749457931878 AS sv_2, -0.7991127838709606 AS sv_3, 0.6616827502981251 AS sv_4, 1.7840049271298177 AS sv_5, 0.8451858943105607 AS sv_6, 0.8140681317224646 AS sv_7, 0.08792025539317516 AS sv_8, 0.9950261622110849 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 32 AS sv_idx, 0.0 AS dual_coeff, 0.3341701047941328 AS sv_0, -2.662482196896262 AS sv_1, 0.07843518137226316 AS sv_2, -1.8595180608743578 AS sv_3, 0.009894199539738802 AS sv_4, 0.5011525213358909 AS sv_5, 1.5449586461756617 AS sv_6, -1.3978967416343981 AS sv_7, 0.8013585074033905 AS sv_8, 1.6588023725821097 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 33 AS sv_idx, 0.0 AS dual_coeff, 0.27097803892047134 AS sv_0, -2.050244728369085 AS sv_1, -0.4542127463856603 AS sv_2, -1.6409303806916962 AS sv_3, 1.2265855708161812 AS sv_4, 0.39276279886971993 AS sv_5, 1.4434868920883854 AS sv_6, -0.300095627427432 AS sv_7, 0.38730712905565656 AS sv_8, -0.3090329471111716 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 34 AS sv_idx, 1.0 AS dual_coeff, 0.7211425879338048 AS sv_0, 1.457288622504473 AS sv_1, 0.04006284303228038 AS sv_2, 1.693972182129337 AS sv_3, -0.43340082570959415 AS sv_4, -1.0101635421053963 AS sv_5, -1.6977213868691645 AS sv_6, 2.1933689021891722 AS sv_7, -0.32853587805805745 AS sv_8, 1.092602209782003 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 35 AS sv_idx, 0.33391626926172124 AS dual_coeff, -2.3565166103036597 AS sv_0, -0.30251013989767633 AS sv_1, -0.3140968676549342 AS sv_2, -0.2384809460116976 AS sv_3, -0.057552546047053434 AS sv_4, 0.3584567179839237 AS sv_5, 0.16476994889061974 AS sv_6, 0.24320679990529717 AS sv_7, -0.34536210647094345 AS sv_8, 0.194783439550393 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 36 AS sv_idx, 0.03400903346512697 AS dual_coeff, -1.0674962632282596 AS sv_0, 0.10738702259752413 AS sv_1, -1.3736167044518084 AS sv_2, -0.9294913297161647 AS sv_3, -0.2591018033659197 AS sv_4, -2.089976011450095 AS sv_5, 0.9982561688181318 AS sv_6, -0.5288704938579509 AS sv_7, -0.2489618806830741 AS sv_8, -0.20163113151409254 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 37 AS sv_idx, 0.7185163480700162 AS dual_coeff, 0.6771904971815166 AS sv_0, 1.0719689016435152 AS sv_1, 0.5245306374555708 AS sv_2, 1.6491563675727086 AS sv_3, 0.00379803365985488 AS sv_4, 1.0864447846283871 AS sv_5, -1.6707192554829466 AS sv_6, 2.0264169541316184 AS sv_7, 0.8991761439312493 AS sv_8, -2.991975528502707 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 38 AS sv_idx, 0.9792216641737309 AS dual_coeff, -1.4368565283727257 AS sv_0, -1.2179850983373004 AS sv_1, 0.02957834923686986 AS sv_2, -1.8886785238541821 AS sv_3, 0.7298464602800008 AS sv_4, -1.2853111154258396 AS sv_5, 2.0338563000592718 AS sv_6, -2.9891471979477635 AS sv_7, 0.8549405023016902 AS sv_8, 0.544772187536236 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 39 AS sv_idx, 0.0 AS dual_coeff, -0.029032309561236043 AS sv_0, -0.6453345904438006 AS sv_1, -1.117203658136182 AS sv_2, -1.5618681060804385 AS sv_3, 1.1721141707277283 AS sv_4, -0.10688969820803637 AS sv_5, 1.6685204789189094 AS sv_6, -0.9473215546387913 AS sv_7, -0.043736970360985186 AS sv_8, 0.35416133142343575 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 40 AS sv_idx, 0.7912651763877347 AS dual_coeff, -0.934981534951002 AS sv_0, -0.9646927105624221 AS sv_1, -1.086082141474592 AS sv_2, -1.8089677945974325 AS sv_3, -0.5573323681766859 AS sv_4, 1.5320749070354607 AS sv_5, 1.8012437726323827 AS sv_6, -1.9513058268134067 AS sv_7, 0.5571671919157734 AS sv_8, 1.2547979832590759 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 41 AS sv_idx, -0.0 AS dual_coeff, 0.0008433489338253888 AS sv_0, 1.0190935734784685 AS sv_1, -1.0466969195863554 AS sv_2, -0.153635634271338 AS sv_3, -0.21784172021227197 AS sv_4, 0.8348367712842659 AS sv_5, 0.3439735076537882 AS sv_6, -0.21776140010381564 AS sv_7, -1.8166151201121956 AS sv_8, -0.02152392332244568 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 42 AS sv_idx, -0.0 AS dual_coeff, 0.5773878879888359 AS sv_0, -0.04740428413578312 AS sv_1, -1.2234686072271048 AS sv_2, -1.0128407016591991 AS sv_3, -0.3818985360960217 AS sv_4, 1.671097439599355 AS sv_5, 1.0699845515484259 AS sv_6, -0.8233511502676111 AS sv_7, -1.4692416856923658 AS sv_8, 0.005724382112255003 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 43 AS sv_idx, -0.0 AS dual_coeff, 0.653603437858243 AS sv_0, 0.8118703103381688 AS sv_1, 0.4831496203093006 AS sv_2, 0.7608214517358779 AS sv_3, -1.1866385814847495 AS sv_4, 1.8806879512866757 AS sv_5, -0.7051943912062965 AS sv_6, -0.3624691202705955 AS sv_7, 0.4555274542508199 AS sv_8, 0.7462749250325531 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 44 AS sv_idx, -0.0 AS dual_coeff, -2.1024798763599506 AS sv_0, 1.5240734804788811 AS sv_1, 1.9689308324675117 AS sv_2, 1.891995306292 AS sv_3, 0.679249986774034 AS sv_4, -0.1098862436845744 AS sv_5, -1.6205444395313497 AS sv_6, 0.12264829403156129 AS sv_7, -0.20911262738915795 AS sv_8, -0.6406762436910173 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 45 AS sv_idx, -0.0 AS dual_coeff, 0.33214000192394044 AS sv_0, 0.8682960329566819 AS sv_1, -0.5013392512877888 AS sv_2, -0.03281534427464479 AS sv_3, -0.0032357270003156705 AS sv_4, 0.2103253963377075 AS sv_5, 0.2304232694176142 AS sv_6, -0.4561249958634437 AS sv_7, -0.0771639856812561 AS sv_8, -0.11028680261650832 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 46 AS sv_idx, -0.972462256273775 AS dual_coeff, -1.1379055912419944 AS sv_0, -0.5640619761892367 AS sv_1, -0.1777553768727278 AS sv_2, -1.0356505287803321 AS sv_3, -0.6587029210547068 AS sv_4, 1.2318416707537607 AS sv_5, 1.0684076836748335 AS sv_6, -1.9304847007875792 AS sv_7, -0.5480279298054324 AS sv_8, -0.9752381834622871 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 47 AS sv_idx, -0.9350312198193185 AS dual_coeff, -0.30054156935146226 AS sv_0, 0.7488764334812653 AS sv_1, -1.0450013234492215 AS sv_2, -0.45948890986000973 AS sv_3, 0.04580678999985555 AS sv_4, -0.05915947239622647 AS sv_5, 0.6587191391651996 AS sv_6, -0.5388077262123063 AS sv_7, -0.09179898167213818 AS sv_8, 1.4028984451900115 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 48 AS sv_idx, -0.0 AS dual_coeff, -0.7372166845096658 AS sv_0, -0.22015314479000983 AS sv_1, 0.42961411818247125 AS sv_2, 0.4250842123905216 AS sv_3, -2.0765881027653883 AS sv_4, -0.5245479335237841 AS sv_5, -0.6405709412212055 AS sv_6, -0.16744493265128024 AS sv_7, -1.444178919308708 AS sv_8, -1.239069279895893 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 49 AS sv_idx, -0.49179450045813233 AS dual_coeff, -0.2920866837452327 AS sv_0, 1.022088295144699 AS sv_1, 0.8926086199520507 AS sv_2, 1.0512447783534276 AS sv_3, -0.18433458091274885 AS sv_4, -1.8267668306458908 AS sv_5, -0.9027661724119904 AS sv_6, -0.0929429673282683 AS sv_7, 1.1530313398531398 AS sv_8, -0.476144506380824 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 50 AS sv_idx, -0.0 AS dual_coeff, 0.0209646061207601 AS sv_0, 0.21454214449934803 AS sv_1, 0.4214492573789425 AS sv_2, -0.38655167771021287 AS sv_3, -0.13001080381200664 AS sv_4, -0.529477376429765 AS sv_5, 0.5921183931822596 AS sv_6, -1.980719521539998 AS sv_7, -0.08522243972761444 AS sv_8, 0.5408456420597524 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 51 AS sv_idx, -1.0 AS dual_coeff, -0.2936890582581222 AS sv_0, 0.1845972607803685 AS sv_1, 1.194851980968043 AS sv_2, 0.8957339490455271 AS sv_3, 0.07996263821322273 AS sv_4, 0.6221954112193534 AS sv_5, -0.9025809387220117 AS sv_6, 0.256469803215711 AS sv_7, 0.3952631174819938 AS sv_8, 0.11259378535590062 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 52 AS sv_idx, -0.0 AS dual_coeff, -0.11191263631327658 AS sv_0, 1.3813029664097791 AS sv_1, 1.656277470117092 AS sv_2, 1.7619728083931392 AS sv_3, -0.9651613323940517 AS sv_4, 0.08470566089931222 AS sv_5, -1.6220269594798407 AS sv_6, -0.24693306041128285 AS sv_7, 0.9092784839684264 AS sv_8, -0.7129384781069622 AS sv_9 FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 53 AS sv_idx, -1.0 AS dual_coeff, 0.44597422459008845 AS sv_0, 0.9902936111731451 AS sv_1, -0.8160384250812989 AS sv_2, 0.35746313515467953 AS sv_3, -0.269092058172476 AS sv_4, -0.9631034804865878 AS sv_5, -0.27341551428773603 AS sv_6, 0.757789277759762 AS sv_7, 0.4622806538341011 AS sv_8, 0.6543304764988714 AS sv_9 FROM SYSIBM.SYSDUMMY1) AS "Values"), 
kernel_dp_2_3 AS 
(SELECT t_5."KEY" AS "KEY", t_5.dot_product AS dot_product 
FROM (SELECT full_join_data_sv_5."KEY" AS "KEY", sum(CAST(full_join_data_sv_5.dot_prod1 AS DOUBLE)) + 0.2744408410538362 AS dot_product 
FROM (SELECT kernel_input."KEY" AS "KEY", "SV_data_2_3".dual_coeff * (kernel_input.scaler_2 * "SV_data_2_3".sv_0 + kernel_input.scaler_3 * "SV_data_2_3".sv_1 + kernel_input.scaler_4 * "SV_data_2_3".sv_2 + kernel_input.scaler_5 * "SV_data_2_3".sv_3 + kernel_input.scaler_6 * "SV_data_2_3".sv_4 + kernel_input.scaler_7 * "SV_data_2_3".sv_5 + kernel_input.scaler_8 * "SV_data_2_3".sv_6 + kernel_input.scaler_9 * "SV_data_2_3".sv_7 + kernel_input.scaler_10 * "SV_data_2_3".sv_8 + kernel_input.scaler_11 * "SV_data_2_3".sv_9) AS dot_prod1 
FROM kernel_input, "SV_data_2_3") AS full_join_data_sv_5 GROUP BY full_join_data_sv_5."KEY") AS t_5), 
kernel_cte_2_3 AS 
(SELECT kernel_dp_2_3."KEY" AS "KEY", 2 AS "OVO_Class1", 3 AS "OVO_Class2", CASE WHEN (-kernel_dp_2_3.dot_product >= 0.0) THEN 1 ELSE 0 END AS "OVO_Decision", coalesce(-kernel_dp_2_3.dot_product, 1.0 / (1.0 + exp(least(greatest(-100.0, -(-((-kernel_dp_2_3.dot_product) * -1.1293462901816147 + 0.10681023272828184))), 100.0)))) AS "OVO_Conf" 
FROM kernel_dp_2_3)
 SELECT "KernAgg_B5"."KEY", "KernAgg_B5"."OVO_Class1", "KernAgg_B5"."OVO_Class2", "KernAgg_B5"."OVO_Decision", "KernAgg_B5"."OVO_Conf" 
FROM (SELECT "KernAgg_esu_5"."KEY" AS "KEY", "KernAgg_esu_5"."OVO_Class1" AS "OVO_Class1", "KernAgg_esu_5"."OVO_Class2" AS "OVO_Class2", "KernAgg_esu_5"."OVO_Decision" AS "OVO_Decision", "KernAgg_esu_5"."OVO_Conf" AS "OVO_Conf" 
FROM (SELECT kernel_cte_2_3."KEY" AS "KEY", kernel_cte_2_3."OVO_Class1" AS "OVO_Class1", kernel_cte_2_3."OVO_Class2" AS "OVO_Class2", kernel_cte_2_3."OVO_Decision" AS "OVO_Decision", kernel_cte_2_3."OVO_Conf" AS "OVO_Conf" 
FROM kernel_cte_2_3) AS "KernAgg_esu_5") AS "KernAgg_B5"

-- Code For temporary table tmp_20180602143442_6i5_kernagg_agg part 1. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180602143442_6i5_kernagg_agg (
	"KEY" BIGINT, 
	"OVO_Vote_0" BIGINT, 
	"OVO_SumConfidence_0" DOUBLE, 
	"OVO_Vote_1" BIGINT, 
	"OVO_SumConfidence_1" DOUBLE, 
	"OVO_Vote_2" BIGINT, 
	"OVO_SumConfidence_2" DOUBLE, 
	"OVO_Vote_3" BIGINT, 
	"OVO_SumConfidence_3" DOUBLE, 
	max_abs_confidence DOUBLE, 
	"OVO_Scale" DOUBLE, 
	"Score_0" DOUBLE, 
	"Score_1" DOUBLE, 
	"Score_2" DOUBLE, 
	"Score_3" DOUBLE
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180602143442_6i5_kernagg_agg part 2. Populate

INSERT INTO tmp_20180602143442_6i5_kernagg_agg WITH "KernAgg_Union" AS 
(SELECT "KernAgg_EnsembleUnion"."KEY" AS "KEY", "KernAgg_EnsembleUnion"."OVO_Class1" AS "OVO_Class1", "KernAgg_EnsembleUnion"."OVO_Class2" AS "OVO_Class2", "KernAgg_EnsembleUnion"."OVO_Decision" AS "OVO_Decision", "KernAgg_EnsembleUnion"."OVO_Conf" AS "OVO_Conf" 
FROM (SELECT "KernAgg_B0"."KEY" AS "KEY", "KernAgg_B0"."OVO_Class1" AS "OVO_Class1", "KernAgg_B0"."OVO_Class2" AS "OVO_Class2", "KernAgg_B0"."OVO_Decision" AS "OVO_Decision", "KernAgg_B0"."OVO_Conf" AS "OVO_Conf" 
FROM tmp_20180602143441_ndz_kernagg_b0 AS "KernAgg_B0" UNION ALL SELECT "KernAgg_B1"."KEY" AS "KEY", "KernAgg_B1"."OVO_Class1" AS "OVO_Class1", "KernAgg_B1"."OVO_Class2" AS "OVO_Class2", "KernAgg_B1"."OVO_Decision" AS "OVO_Decision", "KernAgg_B1"."OVO_Conf" AS "OVO_Conf" 
FROM tmp_20180602143441_4bu_kernagg_b1 AS "KernAgg_B1" UNION ALL SELECT "KernAgg_B2"."KEY" AS "KEY", "KernAgg_B2"."OVO_Class1" AS "OVO_Class1", "KernAgg_B2"."OVO_Class2" AS "OVO_Class2", "KernAgg_B2"."OVO_Decision" AS "OVO_Decision", "KernAgg_B2"."OVO_Conf" AS "OVO_Conf" 
FROM tmp_20180602143441_k1m_kernagg_b2 AS "KernAgg_B2" UNION ALL SELECT "KernAgg_B3"."KEY" AS "KEY", "KernAgg_B3"."OVO_Class1" AS "OVO_Class1", "KernAgg_B3"."OVO_Class2" AS "OVO_Class2", "KernAgg_B3"."OVO_Decision" AS "OVO_Decision", "KernAgg_B3"."OVO_Conf" AS "OVO_Conf" 
FROM tmp_20180602143441_gss_kernagg_b3 AS "KernAgg_B3" UNION ALL SELECT "KernAgg_B4"."KEY" AS "KEY", "KernAgg_B4"."OVO_Class1" AS "OVO_Class1", "KernAgg_B4"."OVO_Class2" AS "OVO_Class2", "KernAgg_B4"."OVO_Decision" AS "OVO_Decision", "KernAgg_B4"."OVO_Conf" AS "OVO_Conf" 
FROM tmp_20180602143441_2gc_kernagg_b4 AS "KernAgg_B4" UNION ALL SELECT "KernAgg_B5"."KEY" AS "KEY", "KernAgg_B5"."OVO_Class1" AS "OVO_Class1", "KernAgg_B5"."OVO_Class2" AS "OVO_Class2", "KernAgg_B5"."OVO_Decision" AS "OVO_Decision", "KernAgg_B5"."OVO_Conf" AS "OVO_Conf" 
FROM tmp_20180602143441_arj_kernagg_b5 AS "KernAgg_B5") AS "KernAgg_EnsembleUnion"), 
"OVO_Votes" AS 
(SELECT "Votes_Sel"."KEY" AS "KEY", "Votes_Sel"."OVO_Vote_0" AS "OVO_Vote_0", "Votes_Sel"."OVO_SumConfidence_0" AS "OVO_SumConfidence_0", "Votes_Sel"."OVO_Vote_1" AS "OVO_Vote_1", "Votes_Sel"."OVO_SumConfidence_1" AS "OVO_SumConfidence_1", "Votes_Sel"."OVO_Vote_2" AS "OVO_Vote_2", "Votes_Sel"."OVO_SumConfidence_2" AS "OVO_SumConfidence_2", "Votes_Sel"."OVO_Vote_3" AS "OVO_Vote_3", "Votes_Sel"."OVO_SumConfidence_3" AS "OVO_SumConfidence_3" 
FROM (SELECT "KernAgg_Union"."KEY" AS "KEY", sum(CASE WHEN ("KernAgg_Union"."OVO_Class1" = 0 OR "KernAgg_Union"."OVO_Class2" = 0) THEN 1 ELSE 0 END * (CASE WHEN ("KernAgg_Union"."OVO_Decision" = 0 AND "KernAgg_Union"."OVO_Class1" = 0) THEN 1 ELSE 0 END + CASE WHEN ("KernAgg_Union"."OVO_Decision" = 1 AND "KernAgg_Union"."OVO_Class2" = 0) THEN 1 ELSE 0 END)) AS "OVO_Vote_0", sum(CASE WHEN ("KernAgg_Union"."OVO_Class1" = 0 OR "KernAgg_Union"."OVO_Class2" = 0) THEN 1 ELSE 0 END * "KernAgg_Union"."OVO_Conf" * (-CASE WHEN ("KernAgg_Union"."OVO_Class1" = 0) THEN 1 ELSE 0 END + CASE WHEN ("KernAgg_Union"."OVO_Class2" = 0) THEN 1 ELSE 0 END)) AS "OVO_SumConfidence_0", sum(CASE WHEN ("KernAgg_Union"."OVO_Class1" = 1 OR "KernAgg_Union"."OVO_Class2" = 1) THEN 1 ELSE 0 END * (CASE WHEN ("KernAgg_Union"."OVO_Decision" = 0 AND "KernAgg_Union"."OVO_Class1" = 1) THEN 1 ELSE 0 END + CASE WHEN ("KernAgg_Union"."OVO_Decision" = 1 AND "KernAgg_Union"."OVO_Class2" = 1) THEN 1 ELSE 0 END)) AS "OVO_Vote_1", sum(CASE WHEN ("KernAgg_Union"."OVO_Class1" = 1 OR "KernAgg_Union"."OVO_Class2" = 1) THEN 1 ELSE 0 END * "KernAgg_Union"."OVO_Conf" * (-CASE WHEN ("KernAgg_Union"."OVO_Class1" = 1) THEN 1 ELSE 0 END + CASE WHEN ("KernAgg_Union"."OVO_Class2" = 1) THEN 1 ELSE 0 END)) AS "OVO_SumConfidence_1", sum(CASE WHEN ("KernAgg_Union"."OVO_Class1" = 2 OR "KernAgg_Union"."OVO_Class2" = 2) THEN 1 ELSE 0 END * (CASE WHEN ("KernAgg_Union"."OVO_Decision" = 0 AND "KernAgg_Union"."OVO_Class1" = 2) THEN 1 ELSE 0 END + CASE WHEN ("KernAgg_Union"."OVO_Decision" = 1 AND "KernAgg_Union"."OVO_Class2" = 2) THEN 1 ELSE 0 END)) AS "OVO_Vote_2", sum(CASE WHEN ("KernAgg_Union"."OVO_Class1" = 2 OR "KernAgg_Union"."OVO_Class2" = 2) THEN 1 ELSE 0 END * "KernAgg_Union"."OVO_Conf" * (-CASE WHEN ("KernAgg_Union"."OVO_Class1" = 2) THEN 1 ELSE 0 END + CASE WHEN ("KernAgg_Union"."OVO_Class2" = 2) THEN 1 ELSE 0 END)) AS "OVO_SumConfidence_2", sum(CASE WHEN ("KernAgg_Union"."OVO_Class1" = 3 OR "KernAgg_Union"."OVO_Class2" = 3) THEN 1 ELSE 0 END * (CASE WHEN ("KernAgg_Union"."OVO_Decision" = 0 AND "KernAgg_Union"."OVO_Class1" = 3) THEN 1 ELSE 0 END + CASE WHEN ("KernAgg_Union"."OVO_Decision" = 1 AND "KernAgg_Union"."OVO_Class2" = 3) THEN 1 ELSE 0 END)) AS "OVO_Vote_3", sum(CASE WHEN ("KernAgg_Union"."OVO_Class1" = 3 OR "KernAgg_Union"."OVO_Class2" = 3) THEN 1 ELSE 0 END * "KernAgg_Union"."OVO_Conf" * (-CASE WHEN ("KernAgg_Union"."OVO_Class1" = 3) THEN 1 ELSE 0 END + CASE WHEN ("KernAgg_Union"."OVO_Class2" = 3) THEN 1 ELSE 0 END)) AS "OVO_SumConfidence_3" 
FROM "KernAgg_Union" GROUP BY "KernAgg_Union"."KEY") AS "Votes_Sel"), 
"OVO_SumConf_CTE" AS 
(SELECT "Values"."KEY" AS "KEY", CAST("Values"."OVO_SumConfidence" AS DOUBLE) AS "OVO_SumConfidence" 
FROM (SELECT "OVO_Votes"."KEY" AS "KEY", "OVO_Votes"."OVO_SumConfidence_0" AS "OVO_SumConfidence" 
FROM "OVO_Votes" UNION ALL SELECT "OVO_Votes"."KEY" AS "KEY", "OVO_Votes"."OVO_SumConfidence_1" AS "OVO_SumConfidence" 
FROM "OVO_Votes" UNION ALL SELECT "OVO_Votes"."KEY" AS "KEY", "OVO_Votes"."OVO_SumConfidence_2" AS "OVO_SumConfidence" 
FROM "OVO_Votes" UNION ALL SELECT "OVO_Votes"."KEY" AS "KEY", "OVO_Votes"."OVO_SumConfidence_3" AS "OVO_SumConfidence" 
FROM "OVO_Votes") AS "Values"), 
"MinMaxConf" AS 
(SELECT min("OVO_SumConf_CTE"."OVO_SumConfidence") AS "OVO_min_conf", max("OVO_SumConf_CTE"."OVO_SumConfidence") AS "OVO_max_conf" 
FROM "OVO_SumConf_CTE"), 
"OVO_Votes_WithScale" AS 
(SELECT "OVO_Votes"."KEY" AS "KEY", "OVO_Votes"."OVO_Vote_0" AS "OVO_Vote_0", "OVO_Votes"."OVO_SumConfidence_0" AS "OVO_SumConfidence_0", "OVO_Votes"."OVO_Vote_1" AS "OVO_Vote_1", "OVO_Votes"."OVO_SumConfidence_1" AS "OVO_SumConfidence_1", "OVO_Votes"."OVO_Vote_2" AS "OVO_Vote_2", "OVO_Votes"."OVO_SumConfidence_2" AS "OVO_SumConfidence_2", "OVO_Votes"."OVO_Vote_3" AS "OVO_Vote_3", "OVO_Votes"."OVO_SumConfidence_3" AS "OVO_SumConfidence_3", CAST(CASE WHEN (abs("MinMaxConf"."OVO_min_conf") >= abs("MinMaxConf"."OVO_max_conf")) THEN abs("MinMaxConf"."OVO_min_conf") ELSE abs("MinMaxConf"."OVO_max_conf") END AS DOUBLE) AS max_abs_confidence, CASE WHEN ("MinMaxConf"."OVO_max_conf" - "MinMaxConf"."OVO_min_conf" <= 0.0) THEN 0.0 ELSE 0.4999999999999998 / CAST(CASE WHEN (abs("MinMaxConf"."OVO_min_conf") >= abs("MinMaxConf"."OVO_max_conf")) THEN abs("MinMaxConf"."OVO_min_conf") ELSE abs("MinMaxConf"."OVO_max_conf") END AS DOUBLE) END AS "OVO_Scale" 
FROM "OVO_Votes", "MinMaxConf")
 SELECT "KernAgg_agg"."KEY", "KernAgg_agg"."OVO_Vote_0", "KernAgg_agg"."OVO_SumConfidence_0", "KernAgg_agg"."OVO_Vote_1", "KernAgg_agg"."OVO_SumConfidence_1", "KernAgg_agg"."OVO_Vote_2", "KernAgg_agg"."OVO_SumConfidence_2", "KernAgg_agg"."OVO_Vote_3", "KernAgg_agg"."OVO_SumConfidence_3", "KernAgg_agg".max_abs_confidence, "KernAgg_agg"."OVO_Scale", "KernAgg_agg"."Score_0", "KernAgg_agg"."Score_1", "KernAgg_agg"."Score_2", "KernAgg_agg"."Score_3" 
FROM (SELECT "OVO_Votes_WithScale"."KEY" AS "KEY", "OVO_Votes_WithScale"."OVO_Vote_0" AS "OVO_Vote_0", "OVO_Votes_WithScale"."OVO_SumConfidence_0" AS "OVO_SumConfidence_0", "OVO_Votes_WithScale"."OVO_Vote_1" AS "OVO_Vote_1", "OVO_Votes_WithScale"."OVO_SumConfidence_1" AS "OVO_SumConfidence_1", "OVO_Votes_WithScale"."OVO_Vote_2" AS "OVO_Vote_2", "OVO_Votes_WithScale"."OVO_SumConfidence_2" AS "OVO_SumConfidence_2", "OVO_Votes_WithScale"."OVO_Vote_3" AS "OVO_Vote_3", "OVO_Votes_WithScale"."OVO_SumConfidence_3" AS "OVO_SumConfidence_3", "OVO_Votes_WithScale".max_abs_confidence AS max_abs_confidence, "OVO_Votes_WithScale"."OVO_Scale" AS "OVO_Scale", "OVO_Votes_WithScale"."OVO_Vote_0" + "OVO_Votes_WithScale"."OVO_Scale" * "OVO_Votes_WithScale"."OVO_SumConfidence_0" AS "Score_0", "OVO_Votes_WithScale"."OVO_Vote_1" + "OVO_Votes_WithScale"."OVO_Scale" * "OVO_Votes_WithScale"."OVO_SumConfidence_1" AS "Score_1", "OVO_Votes_WithScale"."OVO_Vote_2" + "OVO_Votes_WithScale"."OVO_Scale" * "OVO_Votes_WithScale"."OVO_SumConfidence_2" AS "Score_2", "OVO_Votes_WithScale"."OVO_Vote_3" + "OVO_Votes_WithScale"."OVO_Scale" * "OVO_Votes_WithScale"."OVO_SumConfidence_3" AS "Score_3" 
FROM "OVO_Votes_WithScale") AS "KernAgg_agg"

-- Model deployment code

WITH orig_cte AS 
(SELECT "KernAgg_agg"."KEY" AS "KEY", "KernAgg_agg"."Score_0" AS "Score_0", "KernAgg_agg"."Score_1" AS "Score_1", "KernAgg_agg"."Score_2" AS "Score_2", "KernAgg_agg"."Score_3" AS "Score_3", CAST(NULL AS DOUBLE) AS "Proba_0", CAST(NULL AS DOUBLE) AS "Proba_1", CAST(NULL AS DOUBLE) AS "Proba_2", CAST(NULL AS DOUBLE) AS "Proba_3", CAST(NULL AS DOUBLE) AS "LogProba_0", CAST(NULL AS DOUBLE) AS "LogProba_1", CAST(NULL AS DOUBLE) AS "LogProba_2", CAST(NULL AS DOUBLE) AS "LogProba_3", NULL AS "Decision", CAST(NULL AS DOUBLE) AS "DecisionProba" 
FROM tmp_20180602143442_6i5_kernagg_agg AS "KernAgg_agg"), 
score_class_union AS 
(SELECT scu."KEY_u" AS "KEY_u", scu.class AS class, scu."LogProba" AS "LogProba", scu."Proba" AS "Proba", scu."Score" AS "Score" 
FROM (SELECT orig_cte."KEY" AS "KEY_u", 0 AS class, orig_cte."LogProba_0" AS "LogProba", orig_cte."Proba_0" AS "Proba", orig_cte."Score_0" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY_u", 1 AS class, orig_cte."LogProba_1" AS "LogProba", orig_cte."Proba_1" AS "Proba", orig_cte."Score_1" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY_u", 2 AS class, orig_cte."LogProba_2" AS "LogProba", orig_cte."Proba_2" AS "Proba", orig_cte."Score_2" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY_u", 3 AS class, orig_cte."LogProba_3" AS "LogProba", orig_cte."Proba_3" AS "Proba", orig_cte."Score_3" AS "Score" 
FROM orig_cte) AS scu), 
score_max AS 
(SELECT orig_cte."KEY" AS "KEY", orig_cte."Score_0" AS "Score_0", orig_cte."Score_1" AS "Score_1", orig_cte."Score_2" AS "Score_2", orig_cte."Score_3" AS "Score_3", orig_cte."Proba_0" AS "Proba_0", orig_cte."Proba_1" AS "Proba_1", orig_cte."Proba_2" AS "Proba_2", orig_cte."Proba_3" AS "Proba_3", orig_cte."LogProba_0" AS "LogProba_0", orig_cte."LogProba_1" AS "LogProba_1", orig_cte."LogProba_2" AS "LogProba_2", orig_cte."LogProba_3" AS "LogProba_3", orig_cte."Decision" AS "Decision", orig_cte."DecisionProba" AS "DecisionProba", max_select."KEY_m" AS "KEY_m", max_select."max_Score" AS "max_Score" 
FROM orig_cte LEFT OUTER JOIN (SELECT score_class_union."KEY_u" AS "KEY_m", max(score_class_union."Score") AS "max_Score" 
FROM score_class_union GROUP BY score_class_union."KEY_u") AS max_select ON orig_cte."KEY" = max_select."KEY_m"), 
union_with_max AS 
(SELECT score_class_union."KEY_u" AS "KEY_u", score_class_union.class AS class, score_class_union."LogProba" AS "LogProba", score_class_union."Proba" AS "Proba", score_class_union."Score" AS "Score", score_max."KEY" AS "KEY", score_max."Score_0" AS "Score_0", score_max."Score_1" AS "Score_1", score_max."Score_2" AS "Score_2", score_max."Score_3" AS "Score_3", score_max."Proba_0" AS "Proba_0", score_max."Proba_1" AS "Proba_1", score_max."Proba_2" AS "Proba_2", score_max."Proba_3" AS "Proba_3", score_max."LogProba_0" AS "LogProba_0", score_max."LogProba_1" AS "LogProba_1", score_max."LogProba_2" AS "LogProba_2", score_max."LogProba_3" AS "LogProba_3", score_max."Decision" AS "Decision", score_max."DecisionProba" AS "DecisionProba", score_max."KEY_m" AS "KEY_m", score_max."max_Score" AS "max_Score" 
FROM score_class_union LEFT OUTER JOIN score_max ON score_class_union."KEY_u" = score_max."KEY"), 
arg_max_cte AS 
(SELECT score_max."KEY" AS "KEY", score_max."Score_0" AS "Score_0", score_max."Score_1" AS "Score_1", score_max."Score_2" AS "Score_2", score_max."Score_3" AS "Score_3", score_max."Proba_0" AS "Proba_0", score_max."Proba_1" AS "Proba_1", score_max."Proba_2" AS "Proba_2", score_max."Proba_3" AS "Proba_3", score_max."LogProba_0" AS "LogProba_0", score_max."LogProba_1" AS "LogProba_1", score_max."LogProba_2" AS "LogProba_2", score_max."LogProba_3" AS "LogProba_3", score_max."Decision" AS "Decision", score_max."DecisionProba" AS "DecisionProba", score_max."KEY_m" AS "KEY_m", score_max."max_Score" AS "max_Score", "arg_max_t_Score"."KEY_Score" AS "KEY_Score", "arg_max_t_Score"."arg_max_Score" AS "arg_max_Score" 
FROM score_max LEFT OUTER JOIN (SELECT union_with_max."KEY" AS "KEY_Score", min(union_with_max.class) AS "arg_max_Score" 
FROM union_with_max 
WHERE union_with_max."Score" >= union_with_max."max_Score" GROUP BY union_with_max."KEY") AS "arg_max_t_Score" ON score_max."KEY" = "arg_max_t_Score"."KEY_Score")
 SELECT arg_max_cte."KEY" AS "KEY", arg_max_cte."Score_0" AS "Score_0", arg_max_cte."Score_1" AS "Score_1", arg_max_cte."Score_2" AS "Score_2", arg_max_cte."Score_3" AS "Score_3", arg_max_cte."Proba_0" AS "Proba_0", arg_max_cte."Proba_1" AS "Proba_1", arg_max_cte."Proba_2" AS "Proba_2", arg_max_cte."Proba_3" AS "Proba_3", CASE WHEN (arg_max_cte."Proba_0" IS NULL OR arg_max_cte."Proba_0" > 0.0) THEN ln(arg_max_cte."Proba_0") ELSE -1.79769313486231e+308 END AS "LogProba_0", CASE WHEN (arg_max_cte."Proba_1" IS NULL OR arg_max_cte."Proba_1" > 0.0) THEN ln(arg_max_cte."Proba_1") ELSE -1.79769313486231e+308 END AS "LogProba_1", CASE WHEN (arg_max_cte."Proba_2" IS NULL OR arg_max_cte."Proba_2" > 0.0) THEN ln(arg_max_cte."Proba_2") ELSE -1.79769313486231e+308 END AS "LogProba_2", CASE WHEN (arg_max_cte."Proba_3" IS NULL OR arg_max_cte."Proba_3" > 0.0) THEN ln(arg_max_cte."Proba_3") ELSE -1.79769313486231e+308 END AS "LogProba_3", arg_max_cte."arg_max_Score" AS "Decision", CASE WHEN (arg_max_cte."arg_max_Score" = 0) THEN arg_max_cte."Proba_0" WHEN (arg_max_cte."arg_max_Score" = 1) THEN arg_max_cte."Proba_1" WHEN (arg_max_cte."arg_max_Score" = 2) THEN arg_max_cte."Proba_2" WHEN (arg_max_cte."arg_max_Score" = 3) THEN arg_max_cte."Proba_3" END AS "DecisionProba" 
FROM arg_max_cte