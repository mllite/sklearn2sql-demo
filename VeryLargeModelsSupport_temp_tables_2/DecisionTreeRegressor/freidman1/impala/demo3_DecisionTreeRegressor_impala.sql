-- This SQL code was generated by sklearn2sql (development version).
-- Copyright 2018

-- Model : DecisionTreeRegressor
-- Dataset : freidman1
-- Database : impala


-- This SQL code can contain one or more statements, to be executed in the order they appear in this file.



-- Model deployment code

WITH `DT_node_lookup` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_1` <= 0.44577229022979736) THEN CASE WHEN (`ADS`.`Feature_4` <= 0.6678532958030701) THEN CASE WHEN (`ADS`.`Feature_3` <= 0.4583197236061096) THEN CASE WHEN (`ADS`.`Feature_8` <= 0.1413707435131073) THEN 4 ELSE CASE WHEN (`ADS`.`Feature_5` <= 0.1925923377275467) THEN CASE WHEN (`ADS`.`Feature_4` <= 0.27703478932380676) THEN 7 ELSE CASE WHEN (`ADS`.`Feature_3` <= 0.18946413695812225) THEN 9 ELSE 10 END END ELSE CASE WHEN (`ADS`.`Feature_3` <= 0.09447410702705383) THEN CASE WHEN (`ADS`.`Feature_2` <= 0.5338698625564575) THEN 13 ELSE CASE WHEN (`ADS`.`Feature_5` <= 0.3785055875778198) THEN 15 ELSE 16 END END ELSE CASE WHEN (`ADS`.`Feature_5` <= 0.617459774017334) THEN CASE WHEN (`ADS`.`Feature_5` <= 0.39834147691726685) THEN 19 ELSE 20 END ELSE CASE WHEN (`ADS`.`Feature_8` <= 0.5502381324768066) THEN CASE WHEN (`ADS`.`Feature_6` <= 0.39417439699172974) THEN 23 ELSE 24 END ELSE CASE WHEN (`ADS`.`Feature_4` <= 0.5001286268234253) THEN 26 ELSE 27 END END END END END END ELSE CASE WHEN (`ADS`.`Feature_1` <= 0.24637049436569214) THEN CASE WHEN (`ADS`.`Feature_5` <= 0.9225369095802307) THEN CASE WHEN (`ADS`.`Feature_9` <= 0.8895005583763123) THEN CASE WHEN (`ADS`.`Feature_2` <= 0.09128302335739136) THEN 32 ELSE CASE WHEN (`ADS`.`Feature_4` <= 0.6291640996932983) THEN CASE WHEN (`ADS`.`Feature_5` <= 0.8189209699630737) THEN CASE WHEN (`ADS`.`Feature_6` <= 0.18259304761886597) THEN CASE WHEN (`ADS`.`Feature_8` <= 0.7472862005233765) THEN 37 ELSE 38 END ELSE CASE WHEN (`ADS`.`Feature_3` <= 0.7136145830154419) THEN 40 ELSE 41 END END ELSE 42 END ELSE 43 END END ELSE CASE WHEN (`ADS`.`Feature_4` <= 0.5237888693809509) THEN 45 ELSE 46 END END ELSE 47 END ELSE CASE WHEN (`ADS`.`Feature_0` <= 0.541324257850647) THEN CASE WHEN (`ADS`.`Feature_1` <= 0.3046325445175171) THEN CASE WHEN (`ADS`.`Feature_7` <= 0.5161080360412598) THEN 51 ELSE 52 END ELSE 53 END ELSE CASE WHEN (`ADS`.`Feature_2` <= 0.45538997650146484) THEN 55 ELSE CASE WHEN (`ADS`.`Feature_4` <= 0.2480442076921463) THEN 57 ELSE 58 END END END END END ELSE CASE WHEN (`ADS`.`Feature_3` <= 0.6619341373443604) THEN CASE WHEN (`ADS`.`Feature_8` <= 0.3244403898715973) THEN CASE WHEN (`ADS`.`Feature_1` <= 0.23734164237976074) THEN 62 ELSE 63 END ELSE CASE WHEN (`ADS`.`Feature_8` <= 0.7667050361633301) THEN CASE WHEN (`ADS`.`Feature_7` <= 0.6441303491592407) THEN 66 ELSE CASE WHEN (`ADS`.`Feature_8` <= 0.7098629474639893) THEN 68 ELSE 69 END END ELSE 70 END END ELSE CASE WHEN (`ADS`.`Feature_0` <= 0.8129578828811646) THEN CASE WHEN (`ADS`.`Feature_7` <= 0.3239285349845886) THEN CASE WHEN (`ADS`.`Feature_9` <= 0.5372053384780884) THEN 74 ELSE 75 END ELSE 76 END ELSE 77 END END END ELSE CASE WHEN (`ADS`.`Feature_3` <= 0.27792081236839294) THEN CASE WHEN (`ADS`.`Feature_0` <= 0.37086910009384155) THEN CASE WHEN (`ADS`.`Feature_2` <= 0.21655012667179108) THEN 81 ELSE CASE WHEN (`ADS`.`Feature_0` <= 0.29816341400146484) THEN 83 ELSE CASE WHEN (`ADS`.`Feature_7` <= 0.47128358483314514) THEN 85 ELSE 86 END END END ELSE CASE WHEN (`ADS`.`Feature_0` <= 0.8121815919876099) THEN CASE WHEN (`ADS`.`Feature_0` <= 0.4862767159938812) THEN CASE WHEN (`ADS`.`Feature_5` <= 0.5021837949752808) THEN 90 ELSE 91 END ELSE CASE WHEN (`ADS`.`Feature_5` <= 0.6428447961807251) THEN 93 ELSE 94 END END ELSE CASE WHEN (`ADS`.`Feature_7` <= 0.33186042308807373) THEN 96 ELSE 97 END END END ELSE CASE WHEN (`ADS`.`Feature_0` <= 0.23805725574493408) THEN CASE WHEN (`ADS`.`Feature_5` <= 0.9631621837615967) THEN CASE WHEN (`ADS`.`Feature_2` <= 0.3459535241127014) THEN 101 ELSE 102 END ELSE 103 END ELSE CASE WHEN (`ADS`.`Feature_3` <= 0.7423961162567139) THEN CASE WHEN (`ADS`.`Feature_5` <= 0.9200620651245117) THEN CASE WHEN (`ADS`.`Feature_5` <= 0.5558743476867676) THEN CASE WHEN (`ADS`.`Feature_1` <= 0.6416755318641663) THEN CASE WHEN (`ADS`.`Feature_3` <= 0.5546689033508301) THEN 109 ELSE 110 END ELSE CASE WHEN (`ADS`.`Feature_0` <= 0.5959380269050598) THEN CASE WHEN (`ADS`.`Feature_5` <= 0.38930949568748474) THEN CASE WHEN (`ADS`.`Feature_1` <= 0.7748122215270996) THEN 114 ELSE 115 END ELSE 116 END ELSE 117 END END ELSE CASE WHEN (`ADS`.`Feature_2` <= 0.12859861552715302) THEN 119 ELSE CASE WHEN (`ADS`.`Feature_0` <= 0.7265768051147461) THEN CASE WHEN (`ADS`.`Feature_7` <= 0.34459739923477173) THEN 122 ELSE CASE WHEN (`ADS`.`Feature_6` <= 0.5111083388328552) THEN 124 ELSE CASE WHEN (`ADS`.`Feature_4` <= 0.5647256970405579) THEN 126 ELSE 127 END END END ELSE CASE WHEN (`ADS`.`Feature_1` <= 0.6148624420166016) THEN CASE WHEN (`ADS`.`Feature_4` <= 0.3104628324508667) THEN 130 ELSE 131 END ELSE 132 END END END END ELSE CASE WHEN (`ADS`.`Feature_7` <= 0.35593998432159424) THEN 134 ELSE 135 END END ELSE CASE WHEN (`ADS`.`Feature_0` <= 0.8087022304534912) THEN CASE WHEN (`ADS`.`Feature_5` <= 0.939079999923706) THEN CASE WHEN (`ADS`.`Feature_5` <= 0.21848127245903015) THEN 139 ELSE CASE WHEN (`ADS`.`Feature_1` <= 0.5314056873321533) THEN CASE WHEN (`ADS`.`Feature_7` <= 0.7876538038253784) THEN CASE WHEN (`ADS`.`Feature_5` <= 0.5631897449493408) THEN 143 ELSE 144 END ELSE 145 END ELSE CASE WHEN (`ADS`.`Feature_8` <= 0.3314327597618103) THEN 147 ELSE CASE WHEN (`ADS`.`Feature_7` <= 0.508262038230896) THEN 149 ELSE CASE WHEN (`ADS`.`Feature_3` <= 0.9129621386528015) THEN 151 ELSE 152 END END END END END ELSE CASE WHEN (`ADS`.`Feature_4` <= 0.6881959438323975) THEN 154 ELSE 155 END END ELSE CASE WHEN (`ADS`.`Feature_7` <= 0.26279619336128235) THEN 157 ELSE 158 END END END END END END AS node_id_2 
FROM freidman1 AS `ADS`), 
`DT_node_data` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`E` AS DOUBLE) AS `E` 
FROM (SELECT 4 AS nid, 12.760129264370008 AS `E` UNION ALL SELECT 7 AS nid, 12.071171804127433 AS `E` UNION ALL SELECT 9 AS nid, 9.735041217996262 AS `E` UNION ALL SELECT 10 AS nid, 10.045203605952587 AS `E` UNION ALL SELECT 13 AS nid, 5.293284001301807 AS `E` UNION ALL SELECT 15 AS nid, 5.794379036456321 AS `E` UNION ALL SELECT 16 AS nid, 6.2457102486321485 AS `E` UNION ALL SELECT 19 AS nid, 6.980046241948142 AS `E` UNION ALL SELECT 20 AS nid, 6.861453719338209 AS `E` UNION ALL SELECT 23 AS nid, 8.240178848678195 AS `E` UNION ALL SELECT 24 AS nid, 8.06285010237755 AS `E` UNION ALL SELECT 26 AS nid, 7.732429808148176 AS `E` UNION ALL SELECT 27 AS nid, 7.556998078346253 AS `E` UNION ALL SELECT 32 AS nid, 10.483066772506376 AS `E` UNION ALL SELECT 37 AS nid, 12.109886588685942 AS `E` UNION ALL SELECT 38 AS nid, 12.123142001356333 AS `E` UNION ALL SELECT 40 AS nid, 11.789821637076107 AS `E` UNION ALL SELECT 41 AS nid, 11.77602304541345 AS `E` UNION ALL SELECT 42 AS nid, 11.313518144724842 AS `E` UNION ALL SELECT 43 AS nid, 12.830344628983799 AS `E` UNION ALL SELECT 45 AS nid, 10.20209310032856 AS `E` UNION ALL SELECT 46 AS nid, 10.596890487725023 AS `E` UNION ALL SELECT 47 AS nid, 8.897074147742197 AS `E` UNION ALL SELECT 51 AS nid, 14.772563754565986 AS `E` UNION ALL SELECT 52 AS nid, 14.051184902745373 AS `E` UNION ALL SELECT 53 AS nid, 13.174202057525061 AS `E` UNION ALL SELECT 55 AS nid, 15.922558108080853 AS `E` UNION ALL SELECT 57 AS nid, 17.31914707358036 AS `E` UNION ALL SELECT 58 AS nid, 18.282515066510527 AS `E` UNION ALL SELECT 62 AS nid, 11.380993151416082 AS `E` UNION ALL SELECT 63 AS nid, 13.119756721377405 AS `E` UNION ALL SELECT 66 AS nid, 16.08254261562184 AS `E` UNION ALL SELECT 68 AS nid, 16.324769596540094 AS `E` UNION ALL SELECT 69 AS nid, 16.302556715766507 AS `E` UNION ALL SELECT 70 AS nid, 14.4669963696142 AS `E` UNION ALL SELECT 74 AS nid, 18.332058017434036 AS `E` UNION ALL SELECT 75 AS nid, 18.493721395486528 AS `E` UNION ALL SELECT 76 AS nid, 18.0076175728853 AS `E` UNION ALL SELECT 77 AS nid, 23.693970395239383 AS `E` UNION ALL SELECT 81 AS nid, 15.541797868565153 AS `E` UNION ALL SELECT 83 AS nid, 7.219443350314415 AS `E` UNION ALL SELECT 85 AS nid, 10.181631174833692 AS `E` UNION ALL SELECT 86 AS nid, 10.131789617052231 AS `E` UNION ALL SELECT 90 AS nid, 16.009611596379663 AS `E` UNION ALL SELECT 91 AS nid, 16.301279206146624 AS `E` UNION ALL SELECT 93 AS nid, 15.706521981990113 AS `E` UNION ALL SELECT 94 AS nid, 15.701003452436051 AS `E` UNION ALL SELECT 96 AS nid, 18.2506955183825 AS `E` UNION ALL SELECT 97 AS nid, 17.89244707919063 AS `E` UNION ALL SELECT 101 AS nid, 15.308483991007721 AS `E` UNION ALL SELECT 102 AS nid, 14.536245187358322 AS `E` UNION ALL SELECT 103 AS nid, 12.423411759463056 AS `E` UNION ALL SELECT 109 AS nid, 18.237613821788198 AS `E` UNION ALL SELECT 110 AS nid, 18.10948375079814 AS `E` UNION ALL SELECT 114 AS nid, 20.069702085916557 AS `E` UNION ALL SELECT 115 AS nid, 19.95894272650593 AS `E` UNION ALL SELECT 116 AS nid, 20.199033606227683 AS `E` UNION ALL SELECT 117 AS nid, 19.36426348416223 AS `E` UNION ALL SELECT 119 AS nid, 19.59215342592271 AS `E` UNION ALL SELECT 122 AS nid, 16.914408313385564 AS `E` UNION ALL SELECT 124 AS nid, 17.36059041334922 AS `E` UNION ALL SELECT 126 AS nid, 17.51855412510629 AS `E` UNION ALL SELECT 127 AS nid, 17.451457795201584 AS `E` UNION ALL SELECT 130 AS nid, 17.80609748957471 AS `E` UNION ALL SELECT 131 AS nid, 17.954676995000113 AS `E` UNION ALL SELECT 132 AS nid, 18.250248044100616 AS `E` UNION ALL SELECT 134 AS nid, 23.18131440832091 AS `E` UNION ALL SELECT 135 AS nid, 20.629855906779248 AS `E` UNION ALL SELECT 139 AS nid, 19.303788312018888 AS `E` UNION ALL SELECT 143 AS nid, 21.340993370178953 AS `E` UNION ALL SELECT 144 AS nid, 21.774000353025308 AS `E` UNION ALL SELECT 145 AS nid, 20.70189537226964 AS `E` UNION ALL SELECT 147 AS nid, 23.76092016032117 AS `E` UNION ALL SELECT 149 AS nid, 22.309754489339827 AS `E` UNION ALL SELECT 151 AS nid, 22.76939496981568 AS `E` UNION ALL SELECT 152 AS nid, 23.030279372436098 AS `E` UNION ALL SELECT 154 AS nid, 25.24805848092261 AS `E` UNION ALL SELECT 155 AS nid, 24.713338273149652 AS `E` UNION ALL SELECT 157 AS nid, 18.900387696177468 AS `E` UNION ALL SELECT 158 AS nid, 17.41761147731962 AS `E`) AS `Values`), 
`DT_Output` AS 
(SELECT `DT_node_lookup`.`KEY` AS `KEY`, `DT_node_lookup`.node_id_2 AS node_id_2, `DT_node_data`.nid AS nid, `DT_node_data`.`E` AS `E` 
FROM `DT_node_lookup` LEFT OUTER JOIN `DT_node_data` ON `DT_node_lookup`.node_id_2 = `DT_node_data`.nid)
 SELECT `DT_Output`.`KEY` AS `KEY`, `DT_Output`.`E` AS `Estimator` 
FROM `DT_Output`